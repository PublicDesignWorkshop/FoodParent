/*!
 * jQuery JavaScript Library v2.1.4
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-04-28T16:01Z
 */
function isValidEmailAddress(n){return/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i.test(n)}function destroyView(n){n.destroy()}var skipLabels,nativeSplit,compliantExecNpcg,replaceAt,__extends,FoodParent;(function(n,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=n.document?t(n,!0):function(n){if(!n.document)throw new Error("jQuery requires a window with a document");return t(n)}:t(n)})(typeof window!="undefined"?window:this,function(n,t){function ri(n){var t="length"in n&&n.length,r=i.type(n);return r==="function"||i.isWindow(n)?!1:n.nodeType===1&&t?!0:r==="array"||t===0||typeof t=="number"&&t>0&&t-1 in n}function ui(n,t,r){if(i.isFunction(t))return i.grep(n,function(n,i){return!!t.call(n,i,n)!==r});if(t.nodeType)return i.grep(n,function(n){return n===t!==r});if(typeof t=="string"){if(ef.test(t))return i.filter(t,n,r);t=i.filter(t,n)}return i.grep(n,function(n){return ft.call(t,n)>=0!==r})}function ur(n,t){while((n=n[t])&&n.nodeType!==1);return n}function of(n){var t=fi[n]={};return i.each(n.match(c)||[],function(n,i){t[i]=!0}),t}function ht(){u.removeEventListener("DOMContentLoaded",ht,!1);n.removeEventListener("load",ht,!1);i.ready()}function v(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=i.expando+v.uid++}function fr(n,t,r){var u;if(r===undefined&&n.nodeType===1)if(u="data-"+t.replace(hf,"-$1").toLowerCase(),r=n.getAttribute(u),typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:sf.test(r)?i.parseJSON(r):r}catch(f){}e.set(n,t,r)}else r=undefined;return r}function lt(){return!0}function k(){return!1}function hr(){try{return u.activeElement}catch(n){}}function vr(n,t){return i.nodeName(n,"table")&&i.nodeName(t.nodeType!==11?t:t.firstChild,"tr")?n.getElementsByTagName("tbody")[0]||n.appendChild(n.ownerDocument.createElement("tbody")):n}function bf(n){return n.type=(n.getAttribute("type")!==null)+"/"+n.type,n}function kf(n){var t=pf.exec(n.type);return t?n.type=t[1]:n.removeAttribute("type"),n}function ei(n,t){for(var i=0,u=n.length;i<u;i++)r.set(n[i],"globalEval",!t||r.get(t[i],"globalEval"))}function yr(n,t){var f,c,o,s,h,l,a,u;if(t.nodeType===1){if(r.hasData(n)&&(s=r.access(n),h=r.set(t,s),u=s.events,u)){delete h.handle;h.events={};for(o in u)for(f=0,c=u[o].length;f<c;f++)i.event.add(t,o,u[o][f])}e.hasData(n)&&(l=e.access(n),a=i.extend({},l),e.set(t,a))}}function o(n,t){var r=n.getElementsByTagName?n.getElementsByTagName(t||"*"):n.querySelectorAll?n.querySelectorAll(t||"*"):[];return t===undefined||t&&i.nodeName(n,t)?i.merge([n],r):r}function df(n,t){var i=t.nodeName.toLowerCase();i==="input"&&er.test(n.type)?t.checked=n.checked:(i==="input"||i==="textarea")&&(t.defaultValue=n.defaultValue)}function pr(t,r){var f,u=i(r.createElement(t)).appendTo(r.body),e=n.getDefaultComputedStyle&&(f=n.getDefaultComputedStyle(u[0]))?f.display:i.css(u[0],"display");return u.detach(),e}function si(n){var r=u,t=oi[n];return t||(t=pr(n,r),t!=="none"&&t||(at=(at||i("<iframe frameborder='0' width='0' height='0'/>")).appendTo(r.documentElement),r=at[0].contentDocument,r.write(),r.close(),t=pr(n,r),at.detach()),oi[n]=t),t}function it(n,t,r){var e,o,s,u,f=n.style;return r=r||vt(n),r&&(u=r.getPropertyValue(t)||r[t]),r&&(u!==""||i.contains(n.ownerDocument,n)||(u=i.style(n,t)),hi.test(u)&&wr.test(t)&&(e=f.width,o=f.minWidth,s=f.maxWidth,f.minWidth=f.maxWidth=f.width=u,u=r.width,f.width=e,f.minWidth=o,f.maxWidth=s)),u!==undefined?u+"":u}function br(n,t){return{get:function(){if(n()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function gr(n,t){if(t in n)return t;for(var r=t[0].toUpperCase()+t.slice(1),u=t,i=dr.length;i--;)if(t=dr[i]+r,t in n)return t;return u}function nu(n,t,i){var r=ne.exec(t);return r?Math.max(0,r[1]-(i||0))+(r[2]||"px"):t}function tu(n,t,r,u,f){for(var e=r===(u?"border":"content")?4:t==="width"?1:0,o=0;e<4;e+=2)r==="margin"&&(o+=i.css(n,r+p[e],!0,f)),u?(r==="content"&&(o-=i.css(n,"padding"+p[e],!0,f)),r!=="margin"&&(o-=i.css(n,"border"+p[e]+"Width",!0,f))):(o+=i.css(n,"padding"+p[e],!0,f),r!=="padding"&&(o+=i.css(n,"border"+p[e]+"Width",!0,f)));return o}function iu(n,t,r){var o=!0,u=t==="width"?n.offsetWidth:n.offsetHeight,e=vt(n),s=i.css(n,"boxSizing",!1,e)==="border-box";if(u<=0||u==null){if(u=it(n,t,e),(u<0||u==null)&&(u=n.style[t]),hi.test(u))return u;o=s&&(f.boxSizingReliable()||u===n.style[t]);u=parseFloat(u)||0}return u+tu(n,t,r||(s?"border":"content"),o,e)+"px"}function ru(n,t){for(var e,u,s,o=[],f=0,h=n.length;f<h;f++)(u=n[f],u.style)&&(o[f]=r.get(u,"olddisplay"),e=u.style.display,t?(o[f]||e!=="none"||(u.style.display=""),u.style.display===""&&tt(u)&&(o[f]=r.access(u,"olddisplay",si(u.nodeName)))):(s=tt(u),e==="none"&&s||r.set(u,"olddisplay",s?e:i.css(u,"display"))));for(f=0;f<h;f++)(u=n[f],u.style)&&(t&&u.style.display!=="none"&&u.style.display!==""||(u.style.display=t?o[f]||"":"none"));return n}function s(n,t,i,r,u){return new s.prototype.init(n,t,i,r,u)}function fu(){return setTimeout(function(){d=undefined}),d=i.now()}function wt(n,t){var r,u=0,i={height:n};for(t=t?1:0;u<4;u+=2-t)r=p[u],i["margin"+r]=i["padding"+r]=n;return t&&(i.opacity=i.width=n),i}function eu(n,t,i){for(var u,f=(rt[t]||[]).concat(rt["*"]),r=0,e=f.length;r<e;r++)if(u=f[r].call(i,t,n))return u}function fe(n,t,u){var f,a,p,v,o,w,h,b,l=this,y={},s=n.style,c=n.nodeType&&tt(n),e=r.get(n,"fxshow");u.queue||(o=i._queueHooks(n,"fx"),o.unqueued==null&&(o.unqueued=0,w=o.empty.fire,o.empty.fire=function(){o.unqueued||w()}),o.unqueued++,l.always(function(){l.always(function(){o.unqueued--;i.queue(n,"fx").length||o.empty.fire()})}));n.nodeType===1&&("height"in t||"width"in t)&&(u.overflow=[s.overflow,s.overflowX,s.overflowY],h=i.css(n,"display"),b=h==="none"?r.get(n,"olddisplay")||si(n.nodeName):h,b==="inline"&&i.css(n,"float")==="none"&&(s.display="inline-block"));u.overflow&&(s.overflow="hidden",l.always(function(){s.overflow=u.overflow[0];s.overflowX=u.overflow[1];s.overflowY=u.overflow[2]}));for(f in t)if(a=t[f],re.exec(a)){if(delete t[f],p=p||a==="toggle",a===(c?"hide":"show"))if(a==="show"&&e&&e[f]!==undefined)c=!0;else continue;y[f]=e&&e[f]||i.style(n,f)}else h=undefined;if(i.isEmptyObject(y))(h==="none"?si(n.nodeName):h)==="inline"&&(s.display=h);else{e?"hidden"in e&&(c=e.hidden):e=r.access(n,"fxshow",{});p&&(e.hidden=!c);c?i(n).show():l.done(function(){i(n).hide()});l.done(function(){var t;r.remove(n,"fxshow");for(t in y)i.style(n,t,y[t])});for(f in y)v=eu(c?e[f]:0,f,l),f in e||(e[f]=v.start,c&&(v.end=v.start,v.start=f==="width"||f==="height"?1:0))}}function ee(n,t){var r,f,e,u,o;for(r in n)if(f=i.camelCase(r),e=t[f],u=n[r],i.isArray(u)&&(e=u[1],u=n[r]=u[0]),r!==f&&(n[f]=u,delete n[r]),o=i.cssHooks[f],o&&"expand"in o){u=o.expand(u);delete n[f];for(r in u)r in n||(n[r]=u[r],t[r]=e)}else t[f]=e}function ou(n,t,r){var e,o,s=0,l=pt.length,f=i.Deferred().always(function(){delete c.elem}),c=function(){if(o)return!1;for(var s=d||fu(),t=Math.max(0,u.startTime+u.duration-s),h=t/u.duration||0,i=1-h,r=0,e=u.tweens.length;r<e;r++)u.tweens[r].run(i);return f.notifyWith(n,[u,i,t]),i<1&&e?t:(f.resolveWith(n,[u]),!1)},u=f.promise({elem:n,props:i.extend({},t),opts:i.extend(!0,{specialEasing:{}},r),originalProperties:t,originalOptions:r,startTime:d||fu(),duration:r.duration,tweens:[],createTween:function(t,r){var f=i.Tween(n,u.opts,t,r,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(f),f},stop:function(t){var i=0,r=t?u.tweens.length:0;if(o)return this;for(o=!0;i<r;i++)u.tweens[i].run(1);return t?f.resolveWith(n,[u,t]):f.rejectWith(n,[u,t]),this}}),h=u.props;for(ee(h,u.opts.specialEasing);s<l;s++)if(e=pt[s].call(u,n,h,u.opts),e)return e;return i.map(h,eu,u),i.isFunction(u.opts.start)&&u.opts.start.call(n,u),i.fx.timer(i.extend(c,{elem:n,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function pu(n){return function(t,r){typeof t!="string"&&(r=t,t="*");var u,f=0,e=t.toLowerCase().match(c)||[];if(i.isFunction(r))while(u=e[f++])u[0]==="+"?(u=u.slice(1)||"*",(n[u]=n[u]||[]).unshift(r)):(n[u]=n[u]||[]).push(r)}}function wu(n,t,r,u){function e(s){var h;return f[s]=!0,i.each(n[s]||[],function(n,i){var s=i(t,r,u);if(typeof s!="string"||o||f[s]){if(o)return!(h=s)}else return t.dataTypes.unshift(s),e(s),!1}),h}var f={},o=n===ci;return e(t.dataTypes[0])||!f["*"]&&e("*")}function ai(n,t){var r,u,f=i.ajaxSettings.flatOptions||{};for(r in t)t[r]!==undefined&&((f[r]?n:u||(u={}))[r]=t[r]);return u&&i.extend(!0,n,u),n}function ae(n,t,i){for(var e,u,f,o,s=n.contents,r=n.dataTypes;r[0]==="*";)r.shift(),e===undefined&&(e=n.mimeType||t.getResponseHeader("Content-Type"));if(e)for(u in s)if(s[u]&&s[u].test(e)){r.unshift(u);break}if(r[0]in i)f=r[0];else{for(u in i){if(!r[0]||n.converters[u+" "+r[0]]){f=u;break}o||(o=u)}f=f||o}if(f)return f!==r[0]&&r.unshift(f),i[f]}function ve(n,t,i,r){var h,u,f,s,e,o={},c=n.dataTypes.slice();if(c[1])for(f in n.converters)o[f.toLowerCase()]=n.converters[f];for(u=c.shift();u;)if(n.responseFields[u]&&(i[n.responseFields[u]]=t),!e&&r&&n.dataFilter&&(t=n.dataFilter(t,n.dataType)),e=u,u=c.shift(),u)if(u==="*")u=e;else if(e!=="*"&&e!==u){if(f=o[e+" "+u]||o["* "+u],!f)for(h in o)if(s=h.split(" "),s[1]===u&&(f=o[e+" "+s[0]]||o["* "+s[0]],f)){f===!0?f=o[h]:o[h]!==!0&&(u=s[0],c.unshift(s[1]));break}if(f!==!0)if(f&&n.throws)t=f(t);else try{t=f(t)}catch(l){return{state:"parsererror",error:f?l:"No conversion from "+e+" to "+u}}}return{state:"success",data:t}}function vi(n,t,r,u){var f;if(i.isArray(t))i.each(t,function(t,i){r||pe.test(n)?u(n,i):vi(n+"["+(typeof i=="object"?t:"")+"]",i,r,u)});else if(r||i.type(t)!=="object")u(n,t);else for(f in t)vi(n+"["+f+"]",t[f],r,u)}function ku(n){return i.isWindow(n)?n:n.nodeType===9&&n.defaultView}var w=[],a=w.slice,bi=w.concat,ti=w.push,ft=w.indexOf,et={},nf=et.toString,ii=et.hasOwnProperty,f={},u=n.document,ki="2.1.4",i=function(n,t){return new i.fn.init(n,t)},tf=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rf=/^-ms-/,uf=/-([\da-z])/gi,ff=function(n,t){return t.toUpperCase()},y,ot,nr,tr,ir,rr,c,fi,st,l,b,at,oi,oe,su,g,hu,bt,cu,kt,dt,yi,ni,pi,wi,du,gu;i.fn=i.prototype={jquery:ki,constructor:i,selector:"",length:0,toArray:function(){return a.call(this)},get:function(n){return n!=null?n<0?this[n+this.length]:this[n]:a.call(this)},pushStack:function(n){var t=i.merge(this.constructor(),n);return t.prevObject=this,t.context=this.context,t},each:function(n,t){return i.each(this,n,t)},map:function(n){return this.pushStack(i.map(this,function(t,i){return n.call(t,i,t)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(n){var i=this.length,t=+n+(n<0?i:0);return this.pushStack(t>=0&&t<i?[this[t]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:ti,sort:w.sort,splice:w.splice};i.extend=i.fn.extend=function(){var e,f,r,t,o,s,n=arguments[0]||{},u=1,c=arguments.length,h=!1;for(typeof n=="boolean"&&(h=n,n=arguments[u]||{},u++),typeof n=="object"||i.isFunction(n)||(n={}),u===c&&(n=this,u--);u<c;u++)if((e=arguments[u])!=null)for(f in e)(r=n[f],t=e[f],n!==t)&&(h&&t&&(i.isPlainObject(t)||(o=i.isArray(t)))?(o?(o=!1,s=r&&i.isArray(r)?r:[]):s=r&&i.isPlainObject(r)?r:{},n[f]=i.extend(h,s,t)):t!==undefined&&(n[f]=t));return n};i.extend({expando:"jQuery"+(ki+Math.random()).replace(/\D/g,""),isReady:!0,error:function(n){throw new Error(n);},noop:function(){},isFunction:function(n){return i.type(n)==="function"},isArray:Array.isArray,isWindow:function(n){return n!=null&&n===n.window},isNumeric:function(n){return!i.isArray(n)&&n-parseFloat(n)+1>=0},isPlainObject:function(n){return i.type(n)!=="object"||n.nodeType||i.isWindow(n)?!1:n.constructor&&!ii.call(n.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(n){for(var t in n)return!1;return!0},type:function(n){return n==null?n+"":typeof n=="object"||typeof n=="function"?et[nf.call(n)]||"object":typeof n},globalEval:function(n){var t,r=eval;n=i.trim(n);n&&(n.indexOf("use strict")===1?(t=u.createElement("script"),t.text=n,u.head.appendChild(t).parentNode.removeChild(t)):r(n))},camelCase:function(n){return n.replace(rf,"ms-").replace(uf,ff)},nodeName:function(n,t){return n.nodeName&&n.nodeName.toLowerCase()===t.toLowerCase()},each:function(n,t,i){var u,r=0,f=n.length,e=ri(n);if(i){if(e){for(;r<f;r++)if(u=t.apply(n[r],i),u===!1)break}else for(r in n)if(u=t.apply(n[r],i),u===!1)break}else if(e){for(;r<f;r++)if(u=t.call(n[r],r,n[r]),u===!1)break}else for(r in n)if(u=t.call(n[r],r,n[r]),u===!1)break;return n},trim:function(n){return n==null?"":(n+"").replace(tf,"")},makeArray:function(n,t){var r=t||[];return n!=null&&(ri(Object(n))?i.merge(r,typeof n=="string"?[n]:n):ti.call(r,n)),r},inArray:function(n,t,i){return t==null?-1:ft.call(t,n,i)},merge:function(n,t){for(var u=+t.length,i=0,r=n.length;i<u;i++)n[r++]=t[i];return n.length=r,n},grep:function(n,t,i){for(var u,f=[],r=0,e=n.length,o=!i;r<e;r++)u=!t(n[r],r),u!==o&&f.push(n[r]);return f},map:function(n,t,i){var u,r=0,e=n.length,o=ri(n),f=[];if(o)for(;r<e;r++)u=t(n[r],r,i),u!=null&&f.push(u);else for(r in n)u=t(n[r],r,i),u!=null&&f.push(u);return bi.apply([],f)},guid:1,proxy:function(n,t){var u,f,r;return(typeof t=="string"&&(u=n[t],t=n,n=u),!i.isFunction(n))?undefined:(f=a.call(arguments,2),r=function(){return n.apply(t||this,f.concat(a.call(arguments)))},r.guid=n.guid=n.guid||i.guid++,r)},now:Date.now,support:f});i.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(n,t){et["[object "+t+"]"]=t.toLowerCase()});y=function(n){function r(n,t,i,r){var p,s,a,c,w,y,d,v,nt,g;if((t?t.ownerDocument||t:h)!==o&&k(t),t=t||o,i=i||[],c=t.nodeType,typeof n!="string"||!n||c!==1&&c!==9&&c!==11)return i;if(!r&&l){if(c!==11&&(p=hr.exec(n)))if(a=p[1]){if(c===9)if(s=t.getElementById(a),s&&s.parentNode){if(s.id===a)return i.push(s),i}else return i;else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(a))&&et(t,s)&&s.id===a)return i.push(s),i}else{if(p[2])return b.apply(i,t.getElementsByTagName(n)),i;if((a=p[3])&&u.getElementsByClassName)return b.apply(i,t.getElementsByClassName(a)),i}if(u.qsa&&(!e||!e.test(n))){if(v=d=f,nt=t,g=c!==1&&n,c===1&&t.nodeName.toLowerCase()!=="object"){for(y=ft(n),(d=t.getAttribute("id"))?v=d.replace(cr,"\\$&"):t.setAttribute("id",v),v="[id='"+v+"'] ",w=y.length;w--;)y[w]=v+vt(y[w]);nt=dt.test(n)&&ti(t.parentNode)||t;g=y.join(",")}if(g)try{return b.apply(i,nt.querySelectorAll(g)),i}catch(tt){}finally{d||t.removeAttribute("id")}}}return oi(n.replace(lt,"$1"),t,i,r)}function gt(){function n(r,u){return i.push(r+" ")>t.cacheLength&&delete n[i.shift()],n[r+" "]=u}var i=[];return n}function c(n){return n[f]=!0,n}function v(n){var t=o.createElement("div");try{return!!n(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t);t=null}}function ni(n,i){for(var u=n.split("|"),r=n.length;r--;)t.attrHandle[u[r]]=i}function wi(n,t){var i=t&&n,r=i&&n.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||li)-(~n.sourceIndex||li);if(r)return r;if(i)while(i=i.nextSibling)if(i===t)return-1;return n?1:-1}function lr(n){return function(t){var i=t.nodeName.toLowerCase();return i==="input"&&t.type===n}}function ar(n){return function(t){var i=t.nodeName.toLowerCase();return(i==="input"||i==="button")&&t.type===n}}function tt(n){return c(function(t){return t=+t,c(function(i,r){for(var u,f=n([],i.length,t),e=f.length;e--;)i[u=f[e]]&&(i[u]=!(r[u]=i[u]))})})}function ti(n){return n&&typeof n.getElementsByTagName!="undefined"&&n}function bi(){}function vt(n){for(var t=0,r=n.length,i="";t<r;t++)i+=n[t].value;return i}function ii(n,t,i){var r=t.dir,u=i&&r==="parentNode",e=ki++;return t.first?function(t,i,f){while(t=t[r])if(t.nodeType===1||u)return n(t,i,f)}:function(t,i,o){var s,h,c=[a,e];if(o){while(t=t[r])if((t.nodeType===1||u)&&n(t,i,o))return!0}else while(t=t[r])if(t.nodeType===1||u){if(h=t[f]||(t[f]={}),(s=h[r])&&s[0]===a&&s[1]===e)return c[2]=s[2];if(h[r]=c,c[2]=n(t,i,o))return!0}}}function ri(n){return n.length>1?function(t,i,r){for(var u=n.length;u--;)if(!n[u](t,i,r))return!1;return!0}:n[0]}function vr(n,t,i){for(var u=0,f=t.length;u<f;u++)r(n,t[u],i);return i}function yt(n,t,i,r,u){for(var e,o=[],f=0,s=n.length,h=t!=null;f<s;f++)(e=n[f])&&(!i||i(e,r,u))&&(o.push(e),h&&t.push(f));return o}function ui(n,t,i,r,u,e){return r&&!r[f]&&(r=ui(r)),u&&!u[f]&&(u=ui(u,e)),c(function(f,e,o,s){var l,c,a,p=[],y=[],w=e.length,k=f||vr(t||"*",o.nodeType?[o]:o,[]),v=n&&(f||!t)?yt(k,p,n,o,s):k,h=i?u||(f?n:w||r)?[]:e:v;if(i&&i(v,h,o,s),r)for(l=yt(h,y),r(l,[],o,s),c=l.length;c--;)(a=l[c])&&(h[y[c]]=!(v[y[c]]=a));if(f){if(u||n){if(u){for(l=[],c=h.length;c--;)(a=h[c])&&l.push(v[c]=a);u(null,h=[],l,s)}for(c=h.length;c--;)(a=h[c])&&(l=u?nt(f,a):p[c])>-1&&(f[l]=!(e[l]=a))}}else h=yt(h===e?h.splice(w,h.length):h),u?u(null,e,h,s):b.apply(e,h)})}function fi(n){for(var o,u,r,s=n.length,h=t.relative[n[0].type],c=h||t.relative[" "],i=h?1:0,l=ii(function(n){return n===o},c,!0),a=ii(function(n){return nt(o,n)>-1},c,!0),e=[function(n,t,i){var r=!h&&(i||t!==ht)||((o=t).nodeType?l(n,t,i):a(n,t,i));return o=null,r}];i<s;i++)if(u=t.relative[n[i].type])e=[ii(ri(e),u)];else{if(u=t.filter[n[i].type].apply(null,n[i].matches),u[f]){for(r=++i;r<s;r++)if(t.relative[n[r].type])break;return ui(i>1&&ri(e),i>1&&vt(n.slice(0,i-1).concat({value:n[i-2].type===" "?"*":""})).replace(lt,"$1"),u,i<r&&fi(n.slice(i,r)),r<s&&fi(n=n.slice(r)),r<s&&vt(n))}e.push(u)}return ri(e)}function yr(n,i){var u=i.length>0,f=n.length>0,e=function(e,s,h,c,l){var y,d,w,k=0,v="0",g=e&&[],p=[],nt=ht,tt=e||f&&t.find.TAG("*",l),it=a+=nt==null?1:Math.random()||.1,rt=tt.length;for(l&&(ht=s!==o&&s);v!==rt&&(y=tt[v])!=null;v++){if(f&&y){for(d=0;w=n[d++];)if(w(y,s,h)){c.push(y);break}l&&(a=it)}u&&((y=!w&&y)&&k--,e&&g.push(y))}if(k+=v,u&&v!==k){for(d=0;w=i[d++];)w(g,p,s,h);if(e){if(k>0)while(v--)g[v]||p[v]||(p[v]=gi.call(c));p=yt(p)}b.apply(c,p);l&&!e&&p.length>0&&k+i.length>1&&r.uniqueSort(c)}return l&&(a=it,ht=nt),g};return u?c(e):e}var it,u,t,st,ei,ft,pt,oi,ht,w,rt,k,o,s,l,e,d,ct,et,f="sizzle"+1*new Date,h=n.document,a=0,ki=0,si=gt(),hi=gt(),ci=gt(),wt=function(n,t){return n===t&&(rt=!0),0},li=-2147483648,di={}.hasOwnProperty,g=[],gi=g.pop,nr=g.push,b=g.push,ai=g.slice,nt=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return i;return-1},bt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",i="[\\x20\\t\\r\\n\\f]",ut="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",vi=ut.replace("w","w#"),yi="\\["+i+"*("+ut+")(?:"+i+"*([*^$|!~]?=)"+i+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+vi+"))|)"+i+"*\\]",kt=":("+ut+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+yi+")*)|.*)\\)|)",tr=new RegExp(i+"+","g"),lt=new RegExp("^"+i+"+|((?:^|[^\\\\])(?:\\\\.)*)"+i+"+$","g"),ir=new RegExp("^"+i+"*,"+i+"*"),rr=new RegExp("^"+i+"*([>+~]|"+i+")"+i+"*"),ur=new RegExp("="+i+"*([^\\]'\"]*?)"+i+"*\\]","g"),fr=new RegExp(kt),er=new RegExp("^"+vi+"$"),at={ID:new RegExp("^#("+ut+")"),CLASS:new RegExp("^\\.("+ut+")"),TAG:new RegExp("^("+ut.replace("w","w*")+")"),ATTR:new RegExp("^"+yi),PSEUDO:new RegExp("^"+kt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+i+"*(even|odd|(([+-]|)(\\d*)n|)"+i+"*(?:([+-]|)"+i+"*(\\d+)|))"+i+"*\\)|)","i"),bool:new RegExp("^(?:"+bt+")$","i"),needsContext:new RegExp("^"+i+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+i+"*((?:-\\d)?\\d*)"+i+"*\\)|)(?=[^-]|$)","i")},or=/^(?:input|select|textarea|button)$/i,sr=/^h\d$/i,ot=/^[^{]+\{\s*\[native \w/,hr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,dt=/[+~]/,cr=/'|\\/g,y=new RegExp("\\\\([\\da-f]{1,6}"+i+"?|("+i+")|.)","ig"),p=function(n,t,i){var r="0x"+t-65536;return r!==r||i?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)},pi=function(){k()};try{b.apply(g=ai.call(h.childNodes),h.childNodes);g[h.childNodes.length].nodeType}catch(pr){b={apply:g.length?function(n,t){nr.apply(n,ai.call(t))}:function(n,t){for(var i=n.length,r=0;n[i++]=t[r++];);n.length=i-1}}}u=r.support={};ei=r.isXML=function(n){var t=n&&(n.ownerDocument||n).documentElement;return t?t.nodeName!=="HTML":!1};k=r.setDocument=function(n){var a,c,r=n?n.ownerDocument||n:h;return r===o||r.nodeType!==9||!r.documentElement?o:(o=r,s=r.documentElement,c=r.defaultView,c&&c!==c.top&&(c.addEventListener?c.addEventListener("unload",pi,!1):c.attachEvent&&c.attachEvent("onunload",pi)),l=!ei(r),u.attributes=v(function(n){return n.className="i",!n.getAttribute("className")}),u.getElementsByTagName=v(function(n){return n.appendChild(r.createComment("")),!n.getElementsByTagName("*").length}),u.getElementsByClassName=ot.test(r.getElementsByClassName),u.getById=v(function(n){return s.appendChild(n).id=f,!r.getElementsByName||!r.getElementsByName(f).length}),u.getById?(t.find.ID=function(n,t){if(typeof t.getElementById!="undefined"&&l){var i=t.getElementById(n);return i&&i.parentNode?[i]:[]}},t.filter.ID=function(n){var t=n.replace(y,p);return function(n){return n.getAttribute("id")===t}}):(delete t.find.ID,t.filter.ID=function(n){var t=n.replace(y,p);return function(n){var i=typeof n.getAttributeNode!="undefined"&&n.getAttributeNode("id");return i&&i.value===t}}),t.find.TAG=u.getElementsByTagName?function(n,t){return typeof t.getElementsByTagName!="undefined"?t.getElementsByTagName(n):u.qsa?t.querySelectorAll(n):void 0}:function(n,t){var i,r=[],f=0,u=t.getElementsByTagName(n);if(n==="*"){while(i=u[f++])i.nodeType===1&&r.push(i);return r}return u},t.find.CLASS=u.getElementsByClassName&&function(n,t){if(l)return t.getElementsByClassName(n)},d=[],e=[],(u.qsa=ot.test(r.querySelectorAll))&&(v(function(n){s.appendChild(n).innerHTML="<a id='"+f+"'><\/a><select id='"+f+"-\f]' msallowcapture=''><option selected=''><\/option><\/select>";n.querySelectorAll("[msallowcapture^='']").length&&e.push("[*^$]="+i+"*(?:''|\"\")");n.querySelectorAll("[selected]").length||e.push("\\["+i+"*(?:value|"+bt+")");n.querySelectorAll("[id~="+f+"-]").length||e.push("~=");n.querySelectorAll(":checked").length||e.push(":checked");n.querySelectorAll("a#"+f+"+*").length||e.push(".#.+[+~]")}),v(function(n){var t=r.createElement("input");t.setAttribute("type","hidden");n.appendChild(t).setAttribute("name","D");n.querySelectorAll("[name=d]").length&&e.push("name"+i+"*[*^$|!~]?=");n.querySelectorAll(":enabled").length||e.push(":enabled",":disabled");n.querySelectorAll("*,:x");e.push(",.*:")})),(u.matchesSelector=ot.test(ct=s.matches||s.webkitMatchesSelector||s.mozMatchesSelector||s.oMatchesSelector||s.msMatchesSelector))&&v(function(n){u.disconnectedMatch=ct.call(n,"div");ct.call(n,"[s!='']:x");d.push("!=",kt)}),e=e.length&&new RegExp(e.join("|")),d=d.length&&new RegExp(d.join("|")),a=ot.test(s.compareDocumentPosition),et=a||ot.test(s.contains)?function(n,t){var r=n.nodeType===9?n.documentElement:n,i=t&&t.parentNode;return n===i||!!(i&&i.nodeType===1&&(r.contains?r.contains(i):n.compareDocumentPosition&&n.compareDocumentPosition(i)&16))}:function(n,t){if(t)while(t=t.parentNode)if(t===n)return!0;return!1},wt=a?function(n,t){if(n===t)return rt=!0,0;var i=!n.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(n.ownerDocument||n)===(t.ownerDocument||t)?n.compareDocumentPosition(t):1,i&1||!u.sortDetached&&t.compareDocumentPosition(n)===i)?n===r||n.ownerDocument===h&&et(h,n)?-1:t===r||t.ownerDocument===h&&et(h,t)?1:w?nt(w,n)-nt(w,t):0:i&4?-1:1}:function(n,t){if(n===t)return rt=!0,0;var i,u=0,o=n.parentNode,s=t.parentNode,f=[n],e=[t];if(o&&s){if(o===s)return wi(n,t)}else return n===r?-1:t===r?1:o?-1:s?1:w?nt(w,n)-nt(w,t):0;for(i=n;i=i.parentNode;)f.unshift(i);for(i=t;i=i.parentNode;)e.unshift(i);while(f[u]===e[u])u++;return u?wi(f[u],e[u]):f[u]===h?-1:e[u]===h?1:0},r)};r.matches=function(n,t){return r(n,null,null,t)};r.matchesSelector=function(n,t){if((n.ownerDocument||n)!==o&&k(n),t=t.replace(ur,"='$1']"),u.matchesSelector&&l&&(!d||!d.test(t))&&(!e||!e.test(t)))try{var i=ct.call(n,t);if(i||u.disconnectedMatch||n.document&&n.document.nodeType!==11)return i}catch(f){}return r(t,o,null,[n]).length>0};r.contains=function(n,t){return(n.ownerDocument||n)!==o&&k(n),et(n,t)};r.attr=function(n,i){(n.ownerDocument||n)!==o&&k(n);var f=t.attrHandle[i.toLowerCase()],r=f&&di.call(t.attrHandle,i.toLowerCase())?f(n,i,!l):undefined;return r!==undefined?r:u.attributes||!l?n.getAttribute(i):(r=n.getAttributeNode(i))&&r.specified?r.value:null};r.error=function(n){throw new Error("Syntax error, unrecognized expression: "+n);};r.uniqueSort=function(n){var r,f=[],t=0,i=0;if(rt=!u.detectDuplicates,w=!u.sortStable&&n.slice(0),n.sort(wt),rt){while(r=n[i++])r===n[i]&&(t=f.push(i));while(t--)n.splice(f[t],1)}return w=null,n};st=r.getText=function(n){var r,i="",u=0,t=n.nodeType;if(t){if(t===1||t===9||t===11){if(typeof n.textContent=="string")return n.textContent;for(n=n.firstChild;n;n=n.nextSibling)i+=st(n)}else if(t===3||t===4)return n.nodeValue}else while(r=n[u++])i+=st(r);return i};t=r.selectors={cacheLength:50,createPseudo:c,match:at,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(n){return n[1]=n[1].replace(y,p),n[3]=(n[3]||n[4]||n[5]||"").replace(y,p),n[2]==="~="&&(n[3]=" "+n[3]+" "),n.slice(0,4)},CHILD:function(n){return n[1]=n[1].toLowerCase(),n[1].slice(0,3)==="nth"?(n[3]||r.error(n[0]),n[4]=+(n[4]?n[5]+(n[6]||1):2*(n[3]==="even"||n[3]==="odd")),n[5]=+(n[7]+n[8]||n[3]==="odd")):n[3]&&r.error(n[0]),n},PSEUDO:function(n){var i,t=!n[6]&&n[2];return at.CHILD.test(n[0])?null:(n[3]?n[2]=n[4]||n[5]||"":t&&fr.test(t)&&(i=ft(t,!0))&&(i=t.indexOf(")",t.length-i)-t.length)&&(n[0]=n[0].slice(0,i),n[2]=t.slice(0,i)),n.slice(0,3))}},filter:{TAG:function(n){var t=n.replace(y,p).toLowerCase();return n==="*"?function(){return!0}:function(n){return n.nodeName&&n.nodeName.toLowerCase()===t}},CLASS:function(n){var t=si[n+" "];return t||(t=new RegExp("(^|"+i+")"+n+"("+i+"|$)"))&&si(n,function(n){return t.test(typeof n.className=="string"&&n.className||typeof n.getAttribute!="undefined"&&n.getAttribute("class")||"")})},ATTR:function(n,t,i){return function(u){var f=r.attr(u,n);return f==null?t==="!=":t?(f+="",t==="="?f===i:t==="!="?f!==i:t==="^="?i&&f.indexOf(i)===0:t==="*="?i&&f.indexOf(i)>-1:t==="$="?i&&f.slice(-i.length)===i:t==="~="?(" "+f.replace(tr," ")+" ").indexOf(i)>-1:t==="|="?f===i||f.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(n,t,i,r,u){var s=n.slice(0,3)!=="nth",o=n.slice(-4)!=="last",e=t==="of-type";return r===1&&u===0?function(n){return!!n.parentNode}:function(t,i,h){var v,k,c,l,y,w,b=s!==o?"nextSibling":"previousSibling",p=t.parentNode,g=e&&t.nodeName.toLowerCase(),d=!h&&!e;if(p){if(s){while(b){for(c=t;c=c[b];)if(e?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;w=b=n==="only"&&!w&&"nextSibling"}return!0}if(w=[o?p.firstChild:p.lastChild],o&&d){for(k=p[f]||(p[f]={}),v=k[n]||[],y=v[0]===a&&v[1],l=v[0]===a&&v[2],c=y&&p.childNodes[y];c=++y&&c&&c[b]||(l=y=0)||w.pop();)if(c.nodeType===1&&++l&&c===t){k[n]=[a,y,l];break}}else if(d&&(v=(t[f]||(t[f]={}))[n])&&v[0]===a)l=v[1];else while(c=++y&&c&&c[b]||(l=y=0)||w.pop())if((e?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++l&&(d&&((c[f]||(c[f]={}))[n]=[a,l]),c===t))break;return l-=u,l===r||l%r==0&&l/r>=0}}},PSEUDO:function(n,i){var e,u=t.pseudos[n]||t.setFilters[n.toLowerCase()]||r.error("unsupported pseudo: "+n);return u[f]?u(i):u.length>1?(e=[n,n,"",i],t.setFilters.hasOwnProperty(n.toLowerCase())?c(function(n,t){for(var r,f=u(n,i),e=f.length;e--;)r=nt(n,f[e]),n[r]=!(t[r]=f[e])}):function(n){return u(n,0,e)}):u}},pseudos:{not:c(function(n){var t=[],r=[],i=pt(n.replace(lt,"$1"));return i[f]?c(function(n,t,r,u){for(var e,o=i(n,null,u,[]),f=n.length;f--;)(e=o[f])&&(n[f]=!(t[f]=e))}):function(n,u,f){return t[0]=n,i(t,null,f,r),t[0]=null,!r.pop()}}),has:c(function(n){return function(t){return r(n,t).length>0}}),contains:c(function(n){return n=n.replace(y,p),function(t){return(t.textContent||t.innerText||st(t)).indexOf(n)>-1}}),lang:c(function(n){return er.test(n||"")||r.error("unsupported lang: "+n),n=n.replace(y,p).toLowerCase(),function(t){var i;do if(i=l?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===n||i.indexOf(n+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var i=n.location&&n.location.hash;return i&&i.slice(1)===t.id},root:function(n){return n===s},focus:function(n){return n===o.activeElement&&(!o.hasFocus||o.hasFocus())&&!!(n.type||n.href||~n.tabIndex)},enabled:function(n){return n.disabled===!1},disabled:function(n){return n.disabled===!0},checked:function(n){var t=n.nodeName.toLowerCase();return t==="input"&&!!n.checked||t==="option"&&!!n.selected},selected:function(n){return n.parentNode&&n.parentNode.selectedIndex,n.selected===!0},empty:function(n){for(n=n.firstChild;n;n=n.nextSibling)if(n.nodeType<6)return!1;return!0},parent:function(n){return!t.pseudos.empty(n)},header:function(n){return sr.test(n.nodeName)},input:function(n){return or.test(n.nodeName)},button:function(n){var t=n.nodeName.toLowerCase();return t==="input"&&n.type==="button"||t==="button"},text:function(n){var t;return n.nodeName.toLowerCase()==="input"&&n.type==="text"&&((t=n.getAttribute("type"))==null||t.toLowerCase()==="text")},first:tt(function(){return[0]}),last:tt(function(n,t){return[t-1]}),eq:tt(function(n,t,i){return[i<0?i+t:i]}),even:tt(function(n,t){for(var i=0;i<t;i+=2)n.push(i);return n}),odd:tt(function(n,t){for(var i=1;i<t;i+=2)n.push(i);return n}),lt:tt(function(n,t,i){for(var r=i<0?i+t:i;--r>=0;)n.push(r);return n}),gt:tt(function(n,t,i){for(var r=i<0?i+t:i;++r<t;)n.push(r);return n})}};t.pseudos.nth=t.pseudos.eq;for(it in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[it]=lr(it);for(it in{submit:!0,reset:!0})t.pseudos[it]=ar(it);return bi.prototype=t.filters=t.pseudos,t.setFilters=new bi,ft=r.tokenize=function(n,i){var e,f,s,o,u,h,c,l=hi[n+" "];if(l)return i?0:l.slice(0);for(u=n,h=[],c=t.preFilter;u;){(!e||(f=ir.exec(u)))&&(f&&(u=u.slice(f[0].length)||u),h.push(s=[]));e=!1;(f=rr.exec(u))&&(e=f.shift(),s.push({value:e,type:f[0].replace(lt," ")}),u=u.slice(e.length));for(o in t.filter)(f=at[o].exec(u))&&(!c[o]||(f=c[o](f)))&&(e=f.shift(),s.push({value:e,type:o,matches:f}),u=u.slice(e.length));if(!e)break}return i?u.length:u?r.error(n):hi(n,h).slice(0)},pt=r.compile=function(n,t){var r,u=[],e=[],i=ci[n+" "];if(!i){for(t||(t=ft(n)),r=t.length;r--;)i=fi(t[r]),i[f]?u.push(i):e.push(i);i=ci(n,yr(e,u));i.selector=n}return i},oi=r.select=function(n,i,r,f){var s,e,o,a,v,c=typeof n=="function"&&n,h=!f&&ft(n=c.selector||n);if(r=r||[],h.length===1){if(e=h[0]=h[0].slice(0),e.length>2&&(o=e[0]).type==="ID"&&u.getById&&i.nodeType===9&&l&&t.relative[e[1].type]){if(i=(t.find.ID(o.matches[0].replace(y,p),i)||[])[0],i)c&&(i=i.parentNode);else return r;n=n.slice(e.shift().value.length)}for(s=at.needsContext.test(n)?0:e.length;s--;){if(o=e[s],t.relative[a=o.type])break;if((v=t.find[a])&&(f=v(o.matches[0].replace(y,p),dt.test(e[0].type)&&ti(i.parentNode)||i))){if(e.splice(s,1),n=f.length&&vt(e),!n)return b.apply(r,f),r;break}}}return(c||pt(n,h))(f,i,!l,r,dt.test(n)&&ti(i.parentNode)||i),r},u.sortStable=f.split("").sort(wt).join("")===f,u.detectDuplicates=!!rt,k(),u.sortDetached=v(function(n){return n.compareDocumentPosition(o.createElement("div"))&1}),v(function(n){return n.innerHTML="<a href='#'><\/a>",n.firstChild.getAttribute("href")==="#"})||ni("type|href|height|width",function(n,t,i){if(!i)return n.getAttribute(t,t.toLowerCase()==="type"?1:2)}),u.attributes&&v(function(n){return n.innerHTML="<input/>",n.firstChild.setAttribute("value",""),n.firstChild.getAttribute("value")===""})||ni("value",function(n,t,i){if(!i&&n.nodeName.toLowerCase()==="input")return n.defaultValue}),v(function(n){return n.getAttribute("disabled")==null})||ni(bt,function(n,t,i){var r;if(!i)return n[t]===!0?t.toLowerCase():(r=n.getAttributeNode(t))&&r.specified?r.value:null}),r}(n);i.find=y;i.expr=y.selectors;i.expr[":"]=i.expr.pseudos;i.unique=y.uniqueSort;i.text=y.getText;i.isXMLDoc=y.isXML;i.contains=y.contains;var di=i.expr.match.needsContext,gi=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ef=/^.[^:#\[\.,]*$/;i.filter=function(n,t,r){var u=t[0];return r&&(n=":not("+n+")"),t.length===1&&u.nodeType===1?i.find.matchesSelector(u,n)?[u]:[]:i.find.matches(n,i.grep(t,function(n){return n.nodeType===1}))};i.fn.extend({find:function(n){var t,u=this.length,r=[],f=this;if(typeof n!="string")return this.pushStack(i(n).filter(function(){for(t=0;t<u;t++)if(i.contains(f[t],this))return!0}));for(t=0;t<u;t++)i.find(n,f[t],r);return r=this.pushStack(u>1?i.unique(r):r),r.selector=this.selector?this.selector+" "+n:n,r},filter:function(n){return this.pushStack(ui(this,n||[],!1))},not:function(n){return this.pushStack(ui(this,n||[],!0))},is:function(n){return!!ui(this,typeof n=="string"&&di.test(n)?i(n):n||[],!1).length}});nr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;tr=i.fn.init=function(n,t){var r,f;if(!n)return this;if(typeof n=="string"){if(r=n[0]==="<"&&n[n.length-1]===">"&&n.length>=3?[null,n,null]:nr.exec(n),r&&(r[1]||!t)){if(r[1]){if(t=t instanceof i?t[0]:t,i.merge(this,i.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:u,!0)),gi.test(r[1])&&i.isPlainObject(t))for(r in t)i.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return f=u.getElementById(r[2]),f&&f.parentNode&&(this.length=1,this[0]=f),this.context=u,this.selector=n,this}return!t||t.jquery?(t||ot).find(n):this.constructor(t).find(n)}return n.nodeType?(this.context=this[0]=n,this.length=1,this):i.isFunction(n)?typeof ot.ready!="undefined"?ot.ready(n):n(i):(n.selector!==undefined&&(this.selector=n.selector,this.context=n.context),i.makeArray(n,this))};tr.prototype=i.fn;ot=i(u);ir=/^(?:parents|prev(?:Until|All))/;rr={children:!0,contents:!0,next:!0,prev:!0};i.extend({dir:function(n,t,r){for(var u=[],f=r!==undefined;(n=n[t])&&n.nodeType!==9;)if(n.nodeType===1){if(f&&i(n).is(r))break;u.push(n)}return u},sibling:function(n,t){for(var i=[];n;n=n.nextSibling)n.nodeType===1&&n!==t&&i.push(n);return i}});i.fn.extend({has:function(n){var t=i(n,this),r=t.length;return this.filter(function(){for(var n=0;n<r;n++)if(i.contains(this,t[n]))return!0})},closest:function(n,t){for(var r,f=0,o=this.length,u=[],e=di.test(n)||typeof n!="string"?i(n,t||this.context):0;f<o;f++)for(r=this[f];r&&r!==t;r=r.parentNode)if(r.nodeType<11&&(e?e.index(r)>-1:r.nodeType===1&&i.find.matchesSelector(r,n))){u.push(r);break}return this.pushStack(u.length>1?i.unique(u):u)},index:function(n){return n?typeof n=="string"?ft.call(i(n),this[0]):ft.call(this,n.jquery?n[0]:n):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(n,t){return this.pushStack(i.unique(i.merge(this.get(),i(n,t))))},addBack:function(n){return this.add(n==null?this.prevObject:this.prevObject.filter(n))}});i.each({parent:function(n){var t=n.parentNode;return t&&t.nodeType!==11?t:null},parents:function(n){return i.dir(n,"parentNode")},parentsUntil:function(n,t,r){return i.dir(n,"parentNode",r)},next:function(n){return ur(n,"nextSibling")},prev:function(n){return ur(n,"previousSibling")},nextAll:function(n){return i.dir(n,"nextSibling")},prevAll:function(n){return i.dir(n,"previousSibling")},nextUntil:function(n,t,r){return i.dir(n,"nextSibling",r)},prevUntil:function(n,t,r){return i.dir(n,"previousSibling",r)},siblings:function(n){return i.sibling((n.parentNode||{}).firstChild,n)},children:function(n){return i.sibling(n.firstChild)},contents:function(n){return n.contentDocument||i.merge([],n.childNodes)}},function(n,t){i.fn[n]=function(r,u){var f=i.map(this,t,r);return n.slice(-5)!=="Until"&&(u=r),u&&typeof u=="string"&&(f=i.filter(u,f)),this.length>1&&(rr[n]||i.unique(f),ir.test(n)&&f.reverse()),this.pushStack(f)}});c=/\S+/g;fi={};i.Callbacks=function(n){n=typeof n=="string"?fi[n]||of(n):i.extend({},n);var u,h,o,c,f,e,t=[],r=!n.once&&[],l=function(i){for(u=n.memory&&i,h=!0,e=c||0,c=0,f=t.length,o=!0;t&&e<f;e++)if(t[e].apply(i[0],i[1])===!1&&n.stopOnFalse){u=!1;break}o=!1;t&&(r?r.length&&l(r.shift()):u?t=[]:s.disable())},s={add:function(){if(t){var r=t.length;(function e(r){i.each(r,function(r,u){var f=i.type(u);f==="function"?n.unique&&s.has(u)||t.push(u):u&&u.length&&f!=="string"&&e(u)})})(arguments);o?f=t.length:u&&(c=r,l(u))}return this},remove:function(){return t&&i.each(arguments,function(n,r){for(var u;(u=i.inArray(r,t,u))>-1;)t.splice(u,1),o&&(u<=f&&f--,u<=e&&e--)}),this},has:function(n){return n?i.inArray(n,t)>-1:!!(t&&t.length)},empty:function(){return t=[],f=0,this},disable:function(){return t=r=u=undefined,this},disabled:function(){return!t},lock:function(){return r=undefined,u||s.disable(),this},locked:function(){return!r},fireWith:function(n,i){return t&&(!h||r)&&(i=i||[],i=[n,i.slice?i.slice():i],o?r.push(i):l(i)),this},fire:function(){return s.fireWith(this,arguments),this},fired:function(){return!!h}};return s};i.extend({Deferred:function(n){var u=[["resolve","done",i.Callbacks("once memory"),"resolved"],["reject","fail",i.Callbacks("once memory"),"rejected"],["notify","progress",i.Callbacks("memory")]],f="pending",r={state:function(){return f},always:function(){return t.done(arguments).fail(arguments),this},then:function(){var n=arguments;return i.Deferred(function(f){i.each(u,function(u,e){var o=i.isFunction(n[u])&&n[u];t[e[1]](function(){var n=o&&o.apply(this,arguments);n&&i.isFunction(n.promise)?n.promise().done(f.resolve).fail(f.reject).progress(f.notify):f[e[0]+"With"](this===r?f.promise():this,o?[n]:arguments)})});n=null}).promise()},promise:function(n){return n!=null?i.extend(n,r):r}},t={};return r.pipe=r.then,i.each(u,function(n,i){var e=i[2],o=i[3];r[i[1]]=e.add;o&&e.add(function(){f=o},u[n^1][2].disable,u[2][2].lock);t[i[0]]=function(){return t[i[0]+"With"](this===t?r:this,arguments),this};t[i[0]+"With"]=e.fireWith}),r.promise(t),n&&n.call(t,t),t},when:function(n){var t=0,u=a.call(arguments),r=u.length,e=r!==1||n&&i.isFunction(n.promise)?r:0,f=e===1?n:i.Deferred(),h=function(n,t,i){return function(r){t[n]=this;i[n]=arguments.length>1?a.call(arguments):r;i===o?f.notifyWith(t,i):--e||f.resolveWith(t,i)}},o,c,s;if(r>1)for(o=new Array(r),c=new Array(r),s=new Array(r);t<r;t++)u[t]&&i.isFunction(u[t].promise)?u[t].promise().done(h(t,s,u)).fail(f.reject).progress(h(t,c,o)):--e;return e||f.resolveWith(s,u),f.promise()}});i.fn.ready=function(n){return i.ready.promise().done(n),this};i.extend({isReady:!1,readyWait:1,holdReady:function(n){n?i.readyWait++:i.ready(!0)},ready:function(n){(n===!0?--i.readyWait:i.isReady)||(i.isReady=!0,n!==!0&&--i.readyWait>0)||(st.resolveWith(u,[i]),i.fn.triggerHandler&&(i(u).triggerHandler("ready"),i(u).off("ready")))}});i.ready.promise=function(t){return st||(st=i.Deferred(),u.readyState==="complete"?setTimeout(i.ready):(u.addEventListener("DOMContentLoaded",ht,!1),n.addEventListener("load",ht,!1))),st.promise(t)};i.ready.promise();l=i.access=function(n,t,r,u,f,e,o){var s=0,c=n.length,h=r==null;if(i.type(r)==="object"){f=!0;for(s in r)i.access(n,t,s,r[s],!0,e,o)}else if(u!==undefined&&(f=!0,i.isFunction(u)||(o=!0),h&&(o?(t.call(n,u),t=null):(h=t,t=function(n,t,r){return h.call(i(n),r)})),t))for(;s<c;s++)t(n[s],r,o?u:u.call(n[s],s,t(n[s],r)));return f?n:h?t.call(n):c?t(n[0],r):e};i.acceptData=function(n){return n.nodeType===1||n.nodeType===9||!+n.nodeType};v.uid=1;v.accepts=i.acceptData;v.prototype={key:function(n){if(!v.accepts(n))return 0;var r={},t=n[this.expando];if(!t){t=v.uid++;try{r[this.expando]={value:t};Object.defineProperties(n,r)}catch(u){r[this.expando]=t;i.extend(n,r)}}return this.cache[t]||(this.cache[t]={}),t},set:function(n,t,r){var f,e=this.key(n),u=this.cache[e];if(typeof t=="string")u[t]=r;else if(i.isEmptyObject(u))i.extend(this.cache[e],t);else for(f in t)u[f]=t[f];return u},get:function(n,t){var i=this.cache[this.key(n)];return t===undefined?i:i[t]},access:function(n,t,r){var u;return t===undefined||t&&typeof t=="string"&&r===undefined?(u=this.get(n,t),u!==undefined?u:this.get(n,i.camelCase(t))):(this.set(n,t,r),r!==undefined?r:t)},remove:function(n,t){var u,r,f,o=this.key(n),e=this.cache[o];if(t===undefined)this.cache[o]={};else for(i.isArray(t)?r=t.concat(t.map(i.camelCase)):(f=i.camelCase(t),t in e?r=[t,f]:(r=f,r=r in e?[r]:r.match(c)||[])),u=r.length;u--;)delete e[r[u]]},hasData:function(n){return!i.isEmptyObject(this.cache[n[this.expando]]||{})},discard:function(n){n[this.expando]&&delete this.cache[n[this.expando]]}};var r=new v,e=new v,sf=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,hf=/([A-Z])/g;i.extend({hasData:function(n){return e.hasData(n)||r.hasData(n)},data:function(n,t,i){return e.access(n,t,i)},removeData:function(n,t){e.remove(n,t)},_data:function(n,t,i){return r.access(n,t,i)},_removeData:function(n,t){r.remove(n,t)}});i.fn.extend({data:function(n,t){var o,f,s,u=this[0],h=u&&u.attributes;if(n===undefined){if(this.length&&(s=e.get(u),u.nodeType===1&&!r.get(u,"hasDataAttrs"))){for(o=h.length;o--;)h[o]&&(f=h[o].name,f.indexOf("data-")===0&&(f=i.camelCase(f.slice(5)),fr(u,f,s[f])));r.set(u,"hasDataAttrs",!0)}return s}return typeof n=="object"?this.each(function(){e.set(this,n)}):l(this,function(t){var r,f=i.camelCase(n);if(u&&t===undefined)return(r=e.get(u,n),r!==undefined)?r:(r=e.get(u,f),r!==undefined)?r:(r=fr(u,f,undefined),r!==undefined)?r:void 0;this.each(function(){var i=e.get(this,f);e.set(this,f,t);n.indexOf("-")!==-1&&i!==undefined&&e.set(this,n,t)})},null,t,arguments.length>1,null,!0)},removeData:function(n){return this.each(function(){e.remove(this,n)})}});i.extend({queue:function(n,t,u){var f;if(n)return t=(t||"fx")+"queue",f=r.get(n,t),u&&(!f||i.isArray(u)?f=r.access(n,t,i.makeArray(u)):f.push(u)),f||[]},dequeue:function(n,t){t=t||"fx";var r=i.queue(n,t),e=r.length,u=r.shift(),f=i._queueHooks(n,t),o=function(){i.dequeue(n,t)};u==="inprogress"&&(u=r.shift(),e--);u&&(t==="fx"&&r.unshift("inprogress"),delete f.stop,u.call(n,o,f));!e&&f&&f.empty.fire()},_queueHooks:function(n,t){var u=t+"queueHooks";return r.get(n,u)||r.access(n,u,{empty:i.Callbacks("once memory").add(function(){r.remove(n,[t+"queue",u])})})}});i.fn.extend({queue:function(n,t){var r=2;return(typeof n!="string"&&(t=n,n="fx",r--),arguments.length<r)?i.queue(this[0],n):t===undefined?this:this.each(function(){var r=i.queue(this,n,t);i._queueHooks(this,n);n==="fx"&&r[0]!=="inprogress"&&i.dequeue(this,n)})},dequeue:function(n){return this.each(function(){i.dequeue(this,n)})},clearQueue:function(n){return this.queue(n||"fx",[])},promise:function(n,t){var u,e=1,o=i.Deferred(),f=this,s=this.length,h=function(){--e||o.resolveWith(f,[f])};for(typeof n!="string"&&(t=n,n=undefined),n=n||"fx";s--;)u=r.get(f[s],n+"queueHooks"),u&&u.empty&&(e++,u.empty.add(h));return h(),o.promise(t)}});var ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,p=["Top","Right","Bottom","Left"],tt=function(n,t){return n=t||n,i.css(n,"display")==="none"||!i.contains(n.ownerDocument,n)},er=/^(?:checkbox|radio)$/i;(function(){var i=u.createDocumentFragment(),n=i.appendChild(u.createElement("div")),t=u.createElement("input");t.setAttribute("type","radio");t.setAttribute("checked","checked");t.setAttribute("name","t");n.appendChild(t);f.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked;n.innerHTML="<textarea>x<\/textarea>";f.noCloneChecked=!!n.cloneNode(!0).lastChild.defaultValue})();b=typeof undefined;f.focusinBubbles="onfocusin"in n;var cf=/^key/,lf=/^(?:mouse|pointer|contextmenu)|click/,or=/^(?:focusinfocus|focusoutblur)$/,sr=/^([^.]*)(?:\.(.+)|)$/;i.event={global:{},add:function(n,t,u,f,e){var v,y,w,p,k,h,s,l,o,d,g,a=r.get(n);if(a)for(u.handler&&(v=u,u=v.handler,e=v.selector),u.guid||(u.guid=i.guid++),(p=a.events)||(p=a.events={}),(y=a.handle)||(y=a.handle=function(t){return typeof i!==b&&i.event.triggered!==t.type?i.event.dispatch.apply(n,arguments):undefined}),t=(t||"").match(c)||[""],k=t.length;k--;)(w=sr.exec(t[k])||[],o=g=w[1],d=(w[2]||"").split(".").sort(),o)&&(s=i.event.special[o]||{},o=(e?s.delegateType:s.bindType)||o,s=i.event.special[o]||{},h=i.extend({type:o,origType:g,data:f,handler:u,guid:u.guid,selector:e,needsContext:e&&i.expr.match.needsContext.test(e),namespace:d.join(".")},v),(l=p[o])||(l=p[o]=[],l.delegateCount=0,s.setup&&s.setup.call(n,f,d,y)!==!1||n.addEventListener&&n.addEventListener(o,y,!1)),s.add&&(s.add.call(n,h),h.handler.guid||(h.handler.guid=u.guid)),e?l.splice(l.delegateCount++,0,h):l.push(h),i.event.global[o]=!0)},remove:function(n,t,u,f,e){var p,k,h,v,w,s,l,a,o,b,d,y=r.hasData(n)&&r.get(n);if(y&&(v=y.events)){for(t=(t||"").match(c)||[""],w=t.length;w--;){if(h=sr.exec(t[w])||[],o=d=h[1],b=(h[2]||"").split(".").sort(),!o){for(o in v)i.event.remove(n,o+t[w],u,f,!0);continue}for(l=i.event.special[o]||{},o=(f?l.delegateType:l.bindType)||o,a=v[o]||[],h=h[2]&&new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"),k=p=a.length;p--;)s=a[p],(e||d===s.origType)&&(!u||u.guid===s.guid)&&(!h||h.test(s.namespace))&&(!f||f===s.selector||f==="**"&&s.selector)&&(a.splice(p,1),s.selector&&a.delegateCount--,l.remove&&l.remove.call(n,s));k&&!a.length&&(l.teardown&&l.teardown.call(n,b,y.handle)!==!1||i.removeEvent(n,o,y.handle),delete v[o])}i.isEmptyObject(v)&&(delete y.handle,r.remove(n,"events"))}},trigger:function(t,f,e,o){var w,s,c,b,a,v,l,p=[e||u],h=ii.call(t,"type")?t.type:t,y=ii.call(t,"namespace")?t.namespace.split("."):[];if((s=c=e=e||u,e.nodeType!==3&&e.nodeType!==8)&&!or.test(h+i.event.triggered)&&(h.indexOf(".")>=0&&(y=h.split("."),h=y.shift(),y.sort()),a=h.indexOf(":")<0&&"on"+h,t=t[i.expando]?t:new i.Event(h,typeof t=="object"&&t),t.isTrigger=o?2:3,t.namespace=y.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=e),f=f==null?[t]:i.makeArray(f,[t]),l=i.event.special[h]||{},o||!l.trigger||l.trigger.apply(e,f)!==!1)){if(!o&&!l.noBubble&&!i.isWindow(e)){for(b=l.delegateType||h,or.test(b+h)||(s=s.parentNode);s;s=s.parentNode)p.push(s),c=s;c===(e.ownerDocument||u)&&p.push(c.defaultView||c.parentWindow||n)}for(w=0;(s=p[w++])&&!t.isPropagationStopped();)t.type=w>1?b:l.bindType||h,v=(r.get(s,"events")||{})[t.type]&&r.get(s,"handle"),v&&v.apply(s,f),v=a&&s[a],v&&v.apply&&i.acceptData(s)&&(t.result=v.apply(s,f),t.result===!1&&t.preventDefault());return t.type=h,o||t.isDefaultPrevented()||(!l._default||l._default.apply(p.pop(),f)===!1)&&i.acceptData(e)&&a&&i.isFunction(e[h])&&!i.isWindow(e)&&(c=e[a],c&&(e[a]=null),i.event.triggered=h,e[h](),i.event.triggered=undefined,c&&(e[a]=c)),t.result}},dispatch:function(n){n=i.event.fix(n);var o,s,e,u,t,h=[],c=a.call(arguments),l=(r.get(this,"events")||{})[n.type]||[],f=i.event.special[n.type]||{};if(c[0]=n,n.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,n)!==!1){for(h=i.event.handlers.call(this,n,l),o=0;(u=h[o++])&&!n.isPropagationStopped();)for(n.currentTarget=u.elem,s=0;(t=u.handlers[s++])&&!n.isImmediatePropagationStopped();)(!n.namespace_re||n.namespace_re.test(t.namespace))&&(n.handleObj=t,n.data=t.data,e=((i.event.special[t.origType]||{}).handle||t.handler).apply(u.elem,c),e!==undefined&&(n.result=e)===!1&&(n.preventDefault(),n.stopPropagation()));return f.postDispatch&&f.postDispatch.call(this,n),n.result}},handlers:function(n,t){var e,u,f,o,h=[],s=t.delegateCount,r=n.target;if(s&&r.nodeType&&(!n.button||n.type!=="click"))for(;r!==this;r=r.parentNode||this)if(r.disabled!==!0||n.type!=="click"){for(u=[],e=0;e<s;e++)o=t[e],f=o.selector+" ",u[f]===undefined&&(u[f]=o.needsContext?i(f,this).index(r)>=0:i.find(f,this,null,[r]).length),u[f]&&u.push(o);u.length&&h.push({elem:r,handlers:u})}return s<t.length&&h.push({elem:this,handlers:t.slice(s)}),h},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(n,t){return n.which==null&&(n.which=t.charCode!=null?t.charCode:t.keyCode),n}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(n,t){var e,i,r,f=t.button;return n.pageX==null&&t.clientX!=null&&(e=n.target.ownerDocument||u,i=e.documentElement,r=e.body,n.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),n.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),n.which||f===undefined||(n.which=f&1?1:f&2?3:f&4?2:0),n}},fix:function(n){if(n[i.expando])return n;var f,e,o,r=n.type,s=n,t=this.fixHooks[r];for(t||(this.fixHooks[r]=t=lf.test(r)?this.mouseHooks:cf.test(r)?this.keyHooks:{}),o=t.props?this.props.concat(t.props):this.props,n=new i.Event(s),f=o.length;f--;)e=o[f],n[e]=s[e];return n.target||(n.target=u),n.target.nodeType===3&&(n.target=n.target.parentNode),t.filter?t.filter(n,s):n},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==hr()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===hr()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&i.nodeName(this,"input"))return this.click(),!1},_default:function(n){return i.nodeName(n.target,"a")}},beforeunload:{postDispatch:function(n){n.result!==undefined&&n.originalEvent&&(n.originalEvent.returnValue=n.result)}}},simulate:function(n,t,r,u){var f=i.extend(new i.Event,r,{type:n,isSimulated:!0,originalEvent:{}});u?i.event.trigger(f,null,t):i.event.dispatch.call(t,f);f.isDefaultPrevented()&&r.preventDefault()}};i.removeEvent=function(n,t,i){n.removeEventListener&&n.removeEventListener(t,i,!1)};i.Event=function(n,t){if(!(this instanceof i.Event))return new i.Event(n,t);n&&n.type?(this.originalEvent=n,this.type=n.type,this.isDefaultPrevented=n.defaultPrevented||n.defaultPrevented===undefined&&n.returnValue===!1?lt:k):this.type=n;t&&i.extend(this,t);this.timeStamp=n&&n.timeStamp||i.now();this[i.expando]=!0};i.Event.prototype={isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k,preventDefault:function(){var n=this.originalEvent;this.isDefaultPrevented=lt;n&&n.preventDefault&&n.preventDefault()},stopPropagation:function(){var n=this.originalEvent;this.isPropagationStopped=lt;n&&n.stopPropagation&&n.stopPropagation()},stopImmediatePropagation:function(){var n=this.originalEvent;this.isImmediatePropagationStopped=lt;n&&n.stopImmediatePropagation&&n.stopImmediatePropagation();this.stopPropagation()}};i.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(n,t){i.event.special[n]={delegateType:t,bindType:t,handle:function(n){var u,f=this,r=n.relatedTarget,e=n.handleObj;return r&&(r===f||i.contains(f,r))||(n.type=e.origType,u=e.handler.apply(this,arguments),n.type=t),u}}});f.focusinBubbles||i.each({focus:"focusin",blur:"focusout"},function(n,t){var u=function(n){i.event.simulate(t,n.target,i.event.fix(n),!0)};i.event.special[t]={setup:function(){var i=this.ownerDocument||this,f=r.access(i,t);f||i.addEventListener(n,u,!0);r.access(i,t,(f||0)+1)},teardown:function(){var i=this.ownerDocument||this,f=r.access(i,t)-1;f?r.access(i,t,f):(i.removeEventListener(n,u,!0),r.remove(i,t))}}});i.fn.extend({on:function(n,t,r,u,f){var e,o;if(typeof n=="object"){typeof t!="string"&&(r=r||t,t=undefined);for(o in n)this.on(o,t,r,n[o],f);return this}if(r==null&&u==null?(u=t,r=t=undefined):u==null&&(typeof t=="string"?(u=r,r=undefined):(u=r,r=t,t=undefined)),u===!1)u=k;else if(!u)return this;return f===1&&(e=u,u=function(n){return i().off(n),e.apply(this,arguments)},u.guid=e.guid||(e.guid=i.guid++)),this.each(function(){i.event.add(this,n,u,r,t)})},one:function(n,t,i,r){return this.on(n,t,i,r,1)},off:function(n,t,r){var u,f;if(n&&n.preventDefault&&n.handleObj)return u=n.handleObj,i(n.delegateTarget).off(u.namespace?u.origType+"."+u.namespace:u.origType,u.selector,u.handler),this;if(typeof n=="object"){for(f in n)this.off(f,t,n[f]);return this}return(t===!1||typeof t=="function")&&(r=t,t=undefined),r===!1&&(r=k),this.each(function(){i.event.remove(this,n,r,t)})},trigger:function(n,t){return this.each(function(){i.event.trigger(n,t,this)})},triggerHandler:function(n,t){var r=this[0];if(r)return i.event.trigger(n,t,r,!0)}});var cr=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,lr=/<([\w:]+)/,af=/<|&#?\w+;/,vf=/<(?:script|style|link)/i,yf=/checked\s*(?:[^=]|=\s*.checked.)/i,ar=/^$|\/(?:java|ecma)script/i,pf=/^true\/(.*)/,wf=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,h={option:[1,"<select multiple='multiple'>","<\/select>"],thead:[1,"<table>","<\/table>"],col:[2,"<table><colgroup>","<\/colgroup><\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],_default:[0,"",""]};h.optgroup=h.option;h.tbody=h.tfoot=h.colgroup=h.caption=h.thead;h.th=h.td;i.extend({clone:function(n,t,r){var u,c,s,e,h=n.cloneNode(!0),l=i.contains(n.ownerDocument,n);if(!f.noCloneChecked&&(n.nodeType===1||n.nodeType===11)&&!i.isXMLDoc(n))for(e=o(h),s=o(n),u=0,c=s.length;u<c;u++)df(s[u],e[u]);if(t)if(r)for(s=s||o(n),e=e||o(h),u=0,c=s.length;u<c;u++)yr(s[u],e[u]);else yr(n,h);return e=o(h,"script"),e.length>0&&ei(e,!l&&o(n,"script")),h},buildFragment:function(n,t,r,u){for(var f,e,y,l,p,a,s=t.createDocumentFragment(),v=[],c=0,w=n.length;c<w;c++)if(f=n[c],f||f===0)if(i.type(f)==="object")i.merge(v,f.nodeType?[f]:f);else if(af.test(f)){for(e=e||s.appendChild(t.createElement("div")),y=(lr.exec(f)||["",""])[1].toLowerCase(),l=h[y]||h._default,e.innerHTML=l[1]+f.replace(cr,"<$1><\/$2>")+l[2],a=l[0];a--;)e=e.lastChild;i.merge(v,e.childNodes);e=s.firstChild;e.textContent=""}else v.push(t.createTextNode(f));for(s.textContent="",c=0;f=v[c++];)if((!u||i.inArray(f,u)===-1)&&(p=i.contains(f.ownerDocument,f),e=o(s.appendChild(f),"script"),p&&ei(e),r))for(a=0;f=e[a++];)ar.test(f.type||"")&&r.push(f);return s},cleanData:function(n){for(var f,t,o,u,h=i.event.special,s=0;(t=n[s])!==undefined;s++){if(i.acceptData(t)&&(u=t[r.expando],u&&(f=r.cache[u]))){if(f.events)for(o in f.events)h[o]?i.event.remove(t,o):i.removeEvent(t,o,f.handle);r.cache[u]&&delete r.cache[u]}delete e.cache[t[e.expando]]}}});i.fn.extend({text:function(n){return l(this,function(n){return n===undefined?i.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=n)})},null,n,arguments.length)},append:function(){return this.domManip(arguments,function(n){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=vr(this,n);t.appendChild(n)}})},prepend:function(){return this.domManip(arguments,function(n){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=vr(this,n);t.insertBefore(n,t.firstChild)}})},before:function(){return this.domManip(arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this)})},after:function(){return this.domManip(arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling)})},remove:function(n,t){for(var r,f=n?i.filter(n,this):this,u=0;(r=f[u])!=null;u++)t||r.nodeType!==1||i.cleanData(o(r)),r.parentNode&&(t&&i.contains(r.ownerDocument,r)&&ei(o(r,"script")),r.parentNode.removeChild(r));return this},empty:function(){for(var n,t=0;(n=this[t])!=null;t++)n.nodeType===1&&(i.cleanData(o(n,!1)),n.textContent="");return this},clone:function(n,t){return n=n==null?!1:n,t=t==null?n:t,this.map(function(){return i.clone(this,n,t)})},html:function(n){return l(this,function(n){var t=this[0]||{},r=0,u=this.length;if(n===undefined&&t.nodeType===1)return t.innerHTML;if(typeof n=="string"&&!vf.test(n)&&!h[(lr.exec(n)||["",""])[1].toLowerCase()]){n=n.replace(cr,"<$1><\/$2>");try{for(;r<u;r++)t=this[r]||{},t.nodeType===1&&(i.cleanData(o(t,!1)),t.innerHTML=n);t=0}catch(f){}}t&&this.empty().append(n)},null,n,arguments.length)},replaceWith:function(){var n=arguments[0];return this.domManip(arguments,function(t){n=this.parentNode;i.cleanData(o(this));n&&n.replaceChild(t,this)}),n&&(n.length||n.nodeType)?this:this.remove()},detach:function(n){return this.remove(n,!0)},domManip:function(n,t){n=bi.apply([],n);var h,v,s,c,u,y,e=0,l=this.length,w=this,b=l-1,a=n[0],p=i.isFunction(a);if(p||l>1&&typeof a=="string"&&!f.checkClone&&yf.test(a))return this.each(function(i){var r=w.eq(i);p&&(n[0]=a.call(this,i,r.html()));r.domManip(n,t)});if(l&&(h=i.buildFragment(n,this[0].ownerDocument,!1,this),v=h.firstChild,h.childNodes.length===1&&(h=v),v)){for(s=i.map(o(h,"script"),bf),c=s.length;e<l;e++)u=h,e!==b&&(u=i.clone(u,!0,!0),c&&i.merge(s,o(u,"script"))),t.call(this[e],u,e);if(c)for(y=s[s.length-1].ownerDocument,i.map(s,kf),e=0;e<c;e++)u=s[e],ar.test(u.type||"")&&!r.access(u,"globalEval")&&i.contains(y,u)&&(u.src?i._evalUrl&&i._evalUrl(u.src):i.globalEval(u.textContent.replace(wf,"")))}return this}});i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(n,t){i.fn[n]=function(n){for(var u,f=[],e=i(n),o=e.length-1,r=0;r<=o;r++)u=r===o?this:this.clone(!0),i(e[r])[t](u),ti.apply(f,u.get());return this.pushStack(f)}});oi={};var wr=/^margin/,hi=new RegExp("^("+ct+")(?!px)[a-z%]+$","i"),vt=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):n.getComputedStyle(t,null)};(function(){function h(){t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";t.innerHTML="";e.appendChild(r);var i=n.getComputedStyle(t,null);s=i.top!=="1%";o=i.width==="4px";e.removeChild(r)}var s,o,e=u.documentElement,r=u.createElement("div"),t=u.createElement("div");t.style&&(t.style.backgroundClip="content-box",t.cloneNode(!0).style.backgroundClip="",f.clearCloneStyle=t.style.backgroundClip==="content-box",r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(t),n.getComputedStyle&&i.extend(f,{pixelPosition:function(){return h(),s},boxSizingReliable:function(){return o==null&&h(),o},reliableMarginRight:function(){var f,i=t.appendChild(u.createElement("div"));return i.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",t.style.width="1px",e.appendChild(r),f=!parseFloat(n.getComputedStyle(i,null).marginRight),e.removeChild(r),t.removeChild(i),f}}))})();i.swap=function(n,t,i,r){var f,u,e={};for(u in t)e[u]=n.style[u],n.style[u]=t[u];f=i.apply(n,r||[]);for(u in t)n.style[u]=e[u];return f};var gf=/^(none|table(?!-c[ea]).+)/,ne=new RegExp("^("+ct+")(.*)$","i"),te=new RegExp("^([+-])=("+ct+")","i"),ie={position:"absolute",visibility:"hidden",display:"block"},kr={letterSpacing:"0",fontWeight:"400"},dr=["Webkit","O","Moz","ms"];i.extend({cssHooks:{opacity:{get:function(n,t){if(t){var i=it(n,"opacity");return i===""?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(n,t,r,u){if(n&&n.nodeType!==3&&n.nodeType!==8&&n.style){var o,h,e,s=i.camelCase(t),c=n.style;if(t=i.cssProps[s]||(i.cssProps[s]=gr(c,s)),e=i.cssHooks[t]||i.cssHooks[s],r!==undefined){if(h=typeof r,h==="string"&&(o=te.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(i.css(n,t)),h="number"),r==null||r!==r)return;h!=="number"||i.cssNumber[s]||(r+="px");f.clearCloneStyle||r!==""||t.indexOf("background")!==0||(c[t]="inherit");e&&"set"in e&&(r=e.set(n,r,u))===undefined||(c[t]=r)}else return e&&"get"in e&&(o=e.get(n,!1,u))!==undefined?o:c[t]}},css:function(n,t,r,u){var f,s,e,o=i.camelCase(t);return(t=i.cssProps[o]||(i.cssProps[o]=gr(n.style,o)),e=i.cssHooks[t]||i.cssHooks[o],e&&"get"in e&&(f=e.get(n,!0,r)),f===undefined&&(f=it(n,t,u)),f==="normal"&&t in kr&&(f=kr[t]),r===""||r)?(s=parseFloat(f),r===!0||i.isNumeric(s)?s||0:f):f}});i.each(["height","width"],function(n,t){i.cssHooks[t]={get:function(n,r,u){if(r)return gf.test(i.css(n,"display"))&&n.offsetWidth===0?i.swap(n,ie,function(){return iu(n,t,u)}):iu(n,t,u)},set:function(n,r,u){var f=u&&vt(n);return nu(n,r,u?tu(n,t,u,i.css(n,"boxSizing",!1,f)==="border-box",f):0)}}});i.cssHooks.marginRight=br(f.reliableMarginRight,function(n,t){if(t)return i.swap(n,{display:"inline-block"},it,[n,"marginRight"])});i.each({margin:"",padding:"",border:"Width"},function(n,t){i.cssHooks[n+t]={expand:function(i){for(var r=0,f={},u=typeof i=="string"?i.split(" "):[i];r<4;r++)f[n+p[r]+t]=u[r]||u[r-2]||u[0];return f}};wr.test(n)||(i.cssHooks[n+t].set=nu)});i.fn.extend({css:function(n,t){return l(this,function(n,t,r){var f,e,o={},u=0;if(i.isArray(t)){for(f=vt(n),e=t.length;u<e;u++)o[t[u]]=i.css(n,t[u],!1,f);return o}return r!==undefined?i.style(n,t,r):i.css(n,t)},n,t,arguments.length>1)},show:function(){return ru(this,!0)},hide:function(){return ru(this)},toggle:function(n){return typeof n=="boolean"?n?this.show():this.hide():this.each(function(){tt(this)?i(this).show():i(this).hide()})}});i.Tween=s;s.prototype={constructor:s,init:function(n,t,r,u,f,e){this.elem=n;this.prop=r;this.easing=f||"swing";this.options=t;this.start=this.now=this.cur();this.end=u;this.unit=e||(i.cssNumber[r]?"":"px")},cur:function(){var n=s.propHooks[this.prop];return n&&n.get?n.get(this):s.propHooks._default.get(this)},run:function(n){var t,r=s.propHooks[this.prop];return this.pos=this.options.duration?t=i.easing[this.easing](n,this.options.duration*n,0,1,this.options.duration):t=n,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):s.propHooks._default.set(this),this}};s.prototype.init.prototype=s.prototype;s.propHooks={_default:{get:function(n){var t;return n.elem[n.prop]!=null&&(!n.elem.style||n.elem.style[n.prop]==null)?n.elem[n.prop]:(t=i.css(n.elem,n.prop,""),!t||t==="auto"?0:t)},set:function(n){i.fx.step[n.prop]?i.fx.step[n.prop](n):n.elem.style&&(n.elem.style[i.cssProps[n.prop]]!=null||i.cssHooks[n.prop])?i.style(n.elem,n.prop,n.now+n.unit):n.elem[n.prop]=n.now}}};s.propHooks.scrollTop=s.propHooks.scrollLeft={set:function(n){n.elem.nodeType&&n.elem.parentNode&&(n.elem[n.prop]=n.now)}};i.easing={linear:function(n){return n},swing:function(n){return.5-Math.cos(n*Math.PI)/2}};i.fx=s.prototype.init;i.fx.step={};var d,yt,re=/^(?:toggle|show|hide)$/,uu=new RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),ue=/queueHooks$/,pt=[fe],rt={"*":[function(n,t){var f=this.createTween(n,t),s=f.cur(),u=uu.exec(t),e=u&&u[3]||(i.cssNumber[n]?"":"px"),r=(i.cssNumber[n]||e!=="px"&&+s)&&uu.exec(i.css(f.elem,n)),o=1,h=20;if(r&&r[3]!==e){e=e||r[3];u=u||[];r=+s||1;do o=o||".5",r=r/o,i.style(f.elem,n,r+e);while(o!==(o=f.cur()/s)&&o!==1&&--h)}return u&&(r=f.start=+r||+s||0,f.unit=e,f.end=u[1]?r+(u[1]+1)*u[2]:+u[2]),f}]};i.Animation=i.extend(ou,{tweener:function(n,t){i.isFunction(n)?(t=n,n=["*"]):n=n.split(" ");for(var r,u=0,f=n.length;u<f;u++)r=n[u],rt[r]=rt[r]||[],rt[r].unshift(t)},prefilter:function(n,t){t?pt.unshift(n):pt.push(n)}});i.speed=function(n,t,r){var u=n&&typeof n=="object"?i.extend({},n):{complete:r||!r&&t||i.isFunction(n)&&n,duration:n,easing:r&&t||t&&!i.isFunction(t)&&t};return u.duration=i.fx.off?0:typeof u.duration=="number"?u.duration:u.duration in i.fx.speeds?i.fx.speeds[u.duration]:i.fx.speeds._default,(u.queue==null||u.queue===!0)&&(u.queue="fx"),u.old=u.complete,u.complete=function(){i.isFunction(u.old)&&u.old.call(this);u.queue&&i.dequeue(this,u.queue)},u};i.fn.extend({fadeTo:function(n,t,i,r){return this.filter(tt).css("opacity",0).show().end().animate({opacity:t},n,i,r)},animate:function(n,t,u,f){var s=i.isEmptyObject(n),o=i.speed(t,u,f),e=function(){var t=ou(this,i.extend({},n),o);(s||r.get(this,"finish"))&&t.stop(!0)};return e.finish=e,s||o.queue===!1?this.each(e):this.queue(o.queue,e)},stop:function(n,t,u){var f=function(n){var t=n.stop;delete n.stop;t(u)};return typeof n!="string"&&(u=t,t=n,n=undefined),t&&n!==!1&&this.queue(n||"fx",[]),this.each(function(){var s=!0,t=n!=null&&n+"queueHooks",o=i.timers,e=r.get(this);if(t)e[t]&&e[t].stop&&f(e[t]);else for(t in e)e[t]&&e[t].stop&&ue.test(t)&&f(e[t]);for(t=o.length;t--;)o[t].elem===this&&(n==null||o[t].queue===n)&&(o[t].anim.stop(u),s=!1,o.splice(t,1));(s||!u)&&i.dequeue(this,n)})},finish:function(n){return n!==!1&&(n=n||"fx"),this.each(function(){var t,e=r.get(this),u=e[n+"queue"],o=e[n+"queueHooks"],f=i.timers,s=u?u.length:0;for(e.finish=!0,i.queue(this,n,[]),o&&o.stop&&o.stop.call(this,!0),t=f.length;t--;)f[t].elem===this&&f[t].queue===n&&(f[t].anim.stop(!0),f.splice(t,1));for(t=0;t<s;t++)u[t]&&u[t].finish&&u[t].finish.call(this);delete e.finish})}});i.each(["toggle","show","hide"],function(n,t){var r=i.fn[t];i.fn[t]=function(n,i,u){return n==null||typeof n=="boolean"?r.apply(this,arguments):this.animate(wt(t,!0),n,i,u)}});i.each({slideDown:wt("show"),slideUp:wt("hide"),slideToggle:wt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(n,t){i.fn[n]=function(n,i,r){return this.animate(t,n,i,r)}});i.timers=[];i.fx.tick=function(){var r,n=0,t=i.timers;for(d=i.now();n<t.length;n++)r=t[n],r()||t[n]!==r||t.splice(n--,1);t.length||i.fx.stop();d=undefined};i.fx.timer=function(n){i.timers.push(n);n()?i.fx.start():i.timers.pop()};i.fx.interval=13;i.fx.start=function(){yt||(yt=setInterval(i.fx.tick,i.fx.interval))};i.fx.stop=function(){clearInterval(yt);yt=null};i.fx.speeds={slow:600,fast:200,_default:400};i.fn.delay=function(n,t){return n=i.fx?i.fx.speeds[n]||n:n,t=t||"fx",this.queue(t,function(t,i){var r=setTimeout(t,n);i.stop=function(){clearTimeout(r)}})},function(){var n=u.createElement("input"),t=u.createElement("select"),i=t.appendChild(u.createElement("option"));n.type="checkbox";f.checkOn=n.value!=="";f.optSelected=i.selected;t.disabled=!0;f.optDisabled=!i.disabled;n=u.createElement("input");n.value="t";n.type="radio";f.radioValue=n.value==="t"}();g=i.expr.attrHandle;i.fn.extend({attr:function(n,t){return l(this,i.attr,n,t,arguments.length>1)},removeAttr:function(n){return this.each(function(){i.removeAttr(this,n)})}});i.extend({attr:function(n,t,r){var u,f,e=n.nodeType;if(n&&e!==3&&e!==8&&e!==2){if(typeof n.getAttribute===b)return i.prop(n,t,r);if(e===1&&i.isXMLDoc(n)||(t=t.toLowerCase(),u=i.attrHooks[t]||(i.expr.match.bool.test(t)?su:oe)),r!==undefined)if(r===null)i.removeAttr(n,t);else return u&&"set"in u&&(f=u.set(n,r,t))!==undefined?f:(n.setAttribute(t,r+""),r);else return u&&"get"in u&&(f=u.get(n,t))!==null?f:(f=i.find.attr(n,t),f==null?undefined:f)}},removeAttr:function(n,t){var r,u,e=0,f=t&&t.match(c);if(f&&n.nodeType===1)while(r=f[e++])u=i.propFix[r]||r,i.expr.match.bool.test(r)&&(n[u]=!1),n.removeAttribute(r)},attrHooks:{type:{set:function(n,t){if(!f.radioValue&&t==="radio"&&i.nodeName(n,"input")){var r=n.value;return n.setAttribute("type",t),r&&(n.value=r),t}}}}});su={set:function(n,t,r){return t===!1?i.removeAttr(n,r):n.setAttribute(r,r),r}};i.each(i.expr.match.bool.source.match(/\w+/g),function(n,t){var r=g[t]||i.find.attr;g[t]=function(n,t,i){var u,f;return i||(f=g[t],g[t]=u,u=r(n,t,i)!=null?t.toLowerCase():null,g[t]=f),u}});hu=/^(?:input|select|textarea|button)$/i;i.fn.extend({prop:function(n,t){return l(this,i.prop,n,t,arguments.length>1)},removeProp:function(n){return this.each(function(){delete this[i.propFix[n]||n]})}});i.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(n,t,r){var f,u,o,e=n.nodeType;if(n&&e!==3&&e!==8&&e!==2)return o=e!==1||!i.isXMLDoc(n),o&&(t=i.propFix[t]||t,u=i.propHooks[t]),r!==undefined?u&&"set"in u&&(f=u.set(n,r,t))!==undefined?f:n[t]=r:u&&"get"in u&&(f=u.get(n,t))!==null?f:n[t]},propHooks:{tabIndex:{get:function(n){return n.hasAttribute("tabindex")||hu.test(n.nodeName)||n.href?n.tabIndex:-1}}}});f.optSelected||(i.propHooks.selected={get:function(n){var t=n.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}});i.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){i.propFix[this.toLowerCase()]=this});bt=/[\t\r\n\f]/g;i.fn.extend({addClass:function(n){var o,t,r,u,s,f,h=typeof n=="string"&&n,e=0,l=this.length;if(i.isFunction(n))return this.each(function(t){i(this).addClass(n.call(this,t,this.className))});if(h)for(o=(n||"").match(c)||[];e<l;e++)if(t=this[e],r=t.nodeType===1&&(t.className?(" "+t.className+" ").replace(bt," "):" "),r){for(s=0;u=o[s++];)r.indexOf(" "+u+" ")<0&&(r+=u+" ");f=i.trim(r);t.className!==f&&(t.className=f)}return this},removeClass:function(n){var o,t,r,u,s,f,h=arguments.length===0||typeof n=="string"&&n,e=0,l=this.length;if(i.isFunction(n))return this.each(function(t){i(this).removeClass(n.call(this,t,this.className))});if(h)for(o=(n||"").match(c)||[];e<l;e++)if(t=this[e],r=t.nodeType===1&&(t.className?(" "+t.className+" ").replace(bt," "):""),r){for(s=0;u=o[s++];)while(r.indexOf(" "+u+" ")>=0)r=r.replace(" "+u+" "," ");f=n?i.trim(r):"";t.className!==f&&(t.className=f)}return this},toggleClass:function(n,t){var u=typeof n;return typeof t=="boolean"&&u==="string"?t?this.addClass(n):this.removeClass(n):i.isFunction(n)?this.each(function(r){i(this).toggleClass(n.call(this,r,this.className,t),t)}):this.each(function(){if(u==="string")for(var t,e=0,f=i(this),o=n.match(c)||[];t=o[e++];)f.hasClass(t)?f.removeClass(t):f.addClass(t);else(u===b||u==="boolean")&&(this.className&&r.set(this,"__className__",this.className),this.className=this.className||n===!1?"":r.get(this,"__className__")||"")})},hasClass:function(n){for(var i=" "+n+" ",t=0,r=this.length;t<r;t++)if(this[t].nodeType===1&&(" "+this[t].className+" ").replace(bt," ").indexOf(i)>=0)return!0;return!1}});cu=/\r/g;i.fn.extend({val:function(n){var t,r,f,u=this[0];return arguments.length?(f=i.isFunction(n),this.each(function(r){var u;this.nodeType===1&&(u=f?n.call(this,r,i(this).val()):n,u==null?u="":typeof u=="number"?u+="":i.isArray(u)&&(u=i.map(u,function(n){return n==null?"":n+""})),t=i.valHooks[this.type]||i.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,u,"value")!==undefined||(this.value=u))})):u?(t=i.valHooks[u.type]||i.valHooks[u.nodeName.toLowerCase()],t&&"get"in t&&(r=t.get(u,"value"))!==undefined)?r:(r=u.value,typeof r=="string"?r.replace(cu,""):r==null?"":r):void 0}});i.extend({valHooks:{option:{get:function(n){var t=i.find.attr(n,"value");return t!=null?t:i.trim(i.text(n))}},select:{get:function(n){for(var o,t,s=n.options,r=n.selectedIndex,u=n.type==="select-one"||r<0,h=u?null:[],c=u?r+1:s.length,e=r<0?c:u?r:0;e<c;e++)if(t=s[e],(t.selected||e===r)&&(f.optDisabled?!t.disabled:t.getAttribute("disabled")===null)&&(!t.parentNode.disabled||!i.nodeName(t.parentNode,"optgroup"))){if(o=i(t).val(),u)return o;h.push(o)}return h},set:function(n,t){for(var u,r,f=n.options,e=i.makeArray(t),o=f.length;o--;)r=f[o],(r.selected=i.inArray(r.value,e)>=0)&&(u=!0);return u||(n.selectedIndex=-1),e}}}});i.each(["radio","checkbox"],function(){i.valHooks[this]={set:function(n,t){if(i.isArray(t))return n.checked=i.inArray(i(n).val(),t)>=0}};f.checkOn||(i.valHooks[this].get=function(n){return n.getAttribute("value")===null?"on":n.value})});i.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(n,t){i.fn[t]=function(n,i){return arguments.length>0?this.on(t,null,n,i):this.trigger(t)}});i.fn.extend({hover:function(n,t){return this.mouseenter(n).mouseleave(t||n)},bind:function(n,t,i){return this.on(n,null,t,i)},unbind:function(n,t){return this.off(n,null,t)},delegate:function(n,t,i,r){return this.on(t,n,i,r)},undelegate:function(n,t,i){return arguments.length===1?this.off(n,"**"):this.off(t,n||"**",i)}});kt=i.now();dt=/\?/;i.parseJSON=function(n){return JSON.parse(n+"")};i.parseXML=function(n){var t,r;if(!n||typeof n!="string")return null;try{r=new DOMParser;t=r.parseFromString(n,"text/xml")}catch(u){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&i.error("Invalid XML: "+n),t};var se=/#.*$/,lu=/([?&])_=[^&]*/,he=/^(.*?):[ \t]*([^\r\n]*)$/mg,ce=/^(?:GET|HEAD)$/,le=/^\/\//,au=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,vu={},ci={},yu="*/".concat("*"),li=n.location.href,nt=au.exec(li.toLowerCase())||[];i.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:li,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(nt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":yu,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":i.parseJSON,"text xml":i.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(n,t){return t?ai(ai(n,i.ajaxSettings),t):ai(i.ajaxSettings,n)},ajaxPrefilter:pu(vu),ajaxTransport:pu(ci),ajax:function(n,t){function p(n,t,h,c){var v,it,tt,p,nt,l=t;e!==2&&(e=2,b&&clearTimeout(b),s=undefined,w=c||"",u.readyState=n>0?4:0,v=n>=200&&n<300||n===304,h&&(p=ae(r,u,h)),p=ve(r,p,u,v),v?(r.ifModified&&(nt=u.getResponseHeader("Last-Modified"),nt&&(i.lastModified[f]=nt),nt=u.getResponseHeader("etag"),nt&&(i.etag[f]=nt)),n===204||r.type==="HEAD"?l="nocontent":n===304?l="notmodified":(l=p.state,it=p.data,tt=p.error,v=!tt)):(tt=l,(n||!l)&&(l="error",n<0&&(n=0))),u.status=n,u.statusText=(t||l)+"",v?d.resolveWith(o,[it,l,u]):d.rejectWith(o,[u,l,tt]),u.statusCode(y),y=undefined,a&&k.trigger(v?"ajaxSuccess":"ajaxError",[u,r,v?it:tt]),g.fireWith(o,[u,l]),a&&(k.trigger("ajaxComplete",[u,r]),--i.active||i.event.trigger("ajaxStop")))}typeof n=="object"&&(t=n,n=undefined);t=t||{};var s,f,w,v,b,h,a,l,r=i.ajaxSetup({},t),o=r.context||r,k=r.context&&(o.nodeType||o.jquery)?i(o):i.event,d=i.Deferred(),g=i.Callbacks("once memory"),y=r.statusCode||{},tt={},it={},e=0,rt="canceled",u={readyState:0,getResponseHeader:function(n){var t;if(e===2){if(!v)for(v={};t=he.exec(w);)v[t[1].toLowerCase()]=t[2];t=v[n.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return e===2?w:null},setRequestHeader:function(n,t){var i=n.toLowerCase();return e||(n=it[i]=it[i]||n,tt[n]=t),this},overrideMimeType:function(n){return e||(r.mimeType=n),this},statusCode:function(n){var t;if(n)if(e<2)for(t in n)y[t]=[y[t],n[t]];else u.always(n[u.status]);return this},abort:function(n){var t=n||rt;return s&&s.abort(t),p(0,t),this}};if(d.promise(u).complete=g.add,u.success=u.done,u.error=u.fail,r.url=((n||r.url||li)+"").replace(se,"").replace(le,nt[1]+"//"),r.type=t.method||t.type||r.method||r.type,r.dataTypes=i.trim(r.dataType||"*").toLowerCase().match(c)||[""],r.crossDomain==null&&(h=au.exec(r.url.toLowerCase()),r.crossDomain=!!(h&&(h[1]!==nt[1]||h[2]!==nt[2]||(h[3]||(h[1]==="http:"?"80":"443"))!==(nt[3]||(nt[1]==="http:"?"80":"443"))))),r.data&&r.processData&&typeof r.data!="string"&&(r.data=i.param(r.data,r.traditional)),wu(vu,r,t,u),e===2)return u;a=i.event&&r.global;a&&i.active++==0&&i.event.trigger("ajaxStart");r.type=r.type.toUpperCase();r.hasContent=!ce.test(r.type);f=r.url;r.hasContent||(r.data&&(f=r.url+=(dt.test(f)?"&":"?")+r.data,delete r.data),r.cache===!1&&(r.url=lu.test(f)?f.replace(lu,"$1_="+kt++):f+(dt.test(f)?"&":"?")+"_="+kt++));r.ifModified&&(i.lastModified[f]&&u.setRequestHeader("If-Modified-Since",i.lastModified[f]),i.etag[f]&&u.setRequestHeader("If-None-Match",i.etag[f]));(r.data&&r.hasContent&&r.contentType!==!1||t.contentType)&&u.setRequestHeader("Content-Type",r.contentType);u.setRequestHeader("Accept",r.dataTypes[0]&&r.accepts[r.dataTypes[0]]?r.accepts[r.dataTypes[0]]+(r.dataTypes[0]!=="*"?", "+yu+"; q=0.01":""):r.accepts["*"]);for(l in r.headers)u.setRequestHeader(l,r.headers[l]);if(r.beforeSend&&(r.beforeSend.call(o,u,r)===!1||e===2))return u.abort();rt="abort";for(l in{success:1,error:1,complete:1})u[l](r[l]);if(s=wu(ci,r,t,u),s){u.readyState=1;a&&k.trigger("ajaxSend",[u,r]);r.async&&r.timeout>0&&(b=setTimeout(function(){u.abort("timeout")},r.timeout));try{e=1;s.send(tt,p)}catch(ut){if(e<2)p(-1,ut);else throw ut;}}else p(-1,"No Transport");return u},getJSON:function(n,t,r){return i.get(n,t,r,"json")},getScript:function(n,t){return i.get(n,undefined,t,"script")}});i.each(["get","post"],function(n,t){i[t]=function(n,r,u,f){return i.isFunction(r)&&(f=f||u,u=r,r=undefined),i.ajax({url:n,type:t,dataType:f,data:r,success:u})}});i._evalUrl=function(n){return i.ajax({url:n,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})};i.fn.extend({wrapAll:function(n){var t;return i.isFunction(n)?this.each(function(t){i(this).wrapAll(n.call(this,t))}):(this[0]&&(t=i(n,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var n=this;n.firstElementChild;)n=n.firstElementChild;return n}).append(this)),this)},wrapInner:function(n){return i.isFunction(n)?this.each(function(t){i(this).wrapInner(n.call(this,t))}):this.each(function(){var t=i(this),r=t.contents();r.length?r.wrapAll(n):t.append(n)})},wrap:function(n){var t=i.isFunction(n);return this.each(function(r){i(this).wrapAll(t?n.call(this,r):n)})},unwrap:function(){return this.parent().each(function(){i.nodeName(this,"body")||i(this).replaceWith(this.childNodes)}).end()}});i.expr.filters.hidden=function(n){return n.offsetWidth<=0&&n.offsetHeight<=0};i.expr.filters.visible=function(n){return!i.expr.filters.hidden(n)};var ye=/%20/g,pe=/\[\]$/,bu=/\r?\n/g,we=/^(?:submit|button|image|reset|file)$/i,be=/^(?:input|select|textarea|keygen)/i;i.param=function(n,t){var r,u=[],f=function(n,t){t=i.isFunction(t)?t():t==null?"":t;u[u.length]=encodeURIComponent(n)+"="+encodeURIComponent(t)};if(t===undefined&&(t=i.ajaxSettings&&i.ajaxSettings.traditional),i.isArray(n)||n.jquery&&!i.isPlainObject(n))i.each(n,function(){f(this.name,this.value)});else for(r in n)vi(r,n[r],t,f);return u.join("&").replace(ye,"+")};i.fn.extend({serialize:function(){return i.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var n=i.prop(this,"elements");return n?i.makeArray(n):this}).filter(function(){var n=this.type;return this.name&&!i(this).is(":disabled")&&be.test(this.nodeName)&&!we.test(n)&&(this.checked||!er.test(n))}).map(function(n,t){var r=i(this).val();return r==null?null:i.isArray(r)?i.map(r,function(n){return{name:t.name,value:n.replace(bu,"\r\n")}}):{name:t.name,value:r.replace(bu,"\r\n")}}).get()}});i.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(n){}};var ke=0,gt={},de={0:200,1223:204},ut=i.ajaxSettings.xhr();return n.attachEvent&&n.attachEvent("onunload",function(){for(var n in gt)gt[n]()}),f.cors=!!ut&&"withCredentials"in ut,f.ajax=ut=!!ut,i.ajaxTransport(function(n){var t;if(f.cors||ut&&!n.crossDomain)return{send:function(i,r){var f,u=n.xhr(),e=++ke;if(u.open(n.type,n.url,n.async,n.username,n.password),n.xhrFields)for(f in n.xhrFields)u[f]=n.xhrFields[f];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType);n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(f in i)u.setRequestHeader(f,i[f]);t=function(n){return function(){t&&(delete gt[e],t=u.onload=u.onerror=null,n==="abort"?u.abort():n==="error"?r(u.status,u.statusText):r(de[u.status]||u.status,u.statusText,typeof u.responseText=="string"?{text:u.responseText}:undefined,u.getAllResponseHeaders()))}};u.onload=t();u.onerror=t("error");t=gt[e]=t("abort");try{u.send(n.hasContent&&n.data||null)}catch(o){if(t)throw o;}},abort:function(){t&&t()}}}),i.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(n){return i.globalEval(n),n}}}),i.ajaxPrefilter("script",function(n){n.cache===undefined&&(n.cache=!1);n.crossDomain&&(n.type="GET")}),i.ajaxTransport("script",function(n){if(n.crossDomain){var r,t;return{send:function(f,e){r=i("<script>").prop({async:!0,charset:n.scriptCharset,src:n.url}).on("load error",t=function(n){r.remove();t=null;n&&e(n.type==="error"?404:200,n.type)});u.head.appendChild(r[0])},abort:function(){t&&t()}}}}),yi=[],ni=/(=)\?(?=&|$)|\?\?/,i.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=yi.pop()||i.expando+"_"+kt++;return this[n]=!0,n}}),i.ajaxPrefilter("json jsonp",function(t,r,u){var f,o,e,s=t.jsonp!==!1&&(ni.test(t.url)?"url":typeof t.data=="string"&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ni.test(t.data)&&"data");if(s||t.dataTypes[0]==="jsonp")return f=t.jsonpCallback=i.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(ni,"$1"+f):t.jsonp!==!1&&(t.url+=(dt.test(t.url)?"&":"?")+t.jsonp+"="+f),t.converters["script json"]=function(){return e||i.error(f+" was not called"),e[0]},t.dataTypes[0]="json",o=n[f],n[f]=function(){e=arguments},u.always(function(){n[f]=o;t[f]&&(t.jsonpCallback=r.jsonpCallback,yi.push(f));e&&i.isFunction(o)&&o(e[0]);e=o=undefined}),"script"}),i.parseHTML=function(n,t,r){if(!n||typeof n!="string")return null;typeof t=="boolean"&&(r=t,t=!1);t=t||u;var f=gi.exec(n),e=!r&&[];return f?[t.createElement(f[1])]:(f=i.buildFragment([n],t,e),e&&e.length&&i(e).remove(),i.merge([],f.childNodes))},pi=i.fn.load,i.fn.load=function(n,t,r){if(typeof n!="string"&&pi)return pi.apply(this,arguments);var u,o,s,f=this,e=n.indexOf(" ");return e>=0&&(u=i.trim(n.slice(e)),n=n.slice(0,e)),i.isFunction(t)?(r=t,t=undefined):t&&typeof t=="object"&&(o="POST"),f.length>0&&i.ajax({url:n,type:o,dataType:"html",data:t}).done(function(n){s=arguments;f.html(u?i("<div>").append(i.parseHTML(n)).find(u):n)}).complete(r&&function(n,t){f.each(r,s||[n.responseText,t,n])}),this},i.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(n,t){i.fn[t]=function(n){return this.on(t,n)}}),i.expr.filters.animated=function(n){return i.grep(i.timers,function(t){return n===t.elem}).length},wi=n.document.documentElement,i.offset={setOffset:function(n,t,r){var e,o,s,h,u,c,v,l=i.css(n,"position"),a=i(n),f={};l==="static"&&(n.style.position="relative");u=a.offset();s=i.css(n,"top");c=i.css(n,"left");v=(l==="absolute"||l==="fixed")&&(s+c).indexOf("auto")>-1;v?(e=a.position(),h=e.top,o=e.left):(h=parseFloat(s)||0,o=parseFloat(c)||0);i.isFunction(t)&&(t=t.call(n,r,u));t.top!=null&&(f.top=t.top-u.top+h);t.left!=null&&(f.left=t.left-u.left+o);"using"in t?t.using.call(n,f):a.css(f)}},i.fn.extend({offset:function(n){if(arguments.length)return n===undefined?this:this.each(function(t){i.offset.setOffset(this,n,t)});var r,f,t=this[0],u={top:0,left:0},e=t&&t.ownerDocument;if(e)return(r=e.documentElement,!i.contains(r,t))?u:(typeof t.getBoundingClientRect!==b&&(u=t.getBoundingClientRect()),f=ku(e),{top:u.top+f.pageYOffset-r.clientTop,left:u.left+f.pageXOffset-r.clientLeft})},position:function(){if(this[0]){var n,r,u=this[0],t={top:0,left:0};return i.css(u,"position")==="fixed"?r=u.getBoundingClientRect():(n=this.offsetParent(),r=this.offset(),i.nodeName(n[0],"html")||(t=n.offset()),t.top+=i.css(n[0],"borderTopWidth",!0),t.left+=i.css(n[0],"borderLeftWidth",!0)),{top:r.top-t.top-i.css(u,"marginTop",!0),left:r.left-t.left-i.css(u,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var n=this.offsetParent||wi;n&&!i.nodeName(n,"html")&&i.css(n,"position")==="static";)n=n.offsetParent;return n||wi})}}),i.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var u="pageYOffset"===r;i.fn[t]=function(i){return l(this,function(t,i,f){var e=ku(t);if(f===undefined)return e?e[r]:t[i];e?e.scrollTo(u?n.pageXOffset:f,u?f:n.pageYOffset):t[i]=f},t,i,arguments.length,null)}}),i.each(["top","left"],function(n,t){i.cssHooks[t]=br(f.pixelPosition,function(n,r){if(r)return r=it(n,t),hi.test(r)?i(n).position()[t]+"px":r})}),i.each({Height:"height",Width:"width"},function(n,t){i.each({padding:"inner"+n,content:t,"":"outer"+n},function(r,u){i.fn[u]=function(u,f){var e=arguments.length&&(r||typeof u!="boolean"),o=r||(u===!0||f===!0?"margin":"border");return l(this,function(t,r,u){var f;return i.isWindow(t)?t.document.documentElement["client"+n]:t.nodeType===9?(f=t.documentElement,Math.max(t.body["scroll"+n],f["scroll"+n],t.body["offset"+n],f["offset"+n],f["client"+n])):u===undefined?i.css(t,r,o):i.style(t,r,u,o)},t,e?u:undefined,e,null)}})}),i.fn.size=function(){return this.length},i.fn.andSelf=i.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return i}),du=n.jQuery,gu=n.$,i.noConflict=function(t){return n.$===i&&(n.$=gu),t&&n.jQuery===i&&(n.jQuery=du),i},typeof t===b&&(n.jQuery=n.$=i),i});jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(n,t,i,r,u){return jQuery.easing[jQuery.easing.def](n,t,i,r,u)},easeInQuad:function(n,t,i,r,u){return r*(t/=u)*t+i},easeOutQuad:function(n,t,i,r,u){return-r*(t/=u)*(t-2)+i},easeInOutQuad:function(n,t,i,r,u){return(t/=u/2)<1?r/2*t*t+i:-r/2*(--t*(t-2)-1)+i},easeInCubic:function(n,t,i,r,u){return r*(t/=u)*t*t+i},easeOutCubic:function(n,t,i,r,u){return r*((t=t/u-1)*t*t+1)+i},easeInOutCubic:function(n,t,i,r,u){return(t/=u/2)<1?r/2*t*t*t+i:r/2*((t-=2)*t*t+2)+i},easeInQuart:function(n,t,i,r,u){return r*(t/=u)*t*t*t+i},easeOutQuart:function(n,t,i,r,u){return-r*((t=t/u-1)*t*t*t-1)+i},easeInOutQuart:function(n,t,i,r,u){return(t/=u/2)<1?r/2*t*t*t*t+i:-r/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(n,t,i,r,u){return r*(t/=u)*t*t*t*t+i},easeOutQuint:function(n,t,i,r,u){return r*((t=t/u-1)*t*t*t*t+1)+i},easeInOutQuint:function(n,t,i,r,u){return(t/=u/2)<1?r/2*t*t*t*t*t+i:r/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(n,t,i,r,u){return-r*Math.cos(t/u*(Math.PI/2))+r+i},easeOutSine:function(n,t,i,r,u){return r*Math.sin(t/u*(Math.PI/2))+i},easeInOutSine:function(n,t,i,r,u){return-r/2*(Math.cos(Math.PI*t/u)-1)+i},easeInExpo:function(n,t,i,r,u){return t==0?i:r*Math.pow(2,10*(t/u-1))+i},easeOutExpo:function(n,t,i,r,u){return t==u?i+r:r*(-Math.pow(2,-10*t/u)+1)+i},easeInOutExpo:function(n,t,i,r,u){return t==0?i:t==u?i+r:(t/=u/2)<1?r/2*Math.pow(2,10*(t-1))+i:r/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(n,t,i,r,u){return-r*(Math.sqrt(1-(t/=u)*t)-1)+i},easeOutCirc:function(n,t,i,r,u){return r*Math.sqrt(1-(t=t/u-1)*t)+i},easeInOutCirc:function(n,t,i,r,u){return(t/=u/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+i:r/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(n,t,i,r,u){var o=1.70158,f=0,e=r;return t==0?i:(t/=u)==1?i+r:(f||(f=u*.3),e<Math.abs(r)?(e=r,o=f/4):o=f/(2*Math.PI)*Math.asin(r/e),-(e*Math.pow(2,10*(t-=1))*Math.sin((t*u-o)*2*Math.PI/f))+i)},easeOutElastic:function(n,t,i,r,u){var o=1.70158,f=0,e=r;return t==0?i:(t/=u)==1?i+r:(f||(f=u*.3),e<Math.abs(r)?(e=r,o=f/4):o=f/(2*Math.PI)*Math.asin(r/e),e*Math.pow(2,-10*t)*Math.sin((t*u-o)*2*Math.PI/f)+r+i)},easeInOutElastic:function(n,t,i,r,u){var o=1.70158,f=0,e=r;return t==0?i:(t/=u/2)==2?i+r:(f||(f=u*.3*1.5),e<Math.abs(r)?(e=r,o=f/4):o=f/(2*Math.PI)*Math.asin(r/e),t<1)?-.5*e*Math.pow(2,10*(t-=1))*Math.sin((t*u-o)*2*Math.PI/f)+i:e*Math.pow(2,-10*(t-=1))*Math.sin((t*u-o)*2*Math.PI/f)*.5+r+i},easeInBack:function(n,t,i,r,u,f){return f==undefined&&(f=1.70158),r*(t/=u)*t*((f+1)*t-f)+i},easeOutBack:function(n,t,i,r,u,f){return f==undefined&&(f=1.70158),r*((t=t/u-1)*t*((f+1)*t+f)+1)+i},easeInOutBack:function(n,t,i,r,u,f){return(f==undefined&&(f=1.70158),(t/=u/2)<1)?r/2*t*t*(((f*=1.525)+1)*t-f)+i:r/2*((t-=2)*t*(((f*=1.525)+1)*t+f)+2)+i},easeInBounce:function(n,t,i,r,u){return r-jQuery.easing.easeOutBounce(n,u-t,0,r,u)+i},easeOutBounce:function(n,t,i,r,u){return(t/=u)<1/2.75?r*7.5625*t*t+i:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+i:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+i:r*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(n,t,i,r,u){return t<u/2?jQuery.easing.easeInBounce(n,t*2,0,r,u)*.5+i:jQuery.easing.easeOutBounce(n,t*2-u,0,r,u)*.5+r*.5+i}}),function(){var c=this,tt=c._,r=Array.prototype,p=Object.prototype,it=Function.prototype,w=r.push,t=r.slice,l=r.concat,u=p.toString,b=p.hasOwnProperty,rt=Array.isArray,k=Object.keys,a=it.bind,n=function(t){if(t instanceof n)return t;if(!(this instanceof n))return new n(t);this._wrapped=t},i,v,e,f,o,s,nt,h;typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=n),exports._=n):c._=n;n.VERSION="1.7.0";i=function(n,t,i){if(t===void 0)return n;switch(i==null?3:i){case 1:return function(i){return n.call(t,i)};case 2:return function(i,r){return n.call(t,i,r)};case 3:return function(i,r,u){return n.call(t,i,r,u)};case 4:return function(i,r,u,f){return n.call(t,i,r,u,f)}}return function(){return n.apply(t,arguments)}};n.iteratee=function(t,r,u){return t==null?n.identity:n.isFunction(t)?i(t,r,u):n.isObject(t)?n.matches(t):n.property(t)};n.each=n.forEach=function(t,r,u){var f,e,o;if(t==null)return t;if(r=i(r,u),e=t.length,e===+e)for(f=0;f<e;f++)r(t[f],f,t);else for(o=n.keys(t),f=0,e=o.length;f<e;f++)r(t[o[f]],o[f],t);return t};n.map=n.collect=function(t,i,r){var u;if(t==null)return[];i=n.iteratee(i,r);var f=t.length!==+t.length&&n.keys(t),o=(f||t).length,s=Array(o),e;for(u=0;u<o;u++)e=f?f[u]:u,s[u]=i(t[e],e,t);return s};v="Reduce of empty array with no initial value";n.reduce=n.foldl=n.inject=function(t,r,u,f){t==null&&(t=[]);r=i(r,f,4);var o=t.length!==+t.length&&n.keys(t),h=(o||t).length,e=0,s;if(arguments.length<3){if(!h)throw new TypeError(v);u=t[o?o[e++]:e++]}for(;e<h;e++)s=o?o[e]:e,u=r(u,t[s],s,t);return u};n.reduceRight=n.foldr=function(t,r,u,f){t==null&&(t=[]);r=i(r,f,4);var o=t.length!==+t.length&&n.keys(t),e=(o||t).length,s;if(arguments.length<3){if(!e)throw new TypeError(v);u=t[o?o[--e]:--e]}while(e--)s=o?o[e]:e,u=r(u,t[s],s,t);return u};n.find=n.detect=function(t,i,r){var u;return i=n.iteratee(i,r),n.some(t,function(n,t,r){if(i(n,t,r))return u=n,!0}),u};n.filter=n.select=function(t,i,r){var u=[];return t==null?u:(i=n.iteratee(i,r),n.each(t,function(n,t,r){i(n,t,r)&&u.push(n)}),u)};n.reject=function(t,i,r){return n.filter(t,n.negate(n.iteratee(i)),r)};n.every=n.all=function(t,i,r){if(t==null)return!0;i=n.iteratee(i,r);for(var f=t.length!==+t.length&&n.keys(t),o=(f||t).length,e,u=0;u<o;u++)if(e=f?f[u]:u,!i(t[e],e,t))return!1;return!0};n.some=n.any=function(t,i,r){if(t==null)return!1;i=n.iteratee(i,r);for(var f=t.length!==+t.length&&n.keys(t),o=(f||t).length,e,u=0;u<o;u++)if(e=f?f[u]:u,i(t[e],e,t))return!0;return!1};n.contains=n.include=function(t,i){return t==null?!1:(t.length!==+t.length&&(t=n.values(t)),n.indexOf(t,i)>=0)};n.invoke=function(i,r){var u=t.call(arguments,2),f=n.isFunction(r);return n.map(i,function(n){return(f?r:n[r]).apply(n,u)})};n.pluck=function(t,i){return n.map(t,n.property(i))};n.where=function(t,i){return n.filter(t,n.matches(i))};n.findWhere=function(t,i){return n.find(t,n.matches(i))};n.max=function(t,i,r){var u=-Infinity,s=-Infinity,o,f,e,h;if(i==null&&t!=null)for(t=t.length===+t.length?t:n.values(t),e=0,h=t.length;e<h;e++)o=t[e],o>u&&(u=o);else i=n.iteratee(i,r),n.each(t,function(n,t,r){f=i(n,t,r);(f>s||f===-Infinity&&u===-Infinity)&&(u=n,s=f)});return u};n.min=function(t,i,r){var u=Infinity,s=Infinity,o,f,e,h;if(i==null&&t!=null)for(t=t.length===+t.length?t:n.values(t),e=0,h=t.length;e<h;e++)o=t[e],o<u&&(u=o);else i=n.iteratee(i,r),n.each(t,function(n,t,r){f=i(n,t,r);(f<s||f===Infinity&&u===Infinity)&&(u=n,s=f)});return u};n.shuffle=function(t){for(var f=t&&t.length===+t.length?t:n.values(t),e=f.length,r=Array(e),i=0,u;i<e;i++)u=n.random(0,i),u!==i&&(r[i]=r[u]),r[u]=f[i];return r};n.sample=function(t,i,r){return i==null||r?(t.length!==+t.length&&(t=n.values(t)),t[n.random(t.length-1)]):n.shuffle(t).slice(0,Math.max(0,i))};n.sortBy=function(t,i,r){return i=n.iteratee(i,r),n.pluck(n.map(t,function(n,t,r){return{value:n,index:t,criteria:i(n,t,r)}}).sort(function(n,t){var i=n.criteria,r=t.criteria;if(i!==r){if(i>r||i===void 0)return 1;if(i<r||r===void 0)return-1}return n.index-t.index}),"value")};e=function(t){return function(i,r,u){var f={};return r=n.iteratee(r,u),n.each(i,function(n,u){var e=r(n,u,i);t(f,n,e)}),f}};n.groupBy=e(function(t,i,r){n.has(t,r)?t[r].push(i):t[r]=[i]});n.indexBy=e(function(n,t,i){n[i]=t});n.countBy=e(function(t,i,r){n.has(t,r)?t[r]++:t[r]=1});n.sortedIndex=function(t,i,r,u){var e;r=n.iteratee(r,u,1);for(var s=r(i),f=0,o=t.length;f<o;)e=f+o>>>1,r(t[e])<s?f=e+1:o=e;return f};n.toArray=function(i){return i?n.isArray(i)?t.call(i):i.length===+i.length?n.map(i,n.identity):n.values(i):[]};n.size=function(t){return t==null?0:t.length===+t.length?t.length:n.keys(t).length};n.partition=function(t,i,r){i=n.iteratee(i,r);var u=[],f=[];return n.each(t,function(n,t,r){(i(n,t,r)?u:f).push(n)}),[u,f]};n.first=n.head=n.take=function(n,i,r){if(n!=null)return i==null||r?n[0]:i<0?[]:t.call(n,0,i)};n.initial=function(n,i,r){return t.call(n,0,Math.max(0,n.length-(i==null||r?1:i)))};n.last=function(n,i,r){if(n!=null)return i==null||r?n[n.length-1]:t.call(n,Math.max(n.length-i,0))};n.rest=n.tail=n.drop=function(n,i,r){return t.call(n,i==null||r?1:i)};n.compact=function(t){return n.filter(t,n.identity)};f=function(t,i,r,u){var o,s,e;if(i&&n.every(t,n.isArray))return l.apply(u,t);for(o=0,s=t.length;o<s;o++)e=t[o],n.isArray(e)||n.isArguments(e)?i?w.apply(u,e):f(e,i,r,u):r||u.push(e);return u};n.flatten=function(n,t){return f(n,t,!1,[])};n.without=function(i){return n.difference(i,t.call(arguments,1))};n.uniq=n.unique=function(t,i,r,u){var e,s,o,c,f,h;if(t==null)return[];for(n.isBoolean(i)||(u=r,r=i,i=!1),r!=null&&(r=n.iteratee(r,u)),e=[],s=[],o=0,c=t.length;o<c;o++)f=t[o],i?(o&&s===f||e.push(f),s=f):r?(h=r(f,o,t),n.indexOf(s,h)<0&&(s.push(h),e.push(f))):n.indexOf(e,f)<0&&e.push(f);return e};n.union=function(){return n.uniq(f(arguments,!0,!0,[]))};n.intersection=function(t){var r,e,u,o,f,i;if(t==null)return[];for(r=[],e=arguments.length,u=0,o=t.length;u<o;u++)if(f=t[u],!n.contains(r,f)){for(i=1;i<e;i++)if(!n.contains(arguments[i],f))break;i===e&&r.push(f)}return r};n.difference=function(i){var r=f(t.call(arguments,1),!0,!0,[]);return n.filter(i,function(t){return!n.contains(r,t)})};n.zip=function(t){var r,u,i;if(t==null)return[];for(r=n.max(arguments,"length").length,u=Array(r),i=0;i<r;i++)u[i]=n.pluck(arguments,i);return u};n.object=function(n,t){var r,i,u;if(n==null)return{};for(r={},i=0,u=n.length;i<u;i++)t?r[n[i]]=t[i]:r[n[i][0]]=n[i][1];return r};n.indexOf=function(t,i,r){if(t==null)return-1;var u=0,f=t.length;if(r)if(typeof r=="number")u=r<0?Math.max(0,f+r):r;else return u=n.sortedIndex(t,i),t[u]===i?u:-1;for(;u<f;u++)if(t[u]===i)return u;return-1};n.lastIndexOf=function(n,t,i){if(n==null)return-1;var r=n.length;for(typeof i=="number"&&(r=i<0?r+i+1:Math.min(r,i+1));--r>=0;)if(n[r]===t)return r;return-1};n.range=function(n,t,i){var u,f,r;for(arguments.length<=1&&(t=n||0,n=0),i=i||1,u=Math.max(Math.ceil((t-n)/i),0),f=Array(u),r=0;r<u;r++,n+=i)f[r]=n;return f};o=function(){};n.bind=function(i,r){var u,f;if(a&&i.bind===a)return a.apply(i,t.call(arguments,1));if(!n.isFunction(i))throw new TypeError("Bind must be called on a function");return u=t.call(arguments,2),f=function(){var e,s;return(this instanceof f)?(o.prototype=i.prototype,e=new o,o.prototype=null,s=i.apply(e,u.concat(t.call(arguments))),n.isObject(s))?s:e:i.apply(r,u.concat(t.call(arguments)))}};n.partial=function(i){var r=t.call(arguments,1);return function(){for(var f=0,t=r.slice(),u=0,e=t.length;u<e;u++)t[u]===n&&(t[u]=arguments[f++]);while(f<arguments.length)t.push(arguments[f++]);return i.apply(this,t)}};n.bindAll=function(t){var i,u=arguments.length,r;if(u<=1)throw new Error("bindAll must be passed function names");for(i=1;i<u;i++)r=arguments[i],t[r]=n.bind(t[r],t);return t};n.memoize=function(t,i){var r=function(u){var f=r.cache,e=i?i.apply(this,arguments):u;return n.has(f,e)||(f[e]=t.apply(this,arguments)),f[e]};return r.cache={},r};n.delay=function(n,i){var r=t.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},i)};n.defer=function(i){return n.delay.apply(n,[i,1].concat(t.call(arguments,1)))};n.throttle=function(t,i,r){var f,e,s,u=null,o=0,h;return r||(r={}),h=function(){o=r.leading===!1?0:n.now();u=null;s=t.apply(f,e);u||(f=e=null)},function(){var l=n.now(),c;return o||r.leading!==!1||(o=l),c=i-(l-o),f=this,e=arguments,c<=0||c>i?(clearTimeout(u),u=null,o=l,s=t.apply(f,e),u||(f=e=null)):u||r.trailing===!1||(u=setTimeout(h,c)),s}};n.debounce=function(t,i,r){var u,f,e,s,o,h=function(){var c=n.now()-s;c<i&&c>0?u=setTimeout(h,i-c):(u=null,r||(o=t.apply(e,f),u||(e=f=null)))};return function(){e=this;f=arguments;s=n.now();var c=r&&!u;return u||(u=setTimeout(h,i)),c&&(o=t.apply(e,f),e=f=null),o}};n.wrap=function(t,i){return n.partial(i,t)};n.negate=function(n){return function(){return!n.apply(this,arguments)}};n.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,i=n[t].apply(this,arguments);r--;)i=n[r].call(this,i);return i}};n.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}};n.before=function(n,t){var i;return function(){return--n>0?i=t.apply(this,arguments):t=null,i}};n.once=n.partial(n.before,2);n.keys=function(t){var i,r;if(!n.isObject(t))return[];if(k)return k(t);i=[];for(r in t)n.has(t,r)&&i.push(r);return i};n.values=function(t){for(var r=n.keys(t),u=r.length,f=Array(u),i=0;i<u;i++)f[i]=t[r[i]];return f};n.pairs=function(t){for(var r=n.keys(t),u=r.length,f=Array(u),i=0;i<u;i++)f[i]=[r[i],t[r[i]]];return f};n.invert=function(t){for(var u={},r=n.keys(t),i=0,f=r.length;i<f;i++)u[t[r[i]]]=r[i];return u};n.functions=n.methods=function(t){var i=[];for(var r in t)n.isFunction(t[r])&&i.push(r);return i.sort()};n.extend=function(t){var i,r,u,f;if(!n.isObject(t))return t;for(u=1,f=arguments.length;u<f;u++){i=arguments[u];for(r in i)b.call(i,r)&&(t[r]=i[r])}return t};n.pick=function(r,u,f){var o={},e,h,c,s,a;if(r==null)return o;if(n.isFunction(u)){u=i(u,f);for(e in r)h=r[e],u(h,e,r)&&(o[e]=h)}else for(c=l.apply([],t.call(arguments,1)),r=new Object(r),s=0,a=c.length;s<a;s++)e=c[s],e in r&&(o[e]=r[e]);return o};n.omit=function(i,r,u){if(n.isFunction(r))r=n.negate(r);else{var f=n.map(l.apply([],t.call(arguments,1)),String);r=function(t,i){return!n.contains(f,i)}}return n.pick(i,r,u)};n.defaults=function(t){var i,f,u,r;if(!n.isObject(t))return t;for(i=1,f=arguments.length;i<f;i++){u=arguments[i];for(r in u)t[r]===void 0&&(t[r]=u[r])}return t};n.clone=function(t){return n.isObject(t)?n.isArray(t)?t.slice():n.extend({},t):t};n.tap=function(n,t){return t(n),n};s=function(t,i,r,f){var l,a,h,c,e,o,y,v;if(t===i)return t!==0||1/t==1/i;if(t==null||i==null)return t===i;if(t instanceof n&&(t=t._wrapped),i instanceof n&&(i=i._wrapped),l=u.call(t),l!==u.call(i))return!1;switch(l){case"[object RegExp]":case"[object String]":return""+t==""+i;case"[object Number]":return+t!=+t?+i!=+i:+t==0?1/+t==1/i:+t==+i;case"[object Date]":case"[object Boolean]":return+t==+i}if(typeof t!="object"||typeof i!="object")return!1;for(a=r.length;a--;)if(r[a]===t)return f[a]===i;if(h=t.constructor,c=i.constructor,h!==c&&"constructor"in t&&"constructor"in i&&!(n.isFunction(h)&&h instanceof h&&n.isFunction(c)&&c instanceof c))return!1;if(r.push(t),f.push(i),l==="[object Array]"){if(e=t.length,o=e===i.length,o)while(e--)if(!(o=s(t[e],i[e],r,f)))break}else if(y=n.keys(t),e=y.length,o=n.keys(i).length===e,o)while(e--)if(v=y[e],!(o=n.has(i,v)&&s(t[v],i[v],r,f)))break;return r.pop(),f.pop(),o};n.isEqual=function(n,t){return s(n,t,[],[])};n.isEmpty=function(t){if(t==null)return!0;if(n.isArray(t)||n.isString(t)||n.isArguments(t))return t.length===0;for(var i in t)if(n.has(t,i))return!1;return!0};n.isElement=function(n){return!!(n&&n.nodeType===1)};n.isArray=rt||function(n){return u.call(n)==="[object Array]"};n.isObject=function(n){var t=typeof n;return t==="function"||t==="object"&&!!n};n.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){n["is"+t]=function(n){return u.call(n)==="[object "+t+"]"}});n.isArguments(arguments)||(n.isArguments=function(t){return n.has(t,"callee")});typeof/./!="function"&&(n.isFunction=function(n){return typeof n=="function"||!1});n.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))};n.isNaN=function(t){return n.isNumber(t)&&t!==+t};n.isBoolean=function(n){return n===!0||n===!1||u.call(n)==="[object Boolean]"};n.isNull=function(n){return n===null};n.isUndefined=function(n){return n===void 0};n.has=function(n,t){return n!=null&&b.call(n,t)};n.noConflict=function(){return c._=tt,this};n.identity=function(n){return n};n.constant=function(n){return function(){return n}};n.noop=function(){};n.property=function(n){return function(t){return t[n]}};n.matches=function(t){var i=n.pairs(t),r=i.length;return function(n){var t,u,f;if(n==null)return!r;for(n=new Object(n),t=0;t<r;t++)if(u=i[t],f=u[0],u[1]!==n[f]||!(f in n))return!1;return!0}};n.times=function(n,t,r){var f=Array(Math.max(0,n)),u;for(t=i(t,r,1),u=0;u<n;u++)f[u]=t(u);return f};n.random=function(n,t){return t==null&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};n.now=Date.now||function(){return(new Date).getTime()};var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ut=n.invert(d),g=function(t){var r=function(n){return t[n]},i="(?:"+n.keys(t).join("|")+")",u=RegExp(i),f=RegExp(i,"g");return function(n){return n=n==null?"":""+n,u.test(n)?n.replace(f,r):n}};n.escape=g(d);n.unescape=g(ut);n.result=function(t,i){if(t==null)return void 0;var r=t[i];return n.isFunction(r)?t[i]():r};nt=0;n.uniqueId=function(n){var t=++nt+"";return n?n+t:t};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/(.)^/,ft={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},et=/\\|'|\r|\n|\u2028|\u2029/g,ot=function(n){return"\\"+ft[n]};n.template=function(t,i,r){var o,f,h;!i&&r&&(i=r);i=n.defaults({},i,n.templateSettings);var c=RegExp([(i.escape||y).source,(i.interpolate||y).source,(i.evaluate||y).source].join("|")+"|$","g"),e=0,u="__p+='";t.replace(c,function(n,i,r,f,o){return u+=t.slice(e,o).replace(et,ot),e=o+n.length,i?u+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":r?u+="'+\n((__t=("+r+"))==null?'':__t)+\n'":f&&(u+="';\n"+f+"\n__p+='"),n});u+="';\n";i.variable||(u="with(obj||{}){\n"+u+"}\n");u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{o=new Function(i.variable||"obj","_",u)}catch(s){s.source=u;throw s;}return f=function(t){return o.call(this,t,n)},h=i.variable||"obj",f.source="function("+h+"){\n"+u+"}",f};n.chain=function(t){var i=n(t);return i._chain=!0,i};h=function(t){return this._chain?n(t).chain():t};n.mixin=function(t){n.each(n.functions(t),function(i){var r=n[i]=t[i];n.prototype[i]=function(){var t=[this._wrapped];return w.apply(t,arguments),h.call(this,r.apply(n,t))}})};n.mixin(n);n.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=r[t];n.prototype[t]=function(){var n=this._wrapped;return i.apply(n,arguments),(t==="shift"||t==="splice")&&n.length===0&&delete n[0],h.call(this,n)}});n.each(["concat","join","slice"],function(t){var i=r[t];n.prototype[t]=function(){return h.call(this,i.apply(this._wrapped,arguments))}});n.prototype.value=function(){return this._wrapped};typeof define=="function"&&define.amd&&define("underscore",[],function(){return n})}.call(this);
//! moment.js
//! version : 2.10.6
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):n.moment=t()})(this,function(){"use strict";function i(){return ru.apply(null,arguments)}function eo(n){ru=n}function ui(n){return Object.prototype.toString.call(n)==="[object Array]"}function fi(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function oo(n,t){for(var r=[],i=0;i<n.length;++i)r.push(t(n[i],i));return r}function ft(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function ei(n,t){for(var i in t)ft(t,i)&&(n[i]=t[i]);return ft(t,"toString")&&(n.toString=t.toString),ft(t,"valueOf")&&(n.valueOf=t.valueOf),n}function kt(n,t,i,r){return sf(n,t,i,r,!0).utc()}function so(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function e(n){return n._pf==null&&(n._pf=so()),n._pf}function uu(n){if(n._isValid==null){var t=e(n);n._isValid=!isNaN(n._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated;n._strict&&(n._isValid=n._isValid&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined)}return n._isValid}function fu(n){var t=kt(NaN);return n!=null?ei(e(t),n):e(t).userInvalidated=!0,t}function gi(n,t){var u,i,r;if(typeof t._isAMomentObject!="undefined"&&(n._isAMomentObject=t._isAMomentObject),typeof t._i!="undefined"&&(n._i=t._i),typeof t._f!="undefined"&&(n._f=t._f),typeof t._l!="undefined"&&(n._l=t._l),typeof t._strict!="undefined"&&(n._strict=t._strict),typeof t._tzm!="undefined"&&(n._tzm=t._tzm),typeof t._isUTC!="undefined"&&(n._isUTC=t._isUTC),typeof t._offset!="undefined"&&(n._offset=t._offset),typeof t._pf!="undefined"&&(n._pf=e(t)),typeof t._locale!="undefined"&&(n._locale=t._locale),di.length>0)for(u in di)i=di[u],r=t[i],typeof r!="undefined"&&(n[i]=r);return n}function dt(n){gi(this,n);this._d=new Date(n._d!=null?n._d.getTime():NaN);nr===!1&&(nr=!0,i.updateOffset(this),nr=!1)}function tt(n){return n instanceof dt||n!=null&&n._isAMomentObject!=null}function v(n){return n<0?Math.ceil(n):Math.floor(n)}function s(n){var t=+n,i=0;return t!==0&&isFinite(t)&&(i=v(t)),i}function eu(n,t,i){for(var f=Math.min(n.length,t.length),e=Math.abs(n.length-t.length),u=0,r=0;r<f;r++)(i&&n[r]!==t[r]||!i&&s(n[r])!==s(t[r]))&&u++;return u+e}function ou(){}function su(n){return n?n.toLowerCase().replace("_","-"):n}function ho(n){for(var r=0,i,t,f,u;r<n.length;){for(u=su(n[r]).split("-"),i=u.length,t=su(n[r+1]),t=t?t.split("-"):null;i>0;){if(f=hu(u.slice(0,i).join("-")),f)return f;if(t&&t.length>=i&&eu(u,t,!0)>=i-1)break;i--}r++}return null}function hu(n){var t=null;if(!et[n]&&typeof module!="undefined"&&module&&module.exports)try{t=oi._abbr;require("./locale/"+n);gt(t)}catch(i){}return et[n]}function gt(n,t){var i;return n&&(i=typeof t=="undefined"?ot(n):cu(n,t),i&&(oi=i)),oi._abbr}function cu(n,t){return t!==null?(t.abbr=n,et[n]=et[n]||new ou,et[n].set(t),gt(n),et[n]):(delete et[n],null)}function ot(n){var t;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return oi;if(!ui(n)){if(t=hu(n),t)return t;n=[n]}return ho(n)}function l(n,t){var i=n.toLowerCase();ni[i]=ni[i+"s"]=ni[t]=n}function p(n){return typeof n=="string"?ni[n]||ni[n.toLowerCase()]:undefined}function lu(n){var r={},t;for(var i in n)ft(n,i)&&(t=p(i),t&&(r[t]=n[i]));return r}function pt(n,t){return function(r){return r!=null?(au(this,n,r),i.updateOffset(this,t),this):si(this,n)}}function si(n,t){return n._d["get"+(n._isUTC?"UTC":"")+t]()}function au(n,t,i){return n._d["set"+(n._isUTC?"UTC":"")+t](i)}function vu(n,t){var i;if(typeof n=="object")for(i in n)this.set(i,n[i]);else if(n=p(n),typeof this[n]=="function")return this[n](t);return this}function tr(n,t,i){var r=""+Math.abs(n),u=t-r.length,f=n>=0;return(f?i?"+":"":"-")+Math.pow(10,Math.max(0,u)).toString().substr(1)+r}function r(n,t,i,r){var u=r;typeof r=="string"&&(u=function(){return this[r]()});n&&(wt[n]=u);t&&(wt[t[0]]=function(){return tr(u.apply(this,arguments),t[1],t[2])});i&&(wt[i]=function(){return this.localeData().ordinal(u.apply(this,arguments),n)})}function co(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function lo(n){for(var i=n.match(yu),t=0,r=i.length;t<r;t++)i[t]=wt[i[t]]?wt[i[t]]:co(i[t]);return function(u){var f="";for(t=0;t<r;t++)f+=i[t]instanceof Function?i[t].call(u,n):i[t];return f}}function rr(n,t){return n.isValid()?(t=pu(t,n.localeData()),ir[t]=ir[t]||lo(t),ir[t](n)):n.localeData().invalidDate()}function pu(n,t){function r(n){return t.longDateFormat(n)||n}var i=5;for(hi.lastIndex=0;i>=0&&hi.test(n);)n=n.replace(hi,r),hi.lastIndex=0,i-=1;return n}function ao(n){return typeof n=="function"&&Object.prototype.toString.call(n)==="[object Function]"}function t(n,t,i){er[n]=ao(t)?t:function(n){return n&&i?i:t}}function vo(n,t){return ft(er,n)?er[n](t._strict,t._locale):new RegExp(yo(n))}function yo(n){return n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(n,t,i,r,u){return t||i||r||u}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function c(n,t){var i,r=t;for(typeof n=="string"&&(n=[n]),typeof t=="number"&&(r=function(n,i){i[t]=s(n)}),i=0;i<n.length;i++)or[n[i]]=r}function ii(n,t){c(n,function(n,i,r,u){r._w=r._w||{};t(n,r._w,r,u)})}function po(n,t,i){t!=null&&ft(or,n)&&or[n](t,i._a,i,n)}function sr(n,t){return new Date(Date.UTC(n,t+1,0)).getUTCDate()}function wo(n){return this._months[n.month()]}function bo(n){return this._monthsShort[n.month()]}function ko(n,t,i){var r,u,f;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++)if((u=kt([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(u,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(u,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(f="^"+this.months(u,"")+"|^"+this.monthsShort(u,""),this._monthsParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="MMMM"&&this._longMonthsParse[r].test(n))||i&&t==="MMM"&&this._shortMonthsParse[r].test(n)||!i&&this._monthsParse[r].test(n))return r}function gu(n,t){var i;return typeof t=="string"&&(t=n.localeData().monthsParse(t),typeof t!="number")?n:(i=Math.min(n.date(),sr(n.year(),t)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](t,i),n)}function nf(n){return n!=null?(gu(this,n),i.updateOffset(this,!0),this):si(this,"Month")}function go(){return sr(this.year(),this.month())}function hr(n){var i,t=n._a;return t&&e(n).overflow===-2&&(i=t[g]<0||t[g]>11?g:t[k]<1||t[k]>sr(t[b],t[g])?k:t[a]<0||t[a]>24||t[a]===24&&(t[st]!==0||t[ht]!==0||t[ct]!==0)?a:t[st]<0||t[st]>59?st:t[ht]<0||t[ht]>59?ht:t[ct]<0||t[ct]>999?ct:-1,e(n)._overflowDayOfYear&&(i<b||i>k)&&(i=k),e(n).overflow=i),n}function tf(){i.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn}function w(n,t){var i=!0;return ei(function(){return i&&(tf(n+"\n"+(new Error).stack),i=!1),t.apply(this,arguments)},t)}function ns(n,t){cr[n]||(tf(t),cr[n]=!0)}function rf(n){var t,i,r=n._i,u=ts.exec(r);if(u){for(e(n).iso=!0,t=0,i=lr.length;t<i;t++)if(lr[t][1].exec(r)){n._f=lr[t][0];break}for(t=0,i=ar.length;t<i;t++)if(ar[t][1].exec(r)){n._f+=(u[6]||" ")+ar[t][0];break}r.match(yi)&&(n._f+="Z");wr(n)}else n._isValid=!1}function rs(n){var t=is.exec(n._i);if(t!==null){n._d=new Date(+t[1]);return}rf(n);n._isValid===!1&&(delete n._isValid,i.createFromInputFallback(n))}function us(n,t,i,r,u,f,e){var o=new Date(n,t,i,r,u,f,e);return n<1970&&o.setFullYear(n),o}function vr(n){var t=new Date(Date.UTC.apply(null,arguments));return n<1970&&t.setUTCFullYear(n),t}function uf(n){return ff(n)?366:365}function ff(n){return n%4==0&&n%100!=0||n%400==0}function fs(){return ff(this.year())}function lt(n,t,i){var f=i-t,r=i-n.day(),u;return r>f&&(r-=7),r<f-7&&(r+=7),u=o(n).add(r,"d"),{week:Math.ceil(u.dayOfYear()/7),year:u.year()}}function es(n){return lt(n,this._week.dow,this._week.doy).week}function os(){return this._week.dow}function ss(){return this._week.doy}function hs(n){var t=this.localeData().week(this);return n==null?t:this.add((n-t)*7,"d")}function cs(n){var t=lt(this,1,4).week;return n==null?t:this.add((n-t)*7,"d")}function ls(n,t,i,r,u){var o=6+u-r,s=vr(n,0,1+o),e=s.getUTCDay(),f;return e<u&&(e+=7),i=i!=null?1*i:u,f=1+o+7*(t-1)-e+i,{year:f>0?n:n-1,dayOfYear:f>0?f:uf(n-1)+f}}function as(n){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?t:this.add(n-t,"d")}function bt(n,t,i){return n!=null?n:t!=null?t:i}function vs(n){var t=new Date;return n._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function pr(n){var t,i,r=[],u,f;if(!n._d){for(u=vs(n),n._w&&n._a[k]==null&&n._a[g]==null&&ys(n),n._dayOfYear&&(f=bt(n._a[b],u[b]),n._dayOfYear>uf(f)&&(e(n)._overflowDayOfYear=!0),i=vr(f,0,n._dayOfYear),n._a[g]=i.getUTCMonth(),n._a[k]=i.getUTCDate()),t=0;t<3&&n._a[t]==null;++t)n._a[t]=r[t]=u[t];for(;t<7;t++)n._a[t]=r[t]=n._a[t]==null?t===2?1:0:n._a[t];n._a[a]===24&&n._a[st]===0&&n._a[ht]===0&&n._a[ct]===0&&(n._nextDay=!0,n._a[a]=0);n._d=(n._useUTC?vr:us).apply(null,r);n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);n._nextDay&&(n._a[a]=24)}}function ys(n){var t,e,u,r,i,f,s;t=n._w;t.GG!=null||t.W!=null||t.E!=null?(i=1,f=4,e=bt(t.GG,n._a[b],lt(o(),1,4).year),u=bt(t.W,1),r=bt(t.E,1)):(i=n._locale._week.dow,f=n._locale._week.doy,e=bt(t.gg,n._a[b],lt(o(),i,f).year),u=bt(t.w,1),t.d!=null?(r=t.d,r<i&&++u):r=t.e!=null?t.e+i:i);s=ls(e,u,r,f,i);n._a[b]=s.year;n._dayOfYear=s.dayOfYear}function wr(n){if(n._f===i.ISO_8601){rf(n);return}n._a=[];e(n).empty=!0;for(var t=""+n._i,r,u,s,c=t.length,h=0,o=pu(n._f,n._locale).match(yu)||[],f=0;f<o.length;f++)u=o[f],r=(t.match(vo(u,n))||[])[0],r&&(s=t.substr(0,t.indexOf(r)),s.length>0&&e(n).unusedInput.push(s),t=t.slice(t.indexOf(r)+r.length),h+=r.length),wt[u]?(r?e(n).empty=!1:e(n).unusedTokens.push(u),po(u,r,n)):n._strict&&!r&&e(n).unusedTokens.push(u);e(n).charsLeftOver=c-h;t.length>0&&e(n).unusedInput.push(t);e(n).bigHour===!0&&n._a[a]<=12&&n._a[a]>0&&(e(n).bigHour=undefined);n._a[a]=ps(n._locale,n._a[a],n._meridiem);pr(n);hr(n)}function ps(n,t,i){var r;return i==null?t:n.meridiemHour!=null?n.meridiemHour(t,i):n.isPM!=null?(r=n.isPM(i),r&&t<12&&(t+=12),r||t!==12||(t=0),t):t}function ws(n){var t,f,u,r,i;if(n._f.length===0){e(n).invalidFormat=!0;n._d=new Date(NaN);return}for(r=0;r<n._f.length;r++)(i=0,t=gi({},n),n._useUTC!=null&&(t._useUTC=n._useUTC),t._f=n._f[r],wr(t),uu(t))&&(i+=e(t).charsLeftOver,i+=e(t).unusedTokens.length*10,e(t).score=i,(u==null||i<u)&&(u=i,f=t));ei(n,f||t)}function bs(n){if(!n._d){var t=lu(n._i);n._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond];pr(n)}}function ks(n){var t=new dt(hr(of(n)));return t._nextDay&&(t.add(1,"d"),t._nextDay=undefined),t}function of(n){var t=n._i,i=n._f;return(n._locale=n._locale||ot(n._l),t===null||i===undefined&&t==="")?fu({nullInput:!0}):(typeof t=="string"&&(n._i=t=n._locale.preparse(t)),tt(t))?new dt(hr(t)):(ui(i)?ws(n):i?wr(n):fi(t)?n._d=t:ds(n),n)}function ds(n){var t=n._i;t===undefined?n._d=new Date:fi(t)?n._d=new Date(+t):typeof t=="string"?rs(n):ui(t)?(n._a=oo(t.slice(0),function(n){return parseInt(n,10)}),pr(n)):typeof t=="object"?bs(n):typeof t=="number"?n._d=new Date(t):i.createFromInputFallback(n)}function sf(n,t,i,r,u){var f={};return typeof i=="boolean"&&(r=i,i=undefined),f._isAMomentObject=!0,f._useUTC=f._isUTC=u,f._l=i,f._i=n,f._f=t,f._strict=r,ks(f)}function o(n,t,i,r){return sf(n,t,i,r,!1)}function lf(n,t){var r,i;if(t.length===1&&ui(t[0])&&(t=t[0]),!t.length)return o();for(r=t[0],i=1;i<t.length;++i)(!t[i].isValid()||t[i][n](r))&&(r=t[i]);return r}function gs(){var n=[].slice.call(arguments,0);return lf("isBefore",n)}function nh(){var n=[].slice.call(arguments,0);return lf("isAfter",n)}function pi(n){var t=lu(n),i=t.year||0,r=t.quarter||0,u=t.month||0,f=t.week||0,e=t.day||0,o=t.hour||0,s=t.minute||0,h=t.second||0,c=t.millisecond||0;this._milliseconds=+c+h*1e3+s*6e4+o*36e5;this._days=+e+f*7;this._months=+u+r*3+i*12;this._data={};this._locale=ot();this._bubble()}function br(n){return n instanceof pi}function af(n,t){r(n,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+tr(~~(n/60),2)+t+tr(~~n%60,2)})}function kr(n){var i=(n||"").match(yi)||[],u=i[i.length-1]||[],t=(u+"").match(vf)||["-",0,0],r=+(t[1]*60)+s(t[2]);return t[0]==="+"?r:-r}function dr(n,t){var r,u;return t._isUTC?(r=t.clone(),u=(tt(n)||fi(n)?+n:+o(n))-+r,r._d.setTime(+r._d+u),i.updateOffset(r,!1),r):o(n).local()}function gr(n){return-Math.round(n._d.getTimezoneOffset()/15)*15}function th(n,t){var r=this._offset||0,u;return n!=null?(typeof n=="string"&&(n=kr(n)),Math.abs(n)<16&&(n=n*60),!this._isUTC&&t&&(u=gr(this)),this._offset=n,this._isUTC=!0,u!=null&&this.add(u,"m"),r!==n&&(!t||this._changeInProgress?df(this,it(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,i.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:gr(this)}function ih(n,t){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,t),this):-this.utcOffset()}function rh(n){return this.utcOffset(0,n)}function uh(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(gr(this),"m")),this}function fh(){return this._tzm?this.utcOffset(this._tzm):typeof this._i=="string"&&this.utcOffset(kr(this._i)),this}function eh(n){return n=n?o(n).utcOffset():0,(this.utcOffset()-n)%60==0}function oh(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function sh(){var n,t;return typeof this._isDSTShifted!="undefined"?this._isDSTShifted:(n={},gi(n,this),n=of(n),n._a?(t=n._isUTC?kt(n._a):o(n._a),this._isDSTShifted=this.isValid()&&eu(n._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted)}function hh(){return!this._isUTC}function ch(){return this._isUTC}function yf(){return this._isUTC&&this._offset===0}function it(n,t){var i=n,r=null,u,f,e;return br(n)?i={ms:n._milliseconds,d:n._days,M:n._months}:typeof n=="number"?(i={},t?i[t]=n:i.milliseconds=n):(r=pf.exec(n))?(u=r[1]==="-"?-1:1,i={y:0,d:s(r[k])*u,h:s(r[a])*u,m:s(r[st])*u,s:s(r[ht])*u,ms:s(r[ct])*u}):(r=wf.exec(n))?(u=r[1]==="-"?-1:1,i={y:at(r[2],u),M:at(r[3],u),d:at(r[4],u),h:at(r[5],u),m:at(r[6],u),s:at(r[7],u),w:at(r[8],u)}):i==null?i={}:typeof i=="object"&&("from"in i||"to"in i)&&(e=lh(o(i.from),o(i.to)),i={},i.ms=e.milliseconds,i.M=e.months),f=new pi(i),br(n)&&ft(n,"_locale")&&(f._locale=n._locale),f}function at(n,t){var i=n&&parseFloat(n.replace(",","."));return(isNaN(i)?0:i)*t}function bf(n,t){var i={milliseconds:0,months:0};return i.months=t.month()-n.month()+(t.year()-n.year())*12,n.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+n.clone().add(i.months,"M"),i}function lh(n,t){var i;return t=dr(t,n),n.isBefore(t)?i=bf(n,t):(i=bf(t,n),i.milliseconds=-i.milliseconds,i.months=-i.months),i}function kf(n,t){return function(i,r){var u,f;return r===null||isNaN(+r)||(ns(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),f=i,i=r,r=f),i=typeof i=="string"?+i:i,u=it(i,r),df(this,u,n),this}}function df(n,t,r,u){var o=t._milliseconds,f=t._days,e=t._months;u=u==null?!0:u;o&&n._d.setTime(+n._d+o*r);f&&au(n,"Date",si(n,"Date")+f*r);e&&gu(n,si(n,"Month")+e*r);u&&i.updateOffset(n,f||e)}function ah(n,t){var r=n||o(),f=dr(r,this).startOf("day"),i=this.diff(f,"days",!0),u=i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse";return this.format(t&&t[u]||this.localeData().calendar(u,this,o(r)))}function vh(){return new dt(this)}function yh(n,t){var i;return t=p(typeof t!="undefined"?t:"millisecond"),t==="millisecond"?(n=tt(n)?n:o(n),+this>+n):(i=tt(n)?+n:+o(n),i<+this.clone().startOf(t))}function ph(n,t){var i;return t=p(typeof t!="undefined"?t:"millisecond"),t==="millisecond"?(n=tt(n)?n:o(n),+this<+n):(i=tt(n)?+n:+o(n),+this.clone().endOf(t)<i)}function wh(n,t,i){return this.isAfter(n,i)&&this.isBefore(t,i)}function bh(n,t){var i;return t=p(t||"millisecond"),t==="millisecond"?(n=tt(n)?n:o(n),+this==+n):(i=+o(n),+this.clone().startOf(t)<=i&&i<=+this.clone().endOf(t))}function kh(n,t,i){var f=dr(n,this),e=(f.utcOffset()-this.utcOffset())*6e4,u,r;return t=p(t),t==="year"||t==="month"||t==="quarter"?(r=dh(this,f),t==="quarter"?r=r/3:t==="year"&&(r=r/12)):(u=this-f,r=t==="second"?u/1e3:t==="minute"?u/6e4:t==="hour"?u/36e5:t==="day"?(u-e)/864e5:t==="week"?(u-e)/6048e5:u),i?r:v(r)}function dh(n,t){var r=(t.year()-n.year())*12+(t.month()-n.month()),i=n.clone().add(r,"months"),u,f;return t-i<0?(u=n.clone().add(r-1,"months"),f=(t-i)/(i-u)):(u=n.clone().add(r+1,"months"),f=(t-i)/(u-i)),-(r+f)}function gh(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function te(){var n=this.clone().utc();return 0<n.year()&&n.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():rr(n,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):rr(n,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function nc(n){var t=rr(this,n||i.defaultFormat);return this.localeData().postformat(t)}function tc(n,t){return this.isValid()?it({to:this,from:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ic(n){return this.from(o(),n)}function rc(n,t){return this.isValid()?it({from:this,to:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function uc(n){return this.to(o(),n)}function ie(n){var t;return n===undefined?this._locale._abbr:(t=ot(n),t!=null&&(this._locale=t),this)}function re(){return this._locale}function fc(n){n=p(n);switch(n){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return n==="week"&&this.weekday(0),n==="isoWeek"&&this.isoWeekday(1),n==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function ec(n){return(n=p(n),n===undefined||n==="millisecond")?this:this.startOf(n).add(1,n==="isoWeek"?"week":n).subtract(1,"ms")}function oc(){return+this._d-(this._offset||0)*6e4}function sc(){return Math.floor(+this/1e3)}function hc(){return this._offset?new Date(+this):this._d}function cc(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function lc(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function ac(){return uu(this)}function vc(){return ei({},e(this))}function yc(){return e(this).overflow}function wi(n,t){r(0,[n,n.length],0,t)}function ue(n,t,i){return lt(o([n,11,31+t-i]),t,i).week}function pc(n){var t=lt(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return n==null?t:this.add(n-t,"y")}function wc(n){var t=lt(this,1,4).year;return n==null?t:this.add(n-t,"y")}function bc(){return ue(this.year(),1,4)}function kc(){var n=this.localeData()._week;return ue(this.year(),n.dow,n.doy)}function dc(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}function gc(n,t){return typeof n!="string"?n:isNaN(n)?(n=t.weekdaysParse(n),typeof n=="number")?n:null:parseInt(n,10)}function nl(n){return this._weekdays[n.day()]}function tl(n){return this._weekdaysShort[n.day()]}function il(n){return this._weekdaysMin[n.day()]}function rl(n){var t,i,r;for(this._weekdaysParse=this._weekdaysParse||[],t=0;t<7;t++)if(this._weekdaysParse[t]||(i=o([2e3,1]).day(t),r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(n))return t}function ul(n){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=gc(n,this.localeData()),this.add(n-t,"d")):t}function fl(n){var t=(this.day()+7-this.localeData()._week.dow)%7;return n==null?t:this.add(n-t,"d")}function el(n){return n==null?this.day()||7:this.day(this.day()%7?n:n-7)}function se(n,t){r(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function he(n,t){return t._meridiemParse}function ol(n){return(n+"").toLowerCase().charAt(0)==="p"}function sl(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"}function hl(n,t){t[ct]=s(("0."+n)*1e3)}function cl(){return this._isUTC?"UTC":""}function ll(){return this._isUTC?"Coordinated Universal Time":""}function al(n){return o(n*1e3)}function vl(){return o.apply(null,arguments).parseZone()}function yl(n,t,i){var r=this._calendar[n];return typeof r=="function"?r.call(t,i):r}function pl(n){var t=this._longDateFormat[n],i=this._longDateFormat[n.toUpperCase()];return t||!i?t:(this._longDateFormat[n]=i.replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n])}function wl(){return this._invalidDate}function bl(n){return this._ordinal.replace("%d",n)}function no(n){return n}function kl(n,t,i,r){var u=this._relativeTime[i];return typeof u=="function"?u(n,t,i,r):u.replace(/%d/i,n)}function dl(n,t){var i=this._relativeTime[n>0?"future":"past"];return typeof i=="function"?i(t):i.replace(/%s/i,t)}function gl(n){var t;for(var i in n)t=n[i],typeof t=="function"?this[i]=t:this["_"+i]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function io(n,t,i,r){var u=ot(),f=kt().set(r,t);return u[i](f,n)}function ri(n,t,i,r,u){if(typeof n=="number"&&(t=n,n=undefined),n=n||"",t!=null)return io(n,t,i,u);for(var e=[],f=0;f<r;f++)e[f]=io(n,f,i,u);return e}function na(n,t){return ri(n,t,"months",12,"month")}function ta(n,t){return ri(n,t,"monthsShort",12,"month")}function ia(n,t){return ri(n,t,"weekdays",7,"day")}function ra(n,t){return ri(n,t,"weekdaysShort",7,"day")}function ua(n,t){return ri(n,t,"weekdaysMin",7,"day")}function fa(){var n=this._data;return this._milliseconds=d(this._milliseconds),this._days=d(this._days),this._months=d(this._months),n.milliseconds=d(n.milliseconds),n.seconds=d(n.seconds),n.minutes=d(n.minutes),n.hours=d(n.hours),n.months=d(n.months),n.years=d(n.years),this}function ro(n,t,i,r){var u=it(t,i);return n._milliseconds+=r*u._milliseconds,n._days+=r*u._days,n._months+=r*u._months,n._bubble()}function ea(n,t){return ro(this,n,t,1)}function oa(n,t){return ro(this,n,t,-1)}function uo(n){return n<0?Math.floor(n):Math.ceil(n)}function sa(){var r=this._milliseconds,n=this._days,t=this._months,i=this._data,u,f,e,s,o;return r>=0&&n>=0&&t>=0||r<=0&&n<=0&&t<=0||(r+=uo(iu(t)+n)*864e5,n=0,t=0),i.milliseconds=r%1e3,u=v(r/1e3),i.seconds=u%60,f=v(u/60),i.minutes=f%60,e=v(f/60),i.hours=e%24,n+=v(e/24),o=v(fo(n)),t+=o,n-=uo(iu(o)),s=v(t/12),t%=12,i.days=n,i.months=t,i.years=s,this}function fo(n){return n*4800/146097}function iu(n){return n*146097/4800}function ha(n){var t,r,i=this._milliseconds;if(n=p(n),n==="month"||n==="year")return t=this._days+i/864e5,r=this._months+fo(t),n==="month"?r:r/12;t=this._days+Math.round(iu(this._months));switch(n){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return t*24+i/36e5;case"minute":return t*1440+i/6e4;case"second":return t*86400+i/1e3;case"millisecond":return Math.floor(t*864e5)+i;default:throw new Error("Unknown unit "+n);}}function ca(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+s(this._months/12)*31536e6}function ut(n){return function(){return this.as(n)}}function da(n){return n=p(n),this[n+"s"]()}function vt(n){return function(){return this._data[n]}}function ev(){return v(this.days()/7)}function ov(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function sv(n,t,i){var r=it(n).abs(),h=yt(r.as("s")),f=yt(r.as("m")),e=yt(r.as("h")),o=yt(r.as("d")),s=yt(r.as("M")),c=yt(r.as("y")),u=h<nt.s&&["s",h]||f===1&&["m"]||f<nt.m&&["mm",f]||e===1&&["h"]||e<nt.h&&["hh",e]||o===1&&["d"]||o<nt.d&&["dd",o]||s===1&&["M"]||s<nt.M&&["MM",s]||c===1&&["y"]||["yy",c];return u[2]=t,u[3]=+n>0,u[4]=i,ov.apply(null,u)}function hv(n,t){return nt[n]===undefined?!1:t===undefined?nt[n]:(nt[n]=t,!0)}function cv(n){var t=this.localeData(),i=sv(this,!n,t);return n&&(i=t.pastFuture(+this,i)),t.postformat(i)}function ki(){var t=bi(this._milliseconds)/1e3,a=bi(this._days),i=bi(this._months),n,e,o;n=v(t/60);e=v(n/60);t%=60;n%=60;o=v(i/12);i%=12;var s=o,h=i,c=a,r=e,u=n,f=t,l=this.asSeconds();return l?(l<0?"-":"")+"P"+(s?s+"Y":"")+(h?h+"M":"")+(c?c+"D":"")+(r||u||f?"T":"")+(r?r+"H":"")+(u?u+"M":"")+(f?f+"S":""):"P0D"}var ru,di=i.momentProperties=[],nr=!1,et={},oi,ni={},yu=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,hi=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ir={},wt={},wu=/\d/,y=/\d\d/,bu=/\d{3}/,ur=/\d{4}/,ci=/[+-]?\d{6}/,h=/\d\d?/,li=/\d{1,3}/,fr=/\d{1,4}/,ai=/[+-]?\d{1,6}/,vi=/[+-]?\d+/,yi=/Z|[+-]\d\d:?\d\d/gi,ti=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,er={},or={},b=0,g=1,k=2,a=3,st=4,ht=5,ct=6,ku,du,cr,yr,ef,hf,cf,vf,pf,wf,gf,ne,nu,tu,fe,ee,oe,ce,le,ae,ve,rt,ye,n,pe,we,be,ke,de,ge,to,u,d,yt,nt,bi,f;r("M",["MM",2],"Mo",function(){return this.month()+1});r("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});r("MMMM",0,0,function(n){return this.localeData().months(this,n)});l("month","M");t("M",h);t("MM",h,y);t("MMM",ti);t("MMMM",ti);c(["M","MM"],function(n,t){t[g]=s(n)-1});c(["MMM","MMMM"],function(n,t,i,r){var u=i._locale.monthsParse(n,r,i._strict);u!=null?t[g]=u:e(i).invalidMonth=n});ku="January_February_March_April_May_June_July_August_September_October_November_December".split("_");du="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");cr={};i.suppressDeprecationWarnings=!1;var ts=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,lr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],ar=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],is=/^\/?Date\((\-?\d+)/i;for(i.createFromInputFallback=w("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))}),r(0,["YY",2],0,function(){return this.year()%100}),r(0,["YYYY",4],0,"year"),r(0,["YYYYY",5],0,"year"),r(0,["YYYYYY",6,!0],0,"year"),l("year","y"),t("Y",vi),t("YY",h,y),t("YYYY",fr,ur),t("YYYYY",ai,ci),t("YYYYYY",ai,ci),c(["YYYYY","YYYYYY"],b),c("YYYY",function(n,t){t[b]=n.length===2?i.parseTwoDigitYear(n):s(n)}),c("YY",function(n,t){t[b]=i.parseTwoDigitYear(n)}),i.parseTwoDigitYear=function(n){return s(n)+(s(n)>68?1900:2e3)},yr=pt("FullYear",!1),r("w",["ww",2],"wo","week"),r("W",["WW",2],"Wo","isoWeek"),l("week","w"),l("isoWeek","W"),t("w",h),t("ww",h,y),t("W",h),t("WW",h,y),ii(["w","ww","W","WW"],function(n,t,i,r){t[r.substr(0,1)]=s(n)}),ef={dow:0,doy:6},r("DDD",["DDDD",3],"DDDo","dayOfYear"),l("dayOfYear","DDD"),t("DDD",li),t("DDDD",bu),c(["DDD","DDDD"],function(n,t,i){i._dayOfYear=s(n)}),i.ISO_8601=function(){},hf=w("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var n=o.apply(null,arguments);return n<this?this:n}),cf=w("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var n=o.apply(null,arguments);return n>this?this:n}),af("Z",":"),af("ZZ",""),t("Z",yi),t("ZZ",yi),c(["Z","ZZ"],function(n,t,i){i._useUTC=!0;i._tzm=kr(n)}),vf=/([\+\-]|\d\d)/gi,i.updateOffset=function(){},pf=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,wf=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,it.fn=pi.prototype,gf=kf(1,"add"),ne=kf(-1,"subtract"),i.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",nu=w("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===undefined?this.localeData():this.locale(n)}),r(0,["gg",2],0,function(){return this.weekYear()%100}),r(0,["GG",2],0,function(){return this.isoWeekYear()%100}),wi("gggg","weekYear"),wi("ggggg","weekYear"),wi("GGGG","isoWeekYear"),wi("GGGGG","isoWeekYear"),l("weekYear","gg"),l("isoWeekYear","GG"),t("G",vi),t("g",vi),t("GG",h,y),t("gg",h,y),t("GGGG",fr,ur),t("gggg",fr,ur),t("GGGGG",ai,ci),t("ggggg",ai,ci),ii(["gggg","ggggg","GGGG","GGGGG"],function(n,t,i,r){t[r.substr(0,2)]=s(n)}),ii(["gg","GG"],function(n,t,r,u){t[u]=i.parseTwoDigitYear(n)}),r("Q",0,0,"quarter"),l("quarter","Q"),t("Q",wu),c("Q",function(n,t){t[g]=(s(n)-1)*3}),r("D",["DD",2],"Do","date"),l("date","D"),t("D",h),t("DD",h,y),t("Do",function(n,t){return n?t._ordinalParse:t._ordinalParseLenient}),c(["D","DD"],k),c("Do",function(n,t){t[k]=s(n.match(h)[0],10)}),tu=pt("Date",!0),r("d",0,"do","day"),r("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)}),r("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)}),r("dddd",0,0,function(n){return this.localeData().weekdays(this,n)}),r("e",0,0,"weekday"),r("E",0,0,"isoWeekday"),l("day","d"),l("weekday","e"),l("isoWeekday","E"),t("d",h),t("e",h),t("E",h),t("dd",ti),t("ddd",ti),t("dddd",ti),ii(["dd","ddd","dddd"],function(n,t,i){var r=i._locale.weekdaysParse(n);r!=null?t.d=r:e(i).invalidWeekday=n}),ii(["d","e","E"],function(n,t,i,r){t[r]=s(n)}),fe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ee="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),oe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),r("H",["HH",2],0,"hour"),r("h",["hh",2],0,function(){return this.hours()%12||12}),se("a",!0),se("A",!1),l("hour","h"),t("a",he),t("A",he),t("H",h),t("h",h),t("HH",h,y),t("hh",h,y),c(["H","HH"],a),c(["a","A"],function(n,t,i){i._isPm=i._locale.isPM(n);i._meridiem=n}),c(["h","hh"],function(n,t,i){t[a]=s(n);e(i).bigHour=!0}),ce=/[ap]\.?m?\.?/i,le=pt("Hours",!0),r("m",["mm",2],0,"minute"),l("minute","m"),t("m",h),t("mm",h,y),c(["m","mm"],st),ae=pt("Minutes",!1),r("s",["ss",2],0,"second"),l("second","s"),t("s",h),t("ss",h,y),c(["s","ss"],ht),ve=pt("Seconds",!1),r("S",0,0,function(){return~~(this.millisecond()/100)}),r(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),r(0,["SSS",3],0,"millisecond"),r(0,["SSSS",4],0,function(){return this.millisecond()*10}),r(0,["SSSSS",5],0,function(){return this.millisecond()*100}),r(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),r(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),r(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),r(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),l("millisecond","ms"),t("S",li,wu),t("SS",li,y),t("SSS",li,bu),rt="SSSS";rt.length<=9;rt+="S")t(rt,/\d+/);for(rt="S";rt.length<=9;rt+="S")c(rt,hl);ye=pt("Milliseconds",!1);r("z",0,0,"zoneAbbr");r("zz",0,0,"zoneName");n=dt.prototype;n.add=gf;n.calendar=ah;n.clone=vh;n.diff=kh;n.endOf=ec;n.format=nc;n.from=tc;n.fromNow=ic;n.to=rc;n.toNow=uc;n.get=vu;n.invalidAt=yc;n.isAfter=yh;n.isBefore=ph;n.isBetween=wh;n.isSame=bh;n.isValid=ac;n.lang=nu;n.locale=ie;n.localeData=re;n.max=cf;n.min=hf;n.parsingFlags=vc;n.set=vu;n.startOf=fc;n.subtract=ne;n.toArray=cc;n.toObject=lc;n.toDate=hc;n.toISOString=te;n.toJSON=te;n.toString=gh;n.unix=sc;n.valueOf=oc;n.year=yr;n.isLeapYear=fs;n.weekYear=pc;n.isoWeekYear=wc;n.quarter=n.quarters=dc;n.month=nf;n.daysInMonth=go;n.week=n.weeks=hs;n.isoWeek=n.isoWeeks=cs;n.weeksInYear=kc;n.isoWeeksInYear=bc;n.date=tu;n.day=n.days=ul;n.weekday=fl;n.isoWeekday=el;n.dayOfYear=as;n.hour=n.hours=le;n.minute=n.minutes=ae;n.second=n.seconds=ve;n.millisecond=n.milliseconds=ye;n.utcOffset=th;n.utc=rh;n.local=uh;n.parseZone=fh;n.hasAlignedHourOffset=eh;n.isDST=oh;n.isDSTShifted=sh;n.isLocal=hh;n.isUtcOffset=ch;n.isUtc=yf;n.isUTC=yf;n.zoneAbbr=cl;n.zoneName=ll;n.dates=w("dates accessor is deprecated. Use date instead.",tu);n.months=w("months accessor is deprecated. Use month instead",nf);n.years=w("years accessor is deprecated. Use year instead",yr);n.zone=w("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",ih);pe=n;we={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};be={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};ke="Invalid date";de="%d";ge=/\d{1,2}/;to={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};u=ou.prototype;u._calendar=we;u.calendar=yl;u._longDateFormat=be;u.longDateFormat=pl;u._invalidDate=ke;u.invalidDate=wl;u._ordinal=de;u.ordinal=bl;u._ordinalParse=ge;u.preparse=no;u.postformat=no;u._relativeTime=to;u.relativeTime=kl;u.pastFuture=dl;u.set=gl;u.months=wo;u._months=ku;u.monthsShort=bo;u._monthsShort=du;u.monthsParse=ko;u.week=es;u._week=ef;u.firstDayOfYear=ss;u.firstDayOfWeek=os;u.weekdays=nl;u._weekdays=fe;u.weekdaysMin=il;u._weekdaysMin=oe;u.weekdaysShort=tl;u._weekdaysShort=ee;u.weekdaysParse=rl;u.isPM=ol;u._meridiemParse=ce;u.meridiem=sl;gt("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var t=n%10,i=s(n%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return n+i}});i.lang=w("moment.lang is deprecated. Use moment.locale instead.",gt);i.langData=w("moment.langData is deprecated. Use moment.localeData instead.",ot);d=Math.abs;var la=ut("ms"),aa=ut("s"),va=ut("m"),ya=ut("h"),pa=ut("d"),wa=ut("w"),ba=ut("M"),ka=ut("y");var ga=vt("milliseconds"),nv=vt("seconds"),tv=vt("minutes"),iv=vt("hours"),rv=vt("days"),uv=vt("months"),fv=vt("years");return yt=Math.round,nt={s:45,m:45,h:22,d:26,M:11},bi=Math.abs,f=pi.prototype,f.abs=fa,f.add=ea,f.subtract=oa,f.as=ha,f.asMilliseconds=la,f.asSeconds=aa,f.asMinutes=va,f.asHours=ya,f.asDays=pa,f.asWeeks=wa,f.asMonths=ba,f.asYears=ka,f.valueOf=ca,f._bubble=sa,f.get=da,f.milliseconds=ga,f.seconds=nv,f.minutes=tv,f.hours=iv,f.days=rv,f.weeks=ev,f.months=uv,f.years=fv,f.humanize=cv,f.toISOString=ki,f.toString=ki,f.toJSON=ki,f.locale=ie,f.localeData=re,f.toIsoString=w("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ki),f.lang=nu,r("X",0,0,"unix"),r("x",0,0,"valueOf"),t("x",vi),t("X",/[+-]?\d+(\.\d{1,3})?/),c("X",function(n,t,i){i._d=new Date(parseFloat(n,10)*1e3)}),c("x",function(n,t,i){i._d=new Date(s(n))}),i.version="2.10.6",eo(o),i.fn=pe,i.min=gs,i.max=nh,i.utc=kt,i.unix=al,i.months=na,i.isDate=fi,i.locale=gt,i.invalid=fu,i.duration=it,i.isMoment=tt,i.weekdays=ia,i.parseZone=vl,i.localeData=ot,i.isDuration=br,i.monthsShort=ta,i.weekdaysMin=ua,i.defineLocale=cu,i.weekdaysShort=ra,i.normalizeUnits=p,i.relativeTimeThreshold=hv,i}),function(n){var t=typeof self=="object"&&self.self==self&&self||typeof global=="object"&&global.global==global&&global,i,r;if(typeof define=="function"&&define.amd)define(["underscore","jquery","exports"],function(i,r,u){t.Backbone=n(t,u,i,r)});else if(typeof exports!="undefined"){i=require("underscore");try{r=require("jquery")}catch(u){}n(t,exports,i,r)}else t.Backbone=n(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(n,t,i,r){var ot=n.Backbone,y=Array.prototype.slice,h,k,d,c,g,l,o,nt,it,ut,et,v,s;t.VERSION="1.2.3";t.$=r;t.noConflict=function(){return n.Backbone=ot,this};t.emulateHTTP=!1;t.emulateJSON=!1;var st=function(n,t,r){switch(n){case 1:return function(){return i[t](this[r])};case 2:return function(n){return i[t](this[r],n)};case 3:return function(n,u){return i[t](this[r],w(n,this),u)};case 4:return function(n,u,f){return i[t](this[r],w(n,this),u,f)};default:return function(){var n=y.call(arguments);return n.unshift(this[r]),i[t].apply(i,n)}}},p=function(n,t,r){i.each(t,function(t,u){i[u]&&(n.prototype[u]=st(t,u,r))})},w=function(n,t){return i.isFunction(n)?n:i.isObject(n)&&!t._isModel(n)?ht(n):i.isString(n)?function(t){return t.get(n)}:n},ht=function(n){var t=i.matches(n);return function(n){return t(n.attributes)}},u=t.Events={},b=/\s+/,e=function(n,t,r,u,f){var o=0,s;if(r&&typeof r=="object")for(u!==void 0&&("context"in f)&&f.context===void 0&&(f.context=u),s=i.keys(r);o<s.length;o++)t=e(n,t,s[o],r[s[o]],f);else if(r&&b.test(r))for(s=r.split(b);o<s.length;o++)t=n(t,s[o],u,f);else t=n(t,r,u,f);return t};u.on=function(n,t,i){return h(this,n,t,i)};h=function(n,t,i,r,u){if(n._events=e(k,n._events||{},t,i,{context:r,ctx:n,listening:u}),u){var f=n._listeners||(n._listeners={});f[u.id]=u}return n};u.listenTo=function(n,t,r){var o;if(!n)return this;var u=n._listenId||(n._listenId=i.uniqueId("l")),f=this._listeningTo||(this._listeningTo={}),e=f[u];return e||(o=this._listenId||(this._listenId=i.uniqueId("l")),e=f[u]={obj:n,objId:u,id:o,listeningTo:f,count:0}),h(n,t,r,this,e),this};k=function(n,t,i,r){if(i){var e=n[t]||(n[t]=[]),f=r.context,o=r.ctx,u=r.listening;u&&u.count++;e.push({callback:i,context:f,ctx:f||o,listening:u})}return n};u.off=function(n,t,i){return this._events?(this._events=e(d,this._events,n,t,{context:i,listeners:this._listeners}),this):this};u.stopListening=function(n,t,r){var u=this._listeningTo,e,f,o;if(!u)return this;for(e=n?[n._listenId]:i.keys(u),f=0;f<e.length;f++){if(o=u[e[f]],!o)break;o.obj.off(t,r,this)}return i.isEmpty(u)&&(this._listeningTo=void 0),this};d=function(n,t,r,u){var v,y,h,c,l,o;if(n){var e=0,f,a=u.context,s=u.listeners;if(!t&&!r&&!a){for(v=i.keys(s);e<v.length;e++)f=s[v[e]],delete s[f.id],delete f.listeningTo[f.objId];return}for(y=t?[t]:i.keys(n);e<y.length;e++){if(t=y[e],h=n[t],!h)break;for(c=[],l=0;l<h.length;l++)o=h[l],r&&r!==o.callback&&r!==o.callback._callback||a&&a!==o.context?c.push(o):(f=o.listening,f&&--f.count==0&&(delete s[f.id],delete f.listeningTo[f.objId]));c.length?n[t]=c:delete n[t]}if(i.size(n))return n}};u.once=function(n,t,r){var u=e(c,{},n,t,i.bind(this.off,this));return this.on(u,void 0,r)};u.listenToOnce=function(n,t,r){var u=e(c,{},t,r,i.bind(this.stopListening,this,n));return this.listenTo(n,u)};c=function(n,t,r,u){if(r){var f=n[t]=i.once(function(){u(t,f);r.apply(this,arguments)});f._callback=r}return n};u.trigger=function(n){var i,r,t;if(!this._events)return this;for(i=Math.max(0,arguments.length-1),r=Array(i),t=0;t<i;t++)r[t]=arguments[t+1];return e(g,this._events,n,void 0,r),this};g=function(n,t,i,r){if(n){var f=n[t],u=n.all;f&&u&&(u=u.slice());f&&l(f,r);u&&l(u,[t].concat(r))}return n};l=function(n,t){var i,r=-1,u=n.length,f=t[0],e=t[1],o=t[2];switch(t.length){case 0:while(++r<u)(i=n[r]).callback.call(i.ctx);return;case 1:while(++r<u)(i=n[r]).callback.call(i.ctx,f);return;case 2:while(++r<u)(i=n[r]).callback.call(i.ctx,f,e);return;case 3:while(++r<u)(i=n[r]).callback.call(i.ctx,f,e,o);return;default:while(++r<u)(i=n[r]).callback.apply(i.ctx,t);return}};u.bind=u.on;u.unbind=u.off;i.extend(t,u);o=t.Model=function(n,t){var r=n||{};t||(t={});this.cid=i.uniqueId(this.cidPrefix);this.attributes={};t.collection&&(this.collection=t.collection);t.parse&&(r=this.parse(r,t)||{});r=i.defaults({},r,i.result(this,"defaults"));this.set(r,t);this.changed={};this.initialize.apply(this,arguments)};i.extend(o.prototype,u,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(n){return this.attributes[n]},escape:function(n){return i.escape(this.get(n))},has:function(n){return this.get(n)!=null},matches:function(n){return!!i.iteratee(n,this)(this.attributes)},set:function(n,t,r){var f,u,o;if(n==null)return this;if(typeof n=="object"?(f=n,r=t):(f={})[n]=t,r||(r={}),!this._validate(f,r))return!1;var a=r.unset,h=r.silent,e=[],c=this._changing;this._changing=!0;c||(this._previousAttributes=i.clone(this.attributes),this.changed={});var s=this.attributes,l=this.changed,v=this._previousAttributes;for(u in f)t=f[u],i.isEqual(s[u],t)||e.push(u),i.isEqual(v[u],t)?delete l[u]:l[u]=t,a?delete s[u]:s[u]=t;if(this.id=this.get(this.idAttribute),!h)for(e.length&&(this._pending=r),o=0;o<e.length;o++)this.trigger("change:"+e[o],this,s[e[o]],r);if(c)return this;if(!h)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(n,t){return this.set(n,void 0,i.extend({},t,{unset:!0}))},clear:function(n){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,i.extend({},n,{unset:!0}))},hasChanged:function(n){return n==null?!i.isEmpty(this.changed):i.has(this.changed,n)},changedAttributes:function(n){var f,t,r,u;if(!n)return this.hasChanged()?i.clone(this.changed):!1;f=this._changing?this._previousAttributes:this.attributes;t={};for(r in n)(u=n[r],i.isEqual(f[r],u))||(t[r]=u);return i.size(t)?t:!1},previous:function(n){return n==null||!this._previousAttributes?null:this._previousAttributes[n]},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(n){n=i.extend({parse:!0},n);var t=this,r=n.success;return n.success=function(i){var u=n.parse?t.parse(i,n):i;if(!t.set(u,n))return!1;r&&r.call(n.context,t,i,n);t.trigger("sync",t,i,n)},s(this,n),this.sync("read",this,n)},save:function(n,t,r){var u,e,h,l;if(n==null||typeof n=="object"?(u=n,r=t):(u={})[n]=t,r=i.extend({validate:!0,parse:!0},r),e=r.wait,u&&!e){if(!this.set(u,r))return!1}else if(!this._validate(u,r))return!1;var f=this,c=r.success,o=this.attributes;return r.success=function(n){f.attributes=o;var t=r.parse?f.parse(n,r):n;if(e&&(t=i.extend({},u,t)),t&&!f.set(t,r))return!1;c&&c.call(r.context,f,n,r);f.trigger("sync",f,n,r)},s(this,r),u&&e&&(this.attributes=i.extend({},o,u)),h=this.isNew()?"create":r.patch?"patch":"update",h!=="patch"||r.attrs||(r.attrs=u),l=this.sync(h,this,r),this.attributes=o,l},destroy:function(n){var r;n=n?i.clone(n):{};var t=this,u=n.success,f=n.wait,e=function(){t.stopListening();t.trigger("destroy",t,t.collection,n)};return n.success=function(i){f&&e();u&&u.call(n.context,t,i,n);t.isNew()||t.trigger("sync",t,i,n)},r=!1,this.isNew()?i.defer(n.success):(s(this,n),r=this.sync("delete",this,n)),f||e(),r},url:function(){var n=i.result(this,"urlRoot")||i.result(this.collection,"url")||v(),t;return this.isNew()?n:(t=this.get(this.idAttribute),n.replace(/[^\/]$/,"$&/")+encodeURIComponent(t))},parse:function(n){return n},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(n){return this._validate({},i.defaults({validate:!0},n))},_validate:function(n,t){if(!t.validate||!this.validate)return!0;n=i.extend({},this.attributes,n);var r=this.validationError=this.validate(n,t)||null;return r?(this.trigger("invalid",this,r,i.extend(t,{validationError:r})),!1):!0}});nt={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};p(o,nt,"attributes");var a=t.Collection=function(n,t){t||(t={});t.model&&(this.model=t.model);t.comparator!==void 0&&(this.comparator=t.comparator);this._reset();this.initialize.apply(this,arguments);n&&this.reset(n,i.extend({silent:!0},t))},ct={add:!0,remove:!0,merge:!0},lt={add:!0,remove:!1},tt=function(n,t,i){var u,f,r;for(i=Math.min(Math.max(i,0),n.length),u=Array(n.length-i),f=t.length,r=0;r<u.length;r++)u[r]=n[r+i];for(r=0;r<f;r++)n[r+i]=t[r];for(r=0;r<u.length;r++)n[r+f+i]=u[r]};i.extend(a.prototype,u,{model:o,initialize:function(){},toJSON:function(n){return this.map(function(t){return t.toJSON(n)})},sync:function(){return t.sync.apply(this,arguments)},add:function(n,t){return this.set(n,i.extend({merge:!1},t,lt))},remove:function(n,t){var u,r;return t=i.extend({},t),u=!i.isArray(n),n=u?[n]:i.clone(n),r=this._removeModels(n,t),!t.silent&&r&&this.trigger("update",this,t),u?r[0]:r},set:function(n,t){var v,f,u,e,a,p,k;if(n!=null){t=i.defaults({},t,ct);t.parse&&!this._isModel(n)&&(n=this.parse(n,t));v=!i.isArray(n);n=v?[n]:n.slice();f=t.at;f!=null&&(f=+f);f<0&&(f+=this.length+1);var o=[],s=[],c=[],l={},w=t.add,d=t.merge,b=t.remove,h=!1,y=this.comparator&&f==null&&t.sort!==!1,g=i.isString(this.comparator)?this.comparator:null,r;for(u=0;u<n.length;u++)r=n[u],e=this.get(r),e?(d&&r!==e&&(a=this._isModel(r)?r.attributes:r,t.parse&&(a=e.parse(a,t)),e.set(a,t),y&&!h&&(h=e.hasChanged(g))),l[e.cid]||(l[e.cid]=!0,o.push(e)),n[u]=e):w&&(r=n[u]=this._prepareModel(r,t),r&&(s.push(r),this._addReference(r,t),l[r.cid]=!0,o.push(r)));if(b){for(u=0;u<this.length;u++)r=this.models[u],l[r.cid]||c.push(r);c.length&&this._removeModels(c,t)}if(p=!1,k=!y&&w&&b,o.length&&k?(p=this.length!=o.length||i.some(this.models,function(n,t){return n!==o[t]}),this.models.length=0,tt(this.models,o,0),this.length=this.models.length):s.length&&(y&&(h=!0),tt(this.models,s,f==null?this.length:f),this.length=this.models.length),h&&this.sort({silent:!0}),!t.silent){for(u=0;u<s.length;u++)f!=null&&(t.index=f+u),r=s[u],r.trigger("add",r,this,t);(h||p)&&this.trigger("sort",this,t);(s.length||c.length)&&this.trigger("update",this,t)}return v?n[0]:n}},reset:function(n,t){t=t?i.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),n=this.add(n,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),n},push:function(n,t){return this.add(n,i.extend({at:this.length},t))},pop:function(n){var t=this.at(this.length-1);return this.remove(t,n)},unshift:function(n,t){return this.add(n,i.extend({at:0},t))},shift:function(n){var t=this.at(0);return this.remove(t,n)},slice:function(){return y.apply(this.models,arguments)},get:function(n){if(n==null)return void 0;var t=this.modelId(this._isModel(n)?n.attributes:n);return this._byId[n]||this._byId[t]||this._byId[n.cid]},at:function(n){return n<0&&(n+=this.length),this.models[n]},where:function(n,t){return this[t?"find":"filter"](n)},findWhere:function(n){return this.where(n,!0)},sort:function(n){var t=this.comparator,r;if(!t)throw new Error("Cannot sort a set without a comparator");return n||(n={}),r=t.length,i.isFunction(t)&&(t=i.bind(t,this)),r===1||i.isString(t)?this.models=this.sortBy(t):this.models.sort(t),n.silent||this.trigger("sort",this,n),this},pluck:function(n){return i.invoke(this.models,"get",n)},fetch:function(n){n=i.extend({parse:!0},n);var r=n.success,t=this;return n.success=function(i){var u=n.reset?"reset":"set";t[u](i,n);r&&r.call(n.context,t,i,n);t.trigger("sync",t,i,n)},s(this,n),this.sync("read",this,n)},create:function(n,t){var r,f,u;return(t=t?i.clone(t):{},r=t.wait,n=this._prepareModel(n,t),!n)?!1:(r||this.add(n,t),f=this,u=t.success,t.success=function(n,t,i){r&&f.add(n,i);u&&u.call(i.context,n,t,i)},n.save(null,t),n)},parse:function(n){return n},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(n){return n[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(n,t){if(this._isModel(n))return n.collection||(n.collection=this),n;t=t?i.clone(t):{};t.collection=this;var r=new this.model(n,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(n,t){for(var i,f,r=[],u=0;u<n.length;u++)(i=this.get(n[u]),i)&&(f=this.indexOf(i),this.models.splice(f,1),this.length--,t.silent||(t.index=f,i.trigger("remove",i,this,t)),r.push(i),this._removeReference(i,t));return r.length?r:!1},_isModel:function(n){return n instanceof o},_addReference:function(n){this._byId[n.cid]=n;var t=this.modelId(n.attributes);t!=null&&(this._byId[t]=n);n.on("all",this._onModelEvent,this)},_removeReference:function(n){delete this._byId[n.cid];var t=this.modelId(n.attributes);t!=null&&delete this._byId[t];this===n.collection&&delete n.collection;n.off("all",this._onModelEvent,this)},_onModelEvent:function(n,t,i,r){if(n!=="add"&&n!=="remove"||i===this){if(n==="destroy"&&this.remove(t,r),n==="change"){var u=this.modelId(t.previousAttributes()),f=this.modelId(t.attributes);u!==f&&(u!=null&&delete this._byId[u],f!=null&&(this._byId[f]=t))}this.trigger.apply(this,arguments)}}});it={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};p(a,it,"models");var rt=t.View=function(n){this.cid=i.uniqueId("view");i.extend(this,i.pick(n,vt));this._ensureElement();this.initialize.apply(this,arguments)},at=/^(\S+)\s*(.*)$/,vt=["model","collection","el","id","attributes","className","tagName","events"];i.extend(rt.prototype,u,{tagName:"div",$:function(n){return this.$el.find(n)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(n){return this.undelegateEvents(),this._setElement(n),this.delegateEvents(),this},_setElement:function(n){this.$el=n instanceof t.$?n:t.$(n);this.el=this.$el[0]},delegateEvents:function(n){var r,t,u;if(n||(n=i.result(this,"events")),!n)return this;this.undelegateEvents();for(r in n)(t=n[r],i.isFunction(t)||(t=this[t]),t)&&(u=r.match(at),this.delegate(u[1],u[2],i.bind(t,this)));return this},delegate:function(n,t,i){this.$el.on(n+".delegateEvents"+this.cid,t,i);return this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(n,t,i){return this.$el.off(n+".delegateEvents"+this.cid,t,i),this},_createElement:function(n){return document.createElement(n)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var n=i.extend({},i.result(this,"attributes"));this.id&&(n.id=i.result(this,"id"));this.className&&(n["class"]=i.result(this,"className"));this.setElement(this._createElement(i.result(this,"tagName")));this._setAttributes(n)}},_setAttributes:function(n){this.$el.attr(n)}});t.sync=function(n,r,u){var e=ut[n],f,o,s,h;return i.defaults(u||(u={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON}),f={type:e,dataType:"json"},u.url||(f.url=i.result(r,"url")||v()),u.data==null&&r&&(n==="create"||n==="update"||n==="patch"||n==="delete")&&(f.contentType="application/json",f.data=JSON.stringify(u.attrs||r.toJSON(u))),u.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{}),u.emulateHTTP&&(e==="PUT"||e==="DELETE"||e==="PATCH")&&(f.type="POST",u.emulateJSON&&(f.data._method=e),o=u.beforeSend,u.beforeSend=function(n){return n.setRequestHeader("X-HTTP-Method-Override",e),o?o.apply(this,arguments):void 0}),f.type==="GET"||u.emulateJSON||(f.processData=!1),s=u.error,u.error=function(n,t,i){u.textStatus=t;u.errorThrown=i;s&&s.call(u.context,n,t,i)},h=u.xhr=t.ajax(i.extend(f,u)),r.trigger("request",r,h,u),h};ut={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var ft=t.Router=function(n){n||(n={});n.routes&&(this.routes=n.routes);this._bindRoutes();this.initialize.apply(this,arguments)},yt=/\((.*?)\)/g,pt=/(\(\?)?:\w+/g,wt=/\*\w+/g,bt=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(ft.prototype,u,{initialize:function(){},route:function(n,r,u){i.isRegExp(n)||(n=this._routeToRegExp(n));i.isFunction(r)&&(u=r,r="");u||(u=this[r]);var f=this;return t.history.route(n,function(i){var e=f._extractParameters(n,i);f.execute(u,e,r)!==!1&&(f.trigger.apply(f,["route:"+r].concat(e)),f.trigger("route",r,e),t.history.trigger("route",f,r,e))}),this},execute:function(n,t){n&&n.apply(this,t)},navigate:function(n,i){return t.history.navigate(n,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var n,t=i.keys(this.routes);(n=t.pop())!=null;)this.route(n,this.routes[n])}},_routeToRegExp:function(n){return n=n.replace(bt,"\\$&").replace(yt,"(?:$1)?").replace(pt,function(n,t){return t?n:"([^/?]+)"}).replace(wt,"([^?]*?)"),new RegExp("^"+n+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(n,t){var r=n.exec(t).slice(1);return i.map(r,function(n,t){return t===r.length-1?n||null:n?decodeURIComponent(n):null})}});var f=t.History=function(){this.handlers=[];this.checkUrl=i.bind(this.checkUrl,this);typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},kt=/^[#\/]|\s+$/g,dt=/^\/+|\/+$/g,gt=/#.*$/;return f.started=!1,i.extend(f.prototype,u,{interval:50,atRoot:function(){var n=this.location.pathname.replace(/[^\/]$/,"$&/");return n===this.root&&!this.getSearch()},matchRoot:function(){var n=this.decodeFragment(this.location.pathname),t=n.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(n){return decodeURI(n.replace(/%25/g,"%2525"))},getSearch:function(){var n=this.location.href.replace(/#.*/,"").match(/\?.+/);return n?n[0]:""},getHash:function(n){var t=(n||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var n=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return n.charAt(0)==="/"?n.slice(1):n},getFragment:function(n){return n==null&&(n=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),n.replace(kt,"")},start:function(n){var e,r,t,u;if(f.started)throw new Error("Backbone.history has already been started");if(f.started=!0,this.options=i.extend({root:"/"},this.options,n),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.history&&this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(dt,"/"),this._wantsHashChange&&this._wantsPushState)if(this._hasPushState||this.atRoot())this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0});else return e=this.root.slice(0,-1)||"/",this.location.replace(e+"#"+this.getPath()),!0;return this._hasHashChange||!this._wantsHashChange||this._usePushState||(this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1,r=document.body,t=r.insertBefore(this.iframe,r.firstChild).contentWindow,t.document.open(),t.document.close(),t.location.hash="#"+this.fragment),u=window.addEventListener||function(n,t){return attachEvent("on"+n,t)},this._usePushState?u("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?u("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var n=window.removeEventListener||function(n,t){return detachEvent("on"+n,t)};this._usePushState?n("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&n("hashchange",this.checkUrl,!1);this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null);this._checkUrlInterval&&clearInterval(this._checkUrlInterval);f.started=!1},route:function(n,t){this.handlers.unshift({route:n,callback:t})},checkUrl:function(){var n=this.getFragment();if(n===this.fragment&&this.iframe&&(n=this.getHash(this.iframe.contentWindow)),n===this.fragment)return!1;this.iframe&&this.navigate(n);this.loadUrl()},loadUrl:function(n){return this.matchRoot()?(n=this.fragment=this.getFragment(n),i.some(this.handlers,function(t){if(t.route.test(n))return t.callback(n),!0})):!1},navigate:function(n,t){var i,u,r;if(!f.started)return!1;if(t&&t!==!0||(t={trigger:!!t}),n=this.getFragment(n||""),i=this.root,(n===""||n.charAt(0)==="?")&&(i=i.slice(0,-1)||"/"),u=i+n,n=this.decodeFragment(n.replace(gt,"")),this.fragment!==n){if(this.fragment=n,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,u);else if(this._wantsHashChange)this._updateHash(this.location,n,t.replace),this.iframe&&n!==this.getHash(this.iframe.contentWindow)&&(r=this.iframe.contentWindow,t.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,n,t.replace));else return this.location.assign(u);if(t.trigger)return this.loadUrl(n)}},_updateHash:function(n,t,i){if(i){var r=n.href.replace(/(javascript:|#).*$/,"");n.replace(r+"#"+t)}else n.hash="#"+t}}),t.history=new f,et=function(n,t){var u=this,r,f;return r=n&&i.has(n,"constructor")?n.constructor:function(){return u.apply(this,arguments)},i.extend(r,u,t),f=function(){this.constructor=r},f.prototype=u.prototype,r.prototype=new f,n&&i.extend(r.prototype,n),r.__super__=u.prototype,r},o.extend=a.extend=ft.extend=rt.extend=f.extend=et,v=function(){throw new Error('A "url" property or function must be specified');},s=function(n,t){var i=t.error;t.error=function(r){i&&i.call(t.context,n,r,t);n.trigger("error",n,r,t)}},t});
/*
  backbone.paginator 2.0.0
  http://github.com/backbone-paginator/backbone.paginator
  Copyright (c) 2013 Jimmy Yuen Ho Wong and contributors
  Licensed under the MIT @license.
*/
(function(n){if(typeof exports=="object"&&typeof require=="function")module.exports=n(require("underscore"),require("backbone"));else if(typeof define=="function"&&define.amd)define(["underscore","backbone"],n);else if(typeof _!="undefined"&&typeof Backbone!="undefined"){var t=Backbone.PageableCollection,i=n(_,Backbone);Backbone.PageableCollection.noConflict=function(){return Backbone.PageableCollection=t,i}}})(function(n,t){"use strict";function e(t,i){if(!n.isNumber(t)||n.isNaN(t)||!n.isFinite(t)||~~t!==t)throw new TypeError("`"+i+"` must be a finite integer");return t}function ut(n){for(var c,u,i,t,r,f={},o=decodeURIComponent,h=n.split("&"),e=0,l=h.length;e<l;e++)c=h[e],u=c.split("="),i=u[0],t=u[1]||!0,i=o(i),t=o(t),r=f[i],s(r)?r.push(t):f[i]=r?[r,t]:t;return f}function b(n,t,i){var r=n._events[t],u,f;r&&r.length?(u=r[r.length-1],f=u.callback,u.callback=function(){try{f.apply(this,arguments);i()}catch(n){throw n;}finally{u.callback=f}}):i()}var i=n.extend,u=n.omit,f=n.clone,r=n.each,k=n.pick,d=n.contains,y=n.isEmpty,p=n.pairs,rt=n.invert,s=n.isArray,l=n.isFunction,g=n.isObject,h=n.keys,c=n.isUndefined,a=Math.ceil,nt=Math.floor,w=Math.max,v=t.Collection.prototype,tt=/[\s'"]/g,ft=/[<>\s'"]/g,it=t.PageableCollection=t.Collection.extend({state:{firstPage:1,lastPage:null,currentPage:null,pageSize:1,totalPages:null,totalRecords:null,sortKey:null,order:-1},mode:"client",queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc","1":"desc"}},constructor:function(n,t){var u,e,r,h,c;v.constructor.apply(this,arguments);t=t||{};u=this.mode=t.mode||this.mode||o.mode;e=i({},o.queryParams,this.queryParams,t.queryParams||{});e.directions=i({},o.queryParams.directions,this.queryParams.directions,e.directions||{});this.queryParams=e;r=this.state=i({},o.state,this.state,t.state||{});r.currentPage=r.currentPage==null?r.firstPage:r.currentPage;s(n)||(n=n?[n]:[]);n=n.slice();u=="server"||r.totalRecords!=null||y(n)||(r.totalRecords=n.length);this.switchMode(u,i({fetch:!1,resetState:!1,models:n},t));h=t.comparator;r.sortKey&&!h&&this.setSorting(r.sortKey,r.order,t);u!="server"&&(c=this.fullCollection,h&&t.full&&(this.comparator=null,c.comparator=h),t.full&&c.sort(),n&&!y(n)&&(this.reset(n,i({silent:!0},t)),this.getPage(r.currentPage),n.splice.apply(n,[0,n.length].concat(this.models))));this._initState=f(this.state)},_makeFullCollection:function(n,i){for(var f=["url","model","sync","comparator"],o=this.constructor.prototype,r,h={},s,u=0,e=f.length;u<e;u++)r=f[u],c(o[r])||(h[r]=o[r]);for(s=new(t.Collection.extend(h))(n,i),u=0,e=f.length;u<e;u++)r=f[u],this[r]!==o[r]&&(s[r]=this[r]);return s},_makeCollectionEventHandler:function(n,t){return function(u,e,o,s){var k=n._handlers,d,w,nt,s,g,ut,tt,it,ft,et,ot;r(h(k),function(i){var r=k[i];n.off(i,r);t.off(i,r)});var l=f(n.state),rt=l.firstPage,st=rt===0?l.currentPage:l.currentPage-1,y=l.pageSize,v=st*y,p=v+y;u=="add"&&(s=s||{},o==t?(w=t.indexOf(e),w>=v&&w<p&&(nt=n,d=g=w-v)):(d=n.indexOf(e),w=v+d,nt=t,g=c(s.at)?w:s.at+v),s.onRemove||(++l.totalRecords,delete s.onRemove),n.state=n._checkState(l),nt&&(nt.add(e,i({},s||{},{at:g})),ut=d>=y?e:!c(s.at)&&g<p&&n.length>y?n.at(y):null,ut&&b(o,u,function(){n.remove(ut,{onAdd:!0})})));u=="remove"&&(s.onAdd?delete s.onAdd:(--l.totalRecords?(tt=l.totalPages=a(l.totalRecords/y),l.lastPage=rt===0?tt-1:tt||rt,l.currentPage>tt&&(l.currentPage=l.lastPage)):(l.totalRecords=null,l.totalPages=null),n.state=n._checkState(l),ft=s.index,o==n?((it=t.at(p))?b(n,u,function(){n.push(it,{onRemove:!0})}):!n.length&&l.totalRecords&&n.reset(t.models.slice(v-y,p-y),i({},s,{parse:!1})),t.remove(e)):ft>=v&&ft<p&&((it=t.at(p-1))&&b(n,u,function(){n.push(it,{onRemove:!0})}),n.remove(e),!n.length&&l.totalRecords&&n.reset(t.models.slice(v-y,p-y),i({},s,{parse:!1})))));u=="reset"&&(s=o,o=e,o==n&&s.from==null&&s.to==null?(et=t.models.slice(0,v),ot=t.models.slice(v+n.models.length),t.reset(et.concat(n.models).concat(ot),s)):o==t&&((l.totalRecords=t.models.length)||(l.totalRecords=null,l.totalPages=null),n.mode=="client"&&(l.lastPage=l.currentPage=l.firstPage),n.state=n._checkState(l),n.reset(t.models.slice(v,p),i({},s,{parse:!1}))));u=="sort"&&(s=o,o=e,o===t&&n.reset(t.models.slice(v,p),i({},s,{parse:!1})));r(h(k),function(i){var u=k[i];r([n,t],function(n){n.on(i,u);var t=n._events[i]||[];t.unshift(t.pop())})})}},_checkState:function(n){var o=this.mode,s=this.links,f=n.totalRecords,u=n.pageSize,i=n.currentPage,t=n.firstPage,r=n.totalPages;if(f!=null&&u!=null&&i!=null&&t!=null&&(o=="infinite"?s:!0)){if(f=e(f,"totalRecords"),u=e(u,"pageSize"),i=e(i,"currentPage"),t=e(t,"firstPage"),u<1)throw new RangeError("`pageSize` must be >= 1");if(r=n.totalPages=a(f/u),t<0||t>1)throw new RangeError("`firstPage must be 0 or 1`");if(n.lastPage=t===0?w(0,r-1):r||t,o=="infinite"){if(!s[i+""])throw new RangeError("No link found for page "+i);}else if(i<t||r>0&&(t?i>r:i>=r))throw new RangeError("`currentPage` must be firstPage <= currentPage "+(t?"<":"<=")+" totalPages if "+t+"-based. Got "+i+".");}return n},setPageSize:function(n,t){n=e(n,"pageSize");t=t||{first:!1};var r=this.state,f=a(r.totalRecords/n),o=f?w(r.firstPage,nt(f*r.currentPage/r.totalPages)):r.firstPage;return r=this.state=this._checkState(i({},r,{pageSize:n,currentPage:t.first?r.firstPage:o,totalPages:f})),this.getPage(r.currentPage,u(t,["first"]))},switchMode:function(t,e){var c,p,l;if(!d(["server","client","infinite"],t))throw new TypeError('`mode` must be one of "server", "client" or "infinite"');e=e||{fetch:!0,resetState:!0};c=this.state=e.resetState?f(this._initState):this._checkState(i({},this.state));this.mode=t;var y=this,o=this.fullCollection,v=this._handlers=this._handlers||{},s;if(t=="server"||o?t=="server"&&o&&(r(h(v),function(n){s=v[n];y.off(n,s);o.off(n,s)}),delete this._handlers,this._fullComparator=o.comparator,delete this.fullCollection):(o=this._makeFullCollection(e.models||[],e),o.pageableCollection=this,this.fullCollection=o,p=this._makeCollectionEventHandler(this,o),r(["add","remove","reset","sort"],function(t){v[t]=s=n.bind(p,{},t);y.on(t,s);o.on(t,s)}),o.comparator=this._fullComparator),t=="infinite"){var g=this.links={},b=c.firstPage,k=a(c.totalRecords/c.pageSize),nt=b===0?w(0,k-1):k||b;for(l=c.firstPage;l<=nt;l++)g[l]=this.url}else this.links&&delete this.links;return e.fetch?this.fetch(u(e,"fetch","resetState")):this},hasPreviousPage:function(){var n=this.state,t=n.currentPage;return this.mode!="infinite"?t>n.firstPage:!!this.links[t-1]},hasNextPage:function(){var t=this.state,n=this.state.currentPage;return this.mode!="infinite"?n<t.lastPage:!!this.links[n+1]},getFirstPage:function(n){return this.getPage("first",n)},getPreviousPage:function(n){return this.getPage("prev",n)},getNextPage:function(n){return this.getPage("next",n)},getLastPage:function(n){return this.getPage("last",n)},getPage:function(n,t){var o=this.mode,s=this.fullCollection,c,l;t=t||{fetch:!1};var f=this.state,a=f.firstPage,h=f.currentPage,p=f.lastPage,v=f.pageSize,r=n;switch(n){case"first":r=a;break;case"prev":r=h-1;break;case"next":r=h+1;break;case"last":r=p;break;default:r=e(n,"index")}return(this.state=this._checkState(i({},f,{currentPage:r})),t.from=h,t.to=r,c=(a===0?r:r-1)*v,l=s&&s.length?s.models.slice(c,c+v):[],(o=="client"||o=="infinite"&&!y(l))&&!t.fetch)?(this.reset(l,u(t,"fetch")),this):(o=="infinite"&&(t.url=this.links[r]),this.fetch(u(t,"fetch")))},getPageByOffset:function(n,t){if(n<0)throw new RangeError("`offset must be > 0`");n=e(n);var i=nt(n/this.state.pageSize);return this.state.firstPage!==0&&i++,i>this.state.lastPage&&(i=this.state.lastPage),this.getPage(i,t)},sync:function(n,r,u){var f=this,e,o;return f.mode=="infinite"&&(e=u.success,o=f.state.currentPage,u.success=function(n,t,r){var h=f.links,s=f.parseLinks(n,i({xhr:r},u));s.first&&(h[f.state.firstPage]=s.first);s.prev&&(h[o-1]=s.prev);s.next&&(h[o+1]=s.next);e&&e(n,t,r)}),(v.sync||t.sync).call(f,n,r,u)},parseLinks:function(n,t){var i={},u=t.xhr.getResponseHeader("Link"),f;return u&&(f=["first","prev","next"],r(u.split(","),function(n){var t=n.split(";"),u=t[0].replace(ft,""),e=t.slice(1);r(e,function(n){var t=n.split("="),e=t[0].replace(tt,""),r=t[1].replace(tt,"");e=="rel"&&d(f,r)&&(i[r]=u)})})),i},parse:function(n,t){var r=this.parseState(n,f(this.queryParams),f(this.state),t);return r&&(this.state=this._checkState(i({},this.state,r))),this.parseRecords(n,t)},parseState:function(t,i,e){if(t&&t.length===2&&g(t[0])&&s(t[1])){var h=f(e),o=t[0];return r(p(u(i,"directions")),function(t){var u=t[0],i=t[1],r=o[i];c(r)||n.isNull(r)||(h[u]=o[i])}),o.order&&(h.order=rt(i.directions)[o.order]*1),h}},parseRecords:function(n){return n&&n.length===2&&g(n[0])&&s(n[1])?n[1]:n},fetch:function(n){var e,d,a,y,g,nt,rt;n=n||{};e=this._checkState(this.state);d=this.mode;d!="infinite"||n.url||(n.url=this.links[e.currentPage]);a=n.data||{};y=n.url||this.url||"";l(y)&&(y=y.call(this));g=y.indexOf("?");g!=-1&&(i(a,ut(y.slice(g+1))),y=y.slice(0,g));n.url=y;n.data=a;for(var b=this.mode=="client"?k(this.queryParams,"sortKey","order"):u(k(this.queryParams,h(o.queryParams)),"directions"),w,tt,t,et=p(b),it=f(this),r=0;r<et.length;r++)w=et[r],tt=w[0],t=w[1],t=l(t)?t.call(it):t,e[tt]!=null&&t!=null&&(a[t]=e[tt]);if(e.sortKey&&e.order)if(nt=l(b.order)?b.order.call(it):b.order,s(e.order))for(a[nt]=[],r=0;r<e.order.length;r+=1)a[nt].push(this.queryParams.directions[e.order[r]]);else a[nt]=this.queryParams.directions[e.order+""];else e.sortKey||delete a[b.order];for(rt=p(u(this.queryParams,h(o.queryParams))),r=0;r<rt.length;r++)w=rt[r],t=w[1],t=l(t)?t.call(it):t,t!=null&&(a[w[0]]=t);if(d!="server"){var ot=this,ft=this.fullCollection,st=n.success;return n.success=function(t,r,u){u=u||{};c(n.silent)?delete u.silent:u.silent=n.silent;var f=t.models;d=="client"?ft.reset(f,u):(ft.add(f,i({at:ft.length},i(u,{parse:!1}))),ot.trigger("reset",ot,u));st&&st(t,r,u)},v.fetch.call(this,i({},n,{silent:!0}))}return v.fetch.call(this,n)},_makeComparator:function(n,t,i){var r=this.state;if(n=n||r.sortKey,t=t||r.order,n&&t)return i||(i=function(n,t){return n.get(t)}),function(r,u){var f=i(r,n),e=i(u,n),o;return(t===1&&(o=f,f=e,e=o),f===e)?0:f<e?-1:1}},setSorting:function(n,t,r){var f=this.state,s;f.sortKey=n;f.order=t=t||f.order;var u=this.fullCollection,e=!1,o=!1;n||(e=o=!0);s=this.mode;r=i({side:s=="client"?s:"server",full:!0},r);var h=this._makeComparator(n,t,r.sortValue),c=r.full,l=r.side;return l=="client"?c?(u&&(u.comparator=h),e=!0):(this.comparator=h,o=!0):l!="server"||c||(this.comparator=h),e&&(this.comparator=null),o&&u&&(u.comparator=null),this}}),o=it.prototype;return it});
/*!
  backgrid 0.3.5
  http://github.com/wyuenho/backgrid
  Copyright (c) 2014 Jimmy Yuen Ho Wong and contributors <wyuenho@gmail.com>
  Licensed under the MIT license.
*/
(function(n,t){typeof define=="function"&&define.amd?define(["underscore","backbone"],function(i,r){return n.Backgrid=t(i,r)}):typeof exports=="object"?module.exports=t(require("underscore"),require("backbone")):n.Backgrid=t(n._,n.Backbone)})(this,function(n,t){"use strict";function r(n,t,i){var r=t-(n+"").length,u,f;for(r=r<0?0:r,u="",f=0;f<r;f++)u=u+i;return u+n}var s="\t\n\x0b\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",g,nt,l,i,f,e,u,a,h,v,y,p;(!String.prototype.trim||s.trim())&&(s="["+s+"]",g=new RegExp("^"+s+s+"*"),nt=new RegExp(s+s+"*$"),String.prototype.trim=function(){if(this===undefined||this===null)throw new TypeError("can't convert "+this+" to object");return String(this).replace(g,"").replace(nt,"")});l=t.$;i={Extension:{},resolveNameToClass:function(t,r){if(n.isString(t)){var u=n.map(t.split("-"),function(n){return n.slice(0,1).toUpperCase()+n.slice(1)}).join("")+r,f=i[u]||i.Extension[u];if(n.isUndefined(f))throw new ReferenceError("Class '"+u+"' not found");return f}return t},callByNeed:function(){var t=arguments[0],r,i;return n.isFunction(t)?(r=arguments[1],i=[].slice.call(arguments,2),t.apply(r,!(i+"")?[]:i)):t}};n.extend(i,t.Events);f=i.Command=function(t){n.extend(this,{altKey:!!t.altKey,char:t.char,charCode:t.charCode,ctrlKey:!!t.ctrlKey,key:t.key,keyCode:t.keyCode,locale:t.locale,location:t.location,metaKey:!!t.metaKey,repeat:!!t.repeat,shiftKey:!!t.shiftKey,which:t.which})};n.extend(f.prototype,{moveUp:function(){return this.keyCode==38},moveDown:function(){return this.keyCode===40},moveLeft:function(){return this.shiftKey&&this.keyCode===9},moveRight:function(){return!this.shiftKey&&this.keyCode===9},save:function(){return this.keyCode===13},cancel:function(){return this.keyCode===27},passThru:function(){return!(this.moveUp()||this.moveDown()||this.moveLeft()||this.moveRight()||this.save()||this.cancel())}});e=i.CellFormatter=function(){};n.extend(e.prototype,{fromRaw:function(n){return n},toRaw:function(n){return n}});u=i.NumberFormatter=function(t){if(n.extend(this,this.defaults,t||{}),this.decimals<0||this.decimals>20)throw new RangeError("decimals must be between 0 and 20");};u.prototype=new e;n.extend(u.prototype,{defaults:{decimals:4,decimalSeparator:".",orderSeparator:","},HUMANIZED_NUM_RE:/(\d)(?=(?:\d{3})+$)/g,fromRaw:function(t){if(n.isNull(t)||n.isUndefined(t))return"";t=t.toFixed(~~this.decimals);var i=t.split("."),r=i[0],u=i[1]?(this.decimalSeparator||".")+i[1]:"";return r.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+u},toRaw:function(t){var i,f,e,r,u;if(t=t.trim(),t==="")return null;for(i="",f=t.split(this.orderSeparator),r=0;r<f.length;r++)i+=f[r];for(e=i.split(this.decimalSeparator),i="",r=0;r<e.length;r++)i=i+e[r]+".";return i[i.length-1]==="."&&(i=i.slice(0,i.length-1)),u=(i*1).toFixed(~~this.decimals)*1,n.isNumber(u)&&!n.isNaN(u)?u:void 0}});a=i.PercentFormatter=function(){i.NumberFormatter.apply(this,arguments)};a.prototype=new i.NumberFormatter;n.extend(a.prototype,{defaults:n.extend({},u.prototype.defaults,{multiplier:1,symbol:"%"}),fromRaw:function(n){var t=[].slice.call(arguments,1);return t.unshift(n*this.multiplier),(u.prototype.fromRaw.apply(this,t)||"0")+this.symbol},toRaw:function(t){var i=t.split(this.symbol),r;if(i&&i[0]&&i[1]===""||i[1]==null)return(r=u.prototype.toRaw.call(this,i[0]),n.isUndefined(r))?r:r/this.multiplier}});h=i.DatetimeFormatter=function(t){if(n.extend(this,this.defaults,t||{}),!this.includeDate&&!this.includeTime)throw new Error("Either includeDate or includeTime must be true");};h.prototype=new e;n.extend(h.prototype,{defaults:{includeDate:!0,includeTime:!0,includeMilli:!1},DATE_RE:/^([+\-]?\d{4})-(\d{2})-(\d{2})$/,TIME_RE:/^(\d{2}):(\d{2}):(\d{2})(\.(\d{3}))?$/,ISO_SPLITTER_RE:/T|Z| +/,_convert:function(t,i){var s,h,e,c,o,u,f;if((t+"").trim()==="")return null;if(h=null,n.isNumber(t)?(u=new Date(t),s=r(u.getUTCFullYear(),4,0)+"-"+r(u.getUTCMonth()+1,2,0)+"-"+r(u.getUTCDate(),2,0),h=r(u.getUTCHours(),2,0)+":"+r(u.getUTCMinutes(),2,0)+":"+r(u.getUTCSeconds(),2,0)):(t=t.trim(),e=t.split(this.ISO_SPLITTER_RE)||[],s=this.DATE_RE.test(e[0])?e[0]:"",h=s&&e[1]?e[1]:this.TIME_RE.test(e[0])?e[0]:""),c=this.DATE_RE.exec(s)||[],o=this.TIME_RE.exec(h)||[],i){if(this.includeDate&&n.isUndefined(c[0]))return;if(this.includeTime&&n.isUndefined(o[0]))return;if(!this.includeDate&&s)return;if(!this.includeTime&&h)return}return u=new Date(Date.UTC(c[1]*1||0,c[2]*1-1||0,c[3]*1||0,o[1]*1||null,o[2]*1||null,o[3]*1||null,o[5]*1||null)),f="",this.includeDate&&(f=r(u.getUTCFullYear(),4,0)+"-"+r(u.getUTCMonth()+1,2,0)+"-"+r(u.getUTCDate(),2,0)),this.includeTime&&(f=f+(this.includeDate?"T":"")+r(u.getUTCHours(),2,0)+":"+r(u.getUTCMinutes(),2,0)+":"+r(u.getUTCSeconds(),2,0),this.includeMilli&&(f=f+"."+r(u.getUTCMilliseconds(),3,0))),this.includeDate&&this.includeTime&&(f+="Z"),f},fromRaw:function(t){return n.isNull(t)||n.isUndefined(t)?"":this._convert(t)},toRaw:function(n){return this._convert(n,!0)}});v=i.StringFormatter=function(){};v.prototype=new e;n.extend(v.prototype,{fromRaw:function(t){return n.isUndefined(t)||n.isNull(t)?"":t+""}});y=i.EmailFormatter=function(){};y.prototype=new e;n.extend(y.prototype,{toRaw:function(t){var i=t.trim().split("@");if(i.length===2&&n.all(i))return t}});p=i.SelectFormatter=function(){};p.prototype=new e;n.extend(p.prototype,{fromRaw:function(t){return n.isArray(t)?t:t!=null?[t]:[]}});var b=i.CellEditor=t.View.extend({initialize:function(n){this.formatter=n.formatter;this.column=n.column;this.column instanceof o||(this.column=new o(this.column));this.listenTo(this.model,"backgrid:editing",this.postRender)},postRender:function(n,t){return(t==null||t.get("name")==this.column.get("name"))&&this.$el.focus(),this}}),tt=i.InputCellEditor=b.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){tt.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(t){var s=this.formatter,i=this.model,u=this.column,r=new f(t),h=t.type==="blur",e,o;r.moveUp()||r.moveDown()||r.moveLeft()||r.moveRight()||r.save()||h?(t.preventDefault(),t.stopPropagation(),e=this.$el.val(),o=s.toRaw(e,i),n.isUndefined(o)?i.trigger("backgrid:error",i,u,e):(i.set(u.get("name"),o),i.trigger("backgrid:edited",i,u,r))):r.cancel()&&(t.stopPropagation(),i.trigger("backgrid:edited",i,u,r))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),c=i.Cell=t.View.extend({tagName:"td",formatter:e,editor:tt,events:{click:"enterEditMode"},initialize:function(t){this.column=t.column;this.column instanceof o||(this.column=new o(this.column));var r=this.column,u=this.model,f=this.$el,e=i.resolveNameToClass(r.get("formatter")||this.formatter,"Formatter");n.isFunction(e.fromRaw)||n.isFunction(e.toRaw)||(e=new e);this.formatter=e;this.editor=i.resolveNameToClass(this.editor,"CellEditor");this.listenTo(u,"change:"+r.get("name"),function(){f.hasClass("editor")||this.render()});this.listenTo(u,"backgrid:error",this.renderError);this.listenTo(r,"change:editable change:sortable change:renderable",function(n){var t=n.changedAttributes();for(var i in t)t.hasOwnProperty(i)&&f.toggleClass(i,t[i])});i.callByNeed(r.editable(),r,u)&&f.addClass("editable");i.callByNeed(r.sortable(),r,u)&&f.addClass("sortable");i.callByNeed(r.renderable(),r,u)&&f.addClass("renderable");i.callByNeed(r.renderable(),r,u)&&f.addClass(r.get("name"))},render:function(){this.$el.empty();var n=this.model;return this.$el.text(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this.delegateEvents(),this},enterEditMode:function(){var n=this.model,t=this.column,r=i.callByNeed(t.editable(),t,n);r&&(this.currentEditor=new this.editor({column:this.column,model:this.model,formatter:this.formatter}),n.trigger("backgrid:edit",n,t,this,this.currentEditor),this.undelegateEvents(),this.$el.empty(),this.$el.append(this.currentEditor.$el),this.currentEditor.render(),this.$el.addClass("editor"),n.trigger("backgrid:editing",n,t,this,this.currentEditor))},renderError:function(n,t){(t==null||t.get("name")==this.column.get("name"))&&this.$el.addClass("error")},exitEditMode:function(){this.$el.removeClass("error");this.currentEditor&&(this.currentEditor.remove(),this.stopListening(this.currentEditor),delete this.currentEditor);this.$el.removeClass("editor");this.render()},remove:function(){return this.currentEditor&&(this.currentEditor.remove.apply(this.currentEditor,arguments),delete this.currentEditor),c.__super__.remove.apply(this,arguments)}}),rt=i.StringCell=c.extend({className:"string-cell",formatter:v}),ut=i.UriCell=c.extend({className:"uri-cell",title:null,target:"_blank",initialize:function(n){ut.__super__.initialize.apply(this,arguments);this.title=n.title||this.title;this.target=n.target||this.target},render:function(){this.$el.empty();var n=this.model.get(this.column.get("name")),t=this.formatter.fromRaw(n,this.model);return this.$el.append(l("<a>",{tabIndex:-1,href:n,title:this.title||t,target:this.target}).text(t)),this.delegateEvents(),this}}),yt=i.EmailCell=rt.extend({className:"email-cell",formatter:y,render:function(){this.$el.empty();var t=this.model,n=this.formatter.fromRaw(t.get(this.column.get("name")),t);return this.$el.append(l("<a>",{tabIndex:-1,href:"mailto:"+n,title:n}).text(n)),this.delegateEvents(),this}}),k=i.NumberCell=c.extend({className:"number-cell",decimals:u.prototype.defaults.decimals,decimalSeparator:u.prototype.defaults.decimalSeparator,orderSeparator:u.prototype.defaults.orderSeparator,formatter:u,initialize:function(){k.__super__.initialize.apply(this,arguments);var n=this.formatter;n.decimals=this.decimals;n.decimalSeparator=this.decimalSeparator;n.orderSeparator=this.orderSeparator}}),pt=i.IntegerCell=k.extend({className:"integer-cell",decimals:0}),ft=i.PercentCell=k.extend({className:"percent-cell",multiplier:a.prototype.defaults.multiplier,symbol:a.prototype.defaults.symbol,formatter:a,initialize:function(){ft.__super__.initialize.apply(this,arguments);var n=this.formatter;n.multiplier=this.multiplier;n.symbol=this.symbol}}),d=i.DatetimeCell=c.extend({className:"datetime-cell",includeDate:h.prototype.defaults.includeDate,includeTime:h.prototype.defaults.includeTime,includeMilli:h.prototype.defaults.includeMilli,formatter:h,initialize:function(){var i,t;d.__super__.initialize.apply(this,arguments);i=this.formatter;i.includeDate=this.includeDate;i.includeTime=this.includeTime;i.includeMilli=this.includeMilli;t=this.includeDate?"YYYY-MM-DD":"";t+=this.includeDate&&this.includeTime?"T":"";t+=this.includeTime?"HH:mm:ss":"";t+=this.includeTime&&this.includeMilli?".SSS":"";this.editor=this.editor.extend({attributes:n.extend({},this.editor.prototype.attributes,this.editor.attributes,{placeholder:t})})}}),wt=i.DateCell=d.extend({className:"date-cell",includeTime:!1}),bt=i.TimeCell=d.extend({className:"time-cell",includeDate:!1}),et=i.BooleanCellEditor=b.extend({tagName:"input",attributes:{tabIndex:-1,type:"checkbox"},events:{mousedown:function(){this.mouseDown=!0},blur:"enterOrExitEditMode",mouseup:function(){this.mouseDown=!1},change:"saveOrCancel",keydown:"saveOrCancel"},render:function(){var n=this.model,t=this.formatter.fromRaw(n.get(this.column.get("name")),n);return this.$el.prop("checked",t),this},enterOrExitEditMode:function(n){if(!this.mouseDown){var t=this.model;t.trigger("backgrid:edited",t,this.column,new f(n))}},saveOrCancel:function(n){var i=this.model,r=this.column,o=this.formatter,t=new f(n),u,e;if(t.passThru()&&n.type!="change")return!0;t.cancel()&&(n.stopPropagation(),i.trigger("backgrid:edited",i,r,t));u=this.$el;t.save()||t.moveLeft()||t.moveRight()||t.moveUp()||t.moveDown()?(n.preventDefault(),n.stopPropagation(),e=o.toRaw(u.prop("checked"),i),i.set(r.get("name"),e),i.trigger("backgrid:edited",i,r,t)):n.type=="change"&&(e=o.toRaw(u.prop("checked"),i),i.set(r.get("name"),e),u.focus())}}),kt=i.BooleanCell=c.extend({className:"boolean-cell",editor:et,events:{click:"enterEditMode"},render:function(){this.$el.empty();var n=this.model,t=this.column,r=i.callByNeed(t.editable(),t,n);return this.$el.append(l("<input>",{tabIndex:-1,type:"checkbox",checked:this.formatter.fromRaw(n.get(t.get("name")),n),disabled:!r})),this.delegateEvents(),this}}),ot=i.SelectCellEditor=b.extend({tagName:"select",events:{change:"save",blur:"close",keydown:"close"},template:n.template('<option value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- text %><\/option>',null,{variable:null}),setOptionValues:function(t){this.optionValues=t;this.optionValues=n.result(this,"optionValues")},setMultiple:function(n){this.multiple=n;this.$el.prop("multiple",n)},_renderOptions:function(t,i){for(var u="",r=0;r<t.length;r++)u=u+this.template({text:t[r][0],value:t[r][1],selected:n.indexOf(i,t[r][1])>-1});return u},render:function(){var i,t;this.$el.empty();var r=n.result(this,"optionValues"),f=this.model,e=this.formatter.fromRaw(f.get(this.column.get("name")),f);if(!n.isArray(r))throw new TypeError("optionValues must be an array");var t=null,o=null,t=null,s=null,u=null;for(i=0;i<r.length;i++)if(t=r[i],n.isArray(t))o=t[0],t=t[1],this.$el.append(this.template({text:o,value:t,selected:n.indexOf(e,t)>-1}));else if(n.isObject(t))s=t.name,u=l("<optgroup><\/optgroup>",{label:s}),u.append(this._renderOptions.call(this,t.values,e)),this.$el.append(u);else throw new TypeError("optionValues elements must be a name-value pair or an object hash of { name: 'optgroup label', value: [option name-value pairs] }");return this.delegateEvents(),this},save:function(){var n=this.model,t=this.column;n.set(t.get("name"),this.formatter.toRaw(this.$el.val(),n))},close:function(n){var i=this.model,r=this.column,t=new f(n);t.cancel()?(n.stopPropagation(),i.trigger("backgrid:edited",i,r,new f(n))):(t.save()||t.moveLeft()||t.moveRight()||t.moveUp()||t.moveDown()||n.type=="blur")&&(n.preventDefault(),n.stopPropagation(),this.save(n),i.trigger("backgrid:edited",i,r,new f(n)))}}),st=i.SelectCell=c.extend({className:"select-cell",editor:ot,multiple:!1,formatter:p,optionValues:undefined,delimiter:", ",initialize:function(){st.__super__.initialize.apply(this,arguments);this.listenTo(this.model,"backgrid:edit",function(n,t,i,r){t.get("name")==this.column.get("name")&&(r.setOptionValues(this.optionValues),r.setMultiple(this.multiple))})},render:function(){var r,o,u,a,t,s,f,h;this.$el.empty();var i=n.result(this,"optionValues"),c=this.model,l=this.formatter.fromRaw(c.get(this.column.get("name")),c),e=[];try{if(!n.isArray(i)||n.isEmpty(i))throw new TypeError;for(r=0;r<l.length;r++)for(o=l[r],u=0;u<i.length;u++)if(t=i[u],n.isArray(t))a=t[0],t=t[1],t==o&&e.push(a);else if(n.isObject(t))for(s=t.values,f=0;f<s.length;f++)h=s[f],h[1]==o&&e.push(h[0]);else throw new TypeError;this.$el.append(e.join(this.delimiter))}catch(v){if(v instanceof TypeError)throw new TypeError("'optionValues' must be of type {Array.<Array>|Array.<{name: string, values: Array.<Array>}>}");throw v;}return this.delegateEvents(),this}}),o=i.Column=t.Model.extend({defaults:{name:undefined,label:undefined,sortable:!0,editable:!0,renderable:!0,formatter:undefined,sortType:"cycle",sortValue:undefined,direction:null,cell:undefined,headerCell:undefined},initialize:function(){this.has("label")||this.set({label:this.get("name")},{silent:!0});var n=i.resolveNameToClass(this.get("headerCell"),"HeaderCell"),t=i.resolveNameToClass(this.get("cell"),"Cell");this.set({cell:t,headerCell:n},{silent:!0})},sortValue:function(){var t=this.get("sortValue");return n.isString(t)?this[t]:n.isFunction(t)?t:function(n,t){return n.get(t)}}});n.each(["sortable","renderable","editable"],function(t){o.prototype[t]=function(){var i=this.get(t);return n.isString(i)?this[i]:n.isFunction(i)?i:!!i}});var w=i.Columns=t.Collection.extend({model:o}),ht=i.Row=t.View.extend({tagName:"tr",initialize:function(n){var i=this.columns=n.columns,r,u;for(i instanceof t.Collection||(i=this.columns=new w(i)),r=this.cells=[],u=0;u<i.length;u++)r.push(this.makeCell(i.at(u),n));this.listenTo(i,"add",function(t,i){var u=i.indexOf(t),f=this.makeCell(t,n),e;r.splice(u,0,f);e=this.$el;u===0?e.prepend(f.render().$el):u===i.length-1?e.append(f.render().$el):e.children().eq(u).before(f.render().$el)});this.listenTo(i,"remove",function(n,t,i){r[i.index].remove();r.splice(i.index,1)})},makeCell:function(n){return new(n.get("cell"))({column:n,model:this.model})},render:function(){var t,n;for(this.$el.empty(),t=document.createDocumentFragment(),n=0;n<this.cells.length;n++)t.appendChild(this.cells[n].render().el);return this.el.appendChild(t),this.delegateEvents(),this},remove:function(){for(var i,n=0;n<this.cells.length;n++)i=this.cells[n],i.remove.apply(i,arguments);return t.View.prototype.remove.apply(this,arguments)}}),it=i.EmptyRow=t.View.extend({tagName:"tr",emptyText:null,initialize:function(n){this.emptyText=n.emptyText;this.columns=n.columns},render:function(){this.$el.empty();var t=document.createElement("td");return t.setAttribute("colspan",this.columns.length),t.appendChild(document.createTextNode(n.result(this,"emptyText"))),this.el.className="empty",this.el.appendChild(t),this}}),ct=i.HeaderCell=t.View.extend({tagName:"th",events:{"click a":"onClick"},initialize:function(n){this.column=n.column;this.column instanceof o||(this.column=new o(this.column));var t=this.column,r=this.collection,u=this.$el;this.listenTo(t,"change:editable change:sortable change:renderable",function(n){var t=n.changedAttributes();for(var i in t)t.hasOwnProperty(i)&&u.toggleClass(i,t[i])});this.listenTo(t,"change:direction",this.setCellDirection);this.listenTo(t,"change:name change:label",this.render);i.callByNeed(t.editable(),t,r)&&u.addClass("editable");i.callByNeed(t.sortable(),t,r)&&u.addClass("sortable");i.callByNeed(t.renderable(),t,r)&&u.addClass("renderable");this.listenTo(r.fullCollection||r,"sort",this.removeCellDirection)},removeCellDirection:function(){this.$el.removeClass("ascending").removeClass("descending");this.column.set("direction",null)},setCellDirection:function(n,t){this.$el.removeClass("ascending").removeClass("descending");n.cid==this.column.cid&&this.$el.addClass(t)},onClick:function(n){function o(n,i){t.get("direction")==="ascending"?r.trigger(u,i,"descending"):t.get("direction")==="descending"?r.trigger(u,i,null):r.trigger(u,i,"ascending")}function s(n,i){t.get("direction")==="ascending"?r.trigger(u,i,"descending"):r.trigger(u,i,"ascending")}var f,e;n.preventDefault();var t=this.column,r=this.collection,u="backgrid:sort";f=i.callByNeed(t.sortable(),t,this.collection);f&&(e=t.get("sortType"),e==="toggle"?s(this,t):o(this,t))},render:function(){this.$el.empty();var n=this.column,r=i.callByNeed(n.sortable(),n,this.collection),t;return t=r?l("<a>").text(n.get("label")).append("<b class='sort-caret'><\/b>"):document.createTextNode(n.get("label")),this.$el.append(t),this.$el.addClass(n.get("name")),this.$el.addClass(n.get("direction")),this.delegateEvents(),this}}),dt=i.HeaderRow=i.Row.extend({initialize:function(){i.Row.prototype.initialize.apply(this,arguments)},makeCell:function(n,t){var i=n.get("headerCell")||t.headerCell||ct;return new i({column:n,collection:this.collection})}}),lt=i.Header=t.View.extend({tagName:"thead",initialize:function(n){this.columns=n.columns;this.columns instanceof t.Collection||(this.columns=new w(this.columns));this.row=new i.HeaderRow({columns:this.columns,collection:this.collection})},render:function(){return this.$el.append(this.row.render().$el),this.delegateEvents(),this},remove:function(){return this.row.remove.apply(this.row,arguments),t.View.prototype.remove.apply(this,arguments)}}),at=i.Body=t.View.extend({tagName:"tbody",initialize:function(n){this.columns=n.columns;this.columns instanceof t.Collection||(this.columns=new w(this.columns));this.row=n.row||ht;this.rows=this.collection.map(function(n){return new this.row({columns:this.columns,model:n})},this);this.emptyText=n.emptyText;this._unshiftEmptyRowMayBe();var i=this.collection;this.listenTo(i,"add",this.insertRow);this.listenTo(i,"remove",this.removeRow);this.listenTo(i,"sort",this.refresh);this.listenTo(i,"reset",this.refresh);this.listenTo(i,"backgrid:sort",this.sort);this.listenTo(i,"backgrid:edited",this.moveToNextCell)},_unshiftEmptyRowMayBe:function(){if(this.rows.length===0&&this.emptyText!=null)return this.rows.unshift(new it({emptyText:this.emptyText,columns:this.columns})),!0},insertRow:function(n,i,r){var f,u;if(this.rows[0]instanceof it&&this.rows.pop().remove(),!(i instanceof t.Collection)&&!r){this.collection.add(n,r=i);return}f=new this.row({columns:this.columns,model:n});u=i.indexOf(n);this.rows.splice(u,0,f);var e=this.$el,o=e.children(),s=f.render().$el;return u>=o.length?e.append(s):o.eq(u).before(s),this},removeRow:function(t,i,r){if(!r){this.collection.remove(t,r=i);this._unshiftEmptyRowMayBe()&&this.render();return}return(n.isUndefined(r.render)||r.render)&&this.rows[r.index].remove(),this.rows.splice(r.index,1),this._unshiftEmptyRowMayBe()&&this.render(),this},refresh:function(){for(var n=0;n<this.rows.length;n++)this.rows[n].remove();return this.rows=this.collection.map(function(n){return new this.row({columns:this.columns,model:n})},this),this._unshiftEmptyRowMayBe(),this.render(),this.collection.trigger("backgrid:refresh",this),this},render:function(){var t,n,i;for(this.$el.empty(),t=document.createDocumentFragment(),n=0;n<this.rows.length;n++)i=this.rows[n],t.appendChild(i.render().el);return this.el.appendChild(t),this.delegateEvents(),this},remove:function(){for(var i,n=0;n<this.rows.length;n++)i=this.rows[n],i.remove.apply(i,arguments);return t.View.prototype.remove.apply(this,arguments)},sort:function(i,r){var u,f,e;if(!n.contains(["ascending","descending",null],r))throw new RangeError('direction must be one of "ascending", "descending" or `null`');return n.isString(i)&&(i=this.columns.findWhere({name:i})),u=this.collection,f=r==="ascending"?-1:r==="descending"?1:null,e=this.makeComparator(i.get("name"),f,f?i.sortValue():function(n){return n.cid.replace("c","")*1}),t.PageableCollection&&u instanceof t.PageableCollection?(u.setSorting(f&&i.get("name"),f,{sortValue:i.sortValue()}),u.fullCollection?(u.fullCollection.comparator==null&&(u.fullCollection.comparator=e),u.fullCollection.sort(),u.trigger("backgrid:sorted",i,r,u)):u.fetch({reset:!0,success:function(){u.trigger("backgrid:sorted",i,r,u)}})):(u.comparator=e,u.sort(),u.trigger("backgrid:sorted",i,r,u)),i.set("direction",r),this},makeComparator:function(n,t,i){return function(r,u){var f=i(r,n),e=i(u,n),o;return(t===1&&(o=f,f=e,e=o),f===e)?0:f<e?-1:1}},moveToNextCell:function(n,t,r){var h=this.collection.indexOf(n),s=this.columns.indexOf(t),u,y,p,e,c,o,l,a,v,f;if(s===-1)return this;if(this.rows[h].cells[s].exitEditMode(),r.moveUp()||r.moveDown()||r.moveLeft()||r.moveRight()||r.save())if(o=this.columns.length,l=o*this.collection.length,r.moveUp()||r.moveDown())e=h+(r.moveUp()?-1:1),a=this.rows[e],a?(u=a.cells[s],i.callByNeed(u.column.editable(),u.column,n)&&(u.enterEditMode(),n.trigger("backgrid:next",e,s,!1))):n.trigger("backgrid:next",e,s,!0);else if(r.moveLeft()||r.moveRight()){for(v=r.moveRight(),f=h*o+s+(v?1:-1);f>=0&&f<l;v?f++:f--)if(e=~~(f/o),c=f-e*o,u=this.rows[e].cells[c],y=i.callByNeed(u.column.renderable(),u.column,u.model),p=i.callByNeed(u.column.editable(),u.column,n),y&&p){u.enterEditMode();n.trigger("backgrid:next",e,c,!1);break}f==l&&n.trigger("backgrid:next",~~(f/o),f-e*o,!0)}return this}}),gt=i.Footer=t.View.extend({tagName:"tfoot",initialize:function(n){this.columns=n.columns;this.columns instanceof t.Collection||(this.columns=new i.Columns(this.columns))}}),ni=i.Grid=t.View.extend({tagName:"table",className:"backgrid",header:lt,body:at,footer:null,initialize:function(i){i.columns instanceof t.Collection||(i.columns=new w(i.columns||this.columns));this.columns=i.columns;var r=n.omit(i,["el","id","attributes","className","tagName","events"]);this.body=i.body||this.body;this.body=new this.body(r);this.header=i.header||this.header;this.header&&(this.header=new this.header(r));this.footer=i.footer||this.footer;this.footer&&(this.footer=new this.footer(r));this.listenTo(this.columns,"reset",function(){this.header&&(this.header=new(this.header.remove().constructor)(r));this.body=new(this.body.remove().constructor)(r);this.footer&&(this.footer=new(this.footer.remove().constructor)(r));this.render()})},insertRow:function(){return this.body.insertRow.apply(this.body,arguments),this},removeRow:function(){return this.body.removeRow.apply(this.body,arguments),this},insertColumn:function(){return this.columns.add.apply(this.columns,arguments),this},removeColumn:function(){return this.columns.remove.apply(this.columns,arguments),this},sort:function(){return this.body.sort.apply(this.body,arguments),this},render:function(){return this.$el.empty(),this.header&&this.$el.append(this.header.render().$el),this.footer&&this.$el.append(this.footer.render().$el),this.$el.append(this.body.render().$el),this.delegateEvents(),this.trigger("backgrid:rendered",this),this},remove:function(){return this.header&&this.header.remove.apply(this.header,arguments),this.body.remove.apply(this.body,arguments),this.footer&&this.footer.remove.apply(this.footer,arguments),t.View.prototype.remove.apply(this,arguments)}});return i});
/*
  backgrid-moment-cell
  http://github.com/wyuenho/backgrid
  Copyright (c) 2013 Jimmy Yuen Ho Wong and contributors
  Licensed under the MIT @license.
*/
(function(n,t){typeof define=="function"&&define.amd?define(["underscore","backgrid","moment"],t):typeof exports=="object"?module.exports=t(require("underscore"),require("backgrid"),require("moment")):t(n._,n.Backgrid,n.moment)})(this,function(n,t,i){var r=t.Extension.MomentFormatter=function(t){n.extend(this,this.defaults,t)},u;r.prototype=new t.CellFormatter;n.extend(r.prototype,{defaults:{modelInUnixOffset:!1,modelInUnixTimestamp:!1,modelInUTC:!0,modelLang:i.locale(),modelFormat:i.defaultFormat,displayInUnixOffset:!1,displayInUnixTimestamp:!1,displayInUTC:!0,displayLang:i.locale(),displayFormat:i.defaultFormat},fromRaw:function(n){if(n==null)return"";var t=this.modelInUnixOffset?i(n):this.modelInUnixTimestamp?i.unix(n):this.modelInUTC?i.utc(n,this.modelFormat,this.modelLang):i(n,this.modelFormat,this.modelLang);return this.displayInUnixOffset?+t:this.displayInUnixTimestamp?t.unix():(this.displayLang&&t.lang(this.displayLang),this.displayInUTC?t.utc():t.local(),t.format(this.displayFormat))},toRaw:function(n){var t=this.displayInUnixOffset?i(+n):this.displayInUnixTimestamp?i.unix(+n):this.displayInUTC?i.utc(n,this.displayFormat,this.displayLang):i(n,this.displayFormat,this.displayLang);if(t&&t.isValid())return this.modelInUnixOffset?+t:this.modelInUnixTimestamp?t.unix():(this.modelLang&&t.lang(this.modelLang),this.modelInUTC?t.utc():t.local(),t.format(this.modelFormat))}});u=t.Extension.MomentCell=t.Cell.extend({editor:t.InputCellEditor,className:"moment-cell",formatter:r,initialize:function(t){u.__super__.initialize.apply(this,arguments);var i=r.prototype.defaults,f=n.keys(i),e=n.pick(this,f),o=n.pick(t,f);n.extend(this.formatter,i,e,o);this.editor=this.editor.extend({attributes:n.extend({},this.editor.prototype.attributes||this.editor.attributes||{},{placeholder:this.formatter.displayFormat})})}});n.extend(u.prototype,r.prototype.defaults)});
/*
  backgrid-paginator
  http://github.com/wyuenho/backgrid
  Copyright (c) 2013 Jimmy Yuen Ho Wong and contributors
  Licensed under the MIT @license.
*/
(function(n,t){typeof exports=="object"?module.exports=t(require("underscore"),require("backbone"),require("backgrid"),require("backbone.paginator")):typeof define=="function"&&define.amd?define(["underscore","backbone","backgrid","backbone.paginator"],t):t(n._,n.Backbone,n.Backgrid)})(this,function(n,t,i){"use strict";var r=i.Extension.PageHandle=t.View.extend({tagName:"li",events:{"click a":"changePage"},title:function(n){return"Page "+n.label},isRewind:!1,isBack:!1,isForward:!1,isFastForward:!1,initialize:function(t){var s=this.collection,f=s.state,e=f.currentPage,r=f.firstPage,o=f.lastPage,i,u;n.extend(this,n.pick(t,["isRewind","isBack","isForward","isFastForward"]));this.isRewind?i=r:this.isBack?i=Math.max(r,e-1):this.isForward?i=Math.min(o,e+1):this.isFastForward?i=o:(i=+t.pageIndex,i=r?i+1:i);this.pageIndex=i;this.label=(t.label||(r?i:i+1))+"";u=t.title||this.title;this.title=n.isFunction(u)?u({label:this.label}):u},render:function(){var n;this.$el.empty();n=document.createElement("a");n.href="#";this.title&&(n.title=this.title);n.innerHTML=this.label;this.el.appendChild(n);var i=this.collection,t=i.state,r=t.currentPage,u=this.pageIndex;return this.isRewind&&r==t.firstPage||this.isBack&&!i.hasPreviousPage()||this.isForward&&!i.hasNextPage()||this.isFastForward&&(r==t.lastPage||t.totalPages<1)?this.$el.addClass("disabled"):this.isRewind||this.isBack||this.isForward||this.isFastForward||t.currentPage!=u||this.$el.addClass("active"),this.delegateEvents(),this},changePage:function(n){n.preventDefault();var i=this.$el,t=this.collection;return i.hasClass("active")||i.hasClass("disabled")||(this.isRewind?t.getFirstPage():this.isBack?t.getPreviousPage():this.isForward?t.getNextPage():this.isFastForward?t.getLastPage():t.getPage(this.pageIndex,{reset:!0})),this}}),u=i.Extension.Paginator=t.View.extend({className:"backgrid-paginator",windowSize:10,slideScale:.5,controls:{rewind:{label:"\u300a",title:"First"},back:{label:"\u3008",title:"Previous"},forward:{label:"\u3009",title:"Next"},fastForward:{label:"\u300b",title:"Last"}},renderIndexedPageHandles:!0,pageHandle:r,goBackFirstOnSort:!0,initialize:function(t){var i=this,r;i.controls=n.defaults(t.controls||{},i.controls,u.prototype.controls);n.extend(i,n.pick(t||{},"windowSize","pageHandle","slideScale","goBackFirstOnSort","renderIndexedPageHandles"));r=i.collection;i.listenTo(r,"add",i.render);i.listenTo(r,"remove",i.render);i.listenTo(r,"reset",i.render);i.listenTo(r,"backgrid:sorted",function(){i.goBackFirstOnSort&&r.getFirstPage({reset:!0})})},slideMaybe:function(n,t,i,r){return Math.round(i%r/r)},slideThisMuch:function(n,t,i,r,u){return~~(r*u)},_calculateWindow:function(){var s=this.collection,r=s.state,u=r.firstPage,t=+r.lastPage,n,o;t=Math.max(0,u?t-1:t);n=Math.max(r.currentPage,r.firstPage);n=u?n-1:n;var i=this.windowSize,e=this.slideScale,f=Math.floor(n/i)*i;return n<=t-this.slideThisMuch()&&(f+=this.slideMaybe(u,t,n,i,e)*this.slideThisMuch(u,t,n,i,e)),o=Math.min(t+1,f+i),[f,o]},makeHandles:function(){var t=[],r=this.collection,u=this._calculateWindow(),e=u[0],o=u[1],i,f;if(this.renderIndexedPageHandles)for(i=e;i<o;i++)t.push(new this.pageHandle({collection:r,pageIndex:i}));return f=this.controls,n.each(["back","rewind","forward","fastForward"],function(n){var i=f[n],u,e;i&&(u={collection:r,title:i.title,label:i.label},u["is"+n.slice(0,1).toUpperCase()+n.slice(1)]=!0,e=new this.pageHandle(u),n=="rewind"||n=="back"?t.unshift(e):t.push(e))},this),t},render:function(){var r,t,i,n;if(this.$el.empty(),this.handles)for(n=0,r=this.handles.length;n<r;n++)this.handles[n].remove();for(t=this.handles=this.makeHandles(),i=document.createElement("ul"),n=0;n<t.length;n++)i.appendChild(t[n].render().el);return this.el.appendChild(i),this}})});
/*!
 * Bootstrap v3.3.5 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under the MIT license
 */
if(typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(n){"use strict";var t=n.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher");}(jQuery);+function(n){"use strict";function t(){var i=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var t in n)if(i.style[t]!==undefined)return{end:n[t]};return!1}n.fn.emulateTransitionEnd=function(t){var i=!1,u=this,r;n(this).one("bsTransitionEnd",function(){i=!0});return r=function(){i||n(u).trigger(n.support.transition.end)},setTimeout(r,t),this};n(function(){(n.support.transition=t(),n.support.transition)&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(t){if(n(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery);+function(n){"use strict";function u(i){return this.each(function(){var r=n(this),u=r.data("bs.alert");u||r.data("bs.alert",u=new t(this));typeof i=="string"&&u[i].call(r)})}var i='[data-dismiss="alert"]',t=function(t){n(t).on("click",i,this.close)},r;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.prototype.close=function(i){function e(){r.detach().trigger("closed.bs.alert").remove()}var f=n(this),u=f.attr("data-target"),r;(u||(u=f.attr("href"),u=u&&u.replace(/.*(?=#[^\s]*$)/,"")),r=n(u),i&&i.preventDefault(),r.length||(r=f.closest(".alert")),r.trigger(i=n.Event("close.bs.alert")),i.isDefaultPrevented())||(r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e())};r=n.fn.alert;n.fn.alert=u;n.fn.alert.Constructor=t;n.fn.alert.noConflict=function(){return n.fn.alert=r,this};n(document).on("click.bs.alert.data-api",i,t.prototype.close)}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.button"),f=typeof i=="object"&&i;r||u.data("bs.button",r=new t(this,f));i=="toggle"?r.toggle():i&&r.setState(i)})}var t=function(i,r){this.$element=n(i);this.options=n.extend({},t.DEFAULTS,r);this.isLoading=!1},r;t.VERSION="3.3.5";t.DEFAULTS={loadingText:"loading..."};t.prototype.setState=function(t){var r="disabled",i=this.$element,f=i.is("input")?"val":"html",u=i.data();t+="Text";u.resetText==null&&i.data("resetText",i[f]());setTimeout(n.proxy(function(){i[f](u[t]==null?this.options[t]:u[t]);t=="loadingText"?(this.isLoading=!0,i.addClass(r).attr(r,r)):this.isLoading&&(this.isLoading=!1,i.removeClass(r).removeAttr(r))},this),0)};t.prototype.toggle=function(){var t=!0,i=this.$element.closest('[data-toggle="buttons"]'),n;i.length?(n=this.$element.find("input"),n.prop("type")=="radio"?(n.prop("checked")&&(t=!1),i.find(".active").removeClass("active"),this.$element.addClass("active")):n.prop("type")=="checkbox"&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")):(this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active"))};r=n.fn.button;n.fn.button=i;n.fn.button.Constructor=t;n.fn.button.noConflict=function(){return n.fn.button=r,this};n(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=n(t.target);r.hasClass("btn")||(r=r.closest(".btn"));i.call(r,"toggle");n(t.target).is('input[type="radio"]')||n(t.target).is('input[type="checkbox"]')||t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){n(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.carousel"),f=n.extend({},t.DEFAULTS,u.data(),typeof i=="object"&&i),e=typeof i=="string"?i:f.slide;r||u.data("bs.carousel",r=new t(this,f));typeof i=="number"?r.to(i):e?r[e]():f.interval&&r.pause().cycle()})}var t=function(t,i){this.$element=n(t);this.$indicators=this.$element.find(".carousel-indicators");this.options=i;this.paused=null;this.sliding=null;this.interval=null;this.$active=null;this.$items=null;this.options.keyboard&&this.$element.on("keydown.bs.carousel",n.proxy(this.keydown,this));this.options.pause!="hover"||"ontouchstart"in document.documentElement||this.$element.on("mouseenter.bs.carousel",n.proxy(this.pause,this)).on("mouseleave.bs.carousel",n.proxy(this.cycle,this))},u,r;t.VERSION="3.3.5";t.TRANSITION_DURATION=600;t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0};t.prototype.keydown=function(n){if(!/input|textarea/i.test(n.target.tagName)){switch(n.which){case 37:this.prev();break;case 39:this.next();break;default:return}n.preventDefault()}};t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(n.proxy(this.next,this),this.options.interval)),this};t.prototype.getItemIndex=function(n){return this.$items=n.parent().children(".item"),this.$items.index(n||this.$active)};t.prototype.getItemForDirection=function(n,t){var i=this.getItemIndex(t),f=n=="prev"&&i===0||n=="next"&&i==this.$items.length-1,r,u;return f&&!this.options.wrap?t:(r=n=="prev"?-1:1,u=(i+r)%this.$items.length,this.$items.eq(u))};t.prototype.to=function(n){var i=this,t=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(n>this.$items.length-1)&&!(n<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(n)}):t==n?this.pause().cycle():this.slide(n>t?"next":"prev",this.$items.eq(n))};t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&n.support.transition&&(this.$element.trigger(n.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this};t.prototype.next=function(){if(!this.sliding)return this.slide("next")};t.prototype.prev=function(){if(!this.sliding)return this.slide("prev")};t.prototype.slide=function(i,r){var e=this.$element.find(".item.active"),u=r||this.getItemForDirection(i,e),l=this.interval,f=i=="next"?"left":"right",a=this,o,s,h,c;return u.hasClass("active")?this.sliding=!1:(o=u[0],s=n.Event("slide.bs.carousel",{relatedTarget:o,direction:f}),this.$element.trigger(s),s.isDefaultPrevented())?void 0:(this.sliding=!0,l&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),h=n(this.$indicators.children()[this.getItemIndex(u)]),h&&h.addClass("active")),c=n.Event("slid.bs.carousel",{relatedTarget:o,direction:f}),n.support.transition&&this.$element.hasClass("slide")?(u.addClass(i),u[0].offsetWidth,e.addClass(f),u.addClass(f),e.one("bsTransitionEnd",function(){u.removeClass([i,f].join(" ")).addClass("active");e.removeClass(["active",f].join(" "));a.sliding=!1;setTimeout(function(){a.$element.trigger(c)},0)}).emulateTransitionEnd(t.TRANSITION_DURATION)):(e.removeClass("active"),u.addClass("active"),this.sliding=!1,this.$element.trigger(c)),l&&this.cycle(),this)};u=n.fn.carousel;n.fn.carousel=i;n.fn.carousel.Constructor=t;n.fn.carousel.noConflict=function(){return n.fn.carousel=u,this};r=function(t){var o,r=n(this),u=n(r.attr("data-target")||(o=r.attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")),e,f;u.hasClass("carousel")&&(e=n.extend({},u.data(),r.data()),f=r.attr("data-slide-to"),f&&(e.interval=!1),i.call(u,e),f&&u.data("bs.carousel").to(f),t.preventDefault())};n(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r);n(window).on("load",function(){n('[data-ride="carousel"]').each(function(){var t=n(this);i.call(t,t.data())})})}(jQuery);+function(n){"use strict";function r(t){var i,r=t.attr("data-target")||(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return n(r)}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.collapse"),f=n.extend({},t.DEFAULTS,u.data(),typeof i=="object"&&i);!r&&f.toggle&&/show|hide/.test(i)&&(f.toggle=!1);r||u.data("bs.collapse",r=new t(this,f));typeof i=="string"&&r[i]()})}var t=function(i,r){this.$element=n(i);this.options=n.extend({},t.DEFAULTS,r);this.$trigger=n('[data-toggle="collapse"][href="#'+i.id+'"],[data-toggle="collapse"][data-target="#'+i.id+'"]');this.transitioning=null;this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger);this.options.toggle&&this.toggle()},u;t.VERSION="3.3.5";t.TRANSITION_DURATION=350;t.DEFAULTS={toggle:!0};t.prototype.dimension=function(){var n=this.$element.hasClass("width");return n?"width":"height"};t.prototype.show=function(){var f,r,e,u,o,s;if(!this.transitioning&&!this.$element.hasClass("in")&&(r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing"),!r||!r.length||(f=r.data("bs.collapse"),!f||!f.transitioning))&&(e=n.Event("show.bs.collapse"),this.$element.trigger(e),!e.isDefaultPrevented())){if(r&&r.length&&(i.call(r,"hide"),f||r.data("bs.collapse",null)),u=this.dimension(),this.$element.removeClass("collapse").addClass("collapsing")[u](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1,o=function(){this.$element.removeClass("collapsing").addClass("collapse in")[u]("");this.transitioning=0;this.$element.trigger("shown.bs.collapse")},!n.support.transition)return o.call(this);s=n.camelCase(["scroll",u].join("-"));this.$element.one("bsTransitionEnd",n.proxy(o,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[u](this.$element[0][s])}};t.prototype.hide=function(){var r,i,u;if(!this.transitioning&&this.$element.hasClass("in")&&(r=n.Event("hide.bs.collapse"),this.$element.trigger(r),!r.isDefaultPrevented())){if(i=this.dimension(),this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1,u=function(){this.transitioning=0;this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")},!n.support.transition)return u.call(this);this.$element[i](0).one("bsTransitionEnd",n.proxy(u,this)).emulateTransitionEnd(t.TRANSITION_DURATION)}};t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};t.prototype.getParent=function(){return n(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(n.proxy(function(t,i){var u=n(i);this.addAriaAndCollapsedClass(r(u),u)},this)).end()};t.prototype.addAriaAndCollapsedClass=function(n,t){var i=n.hasClass("in");n.attr("aria-expanded",i);t.toggleClass("collapsed",!i).attr("aria-expanded",i)};u=n.fn.collapse;n.fn.collapse=i;n.fn.collapse.Constructor=t;n.fn.collapse.noConflict=function(){return n.fn.collapse=u,this};n(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var u=n(this);u.attr("data-target")||t.preventDefault();var f=r(u),e=f.data("bs.collapse"),o=e?"toggle":u.data();i.call(f,o)})}(jQuery);+function(n){"use strict";function r(t){var i=t.attr("data-target"),r;return i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),r=i&&n(i),r&&r.length?r:t.parent()}function u(t){t&&t.which===3||(n(e).remove(),n(i).each(function(){var u=n(this),i=r(u),f={relatedTarget:this};i.hasClass("open")&&(t&&t.type=="click"&&/input|textarea/i.test(t.target.tagName)&&n.contains(i[0],t.target)||(i.trigger(t=n.Event("hide.bs.dropdown",f)),t.isDefaultPrevented())||(u.attr("aria-expanded","false"),i.removeClass("open").trigger("hidden.bs.dropdown",f)))}))}function o(i){return this.each(function(){var r=n(this),u=r.data("bs.dropdown");u||r.data("bs.dropdown",u=new t(this));typeof i=="string"&&u[i].call(r)})}var e=".dropdown-backdrop",i='[data-toggle="dropdown"]',t=function(t){n(t).on("click.bs.dropdown",this.toggle)},f;t.VERSION="3.3.5";t.prototype.toggle=function(t){var f=n(this),i,o,e;if(!f.is(".disabled, :disabled")){if(i=r(f),o=i.hasClass("open"),u(),!o){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length)n(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(n(this)).on("click",u);if(e={relatedTarget:this},i.trigger(t=n.Event("show.bs.dropdown",e)),t.isDefaultPrevented())return;f.trigger("focus").attr("aria-expanded","true");i.toggleClass("open").trigger("shown.bs.dropdown",e)}return!1}};t.prototype.keydown=function(t){var e,o,s,h,f,u;if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)&&(e=n(this),t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled"))){if(o=r(e),s=o.hasClass("open"),!s&&t.which!=27||s&&t.which==27)return t.which==27&&o.find(i).trigger("focus"),e.trigger("click");(h=" li:not(.disabled):visible a",f=o.find(".dropdown-menu"+h),f.length)&&(u=f.index(t.target),t.which==38&&u>0&&u--,t.which==40&&u<f.length-1&&u++,~u||(u=0),f.eq(u).trigger("focus"))}};f=n.fn.dropdown;n.fn.dropdown=o;n.fn.dropdown.Constructor=t;n.fn.dropdown.noConflict=function(){return n.fn.dropdown=f,this};n(document).on("click.bs.dropdown.data-api",u).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation()}).on("click.bs.dropdown.data-api",i,t.prototype.toggle).on("keydown.bs.dropdown.data-api",i,t.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",t.prototype.keydown)}(jQuery);+function(n){"use strict";function i(i,r){return this.each(function(){var f=n(this),u=f.data("bs.modal"),e=n.extend({},t.DEFAULTS,f.data(),typeof i=="object"&&i);u||f.data("bs.modal",u=new t(this,e));typeof i=="string"?u[i](r):e.show&&u.show(r)})}var t=function(t,i){this.options=i;this.$body=n(document.body);this.$element=n(t);this.$dialog=this.$element.find(".modal-dialog");this.$backdrop=null;this.isShown=null;this.originalBodyPad=null;this.scrollbarWidth=0;this.ignoreBackdropClick=!1;this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,n.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))},r;t.VERSION="3.3.5";t.TRANSITION_DURATION=300;t.BACKDROP_TRANSITION_DURATION=150;t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0};t.prototype.toggle=function(n){return this.isShown?this.hide():this.show(n)};t.prototype.show=function(i){var r=this,u=n.Event("show.bs.modal",{relatedTarget:i});if(this.$element.trigger(u),!this.isShown&&!u.isDefaultPrevented()){this.isShown=!0;this.checkScrollbar();this.setScrollbar();this.$body.addClass("modal-open");this.escape();this.resize();this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this));this.$dialog.on("mousedown.dismiss.bs.modal",function(){r.$element.one("mouseup.dismiss.bs.modal",function(t){n(t.target).is(r.$element)&&(r.ignoreBackdropClick=!0)})});this.backdrop(function(){var f=n.support.transition&&r.$element.hasClass("fade"),u;r.$element.parent().length||r.$element.appendTo(r.$body);r.$element.show().scrollTop(0);r.adjustDialog();f&&r.$element[0].offsetWidth;r.$element.addClass("in");r.enforceFocus();u=n.Event("shown.bs.modal",{relatedTarget:i});f?r.$dialog.one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(u)}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(u)})}};t.prototype.hide=function(i){(i&&i.preventDefault(),i=n.Event("hide.bs.modal"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented())&&(this.isShown=!1,this.escape(),this.resize(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",n.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal())};t.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(n){this.$element[0]===n.target||this.$element.has(n.target).length||this.$element.trigger("focus")},this))};t.prototype.escape=function(){if(this.isShown&&this.options.keyboard)this.$element.on("keydown.dismiss.bs.modal",n.proxy(function(n){n.which==27&&this.hide()},this));else this.isShown||this.$element.off("keydown.dismiss.bs.modal")};t.prototype.resize=function(){if(this.isShown)n(window).on("resize.bs.modal",n.proxy(this.handleUpdate,this));else n(window).off("resize.bs.modal")};t.prototype.hideModal=function(){var n=this;this.$element.hide();this.backdrop(function(){n.$body.removeClass("modal-open");n.resetAdjustments();n.resetScrollbar();n.$element.trigger("hidden.bs.modal")})};t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null};t.prototype.backdrop=function(i){var e=this,f=this.$element.hasClass("fade")?"fade":"",r,u;if(this.isShown&&this.options.backdrop){r=n.support.transition&&f;this.$backdrop=n(document.createElement("div")).addClass("modal-backdrop "+f).appendTo(this.$body);this.$element.on("click.dismiss.bs.modal",n.proxy(function(n){if(this.ignoreBackdropClick){this.ignoreBackdropClick=!1;return}n.target===n.currentTarget&&(this.options.backdrop=="static"?this.$element[0].focus():this.hide())},this));if(r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;r?this.$backdrop.one("bsTransitionEnd",i).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):i()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),u=function(){e.removeBackdrop();i&&i()},n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",u).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):u()):i&&i()};t.prototype.handleUpdate=function(){this.adjustDialog()};t.prototype.adjustDialog=function(){var n=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&n?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!n?this.scrollbarWidth:""})};t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})};t.prototype.checkScrollbar=function(){var n=window.innerWidth,t;n||(t=document.documentElement.getBoundingClientRect(),n=t.right-Math.abs(t.left));this.bodyIsOverflowing=document.body.clientWidth<n;this.scrollbarWidth=this.measureScrollbar()};t.prototype.setScrollbar=function(){var n=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";this.bodyIsOverflowing&&this.$body.css("padding-right",n+this.scrollbarWidth)};t.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)};t.prototype.measureScrollbar=function(){var n=document.createElement("div"),t;return n.className="modal-scrollbar-measure",this.$body.append(n),t=n.offsetWidth-n.clientWidth,this.$body[0].removeChild(n),t};r=n.fn.modal;n.fn.modal=i;n.fn.modal.Constructor=t;n.fn.modal.noConflict=function(){return n.fn.modal=r,this};n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=n(this),f=r.attr("href"),u=n(r.attr("data-target")||f&&f.replace(/.*(?=#[^\s]+$)/,"")),e=u.data("bs.modal")?"toggle":n.extend({remote:!/#/.test(f)&&f},u.data(),r.data());r.is("a")&&t.preventDefault();u.one("show.bs.modal",function(n){if(!n.isDefaultPrevented())u.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})});i.call(u,e,this)})}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tooltip"),f=typeof i=="object"&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.tooltip",r=new t(this,f)),typeof i=="string"&&r[i]())})}var t=function(n,t){this.type=null;this.options=null;this.enabled=null;this.timeout=null;this.hoverState=null;this.$element=null;this.inState=null;this.init("tooltip",n,t)},i;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}};t.prototype.init=function(t,i,r){var f,e,u,o,s;if(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&n(n.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(f=this.options.trigger.split(" "),e=f.length;e--;)if(u=f[e],u=="click")this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else if(u!="manual"){o=u=="hover"?"mouseenter":"focusin";s=u=="hover"?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this));this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this))}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()};t.prototype.getDefaults=function(){return t.DEFAULTS};t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t};t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r)}),t};t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState[t.type=="focusin"?"focus":"hover"]=!0),i.tip().hasClass("in")||i.hoverState=="in"){i.hoverState="in";return}if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)};t.prototype.isInStateTrue=function(){for(var n in this.inState)if(this.inState[n])return!0;return!1};t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)),t instanceof n.Event&&(i.inState[t.type=="focusout"?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){i.hoverState=="out"&&i.hide()},i.options.delay.hide)}};t.prototype.show=function(){var c=n.Event("show.bs."+this.type),l,p,e,w,h;if(this.hasContent()&&this.enabled){if(this.$element.trigger(c),l=n.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]),c.isDefaultPrevented()||!l)return;var u=this,r=this.tip(),a=this.getUID(this.type);this.setContent();r.attr("id",a);this.$element.attr("aria-describedby",a);this.options.animation&&r.addClass("fade");var i=typeof this.options.placement=="function"?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,v=/\s?auto?\s?/i,y=v.test(i);y&&(i=i.replace(v,"")||"top");r.detach().css({top:0,left:0,display:"block"}).addClass(i).data("bs."+this.type,this);this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);this.$element.trigger("inserted.bs."+this.type);var f=this.getPosition(),o=r[0].offsetWidth,s=r[0].offsetHeight;y&&(p=i,e=this.getPosition(this.$viewport),i=i=="bottom"&&f.bottom+s>e.bottom?"top":i=="top"&&f.top-s<e.top?"bottom":i=="right"&&f.right+o>e.width?"left":i=="left"&&f.left-o<e.left?"right":i,r.removeClass(p).addClass(i));w=this.getCalculatedOffset(i,f,o,s);this.applyPlacement(w,i);h=function(){var n=u.hoverState;u.$element.trigger("shown.bs."+u.type);u.hoverState=null;n=="out"&&u.leave(u)};n.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",h).emulateTransitionEnd(t.TRANSITION_DURATION):h()}};t.prototype.applyPlacement=function(t,i){var r=this.tip(),l=r[0].offsetWidth,e=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10),h,f,u;isNaN(o)&&(o=0);isNaN(s)&&(s=0);t.top+=o;t.left+=s;n.offset.setOffset(r[0],n.extend({using:function(n){r.css({top:Math.round(n.top),left:Math.round(n.left)})}},t),0);r.addClass("in");h=r[0].offsetWidth;f=r[0].offsetHeight;i=="top"&&f!=e&&(t.top=t.top+e-f);u=this.getViewportAdjustedDelta(i,t,h,f);u.left?t.left+=u.left:t.top+=u.top;var c=/top|bottom/.test(i),a=c?u.left*2-l+h:u.top*2-e+f,v=c?"offsetWidth":"offsetHeight";r.offset(t);this.replaceArrow(a,r[0][v],c)};t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i?"left":"top",50*(1-n/t)+"%").css(i?"top":"left","")};t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t);n.removeClass("fade in top bottom left right")};t.prototype.hide=function(i){function e(){u.hoverState!="in"&&r.detach();u.$element.removeAttr("aria-describedby").trigger("hidden.bs."+u.type);i&&i()}var u=this,r=n(this.$tip),f=n.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return r.removeClass("in"),n.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",e).emulateTransitionEnd(t.TRANSITION_DURATION):e(),this.hoverState=null,this};t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","")};t.prototype.hasContent=function(){return this.getTitle()};t.prototype.getPosition=function(t){t=t||this.$element;var u=t[0],r=u.tagName=="BODY",i=u.getBoundingClientRect();i.width==null&&(i=n.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var f=r?{top:0,left:0}:t.offset(),e={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},o=r?{width:n(window).width(),height:n(window).height()}:null;return n.extend({},i,e,o,f)};t.prototype.getCalculatedOffset=function(n,t,i,r){return n=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-i/2}:n=="top"?{top:t.top-r,left:t.left+t.width/2-i/2}:n=="left"?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width}};t.prototype.getViewportAdjustedDelta=function(n,t,i,r){var f={top:0,left:0},e,u,o,s,h,c;return this.$viewport?(e=this.options.viewport&&this.options.viewport.padding||0,u=this.getPosition(this.$viewport),/right|left/.test(n)?(o=t.top-e-u.scroll,s=t.top+e-u.scroll+r,o<u.top?f.top=u.top-o:s>u.top+u.height&&(f.top=u.top+u.height-s)):(h=t.left-e,c=t.left+e+i,h<u.left?f.left=u.left-h:c>u.right&&(f.left=u.left+u.width-c)),f):f};t.prototype.getTitle=function(){var t=this.$element,n=this.options;return t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title)};t.prototype.getUID=function(n){do n+=~~(Math.random()*1e6);while(document.getElementById(n));return n};t.prototype.tip=function(){if(!this.$tip&&(this.$tip=n(this.options.template),this.$tip.length!=1))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")};t.prototype.enable=function(){this.enabled=!0};t.prototype.disable=function(){this.enabled=!1};t.prototype.toggleEnabled=function(){this.enabled=!this.enabled};t.prototype.toggle=function(t){var i=this;t&&(i=n(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),n(t.currentTarget).data("bs."+this.type,i)));t?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)};t.prototype.destroy=function(){var n=this;clearTimeout(this.timeout);this.hide(function(){n.$element.off("."+n.type).removeData("bs."+n.type);n.$tip&&n.$tip.detach();n.$tip=null;n.$arrow=null;n.$viewport=null})};i=n.fn.tooltip;n.fn.tooltip=r;n.fn.tooltip.Constructor=t;n.fn.tooltip.noConflict=function(){return n.fn.tooltip=i,this}}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.popover"),f=typeof i=="object"&&i;(r||!/destroy|hide/.test(i))&&(r||u.data("bs.popover",r=new t(this,f)),typeof i=="string"&&r[i]())})}var t=function(n,t){this.init("popover",n,t)},i;if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.5";t.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"><\/div><h3 class="popover-title"><\/h3><div class="popover-content"><\/div><\/div>'});t.prototype=n.extend({},n.fn.tooltip.Constructor.prototype);t.prototype.constructor=t;t.prototype.getDefaults=function(){return t.DEFAULTS};t.prototype.setContent=function(){var n=this.tip(),i=this.getTitle(),t=this.getContent();n.find(".popover-title")[this.options.html?"html":"text"](i);n.find(".popover-content").children().detach().end()[this.options.html?typeof t=="string"?"html":"append":"text"](t);n.removeClass("fade top bottom left right in");n.find(".popover-title").html()||n.find(".popover-title").hide()};t.prototype.hasContent=function(){return this.getTitle()||this.getContent()};t.prototype.getContent=function(){var t=this.$element,n=this.options;return t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content)};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};i=n.fn.popover;n.fn.popover=r;n.fn.popover.Constructor=t;n.fn.popover.noConflict=function(){return n.fn.popover=i,this}}(jQuery);+function(n){"use strict";function t(i,r){this.$body=n(document.body);this.$scrollElement=n(i).is(document.body)?n(window):n(i);this.options=n.extend({},t.DEFAULTS,r);this.selector=(this.options.target||"")+" .nav li > a";this.offsets=[];this.targets=[];this.activeTarget=null;this.scrollHeight=0;this.$scrollElement.on("scroll.bs.scrollspy",n.proxy(this.process,this));this.refresh();this.process()}function i(i){return this.each(function(){var u=n(this),r=u.data("bs.scrollspy"),f=typeof i=="object"&&i;r||u.data("bs.scrollspy",r=new t(this,f));typeof i=="string"&&r[i]()})}t.VERSION="3.3.5";t.DEFAULTS={offset:10};t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)};t.prototype.refresh=function(){var t=this,i="offset",r=0;this.offsets=[];this.targets=[];this.scrollHeight=this.getScrollHeight();n.isWindow(this.$scrollElement[0])||(i="position",r=this.$scrollElement.scrollTop());this.$body.find(this.selector).map(function(){var f=n(this),u=f.data("target")||f.attr("href"),t=/^#./.test(u)&&n(u);return t&&t.length&&t.is(":visible")&&[[t[i]().top+r,u]]||null}).sort(function(n,t){return n[0]-t[0]}).each(function(){t.offsets.push(this[0]);t.targets.push(this[1])})};t.prototype.process=function(){var i=this.$scrollElement.scrollTop()+this.options.offset,f=this.getScrollHeight(),e=this.options.offset+f-this.$scrollElement.height(),t=this.offsets,r=this.targets,u=this.activeTarget,n;if(this.scrollHeight!=f&&this.refresh(),i>=e)return u!=(n=r[r.length-1])&&this.activate(n);if(u&&i<t[0])return this.activeTarget=null,this.clear();for(n=t.length;n--;)u!=r[n]&&i>=t[n]&&(t[n+1]===undefined||i<t[n+1])&&this.activate(r[n])};t.prototype.activate=function(t){this.activeTarget=t;this.clear();var r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=n(r).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active"));i.trigger("activate.bs.scrollspy")};t.prototype.clear=function(){n(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var r=n.fn.scrollspy;n.fn.scrollspy=i;n.fn.scrollspy.Constructor=t;n.fn.scrollspy.noConflict=function(){return n.fn.scrollspy=r,this};n(window).on("load.bs.scrollspy.data-api",function(){n('[data-spy="scroll"]').each(function(){var t=n(this);i.call(t,t.data())})})}(jQuery);+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.tab");r||u.data("bs.tab",r=new t(this));typeof i=="string"&&r[i]()})}var t=function(t){this.element=n(t)},u,i;t.VERSION="3.3.5";t.TRANSITION_DURATION=150;t.prototype.show=function(){var t=this.element,f=t.closest("ul:not(.dropdown-menu)"),i=t.data("target"),u;if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=f.find(".active:last a"),e=n.Event("hide.bs.tab",{relatedTarget:t[0]}),o=n.Event("show.bs.tab",{relatedTarget:r[0]});(r.trigger(e),t.trigger(o),o.isDefaultPrevented()||e.isDefaultPrevented())||(u=n(i),this.activate(t.closest("li"),f),this.activate(u,u.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:t[0]});t.trigger({type:"shown.bs.tab",relatedTarget:r[0]})}))}};t.prototype.activate=function(i,r,u){function o(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1);i.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0);e?(i[0].offsetWidth,i.addClass("in")):i.removeClass("fade");i.parent(".dropdown-menu").length&&i.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0);u&&u()}var f=r.find("> .active"),e=u&&n.support.transition&&(f.length&&f.hasClass("fade")||!!r.find("> .fade").length);f.length&&e?f.one("bsTransitionEnd",o).emulateTransitionEnd(t.TRANSITION_DURATION):o();f.removeClass("in")};u=n.fn.tab;n.fn.tab=r;n.fn.tab.Constructor=t;n.fn.tab.noConflict=function(){return n.fn.tab=u,this};i=function(t){t.preventDefault();r.call(n(this),"show")};n(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.affix"),f=typeof i=="object"&&i;r||u.data("bs.affix",r=new t(this,f));typeof i=="string"&&r[i]()})}var t=function(i,r){this.options=n.extend({},t.DEFAULTS,r);this.$target=n(this.options.target).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this));this.$element=n(i);this.affixed=null;this.unpin=null;this.pinnedOffset=null;this.checkPosition()},r;t.VERSION="3.3.5";t.RESET="affix affix-top affix-bottom";t.DEFAULTS={offset:0,target:window};t.prototype.getState=function(n,t,i,r){var u=this.$target.scrollTop(),f=this.$element.offset(),e=this.$target.height();if(i!=null&&this.affixed=="top")return u<i?"top":!1;if(this.affixed=="bottom")return i!=null?u+this.unpin<=f.top?!1:"bottom":u+e<=n-r?!1:"bottom";var o=this.affixed==null,s=o?u:f.top,h=o?e:t;return i!=null&&u<=i?"top":r!=null&&s+h>=n-r?"bottom":!1};t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var n=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-n};t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1)};t.prototype.checkPosition=function(){var i,e,o;if(this.$element.is(":visible")){var s=this.$element.height(),r=this.options.offset,f=r.top,u=r.bottom,h=Math.max(n(document).height(),n(document.body).height());if(typeof r!="object"&&(u=f=r),typeof f=="function"&&(f=r.top(this.$element)),typeof u=="function"&&(u=r.bottom(this.$element)),i=this.getState(h,s,f,u),this.affixed!=i){if(this.unpin!=null&&this.$element.css("top",""),e="affix"+(i?"-"+i:""),o=n.Event(e+".bs.affix"),this.$element.trigger(o),o.isDefaultPrevented())return;this.affixed=i;this.unpin=i=="bottom"?this.getPinnedOffset():null;this.$element.removeClass(t.RESET).addClass(e).trigger(e.replace("affix","affixed")+".bs.affix")}i=="bottom"&&this.$element.offset({top:h-s-u})}};r=n.fn.affix;n.fn.affix=i;n.fn.affix.Constructor=t;n.fn.affix.noConflict=function(){return n.fn.affix=r,this};n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var r=n(this),t=r.data();t.offset=t.offset||{};t.offsetBottom!=null&&(t.offset.bottom=t.offsetBottom);t.offsetTop!=null&&(t.offset.top=t.offsetTop);i.call(r,t)})})}(jQuery);
/*! ========================================================================
 * Bootstrap Toggle: bootstrap-toggle.js v2.2.0
 * http://www.bootstraptoggle.com
 * ========================================================================
 * Copyright 2014 Min Hur, The New York Times Company
 * Licensed under MIT
 * ======================================================================== */
+function(n){"use strict";function r(i){return this.each(function(){var u=n(this),r=u.data("bs.toggle"),f=typeof i=="object"&&i;r||u.data("bs.toggle",r=new t(this,f));typeof i=="string"&&r[i]&&r[i]()})}var t=function(t,i){this.$element=n(t);this.options=n.extend({},this.defaults(),i);this.render()},i;t.VERSION="2.2.0";t.DEFAULTS={on:"On",off:"Off",onstyle:"primary",offstyle:"default",size:"normal",style:"",width:null,height:null};t.prototype.defaults=function(){return{on:this.$element.attr("data-on")||t.DEFAULTS.on,off:this.$element.attr("data-off")||t.DEFAULTS.off,onstyle:this.$element.attr("data-onstyle")||t.DEFAULTS.onstyle,offstyle:this.$element.attr("data-offstyle")||t.DEFAULTS.offstyle,size:this.$element.attr("data-size")||t.DEFAULTS.size,style:this.$element.attr("data-style")||t.DEFAULTS.style,width:this.$element.attr("data-width")||t.DEFAULTS.width,height:this.$element.attr("data-height")||t.DEFAULTS.height}};t.prototype.render=function(){var e,o;this._onstyle="btn-"+this.options.onstyle;this._offstyle="btn-"+this.options.offstyle;var r=this.options.size==="large"?"btn-lg":this.options.size==="small"?"btn-sm":this.options.size==="mini"?"btn-xs":"",t=n('<label class="btn">').html(this.options.on).addClass(this._onstyle+" "+r),i=n('<label class="btn">').html(this.options.off).addClass(this._offstyle+" "+r+" active"),u=n('<span class="toggle-handle btn btn-default">').addClass(r),f=n('<div class="toggle-group">').append(t,i,u),s=n('<div class="toggle btn" data-toggle="toggle">').addClass(this.$element.prop("checked")?this._onstyle:this._offstyle+" off").addClass(r).addClass(this.options.style);this.$element.wrap(s);n.extend(this,{$toggle:this.$element.parent(),$toggleOn:t,$toggleOff:i,$toggleGroup:f});this.$toggle.append(f);e=this.options.width||Math.max(t.outerWidth(),i.outerWidth())+u.outerWidth()/2;o=this.options.height||Math.max(t.outerHeight(),i.outerHeight());t.addClass("toggle-on");i.addClass("toggle-off");this.$toggle.css({width:e,height:o});this.options.height&&(t.css("line-height",t.height()+"px"),i.css("line-height",i.height()+"px"));this.update(!0);this.trigger(!0)};t.prototype.toggle=function(){this.$element.prop("checked")?this.off():this.on()};t.prototype.on=function(n){if(this.$element.prop("disabled"))return!1;this.$toggle.removeClass(this._offstyle+" off").addClass(this._onstyle);this.$element.prop("checked",!0);n||this.trigger()};t.prototype.off=function(n){if(this.$element.prop("disabled"))return!1;this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+" off");this.$element.prop("checked",!1);n||this.trigger()};t.prototype.enable=function(){this.$toggle.removeAttr("disabled");this.$element.prop("disabled",!1)};t.prototype.disable=function(){this.$toggle.attr("disabled","disabled");this.$element.prop("disabled",!0)};t.prototype.update=function(n){if(this.$element.prop("disabled")?this.disable():this.enable(),this.$element.prop("checked"))this.on(n);else this.off(n)};t.prototype.trigger=function(t){this.$element.off("change.bs.toggle");t||this.$element.change();this.$element.on("change.bs.toggle",n.proxy(function(){this.update()},this))};t.prototype.destroy=function(){this.$element.off("change.bs.toggle");this.$toggleGroup.remove();this.$element.removeData("bs.toggle");this.$element.unwrap()};i=n.fn.bootstrapToggle;n.fn.bootstrapToggle=r;n.fn.bootstrapToggle.Constructor=t;n.fn.toggle.noConflict=function(){return n.fn.bootstrapToggle=i,this};n(function(){n("input[type=checkbox][data-toggle^=toggle]").bootstrapToggle()});n(document).on("click.bs.toggle","div[data-toggle^=toggle]",function(t){var i=n(this).find("input[type=checkbox]");i.bootstrapToggle("toggle");t.preventDefault()})}(jQuery);
/*!
 * Bootstrap-select v1.9.3 (http://silviomoreto.github.io/bootstrap-select)
 *
 * Copyright 2013-2015 bootstrap-select
 * Licensed under MIT (https://github.com/silviomoreto/bootstrap-select/blob/master/LICENSE)
 */
(function(n,t){typeof define=="function"&&define.amd?define(["jquery"],function(n){return t(n)}):typeof exports=="object"?module.exports=t(require("jquery")):t(jQuery)})(this,function(n){(function(n){"use strict";function i(t){return n.each([{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xC7-\xE7]/g,ch:"c"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}],function(){t=t.replace(this.re,this.ch)}),t}function r(n){var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(i).join("|")+")",u=new RegExp(r),f=new RegExp(r,"g"),t=n==null?"":""+n;return u.test(t)?t.replace(f,function(n){return i[n]}):t}function u(i,r){var e=arguments,u=i,s=r,f,o;return[].shift.apply(e),o=this.each(function(){var o=n(this),i,r,c,h;if(o.is("select")){if(i=o.data("selectpicker"),r=typeof u=="object"&&u,i){if(r)for(h in r)r.hasOwnProperty(h)&&(i.options[h]=r[h])}else c=n.extend({},t.DEFAULTS,n.fn.selectpicker.defaults||{},o.data(),r),c.template=n.extend({},t.DEFAULTS.template,n.fn.selectpicker.defaults?n.fn.selectpicker.defaults.template:{},o.data().template,r.template),o.data("selectpicker",i=new t(this,c,s));typeof u=="string"&&(f=i[u]instanceof Function?i[u].apply(i,e):i.options[u])}}),typeof f!="undefined"?f:o}var t,f;String.prototype.includes||function(){var i={}.toString,n=function(){try{var n={},t=Object.defineProperty,i=t(n,n,n)&&t}catch(r){}return i}(),r="".indexOf,t=function(n){var u,s;if(this==null)throw new TypeError;if(u=String(this),n&&i.call(n)=="[object RegExp]")throw new TypeError;var f=u.length,e=String(n),h=e.length,o=arguments.length>1?arguments[1]:undefined,t=o?Number(o):0;return(t!=t&&(t=0),s=Math.min(Math.max(t,0),f),h+s>f)?!1:r.call(u,e,t)!=-1};n?n(String.prototype,"includes",{value:t,configurable:!0,writable:!0}):String.prototype.includes=t}();String.prototype.startsWith||function(){var n=function(){try{var n={},t=Object.defineProperty,i=t(n,n,n)&&t}catch(r){}return i}(),i={}.toString,t=function(n){var u,f,r;if(this==null)throw new TypeError;if(u=String(this),n&&i.call(n)=="[object RegExp]")throw new TypeError;var e=u.length,o=String(n),s=o.length,h=arguments.length>1?arguments[1]:undefined,t=h?Number(h):0;if(t!=t&&(t=0),f=Math.min(Math.max(t,0),e),s+f>e)return!1;for(r=-1;++r<s;)if(u.charCodeAt(f+r)!=o.charCodeAt(r))return!1;return!0};n?n(String.prototype,"startsWith",{value:t,configurable:!0,writable:!0}):String.prototype.startsWith=t}();Object.keys||(Object.keys=function(n,t,i){i=[];for(t in n)i.hasOwnProperty.call(n,t)&&i.push(t);return i});n.fn.triggerNative=function(n){var i=this[0],t;i.dispatchEvent?(typeof Event=="function"?t=new Event(n,{bubbles:!0}):(t=document.createEvent("Event"),t.initEvent(n,!0,!1)),i.dispatchEvent(t)):(i.fireEvent&&(t=document.createEventObject(),t.eventType=n,i.fireEvent("on"+n,t)),this.trigger(n))};n.expr[":"].icontains=function(t,i,r){var u=n(t),f=(u.data("tokens")||u.text()).toUpperCase();return f.includes(r[3].toUpperCase())};n.expr[":"].ibegins=function(t,i,r){var u=n(t),f=(u.data("tokens")||u.text()).toUpperCase();return f.startsWith(r[3].toUpperCase())};n.expr[":"].aicontains=function(t,i,r){var u=n(t),f=(u.data("tokens")||u.data("normalizedText")||u.text()).toUpperCase();return f.includes(r[3].toUpperCase())};n.expr[":"].aibegins=function(t,i,r){var u=n(t),f=(u.data("tokens")||u.data("normalizedText")||u.text()).toUpperCase();return f.startsWith(r[3].toUpperCase())};t=function(i,r,u){u&&(u.stopPropagation(),u.preventDefault());this.$element=n(i);this.$newElement=null;this.$button=null;this.$menu=null;this.$lis=null;this.options=r;this.options.title===null&&(this.options.title=this.$element.attr("title"));this.val=t.prototype.val;this.render=t.prototype.render;this.refresh=t.prototype.refresh;this.setStyle=t.prototype.setStyle;this.selectAll=t.prototype.selectAll;this.deselectAll=t.prototype.deselectAll;this.destroy=t.prototype.destroy;this.remove=t.prototype.remove;this.show=t.prototype.show;this.hide=t.prototype.hide;this.init()};t.VERSION="1.9.3";t.DEFAULTS={noneSelectedText:"Nothing selected",noneResultsText:"No results matched {0}",countSelectedText:function(n){return n==1?"{0} item selected":"{0} items selected"},maxOptionsText:function(n,t){return[n==1?"Limit reached ({n} item max)":"Limit reached ({n} items max)",t==1?"Group limit reached ({n} item max)":"Group limit reached ({n} items max)"]},selectAllText:"Select All",deselectAllText:"Deselect All",doneButton:!1,doneButtonText:"Close",multipleSeparator:", ",styleBase:"btn",style:"btn-default",size:"auto",title:null,selectedTextFormat:"values",width:!1,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0,showContent:!0,dropupAuto:!0,header:!1,liveSearch:!1,liveSearchPlaceholder:null,liveSearchNormalize:!1,liveSearchStyle:"contains",actionsBox:!1,iconBase:"glyphicon",tickIcon:"glyphicon-ok",template:{caret:'<span class="caret"><\/span>'},maxOptions:!1,mobile:!1,selectOnTab:!1,dropdownAlignRight:!1};t.prototype={constructor:t,init:function(){var t=this,i=this.$element.attr("id");this.liObj={};this.multiple=this.$element.prop("multiple");this.autofocus=this.$element.prop("autofocus");this.$newElement=this.createView();this.$element.after(this.$newElement).appendTo(this.$newElement);this.$button=this.$newElement.children("button");this.$menu=this.$newElement.children(".dropdown-menu");this.$menuInner=this.$menu.children(".inner");this.$searchbox=this.$menu.find("input");this.options.dropdownAlignRight&&this.$menu.addClass("dropdown-menu-right");typeof i!="undefined"&&(this.$button.attr("data-id",i),n('label[for="'+i+'"]').click(function(n){n.preventDefault();t.$button.focus()}));this.checkDisabled();this.clickListener();this.options.liveSearch&&this.liveSearchListener();this.render();this.setStyle();this.setWidth();this.options.container&&this.selectPosition();this.$menu.data("this",this);this.$newElement.data("this",this);this.options.mobile&&this.mobile();this.$newElement.on({"hide.bs.dropdown":function(n){t.$element.trigger("hide.bs.select",n)},"hidden.bs.dropdown":function(n){t.$element.trigger("hidden.bs.select",n)},"show.bs.dropdown":function(n){t.$element.trigger("show.bs.select",n)},"shown.bs.dropdown":function(n){t.$element.trigger("shown.bs.select",n)}});if(t.$element[0].hasAttribute("required"))this.$element.on("invalid",function(){t.$button.addClass("bs-invalid").focus();t.$element.on({"focus.bs.select":function(){t.$button.focus();t.$element.off("focus.bs.select")},"shown.bs.select":function(){t.$element.val(t.$element.val()).off("shown.bs.select")},"rendered.bs.select":function(){this.validity.valid&&t.$button.removeClass("bs-invalid");t.$element.off("rendered.bs.select")}})});setTimeout(function(){t.$element.trigger("loaded.bs.select")})},createDropdown:function(){var t=this.multiple?" show-tick":"",i=this.$element.parent().hasClass("input-group")?" input-group-btn":"",u=this.autofocus?" autofocus":"",f=this.options.header?'<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;<\/button>'+this.options.header+"<\/div>":"",e=this.options.liveSearch?'<div class="bs-searchbox"><input type="text" class="form-control" autocomplete="off"'+(null===this.options.liveSearchPlaceholder?"":' placeholder="'+r(this.options.liveSearchPlaceholder)+'"')+"><\/div>":"",o=this.multiple&&this.options.actionsBox?'<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn btn-default">'+this.options.selectAllText+'<\/button><button type="button" class="actions-btn bs-deselect-all btn btn-default">'+this.options.deselectAllText+"<\/button><\/div><\/div>":"",s=this.multiple&&this.options.doneButton?'<div class="bs-donebutton"><div class="btn-group btn-block"><button type="button" class="btn btn-sm btn-default">'+this.options.doneButtonText+"<\/button><\/div><\/div>":"",h='<div class="btn-group bootstrap-select'+t+i+'"><button type="button" class="'+this.options.styleBase+' dropdown-toggle" data-toggle="dropdown"'+u+'><span class="filter-option pull-left"><\/span>&nbsp;<span class="bs-caret">'+this.options.template.caret+'<\/span><\/button><div class="dropdown-menu open">'+f+e+o+'<ul class="dropdown-menu inner" role="menu"><\/ul>'+s+"<\/div><\/div>";return n(h)},createView:function(){var n=this.createDropdown(),t=this.createLi();return n.find("ul")[0].innerHTML=t,n},reloadLi:function(){this.destroyLi();var n=this.createLi();this.$menuInner[0].innerHTML=n},destroyLi:function(){this.$menu.find("li").remove()},createLi:function(){var u=this,t=[],o=0,s=document.createElement("option"),f=-1,e=function(n,t,i,r){return"<li"+(typeof i!="undefined"&""!==i?' class="'+i+'"':"")+(typeof t!="undefined"&null!==t?' data-original-index="'+t+'"':"")+(typeof r!="undefined"&null!==r?'data-optgroup="'+r+'"':"")+">"+n+"<\/li>"},c=function(n,t,f,e){return'<a tabindex="0"'+(typeof t!="undefined"?' class="'+t+'"':"")+(typeof f!="undefined"?' style="'+f+'"':"")+(u.options.liveSearchNormalize?' data-normalized-text="'+i(r(n))+'"':"")+(typeof e!="undefined"||e!==null?' data-tokens="'+e+'"':"")+">"+n+'<span class="'+u.options.iconBase+" "+u.options.tickIcon+' check-mark"><\/span><\/a>'},h;return this.options.title&&!this.multiple&&(f--,this.$element.find(".bs-title-option").length||(h=this.$element[0],s.className="bs-title-option",s.appendChild(document.createTextNode(this.options.title)),s.value="",h.insertBefore(s,h.firstChild),n(h.options[h.selectedIndex]).attr("selected")===undefined&&(s.selected=!0))),this.$element.find("option").each(function(i){var r=n(this),y;if(f++,!r.hasClass("bs-title-option")){var l=this.className||"",a=this.style.cssText,s=r.data("content")?r.data("content"):r.html(),v=r.data("tokens")?r.data("tokens"):null,b=typeof r.data("subtext")!="undefined"?'<small class="text-muted">'+r.data("subtext")+"<\/small>":"",h=typeof r.data("icon")!="undefined"?'<span class="'+u.options.iconBase+" "+r.data("icon")+'"><\/span> ':"",w=this.disabled||this.parentNode.tagName==="OPTGROUP"&&this.parentNode.disabled;if(h!==""&&w&&(h="<span>"+h+"<\/span>"),u.options.hideDisabled&&w){f--;return}if(r.data("content")||(s=h+'<span class="text">'+s+b+"<\/span>"),this.parentNode.tagName==="OPTGROUP"&&r.data("divider")!==!0){if(y=" "+this.parentNode.className||"",r.index()===0){o+=1;var p=this.parentNode.label,k=typeof r.parent().data("subtext")!="undefined"?'<small class="text-muted">'+r.parent().data("subtext")+"<\/small>":"",d=r.parent().data("icon")?'<span class="'+u.options.iconBase+" "+r.parent().data("icon")+'"><\/span> ':"";p=d+'<span class="text">'+p+k+"<\/span>";i!==0&&t.length>0&&(f++,t.push(e("",null,"divider",o+"div")));f++;t.push(e(p,null,"dropdown-header"+y,o))}t.push(e(c(s,"opt "+l+y,a,v),i,"",o))}else r.data("divider")===!0?t.push(e("",i,"divider")):r.data("hidden")===!0?t.push(e(c(s,l,a,v),i,"hidden is-hidden")):(this.previousElementSibling&&this.previousElementSibling.tagName==="OPTGROUP"&&(f++,t.push(e("",null,"divider",o+"div"))),t.push(e(c(s,l,a,v),i)));u.liObj[i]=f}}),this.multiple||this.$element.find("option:selected").length!==0||this.options.title||this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),t.join("")},findLis:function(){return this.$lis==null&&(this.$lis=this.$menu.find("li")),this.$lis},render:function(t){var i=this,o,r,u,f,e,s;t!==!1&&this.$element.find("option").each(function(n){var t=i.findLis().eq(i.liObj[n]);i.setDisabled(n,this.disabled||this.parentNode.tagName==="OPTGROUP"&&this.parentNode.disabled,t);i.setSelected(n,this.selected,t)});this.tabIndex();r=this.$element.find("option").map(function(){if(this.selected){if(i.options.hideDisabled&&(this.disabled||this.parentNode.tagName==="OPTGROUP"&&this.parentNode.disabled))return;var t=n(this),u=t.data("icon")&&i.options.showIcon?'<i class="'+i.options.iconBase+" "+t.data("icon")+'"><\/i> ':"",r;return r=i.options.showSubtext&&t.data("subtext")&&!i.multiple?' <small class="text-muted">'+t.data("subtext")+"<\/small>":"",typeof t.attr("title")!="undefined"?t.attr("title"):t.data("content")&&i.options.showContent?t.data("content"):u+t.html()+r}}).toArray();u=this.multiple?r.join(this.options.multipleSeparator):r[0];this.multiple&&this.options.selectedTextFormat.indexOf("count")>-1&&(f=this.options.selectedTextFormat.split(">"),(f.length>1&&r.length>f[1]||f.length==1&&r.length>=2)&&(o=this.options.hideDisabled?", [disabled]":"",e=this.$element.find("option").not('[data-divider="true"], [data-hidden="true"]'+o).length,s=typeof this.options.countSelectedText=="function"?this.options.countSelectedText(r.length,e):this.options.countSelectedText,u=s.replace("{0}",r.length.toString()).replace("{1}",e.toString())));this.options.title==undefined&&(this.options.title=this.$element.attr("title"));this.options.selectedTextFormat=="static"&&(u=this.options.title);u||(u=typeof this.options.title!="undefined"?this.options.title:this.options.noneSelectedText);this.$button.attr("title",n.trim(u.replace(/<[^>]*>?/g,"")));this.$button.children(".filter-option").html(u);this.$element.trigger("rendered.bs.select")},setStyle:function(n,t){this.$element.attr("class")&&this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|bs-select-hidden|validate\[.*\]/gi,""));var i=n?n:this.options.style;t=="add"?this.$button.addClass(i):t=="remove"?this.$button.removeClass(i):(this.$button.removeClass(this.options.style),this.$button.addClass(i))},liHeight:function(t){var y;if(t||this.options.size!==!1&&!this.sizeInfo){var e=document.createElement("div"),r=document.createElement("div"),o=document.createElement("ul"),l=document.createElement("li"),p=document.createElement("li"),a=document.createElement("a"),v=document.createElement("span"),s=this.options.header&&this.$menu.find(".popover-title").length>0?this.$menu.find(".popover-title")[0].cloneNode(!0):null,u=this.options.liveSearch?document.createElement("div"):null,h=this.options.actionsBox&&this.multiple&&this.$menu.find(".bs-actionsbox").length>0?this.$menu.find(".bs-actionsbox")[0].cloneNode(!0):null,c=this.options.doneButton&&this.multiple&&this.$menu.find(".bs-donebutton").length>0?this.$menu.find(".bs-donebutton")[0].cloneNode(!0):null;v.className="text";e.className=this.$menu[0].parentNode.className+" open";r.className="dropdown-menu open";o.className="dropdown-menu inner";l.className="divider";v.appendChild(document.createTextNode("Inner text"));a.appendChild(v);p.appendChild(a);o.appendChild(p);o.appendChild(l);s&&r.appendChild(s);u&&(y=document.createElement("span"),u.className="bs-searchbox",y.className="form-control",u.appendChild(y),r.appendChild(u));h&&r.appendChild(h);r.appendChild(o);c&&r.appendChild(c);e.appendChild(r);document.body.appendChild(e);var b=a.offsetHeight,k=s?s.offsetHeight:0,d=u?u.offsetHeight:0,g=h?h.offsetHeight:0,nt=c?c.offsetHeight:0,tt=n(l).outerHeight(!0),i=typeof getComputedStyle=="function"?getComputedStyle(r):!1,f=i?null:n(r),w=parseInt(i?i.paddingTop:f.css("paddingTop"))+parseInt(i?i.paddingBottom:f.css("paddingBottom"))+parseInt(i?i.borderTopWidth:f.css("borderTopWidth"))+parseInt(i?i.borderBottomWidth:f.css("borderBottomWidth")),it=w+parseInt(i?i.marginTop:f.css("marginTop"))+parseInt(i?i.marginBottom:f.css("marginBottom"))+2;document.body.removeChild(e);this.sizeInfo={liHeight:b,headerHeight:k,searchHeight:d,actionsHeight:g,doneButtonHeight:nt,dividerHeight:tt,menuPadding:w,menuExtras:it}}},setSize:function(){var h,d,g;if(this.findLis(),this.liHeight(),this.options.header&&this.$menu.css("padding-top",0),this.options.size!==!1){var i=this,t=this.$menu,p=this.$menuInner,c=n(window),nt=this.$newElement[0].offsetHeight,w=this.sizeInfo.liHeight,l=this.sizeInfo.headerHeight,a=this.sizeInfo.searchHeight,v=this.sizeInfo.actionsHeight,y=this.sizeInfo.doneButtonHeight,tt=this.sizeInfo.dividerHeight,o=this.sizeInfo.menuPadding,f=this.sizeInfo.menuExtras,b=this.options.hideDisabled?".disabled":"",r,u,e,s,k=function(){e=i.$newElement.offset().top-c.scrollTop();s=c.height()-e-nt};if(k(),this.options.size==="auto"){h=function(){var h,b=function(t,i){return function(r){return i?r.classList?r.classList.contains(t):n(r).hasClass(t):!(r.classList?r.classList.contains(t):n(r).hasClass(t))}},d=i.$menuInner[0].getElementsByTagName("li"),c=Array.prototype.filter?Array.prototype.filter.call(d,b("hidden",!1)):i.$lis.not(".hidden"),g=Array.prototype.filter?Array.prototype.filter.call(c,b("dropdown-header",!0)):c.filter(".dropdown-header");k();r=s-f;i.options.container?(t.data("height")||t.data("height",t.height()),u=t.data("height")):u=t.height();i.options.dropupAuto&&i.$newElement.toggleClass("dropup",e>s&&r-f<u);i.$newElement.hasClass("dropup")&&(r=e-f);h=c.length+g.length>3?w*3+f-2:0;t.css({"max-height":r+"px",overflow:"hidden","min-height":h+l+a+v+y+"px"});p.css({"max-height":r-l-a-v-y-o+"px","overflow-y":"auto","min-height":Math.max(h-o,0)+"px"})};h();this.$searchbox.off("input.getSize propertychange.getSize").on("input.getSize propertychange.getSize",h);c.off("resize.getSize scroll.getSize").on("resize.getSize scroll.getSize",h)}else this.options.size&&this.options.size!="auto"&&this.$lis.not(b).length>this.options.size&&(d=this.$lis.not(".divider").not(b).children().slice(0,this.options.size).last().parent().index(),g=this.$lis.slice(0,d+1).filter(".divider").length,r=w*this.options.size+g*tt+o,i.options.container?(t.data("height")||t.data("height",t.height()),u=t.data("height")):u=t.height(),i.options.dropupAuto&&this.$newElement.toggleClass("dropup",e>s&&r-f<u),t.css({"max-height":r+l+a+v+y+"px",overflow:"hidden","min-height":""}),p.css({"max-height":r-o+"px","overflow-y":"auto","min-height":""}))}},setWidth:function(){if(this.options.width==="auto"){this.$menu.css("min-width","0");var n=this.$menu.parent().clone().appendTo("body"),t=this.options.container?this.$newElement.clone().appendTo("body"):n,i=n.children(".dropdown-menu").outerWidth(),r=t.css("width","auto").children("button").outerWidth();n.remove();t.remove();this.$newElement.css("width",Math.max(i,r)+"px")}else this.options.width==="fit"?(this.$menu.css("min-width",""),this.$newElement.css("width","").addClass("fit-width")):this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width",this.options.width)):(this.$menu.css("min-width",""),this.$newElement.css("width",""));this.$newElement.hasClass("fit-width")&&this.options.width!=="fit"&&this.$newElement.removeClass("fit-width")},selectPosition:function(){this.$bsContainer=n('<div class="bs-container" />');var t=this,i,r,u=function(n){t.$bsContainer.addClass(n.attr("class").replace(/form-control|fit-width/gi,"")).toggleClass("dropup",n.hasClass("dropup"));i=n.offset();r=n.hasClass("dropup")?0:n[0].offsetHeight;t.$bsContainer.css({top:i.top+r,left:i.left,width:n[0].offsetWidth})};this.$button.on("click",function(){var i=n(this);t.isDisabled()||(u(t.$newElement),t.$bsContainer.appendTo(t.options.container).toggleClass("open",!i.hasClass("open")).append(t.$menu))});n(window).on("resize scroll",function(){u(t.$newElement)});this.$element.on("hide.bs.select",function(){t.$menu.data("height",t.$menu.height());t.$bsContainer.detach()})},setSelected:function(n,t,i){i||(i=this.findLis().eq(this.liObj[n]));i.toggleClass("selected",t)},setDisabled:function(n,t,i){i||(i=this.findLis().eq(this.liObj[n]));t?i.addClass("disabled").children("a").attr("href","#").attr("tabindex",-1):i.removeClass("disabled").children("a").removeAttr("href").attr("tabindex",0)},isDisabled:function(){return this.$element[0].disabled},checkDisabled:function(){var n=this;this.isDisabled()?(this.$newElement.addClass("disabled"),this.$button.addClass("disabled").attr("tabindex",-1)):(this.$button.hasClass("disabled")&&(this.$newElement.removeClass("disabled"),this.$button.removeClass("disabled")),this.$button.attr("tabindex")!=-1||this.$element.data("tabindex")||this.$button.removeAttr("tabindex"));this.$button.click(function(){return!n.isDisabled()})},tabIndex:function(){this.$element.data("tabindex")!==this.$element.attr("tabindex")&&this.$element.attr("tabindex")!==-98&&this.$element.attr("tabindex")!=="-98"&&(this.$element.data("tabindex",this.$element.attr("tabindex")),this.$button.attr("tabindex",this.$element.data("tabindex")));this.$element.attr("tabindex",-98)},clickListener:function(){var t=this,i=n(document);this.$newElement.on("touchstart.dropdown",".dropdown-menu",function(n){n.stopPropagation()});i.data("spaceSelect",!1);this.$button.on("keyup",function(n){/(32)/.test(n.keyCode.toString(10))&&i.data("spaceSelect")&&(n.preventDefault(),i.data("spaceSelect",!1))});this.$button.on("click",function(){t.setSize();t.$element.on("shown.bs.select",function(){var i,n;if(t.options.liveSearch||t.multiple){if(!t.multiple){if(i=t.liObj[t.$element[0].selectedIndex],typeof i!="number"||t.options.size===!1)return;n=t.$lis.eq(i)[0].offsetTop-t.$menuInner[0].offsetTop;n=n-t.$menuInner[0].offsetHeight/2+t.sizeInfo.liHeight/2;t.$menuInner[0].scrollTop=n}}else t.$menuInner.find(".selected a").focus()})});this.$menuInner.on("click","li a",function(i){var s=n(this),e=s.parent().data("originalIndex"),k=t.$element.val(),d=t.$element.prop("selectedIndex"),v,y,b;if(t.multiple&&i.stopPropagation(),i.preventDefault(),!t.isDisabled()&&!s.parent().hasClass("disabled")){var h=t.$element.find("option"),f=h.eq(e),l=f.prop("selected"),a=f.parent("optgroup"),r=t.options.maxOptions,u=a.data("maxOptions")||!1;if(t.multiple){if(f.prop("selected",!l),t.setSelected(e,!l),s.blur(),(r!==!1||u!==!1)&&(v=r<h.filter(":selected").length,y=u<a.find("option:selected").length,r&&v||u&&y))if(r&&r==1)h.prop("selected",!1),f.prop("selected",!0),t.$menuInner.find(".selected").removeClass("selected"),t.setSelected(e,!0);else if(u&&u==1)a.find("option:selected").prop("selected",!1),f.prop("selected",!0),b=s.parent().data("optgroup"),t.$menuInner.find('[data-optgroup="'+b+'"]').removeClass("selected"),t.setSelected(e,!0);else{var o=typeof t.options.maxOptionsText=="function"?t.options.maxOptionsText(r,u):t.options.maxOptionsText,p=o[0].replace("{n}",r),w=o[1].replace("{n}",u),c=n('<div class="notify"><\/div>');o[2]&&(p=p.replace("{var}",o[2][r>1?0:1]),w=w.replace("{var}",o[2][u>1?0:1]));f.prop("selected",!1);t.$menu.append(c);r&&v&&(c.append(n("<div>"+p+"<\/div>")),t.$element.trigger("maxReached.bs.select"));u&&y&&(c.append(n("<div>"+w+"<\/div>")),t.$element.trigger("maxReachedGrp.bs.select"));setTimeout(function(){t.setSelected(e,!1)},10);c.delay(750).fadeOut(300,function(){n(this).remove()})}}else h.prop("selected",!1),f.prop("selected",!0),t.$menuInner.find(".selected").removeClass("selected"),t.setSelected(e,!0);t.multiple?t.options.liveSearch&&t.$searchbox.focus():t.$button.focus();(k!=t.$element.val()&&t.multiple||d!=t.$element.prop("selectedIndex")&&!t.multiple)&&(t.$element.triggerNative("change"),t.$element.trigger("changed.bs.select",[e,f.prop("selected"),l]))}});this.$menu.on("click","li.disabled a, .popover-title, .popover-title :not(.close)",function(i){i.currentTarget==this&&(i.preventDefault(),i.stopPropagation(),t.options.liveSearch&&!n(i.target).hasClass("close")?t.$searchbox.focus():t.$button.focus())});this.$menuInner.on("click",".divider, .dropdown-header",function(n){n.preventDefault();n.stopPropagation();t.options.liveSearch?t.$searchbox.focus():t.$button.focus()});this.$menu.on("click",".popover-title .close",function(){t.$button.click()});this.$searchbox.on("click",function(n){n.stopPropagation()});this.$menu.on("click",".actions-btn",function(i){t.options.liveSearch?t.$searchbox.focus():t.$button.focus();i.preventDefault();i.stopPropagation();n(this).hasClass("bs-select-all")?t.selectAll():t.deselectAll();t.$element.triggerNative("change")});this.$element.change(function(){t.render(!1)})},liveSearchListener:function(){var t=this,u=n('<li class="no-results"><\/li>');this.$button.on("click.dropdown.data-api touchstart.dropdown.data-api",function(){t.$menuInner.find(".active").removeClass("active");!t.$searchbox.val()||(t.$searchbox.val(""),t.$lis.not(".is-hidden").removeClass("hidden"),!u.parent().length||u.remove());t.multiple||t.$menuInner.find(".selected").addClass("active");setTimeout(function(){t.$searchbox.focus()},10)});this.$searchbox.on("click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api",function(n){n.stopPropagation()});this.$searchbox.on("input propertychange",function(){var f,e;t.$searchbox.val()?(f=t.$lis.not(".is-hidden").removeClass("hidden").children("a"),f=t.options.liveSearchNormalize?f.not(":a"+t._searchStyle()+'("'+i(t.$searchbox.val())+'")'):f.not(":"+t._searchStyle()+'("'+t.$searchbox.val()+'")'),f.parent().addClass("hidden"),t.$lis.filter(".dropdown-header").each(function(){var i=n(this),r=i.data("optgroup");t.$lis.filter("[data-optgroup="+r+"]").not(i).not(".hidden").length===0&&(i.addClass("hidden"),t.$lis.filter("[data-optgroup="+r+"div]").addClass("hidden"))}),e=t.$lis.not(".hidden"),e.each(function(t){var i=n(this);i.hasClass("divider")&&(i.index()===e.first().index()||i.index()===e.last().index()||e.eq(t+1).hasClass("divider"))&&i.addClass("hidden")}),t.$lis.not(".hidden, .no-results").length?!u.parent().length||u.remove():(!u.parent().length||u.remove(),u.html(t.options.noneResultsText.replace("{0}",'"'+r(t.$searchbox.val())+'"')).show(),t.$menuInner.append(u))):(t.$lis.not(".is-hidden").removeClass("hidden"),!u.parent().length||u.remove());t.$lis.filter(".active").removeClass("active");t.$searchbox.val()&&t.$lis.not(".hidden, .divider, .dropdown-header").eq(0).addClass("active").children("a").focus();n(this).focus()})},_searchStyle:function(){return{begins:"ibegins",startsWith:"ibegins"}[this.options.liveSearchStyle]||"icontains"},val:function(n){return typeof n!="undefined"?(this.$element.val(n),this.render(),this.$element):this.$element.val()},changeAll:function(t){var i,f;typeof t=="undefined"&&(t=!0);this.findLis();var e=this.$element.find("option"),u=this.$lis.not(".divider, .dropdown-header, .disabled, .hidden").toggleClass("selected",t),o=u.length,r=[];for(i=0;i<o;i++)f=u[i].getAttribute("data-original-index"),r[r.length]=e.eq(f)[0];n(r).prop("selected",t);this.render(!1)},selectAll:function(){return this.changeAll(!0)},deselectAll:function(){return this.changeAll(!1)},keydown:function(t){var e=n(this),l=e.is("input")?e.parent().parent():e.parent(),u,r=l.data("this"),f,h,a,v,p,w,k,s,c=":not(.disabled, .hidden, .dropdown-header, .divider)",b={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},y,o,g,d;(r.options.liveSearch&&(l=e.parent().parent()),r.options.container&&(l=r.$menu),u=n("[role=menu] li",l),s=r.$newElement.hasClass("open"),!s&&(t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=105||t.keyCode>=65&&t.keyCode<=90)&&(r.options.container?r.$button.trigger("click"):(r.setSize(),r.$menu.parent().addClass("open"),s=!0),r.$searchbox.focus()),r.options.liveSearch&&(/(^9$|27)/.test(t.keyCode.toString(10))&&s&&r.$menu.find(".active").length===0&&(t.preventDefault(),r.$menu.parent().removeClass("open"),r.options.container&&r.$newElement.removeClass("open"),r.$button.focus()),u=n("[role=menu] li"+c,l),e.val()||/(38|40)/.test(t.keyCode.toString(10))||u.filter(".active").length===0&&(u=r.$menuInner.find("li"),u=r.options.liveSearchNormalize?u.filter(":a"+r._searchStyle()+"("+i(b[t.keyCode])+")"):u.filter(":"+r._searchStyle()+"("+b[t.keyCode]+")"))),u.length)&&(/(38|40)/.test(t.keyCode.toString(10))?(f=u.index(u.find("a").filter(":focus").parent()),a=u.filter(c).first().index(),v=u.filter(c).last().index(),h=u.eq(f).nextAll(c).eq(0).index(),p=u.eq(f).prevAll(c).eq(0).index(),w=u.eq(h).prevAll(c).eq(0).index(),r.options.liveSearch&&(u.each(function(t){n(this).hasClass("disabled")||n(this).data("index",t)}),f=u.index(u.filter(".active")),a=u.first().data("index"),v=u.last().data("index"),h=u.eq(f).nextAll().eq(0).data("index"),p=u.eq(f).prevAll().eq(0).data("index"),w=u.eq(h).prevAll().eq(0).data("index")),k=e.data("prevIndex"),t.keyCode==38?(r.options.liveSearch&&f--,f!=w&&f>p&&(f=p),f<a&&(f=a),f==k&&(f=v)):t.keyCode==40&&(r.options.liveSearch&&f++,f==-1&&(f=0),f!=w&&f<h&&(f=h),f>v&&(f=v),f==k&&(f=a)),e.data("prevIndex",f),r.options.liveSearch?(t.preventDefault(),e.hasClass("dropdown-toggle")||(u.removeClass("active").eq(f).addClass("active").children("a").focus(),e.focus())):u.eq(f).children("a").focus()):e.is("input")||(y=[],u.each(function(){n(this).hasClass("disabled")||n.trim(n(this).children("a").text().toLowerCase()).substring(0,1)==b[t.keyCode]&&y.push(n(this).index())}),o=n(document).data("keycount"),o++,n(document).data("keycount",o),g=n.trim(n(":focus").text().toLowerCase()).substring(0,1),g!=b[t.keyCode]?(o=1,n(document).data("keycount",o)):o>=y.length&&(n(document).data("keycount",0),o>y.length&&(o=1)),u.eq(y[o-1]).children("a").focus()),(/(13|32)/.test(t.keyCode.toString(10))||/(^9$)/.test(t.keyCode.toString(10))&&r.options.selectOnTab)&&s&&(/(32)/.test(t.keyCode.toString(10))||t.preventDefault(),r.options.liveSearch?/(32)/.test(t.keyCode.toString(10))||(r.$menuInner.find(".active a").click(),e.focus()):(d=n(":focus"),d.click(),d.focus(),t.preventDefault(),n(document).data("spaceSelect",!0)),n(document).data("keycount",0)),(/(^9$|27)/.test(t.keyCode.toString(10))&&s&&(r.multiple||r.options.liveSearch)||/(27)/.test(t.keyCode.toString(10))&&!s)&&(r.$menu.parent().removeClass("open"),r.options.container&&r.$newElement.removeClass("open"),r.$button.focus()))},mobile:function(){this.$element.addClass("mobile-device")},refresh:function(){this.$lis=null;this.liObj={};this.reloadLi();this.render();this.checkDisabled();this.liHeight(!0);this.setStyle();this.setWidth();this.$lis&&this.$searchbox.trigger("propertychange");this.$element.trigger("refreshed.bs.select")},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},remove:function(){this.$newElement.remove();this.$element.remove()},destroy:function(){this.$newElement.remove();this.$bsContainer?this.$bsContainer.remove():this.$menu.remove();this.$element.off(".bs.select").removeData("selectpicker").removeClass("bs-select-hidden selectpicker")}};f=n.fn.selectpicker;n.fn.selectpicker=u;n.fn.selectpicker.Constructor=t;n.fn.selectpicker.noConflict=function(){return n.fn.selectpicker=f,this};n(document).data("keycount",0).on("keydown.bs.select",'.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role="menu"], .bs-searchbox input',t.prototype.keydown).on("focusin.modal",'.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role="menu"], .bs-searchbox input',function(n){n.stopPropagation()});n(window).on("load.bs.select.data-api",function(){n(".selectpicker").each(function(){var t=n(this);u.call(t,t.data())})})})(n)}),function(n){n.fn.btsListFilter=function(t,i){"use strict";function h(n,t){return n.replace(/\{ *([\w_]+) *\}/g,function(n,i){return t[i]||""})}function c(n,t){var i;return t=t||300,function(){var r=this,u=arguments;clearTimeout(i);i=setTimeout(function(){n.apply(r,Array.prototype.slice.call(u))},t)}}var r=this,u=n(this),e=n(t),s,o=u,f;if(i=n.extend({delay:250,minLength:1,initial:!1,casesensitive:!1,eventKey:"keyup click",resetOnBlur:!0,sourceData:null,sourceTmpl:'<a class="list-group-item" href="#"><span>{title}<\/span><\/a>',sourceNode:function(n){return h(i.sourceTmpl,n)},emptyNode:function(){return'<a class="list-group-item well" href="#"><span>No Results<\/span><\/a>'},itemClassTmp:"bts-dynamic-item",itemEl:".list-group-item",itemChild:null,itemFilter:function(t,r){r=r&&r.replace(new RegExp("[({[^.$*+?\\]})]","g"),"");var u=n(t).text(),f=i.initial?"^":"",e=new RegExp(f+r,i.casesensitive?"":"i");return e.test(u)},cancelNode:function(){return'<span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"><\/span>'}},i),r.reset=function(){},n.isFunction(i.cancelNode)){s=n(i.cancelNode.call(r));e.after(s);e.parents(".form-group").addClass("has-feedback");e.prev().is(".control-label")||s.css({top:0});s.on("click",r.reset)}e.on(i.eventKey,c(function(){var s=n(this).val(),t,e;i.itemEl&&(o=u.find(i.itemEl));i.itemChild&&(o=o.find(i.itemChild));t=o.filter(function(){return i.itemFilter.call(r,this,s)});e=o.not(t);i.itemChild&&(t=t.parents(i.itemEl),e=e.parents(i.itemEl).hide());s!==""&&s.length>=i.minLength?(t.show(),e.hide(),n.type(i.sourceData)==="function"?(t.hide(),e.hide(),f&&(n.isFunction(f.abort)?f.abort():n.isFunction(f.stop)&&f.stop()),f=i.sourceData.call(r,s,function(o){if(f=null,t.hide(),e.hide(),u.find("."+i.itemClassTmp).remove(),o&&o.length!==0)for(var s in o)n(i.sourceNode.call(r,o[s])).addClass(i.itemClassTmp).appendTo(u);else n(i.emptyNode.call(r)).addClass(i.itemClassTmp).appendTo(u)})):(u.find("."+i.itemClassTmp).remove(),t.length===0&&n(i.emptyNode.call(r)).addClass(i.itemClassTmp).appendTo(u))):(t.show(),e.show(),u.find("."+i.itemClassTmp).remove())},i.delay));if(i.resetOnBlur)e.on("blur",function(){r.reset()});return u}}(jQuery);
/*!
 * Chart.js
 * http://chartjs.org/
 * Version: 1.0.2
 *
 * Copyright 2015 Nick Downie
 * Released under the MIT license
 * https://github.com/nnnick/Chart.js/blob/master/LICENSE.md
 */
(function(){"use strict";var l=this,nt=l.Chart,t=function(t){var f=this;this.canvas=t.canvas;this.ctx=t;var i=function(n,t){return n["offset"+t]?n["offset"+t]:document.defaultView.getComputedStyle(n).getPropertyValue(t)},r=this.width=i(t.canvas,"Width")||t.canvas.width,u=this.height=i(t.canvas,"Height")||t.canvas.height;return r=this.width=t.canvas.width,u=this.height=t.canvas.height,this.aspectRatio=this.width/this.height,n.retinaScale(this),this};t.defaults={global:{animation:!0,animationSteps:90,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!1,showTooltips:!0,customTooltips:!1,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipTitleTemplate:"<%= label%>",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",segmentColorDefault:["#A6CEE3","#1F78B4","#B2DF8A","#33A02C","#FB9A99","#E31A1C","#FDBF6F","#FF7F00","#CAB2D6","#6A3D9A","#B4B482","#B15928"],segmentHighlightColorDefaults:["#CEF6FF","#47A0DC","#DAFFB2","#5BC854","#FFC2C1","#FF4244","#FFE797","#FFA728","#F2DAFE","#9265C2","#DCDCAA","#D98150"],onAnimationProgress:function(){},onAnimationComplete:function(){}}};t.types={};var n=t.helpers={},i=n.each=function(n,t,i){var f=Array.prototype.slice.call(arguments,3),r,u;if(n)if(n.length===+n.length)for(r=0;r<n.length;r++)t.apply(i,[n[r],r].concat(f));else for(u in n)t.apply(i,[n[u],u].concat(f))},a=n.clone=function(n){var t={};return i(n,function(i,r){n.hasOwnProperty(r)&&(t[r]=i)}),t},r=n.extend=function(n){return i(Array.prototype.slice.call(arguments,1),function(t){i(t,function(i,r){t.hasOwnProperty(r)&&(n[r]=i)})}),n},tt=n.merge=function(){var n=Array.prototype.slice.call(arguments,0);return n.unshift({}),r.apply(null,n)},it=n.indexOf=function(n,t){if(Array.prototype.indexOf)return n.indexOf(t);for(var i=0;i<n.length;i++)if(n[i]===t)return i;return-1},yt=n.where=function(t,i){var r=[];return n.each(t,function(n){i(n)&&r.push(n)}),r},pt=n.findNextWhere=function(n,t,i){var r,u;for(i||(i=-1),r=i+1;r<n.length;r++)if(u=n[r],t(u))return u},wt=n.findPreviousWhere=function(n,t,i){var r,u;for(i||(i=n.length),r=i-1;r>=0;r--)if(u=n[r],t(u))return u},p=n.inherits=function(n){var i=this,t=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return i.apply(this,arguments)},u=function(){this.constructor=t};return u.prototype=i.prototype,t.prototype=new u,t.extend=p,n&&r(t.prototype,n),t.__super__=i.prototype,t},v=n.noop=function(){},rt=n.uid=function(){var n=0;return function(){return"chart-"+n++}}(),ut=n.warn=function(n){window.console&&typeof window.console.warn=="function"&&console.warn(n)},ft=n.amd=typeof define=="function"&&define.amd,f=n.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},h=n.max=function(n){return Math.max.apply(Math,n)},o=n.min=function(n){return Math.min.apply(Math,n)},bt=n.cap=function(n,t,i){if(f(t)){if(n>t)return t}else if(f(i)&&n<i)return i;return n},w=n.getDecimalPlaces=function(n){var t,i;return n%1!=0&&f(n)?(t=n.toString(),t.indexOf("e-")<0?t.split(".")[1].length:t.indexOf(".")<0?parseInt(t.split("e-")[1]):(i=t.split(".")[1].split("e-"),i[0].length+parseInt(i[1]))):0},b=n.radians=function(n){return n*(Math.PI/180)},kt=n.getAngleFromPoint=function(n,t){var i=t.x-n.x,r=t.y-n.y,f=Math.sqrt(i*i+r*r),u=Math.PI*2+Math.atan2(r,i);return i<0&&r<0&&(u+=Math.PI*2),{angle:u,distance:f}},k=n.aliasPixel=function(n){return n%2==0?0:.5},dt=n.splineCurve=function(n,t,i,r){var u=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),f=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),e=r*u/(u+f),o=r*f/(u+f);return{inner:{x:t.x-e*(i.x-n.x),y:t.y-e*(i.y-n.y)},outer:{x:t.x+o*(i.x-n.x),y:t.y+o*(i.y-n.y)}}},et=n.calculateOrderOfMagnitude=function(n){return Math.floor(Math.log(n)/Math.LN10)},gt=n.calculateScaleRange=function(n,t,i,r,u){var w=2,v=Math.floor(t/(i*1.5)),y=w>=v,c=h(n),l=o(n);c===l&&(c+=.5,l>=.5&&!r?l-=.5:c+=.5);for(var b=Math.abs(c-l),s=et(b),k=Math.ceil(c/(1*Math.pow(10,s)))*Math.pow(10,s),p=r?0:Math.floor(l/(1*Math.pow(10,s)))*Math.pow(10,s),a=k-p,f=Math.pow(10,s),e=Math.round(a/f);(e>v||e*2<v)&&!y;)if(e>v)f*=2,e=Math.round(a/f),e%1!=0&&(y=!0);else if(u&&s>=0)if(f/2%1==0)f/=2,e=Math.round(a/f);else break;else f/=2,e=Math.round(a/f);return y&&(e=w,f=a/e),{steps:e,stepValue:f,min:p,max:p+e*f}},u=n.template=function(n,t){function r(n,t){var r=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[n]=i[n];return t?r(t):r}if(n instanceof Function)return n(t);var i={};return r(n,t)},ni=n.generateLabels=function(n,t,r,f){var e=new Array(t);return n&&i(e,function(t,i){e[i]=u(n,{value:r+f*(i+1)})}),e},s=n.easingEffects={linear:function(n){return n},easeInQuad:function(n){return n*n},easeOutQuad:function(n){return-1*n*(n-2)},easeInOutQuad:function(n){return(n/=1/2)<1?1/2*n*n:-1/2*(--n*(n-2)-1)},easeInCubic:function(n){return n*n*n},easeOutCubic:function(n){return 1*((n=n/1-1)*n*n+1)},easeInOutCubic:function(n){return(n/=1/2)<1?1/2*n*n*n:1/2*((n-=2)*n*n+2)},easeInQuart:function(n){return n*n*n*n},easeOutQuart:function(n){return-1*((n=n/1-1)*n*n*n-1)},easeInOutQuart:function(n){return(n/=1/2)<1?1/2*n*n*n*n:-1/2*((n-=2)*n*n*n-2)},easeInQuint:function(n){return 1*(n/=1)*n*n*n*n},easeOutQuint:function(n){return 1*((n=n/1-1)*n*n*n*n+1)},easeInOutQuint:function(n){return(n/=1/2)<1?1/2*n*n*n*n*n:1/2*((n-=2)*n*n*n*n+2)},easeInSine:function(n){return-1*Math.cos(n/1*(Math.PI/2))+1},easeOutSine:function(n){return 1*Math.sin(n/1*(Math.PI/2))},easeInOutSine:function(n){return-1/2*(Math.cos(Math.PI*n/1)-1)},easeInExpo:function(n){return n===0?1:1*Math.pow(2,10*(n/1-1))},easeOutExpo:function(n){return n===1?1:1*(-Math.pow(2,-10*n)+1)},easeInOutExpo:function(n){return n===0?0:n===1?1:(n/=1/2)<1?1/2*Math.pow(2,10*(n-1)):1/2*(-Math.pow(2,-10*--n)+2)},easeInCirc:function(n){return n>=1?n:-1*(Math.sqrt(1-(n/=1)*n)-1)},easeOutCirc:function(n){return 1*Math.sqrt(1-(n=n/1-1)*n)},easeInOutCirc:function(n){return(n/=1/2)<1?-1/2*(Math.sqrt(1-n*n)-1):1/2*(Math.sqrt(1-(n-=2)*n)+1)},easeInElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1)==1?1:(t||(t=1*.3),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t)))},easeOutElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1)==1?1:(t||(t=1*.3),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*n)*Math.sin((n*1-r)*2*Math.PI/t)+1)},easeInOutElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1/2)==2?1:(t||(t=1*.3*1.5),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),n<1)?-.5*i*Math.pow(2,10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t):i*Math.pow(2,-10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t)*.5+1},easeInBack:function(n){var t=1.70158;return 1*(n/=1)*n*((t+1)*n-t)},easeOutBack:function(n){var t=1.70158;return 1*((n=n/1-1)*n*((t+1)*n+t)+1)},easeInOutBack:function(n){var t=1.70158;return(n/=1/2)<1?1/2*n*n*(((t*=1.525)+1)*n-t):1/2*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:function(n){return 1-s.easeOutBounce(1-n)},easeOutBounce:function(n){return(n/=1)<1/2.75?1*7.5625*n*n:n<2/2.75?1*(7.5625*(n-=1.5/2.75)*n+.75):n<2.5/2.75?1*(7.5625*(n-=2.25/2.75)*n+.9375):1*(7.5625*(n-=2.625/2.75)*n+.984375)},easeInOutBounce:function(n){return n<1/2?s.easeInBounce(n*2)*.5:s.easeOutBounce(n*2-1)*.5+1*.5}},d=n.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){return window.setTimeout(n,1e3/60)}}(),ti=n.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(n){return window.clearTimeout(n,1e3/60)}}(),ii=n.animationLoop=function(n,t,i,r,u,f){var e=0,h=s[i]||s.linear,o=function(){e++;var i=e/t,s=h(i);n.call(f,s,i,e);r.call(f,s,i);e<t?f.animationFrame=d(o):u.apply(f)};d(o)},ri=n.getRelativePosition=function(n){var r,u,t=n.originalEvent||n,f=n.currentTarget||n.srcElement,i=f.getBoundingClientRect();return t.touches?(r=t.touches[0].clientX-i.left,u=t.touches[0].clientY-i.top):(r=t.clientX-i.left,u=t.clientY-i.top),{x:r,y:u}},ot=n.addEvent=function(n,t,i){n.addEventListener?n.addEventListener(t,i):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i},st=n.removeEvent=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent?n.detachEvent("on"+t,i):n["on"+t]=v},ui=n.bindEvents=function(n,t,r){n.events||(n.events={});i(t,function(t){n.events[t]=function(){r.apply(n,arguments)};ot(n.chart.canvas,t,n.events[t])})},ht=n.unbindEvents=function(n,t){i(t,function(t,i){st(n.chart.canvas,i,t)})},ct=n.getMaximumWidth=function(n){var t=n.parentNode,i=parseInt(c(t,"padding-left"))+parseInt(c(t,"padding-right"));return t.clientWidth-i},lt=n.getMaximumHeight=function(n){var t=n.parentNode,i=parseInt(c(t,"padding-bottom"))+parseInt(c(t,"padding-top"));return t.clientHeight-i},c=n.getStyle=function(n,t){return n.currentStyle?n.currentStyle[t]:document.defaultView.getComputedStyle(n,null).getPropertyValue(t)},fi=n.getMaximumSize=n.getMaximumWidth,at=n.retinaScale=function(n){var t=n.ctx,i=n.canvas.width,r=n.canvas.height;window.devicePixelRatio&&(t.canvas.style.width=i+"px",t.canvas.style.height=r+"px",t.canvas.height=r*window.devicePixelRatio,t.canvas.width=i*window.devicePixelRatio,t.scale(window.devicePixelRatio,window.devicePixelRatio))},vt=n.clear=function(n){n.ctx.clearRect(0,0,n.width,n.height)},e=n.fontString=function(n,t,i){return t+" "+n+"px "+i},y=n.longestText=function(n,t,r){n.font=t;var u=0;return i(r,function(t){var i=n.measureText(t).width;u=i>u?i:u}),u},g=n.drawRoundedRectangle=function(n,t,i,r,u,f){n.beginPath();n.moveTo(t+f,i);n.lineTo(t+r-f,i);n.quadraticCurveTo(t+r,i,t+r,i+f);n.lineTo(t+r,i+u-f);n.quadraticCurveTo(t+r,i+u,t+r-f,i+u);n.lineTo(t+f,i+u);n.quadraticCurveTo(t,i+u,t,i+u-f);n.lineTo(t,i+f);n.quadraticCurveTo(t,i,t+f,i);n.closePath()};t.instances={};t.Type=function(n,i,r){this.options=i;this.chart=r;this.id=rt();t.instances[this.id]=this;i.responsive&&this.resize();this.initialize.call(this,n)};r(t.Type.prototype,{initialize:function(){return this},clear:function(){return vt(this.chart),this},stop:function(){return t.animationService.cancelAnimation(this),this},resize:function(n){this.stop();var t=this.chart.canvas,i=ct(this.chart.canvas),r=this.options.maintainAspectRatio?i/this.chart.aspectRatio:lt(this.chart.canvas);return t.width=this.chart.width=i,t.height=this.chart.height=r,at(this.chart),typeof n=="function"&&n.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:v,render:function(i){if(i&&this.reflow(),this.options.animation&&!i){var r=new t.Animation;r.numSteps=this.options.animationSteps;r.easing=this.options.animationEasing;r.render=function(t,i){var u=n.easingEffects[i.easing],r=i.currentStep/i.numSteps,f=u(r);t.draw(f,r,i.currentStep)};r.onAnimationProgress=this.options.onAnimationProgress;r.onAnimationComplete=this.options.onAnimationComplete;t.animationService.addAnimation(this,r)}else this.draw(),this.options.onAnimationComplete.call(this);return this},generateLegend:function(){return u(this.options.legendTemplate,this)},destroy:function(){this.clear();ht(this,this.events);var n=this.chart.canvas;n.width=this.chart.width;n.height=this.chart.height;n.style.removeProperty?(n.style.removeProperty("width"),n.style.removeProperty("height")):(n.style.removeAttribute("width"),n.style.removeAttribute("height"));delete t.instances[this.id]},showTooltip:function(r,f){var c,l,e,s;if(typeof this.activeElements=="undefined"&&(this.activeElements=[]),c=function(n){var t=!1;return n.length!==this.activeElements.length?t=!0:(i(n,function(n,i){n!==this.activeElements[i]&&(t=!0)},this),t)}.call(this,r),c||f)this.activeElements=r;else return;if(this.activeElements.length>0&&(this.activeElements=[this.activeElements[0]]),r.length>0&&(r=[r[0]]),this.draw(),this.options.customTooltips&&this.options.customTooltips(!1),r.length>0)if(this.datasets&&this.datasets.length>1){for(s=this.datasets.length-1;s>=0;s--)if(l=this.datasets[s].points||this.datasets[s].bars||this.datasets[s].segments,e=it(l,r[0]),e!==-1)break;var a=[],v=[],y=function(){var f=[],t,i=[],r=[],s,c,u,l;return n.each(this.datasets,function(n){t=n.points||n.bars||n.segments;t[e]&&t[e].hasValue()&&f.push(t[e])}),n.each(f,function(t){i.push(t.x);r.push(t.y);a.push(n.template(this.options.multiTooltipTemplate,t));v.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),l=o(r),c=h(r),u=o(i),s=h(i),{x:u>this.chart.width/2?u:s,y:(l+c)/2}}.call(this,e);new t.MultiTooltip({x:y.x,y:y.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:a,legendColors:v,legendColorBackground:this.options.multiTooltipKeyBackground,title:u(this.options.tooltipTitleTemplate,r[0]),chart:this.chart,ctx:this.chart.ctx,custom:this.options.customTooltips}).draw()}else r.length>0&&i([r[0]],function(n){var i=n.tooltipPosition();new t.Tooltip({x:Math.round(i.x),y:Math.round(i.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,id:n.id,label:n.label,text:u(this.options.tooltipTemplate,n),chart:this.chart,custom:this.options.customTooltips}).draw()},this);return this},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}});t.Type.extend=function(n){var i=this,u=function(){return i.apply(this,arguments)},f,e;return u.prototype=a(i.prototype),r(u.prototype,n),u.extend=t.Type.extend,n.name||i.prototype.name?(f=n.name||i.prototype.name,e=t.defaults[i.prototype.name]?a(t.defaults[i.prototype.name]):{},t.defaults[f]=r(e,n.defaults),t.types[f]=u,t.prototype[f]=function(n,i){var r=tt(t.defaults.global,t.defaults[f],i||{});return new u(n,r,this)}):ut("Name not provided for this chart, so it hasn't been registered"),i};t.Element=function(n){r(this,n);this.initialize.apply(this,arguments);this.save()};r(t.Element.prototype,{initialize:function(){},restore:function(n){return n?i(n,function(n){this[n]=this._saved[n]},this):r(this,this._saved),this},save:function(){return this._saved=a(this),delete this._saved._saved,this},update:function(n){return i(n,function(n,t){this._saved[t]=this[t];this[t]=n},this),this},transition:function(n,t){return i(n,function(n,i){this[i]=(n-this._saved[i])*t+this._saved[i]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return f(this.value)}});t.Element.extend=p;t.Point=t.Element.extend({display:!0,active:!1,first:!1,inRange:function(n,t){var i=this.hitDetectionRadius+this.radius;return Math.pow(n-this.x,2)+Math.pow(t-this.y,2)<Math.pow(i,2)},draw:function(){if(this.display||this.active||this.first){var n=this.ctx;n.beginPath();n.arc(this.x,this.y,this.radius,0,Math.PI*2);n.closePath();n.strokeStyle=this.strokeColor;n.lineWidth=this.strokeWidth;n.fillStyle=this.fillColor;n.fill();n.stroke()}}});t.Arc=t.Element.extend({inRange:function(t,i){var u=n.getAngleFromPoint(this,{x:t,y:i}),r=u.angle%(Math.PI*2),f=(Math.PI*2+this.startAngle)%(Math.PI*2),e=(Math.PI*2+this.endAngle)%(Math.PI*2)||360,o=e<f?r<=e||r>=f:r>=f&&r<=e,s=u.distance>=this.innerRadius&&u.distance<=this.outerRadius;return o&&s},tooltipPosition:function(){var n=this.startAngle+(this.endAngle-this.startAngle)/2,t=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(n)*t,y:this.y+Math.sin(n)*t}},draw:function(n){var i=n||1,t=this.ctx;t.beginPath();t.arc(this.x,this.y,this.outerRadius<0?0:this.outerRadius,this.startAngle,this.endAngle);t.arc(this.x,this.y,this.innerRadius<0?0:this.innerRadius,this.endAngle,this.startAngle,!0);t.closePath();t.strokeStyle=this.strokeColor;t.lineWidth=this.strokeWidth;t.fillStyle=this.fillColor;t.fill();t.lineJoin="bevel";this.showStroke&&t.stroke()}});t.Rectangle=t.Element.extend({draw:function(){var n=this.ctx,f=this.width/2,t=this.x-f,i=this.x+f,r=this.base-(this.base-this.y),u=this.strokeWidth/2;this.showStroke&&(t+=u,i-=u,r+=u);n.beginPath();n.fillStyle=this.fillColor;n.strokeStyle=this.strokeColor;n.lineWidth=this.strokeWidth;n.moveTo(t,this.base);n.lineTo(t,r);n.lineTo(i,r);n.lineTo(i,this.base);n.fill();this.showStroke&&n.stroke()},height:function(){return this.base-this.y},inRange:function(n,t){return n>=this.x-this.width/2&&n<=this.x+this.width/2&&t>=this.y&&t<=this.base}});t.Animation=t.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null});t.Tooltip=t.Element.extend({draw:function(){var n=this.chart.ctx,r,u;n.font=e(this.fontSize,this.fontStyle,this.fontFamily);this.xAlign="center";this.yAlign="above";var t=this.caretPadding=2,i=n.measureText(this.text).width+2*this.xPadding,f=this.fontSize+2*this.yPadding,o=f+this.caretHeight+t;if(this.x+i/2>this.chart.width?this.xAlign="left":this.x-i/2<0&&(this.xAlign="right"),this.y-o<0&&(this.yAlign="below"),r=this.x-i/2,u=this.y-o,n.fillStyle=this.fillColor,this.custom)this.custom(this);else{switch(this.yAlign){case"above":n.beginPath();n.moveTo(this.x,this.y-t);n.lineTo(this.x+this.caretHeight,this.y-(t+this.caretHeight));n.lineTo(this.x-this.caretHeight,this.y-(t+this.caretHeight));n.closePath();n.fill();break;case"below":u=this.y+t+this.caretHeight;n.beginPath();n.moveTo(this.x,this.y+t);n.lineTo(this.x+this.caretHeight,this.y+t+this.caretHeight);n.lineTo(this.x-this.caretHeight,this.y+t+this.caretHeight);n.closePath();n.fill()}switch(this.xAlign){case"left":r=this.x-i+(this.cornerRadius+this.caretHeight);break;case"right":r=this.x-(this.cornerRadius+this.caretHeight)}g(n,r,u,i,f,this.cornerRadius);n.fill();n.fillStyle=this.textColor;n.textAlign="center";n.textBaseline="middle";n.fillText(this.text,r+i/2,u+f/2)}}});t.MultiTooltip=t.Element.extend({initialize:function(){var n;this.font=e(this.fontSize,this.fontStyle,this.fontFamily);this.titleFont=e(this.titleFontSize,this.titleFontStyle,this.titleFontFamily);this.titleHeight=this.title?this.titleFontSize*1.5:0;this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+this.yPadding*2+this.titleHeight;this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,i=y(this.ctx,this.font,this.labels)+this.fontSize+3,r=h([i,t]);this.width=r+this.xPadding*2;n=this.height/2;this.y-n<0?this.y=n:this.y+n>this.chart.height&&(this.y=this.chart.height-n);this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(n){var t=this.y-this.height/2+this.yPadding,i=n-1;return n===0?t+this.titleHeight/3:t+(this.fontSize*1.5*i+this.fontSize/2)+this.titleHeight},draw:function(){if(this.custom)this.custom(this);else{g(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor;t.fill();t.closePath();t.textAlign="left";t.textBaseline="middle";t.fillStyle=this.titleTextColor;t.font=this.titleFont;t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0));t.font=this.font;n.each(this.labels,function(n,i){t.fillStyle=this.textColor;t.fillText(n,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(i+1));t.fillStyle=this.legendColorBackground;t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize);t.fillStyle=this.legendColors[i].fill;t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}});t.Scale=t.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){var t,n;for(this.yLabels=[],t=w(this.stepValue),n=0;n<=this.steps;n++)this.yLabels.push(u(this.templateString,{value:(this.min+n*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?y(this.ctx,this.font,this.yLabels)+10:0},addXLabel:function(n){this.xLabels.push(n);this.valuesCount++;this.fit()},removeXLabel:function(){this.xLabels.shift();this.valuesCount--;this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0;this.endPoint=this.display?this.height-this.fontSize*1.5-5:this.height;this.startPoint+=this.padding;this.endPoint-=this.padding;var i=this.endPoint,n=this.endPoint-this.startPoint,t;for(this.calculateYRange(n),this.buildYLabels(),this.calculateXLabelRotation();n>this.endPoint-this.startPoint;)n=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(n),this.buildYLabels(),t<this.yLabelWidth&&(this.endPoint=i,this.calculateXLabelRotation())},calculateXLabelRotation:function(){var n,i,r,e,u,t,f;if(this.ctx.font=this.font,n=this.ctx.measureText(this.xLabels[0]).width,i=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width,this.xScalePaddingRight=i/2+3,this.xScalePaddingLeft=n/2>this.yLabelWidth?n/2:this.yLabelWidth,this.xLabelRotation=0,this.display)for(u=y(this.ctx,this.font,this.xLabels),this.xLabelWidth=u,f=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>f&&this.xLabelRotation===0||this.xLabelWidth>f&&this.xLabelRotation<=90&&this.xLabelRotation>0;)t=Math.cos(b(this.xLabelRotation)),r=t*n,e=t*i,r+this.fontSize/2>this.yLabelWidth&&(this.xScalePaddingLeft=r+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=t*u;else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:v,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(n){var t=this.drawingArea()/(this.min-this.max);return this.endPoint-t*(n-this.min)},calculateX:function(n){var u=this.xLabelRotation>0,r=this.width-(this.xScalePaddingLeft+this.xScalePaddingRight),t=r/Math.max(this.valuesCount-(this.offsetGridLines?0:1),1),i=t*n+this.xScalePaddingLeft;return this.offsetGridLines&&(i+=t/2),Math.round(i)},update:function(t){n.extend(this,t);this.fit()},draw:function(){var t=this.ctx,u=(this.endPoint-this.startPoint)/this.steps,r=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,i(this.yLabels,function(i,f){var s=this.endPoint-u*f,e=Math.round(s),o=this.showHorizontalLines;t.textAlign="right";t.textBaseline="middle";this.showLabels&&t.fillText(i,r-10,s);f!==0||o||(o=!0);o&&t.beginPath();f>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor);e+=n.aliasPixel(t.lineWidth);o&&(t.moveTo(r,e),t.lineTo(this.width,e),t.stroke(),t.closePath());t.lineWidth=this.lineWidth;t.strokeStyle=this.lineColor;t.beginPath();t.moveTo(r-5,e);t.lineTo(r,e);t.stroke();t.closePath()},this),i(this.xLabels,function(n,i){if(i%skipLabels==0){var e=this.calculateX(i)+k(this.lineWidth),r=this.calculateX(i-(this.offsetGridLines?.5:0))+k(this.lineWidth),f=!1,u=this.showVerticalLines;this.xLabelRotation=0;n=moment(n,FoodParent.Setting.getDateHourFormat()).format(FoodParent.Setting.getDateFormat2());i!==0||u||(u=!0);u&&t.beginPath();i>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor);u&&(t.moveTo(r,this.endPoint),t.lineTo(r,this.startPoint-3),t.stroke(),t.closePath());t.lineWidth=this.lineWidth;t.strokeStyle=this.lineColor;t.beginPath();t.moveTo(r,this.endPoint);t.lineTo(r,this.endPoint+5);t.stroke();t.closePath();t.save();t.translate(e,f?this.endPoint+12:this.endPoint+8);t.rotate(b(this.xLabelRotation)*-1);t.font=this.font;t.textAlign=f?"right":"center";t.textBaseline=f?"middle":"top";t.fillText(n,0,0);t.restore()}},this))}});t.RadialScale=t.Element.extend({initialize:function(){this.size=o([this.height,this.width]);this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(n){var t=this.drawingArea/(this.max-this.min);return(n-this.min)*t},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize();this.buildYLabels()},buildYLabels:function(){var t,n;for(this.yLabels=[],t=w(this.stepValue),n=0;n<=this.steps;n++)this.yLabels.push(u(this.templateString,{value:(this.min+n*this.stepValue).toFixed(t)}))},getCircumference:function(){return Math.PI*2/this.valuesCount},setScaleSize:function(){var y=o([this.height/2-this.pointLabelFontSize-5,this.width/2]),t,n,i,h,c=this.width,a,p,l=0,v,w,b,k,r,s;for(this.ctx.font=e(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),n=0;n<this.valuesCount;n++)t=this.getPointPosition(n,y),i=this.ctx.measureText(u(this.templateString,{value:this.labels[n]})).width+5,n===0||n===this.valuesCount/2?(h=i/2,t.x+h>c&&(c=t.x+h,a=n),t.x-h<l&&(l=t.x-h,v=n)):n<this.valuesCount/2?t.x+i>c&&(c=t.x+i,a=n):n>this.valuesCount/2&&t.x-i<l&&(l=t.x-i,v=n);b=l;k=Math.ceil(c-this.width);p=this.getIndexAngle(a);w=this.getIndexAngle(v);r=k/Math.sin(p+Math.PI/2);s=b/Math.sin(w+Math.PI/2);r=f(r)?r:0;s=f(s)?s:0;this.drawingArea=y-(s+r)/2;this.setCenterPoint(s,r)},setCenterPoint:function(n,t){var i=this.width-t-this.drawingArea,r=n+this.drawingArea;this.xCenter=(r+i)/2;this.yCenter=this.height/2},getIndexAngle:function(n){var t=Math.PI*2/this.valuesCount;return n*t-Math.PI/2},getPointPosition:function(n,t){var i=this.getIndexAngle(n);return{x:Math.cos(i)*t+this.xCenter,y:Math.sin(i)*t+this.yCenter}},draw:function(){var n,t,u,r,o;if(this.display&&(n=this.ctx,i(this.yLabels,function(t,i){var f,o,r,u,s;if(i>0){if(f=i*(this.drawingArea/this.steps),o=this.yCenter-f,this.lineWidth>0)if(n.strokeStyle=this.lineColor,n.lineWidth=this.lineWidth,this.lineArc)n.beginPath(),n.arc(this.xCenter,this.yCenter,f,0,Math.PI*2),n.closePath(),n.stroke();else{for(n.beginPath(),u=0;u<this.valuesCount;u++)r=this.getPointPosition(u,this.calculateCenterOffset(this.min+i*this.stepValue)),u===0?n.moveTo(r.x,r.y):n.lineTo(r.x,r.y);n.closePath();n.stroke()}this.showLabels&&(n.font=e(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop&&(s=n.measureText(t).width,n.fillStyle=this.backdropColor,n.fillRect(this.xCenter-s/2-this.backdropPaddingX,o-this.fontSize/2-this.backdropPaddingY,s+this.backdropPaddingX*2,this.fontSize+this.backdropPaddingY*2)),n.textAlign="center",n.textBaseline="middle",n.fillStyle=this.fontColor,n.fillText(t,this.xCenter,o))}},this),!this.lineArc))for(n.lineWidth=this.angleLineWidth,n.strokeStyle=this.angleLineColor,t=this.valuesCount-1;t>=0;t--){if(u=null,r=null,this.angleLineWidth>0&&(u=this.calculateCenterOffset(this.max),r=this.getPointPosition(t,u),n.beginPath(),n.moveTo(this.xCenter,this.yCenter),n.lineTo(r.x,r.y),n.stroke(),n.closePath()),this.backgroundColors&&this.backgroundColors.length==this.valuesCount){u==null&&(u=this.calculateCenterOffset(this.max));r==null&&(r=this.getPointPosition(t,u));var h=this.getPointPosition(t===0?this.valuesCount-1:t-1,u),c=this.getPointPosition(t===this.valuesCount-1?0:t+1,u),l={x:(h.x+r.x)/2,y:(h.y+r.y)/2},a={x:(r.x+c.x)/2,y:(r.y+c.y)/2};n.beginPath();n.moveTo(this.xCenter,this.yCenter);n.lineTo(l.x,l.y);n.lineTo(r.x,r.y);n.lineTo(a.x,a.y);n.fillStyle=this.backgroundColors[t];n.fill();n.closePath()}o=this.getPointPosition(t,this.calculateCenterOffset(this.max)+5);n.font=e(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily);n.fillStyle=this.pointLabelFontColor;var v=this.labels.length,s=this.labels.length/2,f=s/2,y=t<f||t>v-f,p=t===f||t===v-f;n.textAlign=t===0?"center":t===s?"center":t<s?"left":"right";n.textBaseline=p?"middle":y?"bottom":"top";n.fillText(this.labels[t],o.x,o.y)}}});t.animationService={frameDuration:17,animations:[],dropFrames:0,addAnimation:function(t,i){for(var r=0;r<this.animations.length;++r)if(this.animations[r].chartInstance===t){this.animations[r].animationObject=i;return}this.animations.push({chartInstance:t,animationObject:i});this.animations.length==1&&n.requestAnimFrame.call(window,this.digestWrapper)},cancelAnimation:function(t){var i=n.findNextWhere(this.animations,function(n){return n.chartInstance===t});i&&this.animations.splice(i,1)},digestWrapper:function(){t.animationService.startDigest.call(t.animationService)},startDigest:function(){var u=Date.now(),i=0,t;for(this.dropFrames>1&&(i=Math.floor(this.dropFrames),this.dropFrames-=i),t=0;t<this.animations.length;t++)this.animations[t].animationObject.currentStep===null&&(this.animations[t].animationObject.currentStep=0),this.animations[t].animationObject.currentStep+=1+i,this.animations[t].animationObject.currentStep>this.animations[t].animationObject.numSteps&&(this.animations[t].animationObject.currentStep=this.animations[t].animationObject.numSteps),this.animations[t].animationObject.render(this.animations[t].chartInstance,this.animations[t].animationObject),this.animations[t].animationObject.currentStep==this.animations[t].animationObject.numSteps&&(this.animations[t].animationObject.onAnimationComplete.call(this.animations[t].chartInstance),this.animations.splice(t,1),t--);var f=Date.now(),e=f-u-this.frameDuration,r=e/this.frameDuration;r>1&&(this.dropFrames+=r);this.animations.length>0&&n.requestAnimFrame.call(window,this.digestWrapper)}};n.addEvent(window,"resize",function(){var n;return function(){clearTimeout(n);n=setTimeout(function(){i(t.instances,function(n){n.options.responsive&&n.resize(n.render,!0)})},50)}}());ft?define(function(){return t}):typeof module=="object"&&module.exports&&(module.exports=t);l.Chart=t;t.noConflict=function(){return l.Chart=nt,t}}).call(this),function(){"use strict";var n=this,t=n.Chart,i=t.helpers}.call(this),function(){"use strict";var n=this,t=n.Chart,i=t.helpers}.call(this),function(){"use strict";var i=this,t=i.Chart,n=t.helpers;t.Type.extend({name:"Line",defaults:{scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%><\/span><\/li><%}%><\/ul>',offsetGridLines:!1},initialize:function(i){this.PointClass=t.Point.extend({offsetGridLines:this.options.offsetGridLines,strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,active:!1,first:!1,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(n){return Math.pow(n-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}});this.datasets=[];this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getPointsAtEvent(t):[];this.eachPoints(function(n){n.active=!1;n.restore(["fillColor","strokeColor"])});i.length>0&&(i=[i[0]],n.each(i,function(n){n.active=!0;n.fillColor=n.highlightFill;n.strokeColor=n.highlightStroke}));this.showTooltip(i)});skipLabels=this.options.labelskip;n.each(i.datasets,function(t){var r={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,pointColor:t.pointColor,pointStrokeColor:t.pointStrokeColor,points:[]};this.datasets.push(r);n.each(t.data,function(n,u){var f;n instanceof FoodParent.Note?(f=!1,u==0?f=!0:t.data[u].getId()!=t.data[u-1].getId()&&(f=!0),r.points.push(new this.PointClass({id:n.getId(),value:n.getRate(),label:i.labels[u],first:f,datasetLabel:t.label,strokeColor:t.pointStrokeColor,fillColor:t.pointColor,highlightFill:t.pointHighlightFill||t.pointColor,highlightStroke:t.pointHighlightStroke||t.pointStrokeColor}))):n instanceof FoodParent.Donation&&(f=!1,u==0?f=!0:t.data[u].getId()!=t.data[u-1].getId()&&t.data[u].getQuantity()!=0&&(f=!0),r.points.push(new this.PointClass({id:n.getId(),value:n.getCumulativeQuantity(),label:i.labels[u],first:f,datasetLabel:t.label,strokeColor:t.pointStrokeColor,fillColor:t.pointColor,highlightFill:t.pointHighlightFill||t.pointColor,highlightStroke:t.pointHighlightStroke||t.pointStrokeColor})))},this);this.buildScale(i.labels);this.eachPoints(function(t,i){n.extend(t,{x:this.scale.calculateX(i),y:this.scale.endPoint});t.save()},this)},this);this.render()},update:function(){this.scale.update();n.each(this.activeElements,function(n){n.restore(["fillColor","strokeColor"])});this.eachPoints(function(n){n.save()});this.render()},eachPoints:function(t){n.each(this.datasets,function(i){n.each(i.points,t,this)},this)},getPointsAtEvent:function(t){var i=[],r=n.getRelativePosition(t);return n.each(this.datasets,function(t){n.each(t.points,function(n){n.inRange(r.x,r.y)&&i.push(n)})},this),i},buildScale:function(i){var u=this,f=function(){var n=[];return u.eachPoints(function(t){n.push(t.value)}),n},r={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,offsetGridLines:this.options.offsetGridLines,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:i.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=n.calculateScaleRange(f(),t,this.fontSize,this.beginAtZero,this.integersOnly);n.extend(this,i)},xLabels:i,font:n.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&n.extend(r,{calculateYRange:n.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth});this.scale=new t.Scale(r)},addData:function(t,i){n.each(t,function(n,t){this.datasets[t].points.push(new this.PointClass({value:n,label:i,datasetLabel:this.datasets[t].label,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[t].pointStrokeColor,fillColor:this.datasets[t].pointColor}))},this);this.scale.addXLabel(i);this.update()},removeData:function(){this.scale.removeXLabel();n.each(this.datasets,function(n){n.points.shift()},this);this.update()},reflow:function(){var t=n.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var u=t||1;this.clear();var i=this.chart.ctx,r=function(n){return n.value!==null},e=function(t,i,u){return n.findNextWhere(i,r,u)||t},f=function(t,i,u){return n.findPreviousWhere(i,r,u)||t};this.scale&&(this.scale.draw(u),n.each(this.datasets,function(t){var o=n.where(t.points,r);n.each(t.points,function(n,t){n.hasValue()&&n.transition({y:this.scale.calculateY(n.value),x:this.scale.calculateX(t)},u)},this);this.options.bezierCurve&&n.each(o,function(t,i){var r=i>0&&i<o.length-1?this.options.bezierCurveTension:0;t.controlPoints=n.splineCurve(f(t,o,i),t,e(t,o,i),r);t.controlPoints.outer.y>this.scale.endPoint?t.controlPoints.outer.y=this.scale.endPoint:t.controlPoints.outer.y<this.scale.startPoint&&(t.controlPoints.outer.y=this.scale.startPoint);t.controlPoints.inner.y>this.scale.endPoint?t.controlPoints.inner.y=this.scale.endPoint:t.controlPoints.inner.y<this.scale.startPoint&&(t.controlPoints.inner.y=this.scale.startPoint)},this);i.lineWidth=this.options.datasetStrokeWidth;i.strokeStyle=t.strokeColor;i.beginPath();n.each(o,function(n,t){if(t===0)i.moveTo(n.x,n.y);else if(this.options.bezierCurve){var r=f(n,o,t);i.bezierCurveTo(r.controlPoints.outer.x,r.controlPoints.outer.y,n.controlPoints.inner.x,n.controlPoints.inner.y,n.x,n.y)}else i.lineTo(n.x,n.y)},this);this.options.datasetStroke&&i.stroke();this.options.datasetFill&&o.length>0&&(i.lineTo(o[o.length-1].x,this.scale.endPoint),i.lineTo(o[0].x,this.scale.endPoint),i.fillStyle=t.fillColor,i.closePath(),i.fill());n.each(o,function(n){n.draw()})},this))}})}.call(this),function(){"use strict";var n=this,t=n.Chart,i=t.helpers}.call(this),function(){"use strict";function n(n,t,i,r){function e(n,t){for(var r,i=0;i<n.length;i++)r=n[i],t(r,i)}function s(n){h(n);c(n);l(n)}function h(n){n.addEventListener("mouseover",function(){e(u,function(t,i){i<=parseInt(n.getAttribute("data-index"))?t.classList.add("is-active"):t.classList.remove("is-active")})})}function c(n){n.addEventListener("mouseout",function(n){u.indexOf(n.relatedTarget)===-1&&f(null,!1)})}function l(n){n.addEventListener("click",function(t){t.preventDefault();f(parseInt(n.getAttribute("data-index"))+1,!0)})}function f(n,f){n&&n<0||n>i||(f===undefined&&(f=!0),t=n||t,e(u,function(n,i){i<t?n.classList.add("is-active"):n.classList.remove("is-active")}),r&&f&&r(o()))}function o(){return t}var u=[];return function(){var f,r;if(!n)throw Error("No element supplied.");if(!i)throw Error("No max rating supplied.");if(t||(t=0),t<0||t>i)throw Error("Current rating is out of bounds.");for(f=0;f<i;f++)r=document.createElement("li"),f==0?r.classList.add("c-rating__item2"):r.classList.add("c-rating__item"),r.setAttribute("data-index",f),f<t&&r.classList.add("is-active"),n.appendChild(r),u.push(r),s(r)}(),{setRating:f,getRating:o}}window.rating=n}();
/*!
 * pickadate.js v3.5.6, 2015/04/20
 * By Amsul, http://amsul.ca
 * Hosted on http://amsul.github.io/pickadate.js
 * Licensed under MIT
 */
(function(n){typeof define=="function"&&define.amd?define("picker",["jquery"],n):typeof exports=="object"?module.exports=n(require("jquery")):this.Picker=n(jQuery)})(function(n){function t(e,s,l,a){function g(){return t._.node("div",t._.node("div",t._.node("div",t._.node("div",v.component.nodes(y.open),w.box),w.wrap),w.frame),w.holder,'tabindex="-1"')}function rt(){if(b.data(s,v).addClass(w.input).val(b.data("value")?v.get("select",p.format):e.value),!p.editable)b.on("focus."+y.id+" click."+y.id,function(n){n.preventDefault();v.open()}).on("keydown."+y.id,it);i(e,{haspopup:!0,expanded:!1,readonly:!1,owns:e.id+"_root"})}function ut(){i(v.$root[0],"hidden",!0)}function nt(){v.$holder.on({keydown:it,"focus.toOpen":tt,blur:function(){b.removeClass(w.target)},focusin:function(n){v.$root.removeClass(w.focused);n.stopPropagation()},"mousedown click":function(t){var i=t.target;i!=v.$holder[0]&&(t.stopPropagation(),t.type!="mousedown"||n(i).is("input, select, textarea, button, option")||(t.preventDefault(),v.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var r=n(this),t=r.data(),u=r.hasClass(w.navDisabled)||r.hasClass(w.disabled),i=o();i=i&&(i.type||i.href);(u||i&&!n.contains(v.$root[0],i))&&v.$holder[0].focus();!u&&t.nav?v.set("highlight",v.component.item.highlight,{nav:t.nav}):!u&&"pick"in t?(v.set("select",t.pick),p.closeOnSelect&&v.close(!0)):t.clear?(v.clear(),p.closeOnClear&&v.close(!0)):t.close&&v.close(!0)})}function ft(){var t;p.hiddenName===!0?(t=e.name,e.name=""):(t=[typeof p.hiddenPrefix=="string"?p.hiddenPrefix:"",typeof p.hiddenSuffix=="string"?p.hiddenSuffix:"_submit"],t=t[0]+e.name+t[1]);v._hidden=n('<input type=hidden name="'+t+'"'+(b.data("value")||e.value?' value="'+v.get("select",p.formatSubmit)+'"':"")+">")[0];b.on("change."+y.id,function(){v._hidden.value=e.value?v.get("select",p.formatSubmit):""})}function et(){if(k&&h)v.$holder.find("."+w.frame).one("transitionend",function(){v.$holder[0].focus()});else v.$holder[0].focus()}function tt(n){n.stopPropagation();b.addClass(w.target);v.$root.addClass(w.focused)}function it(n){var t=n.keyCode,i=/^(8|46)$/.test(t);if(t==27)return v.close(!0),!1;(t==32||i||!y.open&&v.component.key[t])&&(n.preventDefault(),n.stopPropagation(),i?v.clear().close():v.open())}if(!e)return t;var k=!1,y={id:e.id||"P"+Math.abs(~~(Math.random()*new Date))},p=l?n.extend(!0,{},l.defaults,a):a||{},w=n.extend({},t.klasses(),p.klass),b=n(e),d=function(){return this.start()},v=d.prototype={constructor:d,$node:b,start:function(){if(y&&y.start)return v;y.methods={};y.start=!0;y.open=!1;y.type=e.type;e.autofocus=e==o();e.readOnly=!p.editable;e.id=e.id||y.id;e.type!="text"&&(e.type="text");v.component=new l(v,p);v.$root=n('<div class="'+w.picker+'" id="'+e.id+'_root" />');ut();v.$holder=n(g()).appendTo(v.$root);nt();p.formatSubmit&&ft();rt();p.containerHidden?n(p.containerHidden).append(v._hidden):b.after(v._hidden);p.container?n(p.container).append(v.$root):b.after(v.$root);v.on({start:v.component.onStart,render:v.component.onRender,stop:v.component.onStop,open:v.component.onOpen,close:v.component.onClose,set:v.component.onSet}).on({start:p.onStart,render:p.onRender,stop:p.onStop,open:p.onOpen,close:p.onClose,set:p.onSet});return k=c(v.$holder[0]),e.autofocus&&v.open(),v.trigger("start").trigger("render")},render:function(t){return t?(v.$holder=n(g()),nt(),v.$root.html(v.$holder)):v.$root.find("."+w.box).html(v.component.nodes(y.open)),v.trigger("render")},stop:function(){return y.start?(v.close(),v._hidden&&v._hidden.parentNode.removeChild(v._hidden),v.$root.remove(),b.removeClass(w.input).removeData(s),setTimeout(function(){b.off("."+y.id)},0),e.type=y.type,e.readOnly=!1,v.trigger("stop"),y.methods={},y.start=!1,v):v},open:function(o){if(y.open)return v;if(b.addClass(w.active),i(e,"expanded",!0),setTimeout(function(){v.$root.addClass(w.opened);i(v.$root[0],"hidden",!1)},0),o!==!1){y.open=!0;k&&r.css("overflow","hidden").css("padding-right","+="+f());et();u.on("click."+y.id+" focusin."+y.id,function(n){var t=n.target;t!=e&&t!=document&&n.which!=3&&v.close(t===v.$holder[0])}).on("keydown."+y.id,function(i){var r=i.keyCode,u=v.component.key[r],f=i.target;r==27?v.close(!0):f==v.$holder[0]&&(u||r==13)?(i.preventDefault(),u?t._.trigger(v.component.key.go,v,[t._.trigger(u)]):v.$root.find("."+w.highlighted).hasClass(w.disabled)||(v.set("select",v.component.item.highlight),p.closeOnSelect&&v.close(!0))):n.contains(v.$root[0],f)&&r==13&&(i.preventDefault(),f.click())})}return v.trigger("open")},close:function(n){return(n&&(p.editable?e.focus():(v.$holder.off("focus.toOpen").focus(),setTimeout(function(){v.$holder.on("focus.toOpen",tt)},0))),b.removeClass(w.active),i(e,"expanded",!1),setTimeout(function(){v.$root.removeClass(w.opened+" "+w.focused);i(v.$root[0],"hidden",!0)},0),!y.open)?v:(y.open=!1,k&&r.css("overflow","").css("padding-right","-="+f()),u.off("."+y.id),v.trigger("close"))},clear:function(n){return v.set("clear",null,n)},set:function(t,i,r){var u,f,o=n.isPlainObject(t),e=o?t:{};if(r=o&&n.isPlainObject(i)?i:r||{},t){o||(e[t]=i);for(u in e)f=e[u],u in v.component.item&&(f===undefined&&(f=null),v.component.set(u,f,r)),(u=="select"||u=="clear")&&b.val(u=="clear"?"":v.get(u,p.format)).trigger("change");v.render()}return r.muted?v:v.trigger("set",e)},get:function(n,i){if(n=n||"value",y[n]!=null)return y[n];if(n=="valueSubmit"){if(v._hidden)return v._hidden.value;n="value"}if(n=="value")return e.value;if(n in v.component.item){if(typeof i=="string"){var r=v.component.get(n);return r?t._.trigger(v.component.formats.toString,v.component,[i,r]):""}return v.component.get(n)}},on:function(t,i,r){var u,e,o=n.isPlainObject(t),f=o?t:{};if(t){o||(f[t]=i);for(u in f)e=f[u],r&&(u="_"+u),y.methods[u]=y.methods[u]||[],y.methods[u].push(e)}return v},off:function(){var n,t,i=arguments;for(n=0,namesCount=i.length;n<namesCount;n+=1)t=i[n],t in y.methods&&delete y.methods[t];return v},trigger:function(n,i){var r=function(n){var r=y.methods[n];r&&r.map(function(n){t._.trigger(n,v,[i])})};return r("_"+n),r(n),v}};return new d}function c(n){var t,i="position";return n.currentStyle?t=n.currentStyle[i]:window.getComputedStyle&&(t=getComputedStyle(n)[i]),t=="fixed"}function f(){var t,i,u,f;return r.height()<=s.height()?0:(t=n('<div style="visibility:hidden;width:100px" />').appendTo("body"),i=t[0].offsetWidth,t.css("overflow","scroll"),u=n('<div style="width:100%" />').appendTo(t),f=u[0].offsetWidth,t.remove(),i-f)}function i(t,i,r){if(n.isPlainObject(i))for(var u in i)e(t,u,i[u]);else e(t,i,r)}function e(n,t,i){n.setAttribute((t=="role"?"":"aria-")+t,i)}function l(t,i){var r,u,f;n.isPlainObject(t)||(t={attribute:i});i="";for(r in t)u=(r=="role"?"":"aria-")+r,f=t[r],i+=f==null?"":u+'="'+t[r]+'"';return i}function o(){try{return document.activeElement}catch(n){}}var s=n(window),u=n(document),r=n(document.documentElement),h=document.documentElement.style.transition!=null;return t.klasses=function(n){return n=n||"picker",{picker:n,opened:n+"--opened",focused:n+"--focused",input:n+"__input",active:n+"__input--active",target:n+"__input--target",holder:n+"__holder",frame:n+"__frame",wrap:n+"__wrap",box:n+"__box"}},t._={group:function(n){for(var i,u="",r=t._.trigger(n.min,n);r<=t._.trigger(n.max,n,[r]);r+=n.i)i=t._.trigger(n.item,n,[r]),u+=t._.node(n.node,i[0],i[1],i[2]);return u},node:function(t,i,r,u){return i?(i=n.isArray(i)?i.join(""):i,r=r?' class="'+r+'"':"",u=u?" "+u:"","<"+t+r+u+">"+i+"<\/"+t+">"):""},lead:function(n){return(n<10?"0":"")+n},trigger:function(n,t,i){return typeof n=="function"?n.apply(t,i||[]):n},digits:function(n){return/\d/.test(n[1])?2:1},isDate:function(n){return{}.toString.call(n).indexOf("Date")>-1&&this.isInteger(n.getDate())},isInteger:function(n){return{}.toString.call(n).indexOf("Number")>-1&&n%1==0},ariaAttr:l},t.extend=function(i,r){n.fn[i]=function(u,f){var e=this.data(i);return u=="picker"?e:e&&typeof u=="string"?t._.trigger(e[u],e,[f]):this.each(function(){var f=n(this);f.data(i)||new t(this,i,r,u)})};n.fn[i].defaults=r.defaults},t});
/*!
 * Date picker for pickadate.js v3.5.6
 * http://amsul.github.io/pickadate.js/date.htm
 */
(function(n){typeof define=="function"&&define.amd?define(["picker","jquery"],n):typeof exports=="object"?module.exports=n(require("./picker.js"),require("jquery")):n(Picker,jQuery)})(function(n,t){function r(n,t){var i=this,r=n.$node[0],o=r.value,u=n.$node.data("value"),f=u||o,s=u?t.formatSubmit:t.format,e=function(){return r.currentStyle?r.currentStyle.direction=="rtl":getComputedStyle(n.$root[0]).direction=="rtl"};i.settings=t;i.$node=n.$node;i.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"};i.item={};i.item.clear=null;i.item.disable=(t.disable||[]).slice(0);i.item.enable=-function(n){return n[0]===!0?n.shift():-1}(i.item.disable);i.set("min",t.min).set("max",t.max).set("now");f?i.set("select",f,{format:s,defaultValue:!0}):i.set("select",null).set("highlight",i.item.now);i.key={40:7,38:-7,39:function(){return e()?-1:1},37:function(){return e()?1:-1},go:function(n){var t=i.item.highlight,r=new Date(t.year,t.month,t.date+n);i.set("highlight",r,{interval:n});this.render()}};n.on("render",function(){n.$root.find("."+t.klass.selectMonth).on("change",function(){var i=this.value;i&&(n.set("highlight",[n.get("view").year,i,n.get("highlight").date]),n.$root.find("."+t.klass.selectMonth).trigger("focus"))});n.$root.find("."+t.klass.selectYear).on("change",function(){var i=this.value;i&&(n.set("highlight",[i,n.get("view").month,n.get("highlight").date]),n.$root.find("."+t.klass.selectYear).trigger("focus"))})},1).on("open",function(){var r="";i.disabled(i.get("now"))&&(r=":not(."+t.klass.buttonToday+")");n.$root.find("button"+r+", select").attr("disabled",!1)},1).on("close",function(){n.$root.find("button, select").attr("disabled",!0)},1)}var u=7,f=6,i=n._;r.prototype.set=function(n,t,i){var r=this,u=r.item;return t===null?(n=="clear"&&(n="select"),u[n]=t,r):(u[n=="enable"?"disable":n=="flip"?"enable":n]=r.queue[n].split(" ").map(function(u){return t=r[u](n,t,i)}).pop(),n=="select"?r.set("highlight",u.select,i):n=="highlight"?r.set("view",u.highlight,i):n.match(/^(flip|min|max|disable|enable)$/)&&(u.select&&r.disabled(u.select)&&r.set("select",u.select,i),u.highlight&&r.disabled(u.highlight)&&r.set("highlight",u.highlight,i)),r)};r.prototype.get=function(n){return this.item[n]};r.prototype.create=function(n,r,u){var f,e=this;return r=r===undefined?n:r,r==-Infinity||r==Infinity?f=r:t.isPlainObject(r)&&i.isInteger(r.pick)?r=r.obj:t.isArray(r)?(r=new Date(r[0],r[1],r[2]),r=i.isDate(r)?r:e.create().obj):r=i.isInteger(r)||i.isDate(r)?e.normalize(new Date(r),u):e.now(n,r,u),{year:f||r.getFullYear(),month:f||r.getMonth(),date:f||r.getDate(),day:f||r.getDay(),obj:f||r,pick:f||r.getTime()}};r.prototype.createRange=function(n,r){var f=this,u=function(n){return n===!0||t.isArray(n)||i.isDate(n)?f.create(n):n};return i.isInteger(n)||(n=u(n)),i.isInteger(r)||(r=u(r)),i.isInteger(n)&&t.isPlainObject(r)?n=[r.year,r.month,r.date+n]:i.isInteger(r)&&t.isPlainObject(n)&&(r=[n.year,n.month,n.date+r]),{from:u(n),to:u(r)}};r.prototype.withinRange=function(n,t){return n=this.createRange(n.from,n.to),t.pick>=n.from.pick&&t.pick<=n.to.pick};r.prototype.overlapRanges=function(n,t){var i=this;return n=i.createRange(n.from,n.to),t=i.createRange(t.from,t.to),i.withinRange(n,t.from)||i.withinRange(n,t.to)||i.withinRange(t,n.from)||i.withinRange(t,n.to)};r.prototype.now=function(n,t,i){return t=new Date,i&&i.rel&&t.setDate(t.getDate()+i.rel),this.normalize(t,i)};r.prototype.navigate=function(n,i,r){var s,f,u,e,c=t.isArray(i),h=t.isPlainObject(i),o=this.item.view;if(c||h){for(h?(f=i.year,u=i.month,e=i.date):(f=+i[0],u=+i[1],e=+i[2]),r&&r.nav&&o&&o.month!==u&&(f=o.year,u=o.month),s=new Date(f,u+(r&&r.nav?r.nav:0),1),f=s.getFullYear(),u=s.getMonth();new Date(f,u,e).getMonth()!==u;)e-=1;i=[f,u,e]}return i};r.prototype.normalize=function(n){return n.setHours(0,0,0,0),n};r.prototype.measure=function(n,t){var r=this;return t?typeof t=="string"?t=r.parse(n,t):i.isInteger(t)&&(t=r.now(n,t,{rel:t})):t=n=="min"?-Infinity:Infinity,t};r.prototype.viewset=function(n,t){return this.create([t.year,t.month,1])};r.prototype.validate=function(n,r,u){var f=this,c=r,e=u&&u.interval?u.interval:1,h=f.item.enable===-1,l,a,o=f.item.min,s=f.item.max,v,y,p=h&&f.item.disable.filter(function(n){if(t.isArray(n)){var u=f.create(n).pick;u<r.pick?l=!0:u>r.pick&&(a=!0)}return i.isInteger(n)}).length;if((!u||!u.nav&&!u.defaultValue)&&(!h&&f.disabled(r)||h&&f.disabled(r)&&(p||l||a)||!h&&(r.pick<=o.pick||r.pick>=s.pick)))for(h&&!p&&(!a&&e>0||!l&&e<0)&&(e*=-1);f.disabled(r);){if(Math.abs(e)>1&&(r.month<c.month||r.month>c.month)&&(r=c,e=e>0?1:-1),r.pick<=o.pick?(v=!0,e=1,r=f.create([o.year,o.month,o.date+(r.pick===o.pick?0:-1)])):r.pick>=s.pick&&(y=!0,e=-1,r=f.create([s.year,s.month,s.date+(r.pick===s.pick?0:1)])),v&&y)break;r=f.create([r.year,r.month,r.date+e])}return r};r.prototype.disabled=function(n){var r=this,u=r.item.disable.filter(function(u){return i.isInteger(u)?n.day===(r.settings.firstDay?u:u-1)%7:t.isArray(u)||i.isDate(u)?n.pick===r.create(u).pick:t.isPlainObject(u)?r.withinRange(u,n):void 0});return u=u.length&&!u.filter(function(n){return t.isArray(n)&&n[3]=="inverted"||t.isPlainObject(n)&&n.inverted}).length,r.item.enable===-1?!u:u||n.pick<r.item.min.pick||n.pick>r.item.max.pick};r.prototype.parse=function(n,t,r){var f=this,u={};return!t||typeof t!="string"?t:(r&&r.format||(r=r||{},r.format=f.settings.format),f.formats.toArray(r.format).map(function(n){var r=f.formats[n],e=r?i.trigger(r,f,[t,u]):n.replace(/^!/,"").length;r&&(u[n]=t.substr(0,e));t=t.substr(e)}),[u.yyyy||u.yy,+(u.mm||u.m)-1,u.dd||u.d])};r.prototype.formats=function(){function n(n,t,i){var r=n.match(/[^\x00-\x7F]+|\w+/)[0];return i.mm||i.m||(i.m=t.indexOf(r)+1),r.length}function t(n){return n.match(/\w+/)[0].length}return{d:function(n,t){return n?i.digits(n):t.date},dd:function(n,t){return n?2:i.lead(t.date)},ddd:function(n,i){return n?t(n):this.settings.weekdaysShort[i.day]},dddd:function(n,i){return n?t(n):this.settings.weekdaysFull[i.day]},m:function(n,t){return n?i.digits(n):t.month+1},mm:function(n,t){return n?2:i.lead(t.month+1)},mmm:function(t,i){var r=this.settings.monthsShort;return t?n(t,r,i):r[i.month]},mmmm:function(t,i){var r=this.settings.monthsFull;return t?n(t,r,i):r[i.month]},yy:function(n,t){return n?2:(""+t.year).slice(2)},yyyy:function(n,t){return n?4:t.year},toArray:function(n){return n.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(n,t){var r=this;return r.formats.toArray(n).map(function(n){return i.trigger(r.formats[n],r,[0,t])||n.replace(/^!/,"")}).join("")}}}();r.prototype.isDateExact=function(n,r){var u=this;return i.isInteger(n)&&i.isInteger(r)||typeof n=="boolean"&&typeof r=="boolean"?n===r:(i.isDate(n)||t.isArray(n))&&(i.isDate(r)||t.isArray(r))?u.create(n).pick===u.create(r).pick:t.isPlainObject(n)&&t.isPlainObject(r)?u.isDateExact(n.from,r.from)&&u.isDateExact(n.to,r.to):!1};r.prototype.isDateOverlap=function(n,r){var u=this,f=u.settings.firstDay?1:0;return i.isInteger(n)&&(i.isDate(r)||t.isArray(r))?(n=n%7+f,n===u.create(r).day+1):i.isInteger(r)&&(i.isDate(n)||t.isArray(n))?(r=r%7+f,r===u.create(n).day+1):t.isPlainObject(n)&&t.isPlainObject(r)?u.overlapRanges(n,r):!1};r.prototype.flipEnable=function(n){var t=this.item;t.enable=n||(t.enable==-1?1:-1)};r.prototype.deactivate=function(n,r){var f=this,u=f.item.disable.slice(0);return r=="flip"?f.flipEnable():r===!1?(f.flipEnable(1),u=[]):r===!0?(f.flipEnable(-1),u=[]):r.map(function(n){for(var e,r=0;r<u.length;r+=1)if(f.isDateExact(n,u[r])){e=!0;break}e||(i.isInteger(n)||i.isDate(n)||t.isArray(n)||t.isPlainObject(n)&&n.from&&n.to)&&u.push(n)}),u};r.prototype.activate=function(n,r){var f=this,u=f.item.disable,e=u.length;return r=="flip"?f.flipEnable():r===!0?(f.flipEnable(1),u=[]):r===!1?(f.flipEnable(-1),u=[]):r.map(function(n){for(var o,s,h,r=0;r<e;r+=1)if(s=u[r],f.isDateExact(s,n)){o=u[r]=null;h=!0;break}else if(f.isDateOverlap(s,n)){t.isPlainObject(n)?(n.inverted=!0,o=n):t.isArray(n)?(o=n,o[3]||o.push("inverted")):i.isDate(n)&&(o=[n.getFullYear(),n.getMonth(),n.getDate(),"inverted"]);break}if(o)for(r=0;r<e;r+=1)if(f.isDateExact(u[r],n)){u[r]=null;break}if(h)for(r=0;r<e;r+=1)if(f.isDateOverlap(u[r],n)){u[r]=null;break}o&&u.push(o)}),u.filter(function(n){return n!=null})};r.prototype.nodes=function(n){var r=this,t=r.settings,o=r.item,c=o.now,l=o.select,a=o.highlight,e=o.view,w=o.disable,s=o.min,h=o.max,b=function(n,r){return t.firstDay&&(n.push(n.shift()),r.push(r.shift())),i.node("thead",i.node("tr",i.group({min:0,max:u-1,i:1,node:"th",item:function(i){return[n[i],t.klass.weekdays,'scope=col title="'+r[i]+'"']}})))}((t.showWeekdaysFull?t.weekdaysFull:t.weekdaysShort).slice(0),t.weekdaysFull.slice(0)),v=function(n){return i.node("div"," ",t.klass["nav"+(n?"Next":"Prev")]+(n&&e.year>=h.year&&e.month>=h.month||!n&&e.year<=s.year&&e.month<=s.month?" "+t.klass.navDisabled:""),"data-nav="+(n||-1)+" "+i.ariaAttr({role:"button",controls:r.$node[0].id+"_table"})+' title="'+(n?t.labelMonthNext:t.labelMonthPrev)+'"')},y=function(){var u=t.showMonthsShort?t.monthsShort:t.monthsFull;return t.selectMonths?i.node("select",i.group({min:0,max:11,i:1,node:"option",item:function(n){return[u[n],0,"value="+n+(e.month==n?" selected":"")+(e.year==s.year&&n<s.month||e.year==h.year&&n>h.month?" disabled":"")]}}),t.klass.selectMonth,(n?"":"disabled")+" "+i.ariaAttr({controls:r.$node[0].id+"_table"})+' title="'+t.labelMonthSelect+'"'):i.node("div",u[e.month],t.klass.month)},p=function(){var o=e.year,l=t.selectYears===!0?5:~~(t.selectYears/2),v,y;if(l){var c=s.year,a=h.year,u=o-l,f=o+l;return c>u&&(f+=c-u,u=c),a<f&&(v=u-c,y=f-a,u-=v>y?y:v,f=a),i.node("select",i.group({min:u,max:f,i:1,node:"option",item:function(n){return[n,0,"value="+n+(o==n?" selected":"")]}}),t.klass.selectYear,(n?"":"disabled")+" "+i.ariaAttr({controls:r.$node[0].id+"_table"})+' title="'+t.labelYearSelect+'"')}return i.node("div",o,t.klass.year)};return i.node("div",(t.selectYears?p()+y():y()+p())+v()+v(1),t.klass.header)+i.node("table",b+i.node("tbody",i.group({min:0,max:f-1,i:1,node:"tr",item:function(n){var f=t.firstDay&&r.create([e.year,e.month,1]).day===0?-7:0;return[i.group({min:u*n-e.day+f+1,max:function(){return this.min+u-1},i:1,node:"td",item:function(n){n=r.create([e.year,e.month,n+(t.firstDay?1:0)]);var u=l&&l.pick==n.pick,f=a&&a.pick==n.pick,o=w&&r.disabled(n)||n.pick<s.pick||n.pick>h.pick,v=i.trigger(r.formats.toString,r,[t.format,n]);return[i.node("div",n.date,function(i){return i.push(e.month==n.month?t.klass.infocus:t.klass.outfocus),c.pick==n.pick&&i.push(t.klass.now),u&&i.push(t.klass.selected),f&&i.push(t.klass.highlighted),o&&i.push(t.klass.disabled),i.join(" ")}([t.klass.day]),"data-pick="+n.pick+" "+i.ariaAttr({role:"gridcell",label:v,selected:u&&r.$node.val()===v?!0:null,activedescendant:f?!0:null,disabled:o?!0:null})),"",i.ariaAttr({role:"presentation"})]}})]}})),t.klass.table,'id="'+r.$node[0].id+'_table" '+i.ariaAttr({role:"grid",controls:r.$node[0].id,readonly:!0}))+i.node("div",i.node("button",t.today,t.klass.buttonToday,"type=button data-pick="+c.pick+(n&&!r.disabled(c)?"":" disabled")+" "+i.ariaAttr({controls:r.$node[0].id}))+i.node("button",t.clear,t.klass.buttonClear,"type=button data-clear=1"+(n?"":" disabled")+" "+i.ariaAttr({controls:r.$node[0].id}))+i.node("button",t.close,t.klass.buttonClose,"type=button data-close=true "+(n?"":" disabled")+" "+i.ariaAttr({controls:r.$node[0].id})),t.klass.footer)};r.defaults=function(n){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,format:"d mmmm, yyyy",klass:{table:n+"table",header:n+"header",navPrev:n+"nav--prev",navNext:n+"nav--next",navDisabled:n+"nav--disabled",month:n+"month",year:n+"year",selectMonth:n+"select--month",selectYear:n+"select--year",weekdays:n+"weekday",day:n+"day",disabled:n+"day--disabled",selected:n+"day--selected",highlighted:n+"day--highlighted",now:n+"day--today",infocus:n+"day--infocus",outfocus:n+"day--outfocus",footer:n+"footer",buttonClear:n+"button--clear",buttonToday:n+"button--today",buttonClose:n+"button--close"}}}(n.klasses().picker+"__");n.extend("pickadate",r)});
/*!
 * Legacy browser support
 */
[].map||(Array.prototype.map=function(n,t){for(var r=this,u=r.length,f=new Array(u),i=0;i<u;i++)i in r&&(f[i]=n.call(t,r[i],i,r));return f});[].filter||(Array.prototype.filter=function(n){var i,f,r,e,t,u;if(this==null)throw new TypeError;if(i=Object(this),f=i.length>>>0,typeof n!="function")throw new TypeError;for(r=[],e=arguments[1],t=0;t<f;t++)t in i&&(u=i[t],n.call(e,u,t,i)&&r.push(u));return r});[].indexOf||(Array.prototype.indexOf=function(n){var u,r,t,i;if(this==null)throw new TypeError;if((u=Object(this),r=u.length>>>0,r===0)||(t=0,arguments.length>1&&(t=Number(arguments[1]),t!=t?t=0:t!==0&&t!=Infinity&&t!=-Infinity&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=r))return-1;for(i=t>=0?t:Math.max(r-Math.abs(t),0);i<r;i++)if(i in u&&u[i]===n)return i;return-1});
/*!
 * Cross-Browser Split 1.1.1
 * Copyright 2007-2012 Steven Levithan <stevenlevithan.com>
 * Available under the MIT License
 * http://blog.stevenlevithan.com/archives/cross-browser-split
 */
nativeSplit=String.prototype.split;compliantExecNpcg=/()??/.exec("")[1]===undefined;String.prototype.split=function(n,t){var u=this;if(Object.prototype.toString.call(n)!=="[object RegExp]")return nativeSplit.call(u,n,t);var r=[],o=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.extended?"x":"")+(n.sticky?"y":""),f=0,s,i,e,h;for(n=new RegExp(n.source,o+"g"),u+="",compliantExecNpcg||(s=new RegExp("^"+n.source+"$(?!\\s)",o)),t=t===undefined?-1>>>0:t>>>0;i=n.exec(u);){if(e=i.index+i[0].length,e>f&&(r.push(u.slice(f,i.index)),!compliantExecNpcg&&i.length>1&&i[0].replace(s,function(){for(var n=1;n<arguments.length-2;n++)arguments[n]===undefined&&(i[n]=undefined)}),i.length>1&&i.index<u.length&&Array.prototype.push.apply(r,i.slice(1)),h=i[0].length,f=e,r.length>=t))break;n.lastIndex===i.index&&n.lastIndex++}return f===u.length?(h||!n.test(""))&&r.push(""):r.push(u.slice(f)),r.length>t?r.slice(0,t):r};
/**
 * @preserve  textfill
 * @name      jquery.textfill.js
 * @author    Russ Painter
 * @author    Yu-Jie Lin
 * @author    Alexandre Dantas
 * @version   0.6.0
 * @date      2014-08-19
 * @copyright (c) 2014 Alexandre Dantas
 * @copyright (c) 2012-2013 Yu-Jie Lin
 * @copyright (c) 2009 Russ Painter
 * @license   MIT License
 * @homepage  https://github.com/jquery-textfill/jquery-textfill
 * @example   http://jquery-textfill.github.io/jquery-textfill/index.html
 */
(function(n){n.fn.textfill=function(t){function r(){i.debug&&typeof console!="undefined"&&typeof console.debug!="undefined"&&console.debug.apply(console,arguments)}function e(){typeof console!="undefined"&&typeof console.warn!="undefined"&&console.warn.apply(console,arguments)}function u(n,t,i,u,f,e){function o(n,t){var i=" / ";return n>t?i=" > ":n==t&&(i=" = "),i}r("[TextFill] "+n+" { font-size: "+t.css("font-size")+",Height: "+t.height()+"px "+o(t.height(),i)+i+"px,Width: "+t.width()+o(t.width(),u)+u+",minFontPixels: "+f+"px, maxFontPixels: "+e+"px }")}function f(n,t,i,r,f,e,o,s){for(u(n,t,f,e,o,s);o<s-1;){var h=Math.floor((o+s)/2);if(t.css("font-size",h),i.call(t)<=r){if(o=h,i.call(t)==r)break}else s=h;u(n,t,f,e,o,s)}return t.css("font-size",s),i.call(t)<=r&&(o=s,u(n+"* ",t,f,e,o,s)),o}var i=n.extend({debug:!1,maxFontPixels:40,minFontPixels:4,innerTag:"span",widthOnly:!1,success:null,callback:null,fail:null,complete:null,explicitWidth:null,explicitHeight:null,changeLineHeight:!1},t);return r("[TextFill] Start Debug"),this.each(function(){var t=n(i.innerTag+":visible:first",this),u=i.explicitHeight||n(this).height(),o=i.explicitWidth||n(this).width(),h=t.css("font-size"),l=parseFloat(t.css("line-height"))/parseFloat(h),s,c;r("[TextFill] Inner text: "+t.text());r("[TextFill] All options: ",i);r("[TextFill] Maximum sizes: { Height: "+u+"px, Width: "+o+"px }");var a=i.minFontPixels,v=i.maxFontPixels<=0?u:i.maxFontPixels,y=undefined;i.widthOnly||(y=f("Height",t,n.fn.height,u,u,o,a,v));s=undefined;s=f("Width",t,n.fn.width,o,u,o,a,v);i.widthOnly?(t.css({"font-size":s,"white-space":"nowrap"}),i.changeLineHeight&&t.parent().css("line-height",l*s+"px")):(c=Math.min(y,s),t.css("font-size",c),i.changeLineHeight&&t.parent().css("line-height",l*c+"px"));r("[TextFill] Finished { Old font-size: "+h+", New font-size: "+t.css("font-size")+" }");t.width()>o||t.height()>u&&!i.widthOnly?(t.css("font-size",h),i.fail&&i.fail(this),r("[TextFill] Failure { Current Width: "+t.width()+", Maximum Width: "+o+", Current Height: "+t.height()+", Maximum Height: "+u+" }")):i.success?i.success(this):i.callback&&(e("callback is deprecated, use success, instead"),i.callback(this))}),i.complete&&i.complete(this),r("[TextFill] End Debug"),this}})(window.jQuery),function(){var nt,ct,lt,at,vt,yt,pt,wt,a,n,bt,kt,tt,dt,gt,o,ni,r,v,y,it,s,p,ti,rt,ut,f,ii,u,t,w,ft,ri,h,et,b,i,e,ot,c,k,st,d,g,ui,fi,ht,ei,oi,l=[].slice,si={}.hasOwnProperty,hi=function(n,t){function r(){this.constructor=n}for(var i in t)si.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n},ci=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===n)return t;return-1};for(it={catchupTime:100,initialRate:.03,minTime:250,ghostTime:100,maxProgressPerFrame:20,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:!0,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET","POST","PUT","DELETE"],trackWebSockets:!0,ignoreURLs:[]}},u=function(){var n;return(n=typeof performance!="undefined"&&performance!==null?typeof performance.now=="function"?performance.now():void 0:void 0)!=null?n:+new Date},w=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,y=window.cancelAnimationFrame||window.mozCancelAnimationFrame,w==null&&(w=function(n){return setTimeout(n,50)},y=function(n){return clearTimeout(n)}),ri=function(n){var i,t;return i=u(),t=function(){var r;return r=u()-i,r>=33?(i=u(),n(r,function(){return w(t)})):setTimeout(t,33-r)},t()},ft=function(){var i,t,n;return n=arguments[0],t=arguments[1],i=3<=arguments.length?l.call(arguments,2):[],typeof n[t]=="function"?n[t].apply(n,i):n[t]},s=function(){var n,t,i,f,r,u,e;for(t=arguments[0],f=2<=arguments.length?l.call(arguments,1):[],u=0,e=f.length;u<e;u++)if(i=f[u],i)for(n in i)si.call(i,n)&&(r=i[n],t[n]!=null&&typeof t[n]=="object"&&r!=null&&typeof r=="object"?s(t[n],r):t[n]=r);return t},ni=function(n){var i,r,u,t,f;for(r=i=0,t=0,f=n.length;t<f;t++)u=n[t],r+=Math.abs(u),i++;return r/i},ti=function(n,t){var i,u,r;if(n==null&&(n="options"),t==null&&(t=!0),r=document.querySelector("[data-pace-"+n+"]"),r){if(i=r.getAttribute("data-pace-"+n),!t)return i;try{return JSON.parse(i)}catch(f){return u=f,typeof console!="undefined"&&console!==null?console.error("Error parsing inline pace options",u):void 0}}},pt=function(){function n(){}return n.prototype.on=function(n,t,i,r){var u;return r==null&&(r=!1),this.bindings==null&&(this.bindings={}),(u=this.bindings)[n]==null&&(u[n]=[]),this.bindings[n].push({handler:t,ctx:i,once:r})},n.prototype.once=function(n,t,i){return this.on(n,t,i,!0)},n.prototype.off=function(n,t){var i,u,r;if(((u=this.bindings)!=null?u[n]:void 0)!=null){if(t==null)return delete this.bindings[n];for(i=0,r=[];i<this.bindings[n].length;)this.bindings[n][i].handler===t?r.push(this.bindings[n].splice(i,1)):r.push(i++);return r}},n.prototype.trigger=function(){var f,u,n,e,t,o,s,i,r;if(n=arguments[0],f=2<=arguments.length?l.call(arguments,1):[],(s=this.bindings)!=null?s[n]:void 0){for(t=0,r=[];t<this.bindings[n].length;)i=this.bindings[n][t],e=i.handler,u=i.ctx,o=i.once,e.apply(u!=null?u:this,f),o?r.push(this.bindings[n].splice(t,1)):r.push(t++);return r}},n}(),n=window.Pace||{},window.Pace=n,s(n,pt.prototype),t=n.options=s({},it,window.paceOptions,ti()),ht=["ajax","document","eventLag","elements"],d=0,ui=ht.length;d<ui;d++)i=ht[d],t[i]===!0&&(t[i]=it[i]);a=function(n){function t(){return ei=t.__super__.constructor.apply(this,arguments)}return hi(t,n),t}(Error);ct=function(){function n(){this.progress=0}return n.prototype.getElement=function(){var n;if(this.el==null){if(n=document.querySelector(t.target),!n)throw new a;this.el=document.createElement("div");this.el.className="pace pace-active";document.body.className=document.body.className.replace(/pace-done/g,"");document.body.className+=" pace-running";this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"><\/div>\n<\/div>\n<div class="pace-activity"><\/div>';n.firstChild!=null?n.insertBefore(this.el,n.firstChild):n.appendChild(this.el)}return this.el},n.prototype.finish=function(){var n;return n=this.getElement(),n.className=n.className.replace("pace-active",""),n.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},n.prototype.update=function(n){return this.progress=n,this.render()},n.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(n){a=n}return this.el=void 0},n.prototype.render=function(){var n,u,f,e,i,o,r;if(document.querySelector(t.target)==null)return!1;for(n=this.getElement(),e="translate3d("+this.progress+"%, 0, 0)",r=["webkitTransform","msTransform","transform"],i=0,o=r.length;i<o;i++)u=r[i],n.children[0].style[u]=e;return(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(n.children[0].setAttribute("data-progress-text",""+(this.progress|0)+"%"),f=this.progress>=100?"99":(this.progress<10?"0":"")+(this.progress|0),n.children[0].setAttribute("data-progress",""+f)),this.lastRenderedProgress=this.progress},n.prototype.done=function(){return this.progress>=100},n}();wt=function(){function n(){this.bindings={}}return n.prototype.trigger=function(n,t){var f,i,e,r,u;if(this.bindings[n]!=null){for(r=this.bindings[n],u=[],i=0,e=r.length;i<e;i++)f=r[i],u.push(f.call(this,t));return u}},n.prototype.on=function(n,t){var i;return(i=this.bindings)[n]==null&&(i[n]=[]),this.bindings[n].push(t)},n}();st=window.XMLHttpRequest;k=window.XDomainRequest;c=window.WebSocket;p=function(n,t){var u,i,r=[];for(i in t.prototype)try{n[i]==null&&typeof t[i]!="function"?typeof Object.defineProperty=="function"?r.push(Object.defineProperty(n,i,{get:function(){return t.prototype[i]},configurable:!0,enumerable:!0})):r.push(n[i]=t.prototype[i]):r.push(void 0)}catch(f){u=f}return r};f=[];n.ignore=function(){var n,t,i;return t=arguments[0],n=2<=arguments.length?l.call(arguments,1):[],f.unshift("ignore"),i=t.apply(null,n),f.shift(),i};n.track=function(){var n,t,i;return t=arguments[0],n=2<=arguments.length?l.call(arguments,1):[],f.unshift("track"),i=t.apply(null,n),f.shift(),i};b=function(n){var i;return(n==null&&(n="GET"),f[0]==="track")?"force":!f.length&&t.ajax&&(n==="socket"&&t.ajax.trackWebSockets||(i=n.toUpperCase(),ci.call(t.ajax.trackMethods,i)>=0))?!0:!1};bt=function(n){function i(){var n,r=this;i.__super__.constructor.apply(this,arguments);n=function(n){var t;return t=n.open,n.open=function(i,u){return b(i)&&r.trigger("request",{type:i,url:u,request:n}),t.apply(n,arguments)}};window.XMLHttpRequest=function(t){var i;return i=new st(t),n(i),i};try{p(window.XMLHttpRequest,st)}catch(u){}if(k!=null){window.XDomainRequest=function(){var t;return t=new k,n(t),t};try{p(window.XDomainRequest,k)}catch(u){}}if(c!=null&&t.ajax.trackWebSockets){window.WebSocket=function(n,t){var i;return i=t!=null?new c(n,t):new c(n),b("socket")&&r.trigger("request",{type:"socket",url:n,protocols:t,request:i}),i};try{p(window.WebSocket,c)}catch(u){}}}return hi(i,n),i}(wt);g=null;rt=function(){return g==null&&(g=new bt),g};et=function(n){var i,r,f,u;for(u=t.ajax.ignoreURLs,r=0,f=u.length;r<f;r++)if(i=u[r],typeof i=="string"){if(n.indexOf(i)!==-1)return!0}else if(i.test(n))return!0;return!1};rt().on("request",function(r){var u,o,f,e,s;if(e=r.type,f=r.request,s=r.url,!et(s))return!n.running&&(t.restartOnRequestAfter!==!1||b(e)==="force")?(o=arguments,u=t.restartOnRequestAfter||0,typeof u=="boolean"&&(u=0),setTimeout(function(){var s,t,h,c,r,u;if(s=e==="socket"?f.readyState<2:0<(c=f.readyState)&&c<4,s){for(n.restart(),r=n.sources,u=[],t=0,h=r.length;t<h;t++)if(i=r[t],i instanceof nt){i.watch.apply(i,o);break}else u.push(void 0);return u}},u)):void 0});nt=function(){function n(){var n=this;this.elements=[];rt().on("request",function(){return n.watch.apply(n,arguments)})}return n.prototype.watch=function(n){var t,i,r,u;if(r=n.type,t=n.request,u=n.url,!et(u))return i=r==="socket"?new dt(t):new gt(t),this.elements.push(i)},n}();gt=function(){function n(n){var f,o,i,e,r,u,t=this;if(this.progress=0,window.ProgressEvent!=null)for(o=null,n.addEventListener("progress",function(n){return t.progress=n.lengthComputable?100*n.loaded/n.total:t.progress+(100-t.progress)/2},!1),u=["load","abort","timeout","error"],i=0,e=u.length;i<e;i++)f=u[i],n.addEventListener(f,function(){return t.progress=100},!1);else r=n.onreadystatechange,n.onreadystatechange=function(){var i;return(i=n.readyState)===0||i===4?t.progress=100:n.readyState===3&&(t.progress=50),typeof r=="function"?r.apply(null,arguments):void 0}}return n}();dt=function(){function n(n){var r,t,u,i,f=this;for(this.progress=0,i=["error","open"],t=0,u=i.length;t<u;t++)r=i[t],n.addEventListener(r,function(){return f.progress=100},!1)}return n}();at=function(){function n(n){var r,t,u,i;for(n==null&&(n={}),this.elements=[],n.selectors==null&&(n.selectors=[]),i=n.selectors,t=0,u=i.length;t<u;t++)r=i[t],this.elements.push(new vt(r))}return n}();vt=function(){function n(n){this.selector=n;this.progress=0;this.check()}return n.prototype.check=function(){var n=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return n.check()},t.elements.checkInterval)},n.prototype.done=function(){return this.progress=100},n}();lt=function(){function n(){var n,i,t=this;this.progress=(i=this.states[document.readyState])!=null?i:100;n=document.onreadystatechange;document.onreadystatechange=function(){return t.states[document.readyState]!=null&&(t.progress=t.states[document.readyState]),typeof n=="function"?n.apply(null,arguments):void 0}}return n.prototype.states={loading:0,interactive:50,complete:100},n}();yt=function(){function n(){var i,f,r,e,n,o=this;this.progress=0;i=0;n=[];e=0;r=u();f=setInterval(function(){var s;return s=u()-r-50,r=u(),n.push(s),n.length>t.eventLag.sampleCount&&n.shift(),i=ni(n),++e>=t.eventLag.minSamples&&i<t.eventLag.lagThreshold?(o.progress=100,clearInterval(f)):o.progress=300/(i+3)},50)}return n}();tt=function(){function n(n){this.source=n;this.last=this.sinceLastUpdate=0;this.rate=t.initialRate;this.catchup=0;this.progress=this.lastProgress=0;this.source!=null&&(this.progress=ft(this.source,"progress"))}return n.prototype.tick=function(n,i){var r;return i==null&&(i=ft(this.source,"progress")),i>=100&&(this.done=!0),i===this.last?this.sinceLastUpdate+=n:(this.sinceLastUpdate&&(this.rate=(i-this.last)/this.sinceLastUpdate),this.catchup=(i-this.progress)/t.catchupTime,this.sinceLastUpdate=0,this.last=i),i>this.progress&&(this.progress+=this.catchup*n),r=1-Math.pow(this.progress/100,t.easeFactor),this.progress+=r*this.rate*n,this.progress=Math.min(this.lastProgress+t.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},n}();e=null;h=null;r=null;ot=null;o=null;v=null;n.running=!1;ut=function(){if(t.restartOnPushState)return n.restart()};window.history.pushState!=null&&(fi=window.history.pushState,window.history.pushState=function(){return ut(),fi.apply(window.history,arguments)});window.history.replaceState!=null&&(oi=window.history.replaceState,window.history.replaceState=function(){return ut(),oi.apply(window.history,arguments)});kt={ajax:nt,elements:at,document:lt,eventLag:yt};(ii=function(){var u,f,o,l,a,s,v,c;for(n.sources=e=[],s=["ajax","elements","document","eventLag"],f=0,l=s.length;f<l;f++)u=s[f],t[u]!==!1&&e.push(new kt[u](t[u]));for(c=(v=t.extraSources)!=null?v:[],o=0,a=c.length;o<a;o++)i=c[o],e.push(new i(t));return n.bar=r=new ct,h=[],ot=new tt})();n.stop=function(){return n.trigger("stop"),n.running=!1,r.destroy(),v=!0,o!=null&&(typeof y=="function"&&y(o),o=null),ii()};n.restart=function(){return n.trigger("restart"),n.stop(),n.start()};n.go=function(){var f;return n.running=!0,r.render(),f=u(),v=!1,o=ri(function(o,s){var nt,p,w,it,b,c,l,et,a,y,k,d,g,rt,ut,ft;for(et=100-r.progress,p=k=0,w=!0,c=d=0,rt=e.length;d<rt;c=++d)for(i=e[c],y=h[c]!=null?h[c]:h[c]=[],b=(ft=i.elements)!=null?ft:[i],l=g=0,ut=b.length;g<ut;l=++g)(it=b[l],a=y[l]!=null?y[l]:y[l]=new tt(it),w&=a.done,a.done)||(p++,k+=a.tick(o));return nt=k/p,r.update(ot.tick(o,nt)),r.done()||w||v?(r.update(100),n.trigger("done"),setTimeout(function(){return r.finish(),n.running=!1,n.trigger("hide")},Math.max(t.ghostTime,Math.max(t.minTime-(u()-f),0)))):s()})};n.start=function(i){s(t,i);n.running=!0;try{r.render()}catch(u){a=u}return document.querySelector(".pace")?(n.trigger("start"),n.go()):setTimeout(n.start,50)};typeof define=="function"&&define.amd?define(["pace"],function(){return n}):typeof exports=="object"?module.exports=n:t.startOnPageLoad&&n.start()}.call(this),function(n,t,i){var e=n.L,r={},u,f;r.version="0.7.5";typeof module=="object"&&typeof module.exports=="object"?module.exports=r:typeof define=="function"&&define.amd&&define(r);r.noConflict=function(){return n.L=e,this};n.L=r;r.Util={extend:function(n){for(var u=Array.prototype.slice.call(arguments,1),t,r,i=0,f=u.length;i<f;i++){r=u[i]||{};for(t in r)r.hasOwnProperty(t)&&(n[t]=r[t])}return n},bind:function(n,t){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return n.apply(t,i||arguments)}},stamp:function(){var t=0,n="_leaflet_id";return function(i){return i[n]=i[n]||++t,i[n]}}(),invokeEach:function(n,t,i){var r,u;if(typeof n=="object"){u=Array.prototype.slice.call(arguments,3);for(r in n)t.apply(i,[r,n[r]].concat(u));return!0}return!1},limitExecByInterval:function(n,t,i){var r,u;return function f(){var e=arguments;if(r){u=!0;return}r=!0;setTimeout(function(){r=!1;u&&(f.apply(i,e),u=!1)},t);n.apply(i,e)}},falseFn:function(){return!1},formatNum:function(n,t){var i=Math.pow(10,t||5);return Math.round(n*i)/i},trim:function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},splitWords:function(n){return r.Util.trim(n).split(/\s+/)},setOptions:function(n,t){return n.options=r.extend({},n.options,t),n.options},getParamString:function(n,t,i){var u=[];for(var r in n)u.push(encodeURIComponent(i?r.toUpperCase():r)+"="+encodeURIComponent(n[r]));return(!t||t.indexOf("?")===-1?"?":"&")+u.join("&")},template:function(n,t){return n.replace(/\{ *([\w_]+) *\}/g,function(n,r){var u=t[r];if(u===i)throw new Error("No value provided for variable "+n);else typeof u=="function"&&(u=u(t));return u})},isArray:Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){for(var r,u=["webkit","moz","o","ms"],i=0;i<u.length&&!r;i++)r=n[u[i]+t];return r}function u(t){var r=+new Date,u=Math.max(0,16-(r-i));return i=r+u,n.setTimeout(t,u)}var i=0,f=n.requestAnimationFrame||t("RequestAnimationFrame")||u,e=n.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){n.clearTimeout(t)};r.Util.requestAnimFrame=function(t,i,e,o){if(t=r.bind(t,i),e&&f===u)t();else return f.call(n,t,o)};r.Util.cancelAnimFrame=function(t){t&&e.call(n,t)}}();r.extend=r.Util.extend;r.bind=r.Util.bind;r.stamp=r.Util.stamp;r.setOptions=r.Util.setOptions;r.Class=function(){};r.Class.extend=function(n){var i=function(){this.initialize&&this.initialize.apply(this,arguments);this._initHooks&&this.callInitHooks()},e=function(){},t,u,f;e.prototype=this.prototype;t=new e;t.constructor=i;i.prototype=t;for(u in this)this.hasOwnProperty(u)&&u!=="prototype"&&(i[u]=this[u]);return n.statics&&(r.extend(i,n.statics),delete n.statics),n.includes&&(r.Util.extend.apply(null,[t].concat(n.includes)),delete n.includes),n.options&&t.options&&(n.options=r.extend({},t.options,n.options)),r.extend(t,n),t._initHooks=[],f=this,i.__super__=f.prototype,t.callInitHooks=function(){if(!this._initHooksCalled){f.prototype.callInitHooks&&f.prototype.callInitHooks.call(this);this._initHooksCalled=!0;for(var n=0,i=t._initHooks.length;n<i;n++)t._initHooks[n].call(this)}},i};r.Class.include=function(n){r.extend(this.prototype,n)};r.Class.mergeOptions=function(n){r.extend(this.prototype.options,n)};r.Class.addInitHook=function(n){var t=Array.prototype.slice.call(arguments,1),i=typeof n=="function"?n:function(){this[n].apply(this,t)};this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push(i)};u="_leaflet_events";r.Mixin={};r.Mixin.Events={addEventListener:function(n,t,i){if(r.Util.invokeEach(n,this.addEventListener,this,t,i))return this;var f=this[u]=this[u]||{},o=i&&i!==this&&r.stamp(i),s,v,l,e,h,a,c;for(n=r.Util.splitWords(n),s=0,v=n.length;s<v;s++)l={action:t,context:i||this},e=n[s],o?(h=e+"_idx",a=h+"_len",c=f[h]=f[h]||{},c[o]||(c[o]=[],f[a]=(f[a]||0)+1),c[o].push(l)):(f[e]=f[e]||[],f[e].push(l));return this},hasEventListeners:function(n){var t=this[u];return!!t&&(n in t&&t[n].length>0||n+"_idx"in t&&t[n+"_idx_len"]>0)},removeEventListener:function(n,t,i){if(!this[u])return this;if(!n)return this.clearAllEventListeners();if(r.Util.invokeEach(n,this.removeEventListener,this,t,i))return this;var e=this[u],a=i&&i!==this&&r.stamp(i),h,y,c,f,o,l,v,s,p;for(n=r.Util.splitWords(n),h=0,y=n.length;h<y;h++)if(c=n[h],l=c+"_idx",v=l+"_len",s=e[l],t){if(f=a&&s?s[a]:e[c],f){for(o=f.length-1;o>=0;o--)f[o].action!==t||i&&f[o].context!==i||(p=f.splice(o,1),p[0].action=r.Util.falseFn);i&&s&&f.length===0&&(delete s[a],e[v]--)}}else delete e[c],delete e[l],delete e[v];return this},clearAllEventListeners:function(){return delete this[u],this},fireEvent:function(n,t){if(!this.hasEventListeners(n))return this;var h=r.Util.extend({},t,{type:n,target:this}),o=this[u],f,i,e,s,c;if(o[n])for(f=o[n].slice(),i=0,e=f.length;i<e;i++)f[i].action.call(f[i].context,h);s=o[n+"_idx"];for(c in s)if(f=s[c].slice(),f)for(i=0,e=f.length;i<e;i++)f[i].action.call(f[i].context,h);return this},addOneTimeEventListener:function(n,t,i){if(r.Util.invokeEach(n,this.addOneTimeEventListener,this,t,i))return this;var u=r.bind(function(){this.removeEventListener(n,t,i).removeEventListener(n,u,i)},this);return this.addEventListener(n,t,i).addEventListener(n,u,i)}};r.Mixin.Events.on=r.Mixin.Events.addEventListener;r.Mixin.Events.off=r.Mixin.Events.removeEventListener;r.Mixin.Events.once=r.Mixin.Events.addOneTimeEventListener;r.Mixin.Events.fire=r.Mixin.Events.fireEvent,function(){var f="ActiveXObject"in n,b=f&&!t.addEventListener,u=navigator.userAgent.toLowerCase(),o=u.indexOf("webkit")!==-1,k=u.indexOf("chrome")!==-1,c=u.indexOf("phantom")!==-1,d=u.indexOf("android")!==-1,l=u.search("android [23]")!==-1,g=u.indexOf("gecko")!==-1,e=typeof orientation!=i+"",a=!n.PointerEvent&&n.MSPointerEvent,v=n.PointerEvent&&n.navigator.pointerEnabled&&n.navigator.maxTouchPoints||a,nt="devicePixelRatio"in n&&n.devicePixelRatio>1||"matchMedia"in n&&n.matchMedia("(min-resolution:144dpi)")&&n.matchMedia("(min-resolution:144dpi)").matches,s=t.documentElement,y=f&&"transition"in s.style,h="WebKitCSSMatrix"in n&&"m11"in new n.WebKitCSSMatrix&&!l,p="MozPerspective"in s.style,w="OTransition"in s.style,tt=!n.L_DISABLE_3D&&(y||h||p||w)&&!c,it=!n.L_NO_TOUCH&&!c&&(v||"ontouchstart"in n||n.DocumentTouch&&t instanceof n.DocumentTouch);r.Browser={ie:f,ielt9:b,webkit:o,gecko:g&&!o&&!n.opera&&!f,android:d,android23:l,chrome:k,ie3d:y,webkit3d:h,gecko3d:p,opera3d:w,any3d:tt,mobile:e,mobileWebkit:e&&o,mobileWebkit3d:e&&h,mobileOpera:e&&n.opera,touch:it,msPointer:a,pointer:v,retina:nt}}();r.Point=function(n,t,i){this.x=i?Math.round(n):n;this.y=i?Math.round(t):t};r.Point.prototype={clone:function(){return new r.Point(this.x,this.y)},add:function(n){return this.clone()._add(r.point(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(r.point(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(n){n=r.point(n);var t=n.x-this.x,i=n.y-this.y;return Math.sqrt(t*t+i*i)},equals:function(n){return n=r.point(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=r.point(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+r.Util.formatNum(this.x)+", "+r.Util.formatNum(this.y)+")"}};r.point=function(n,t,u){return n instanceof r.Point?n:r.Util.isArray(n)?new r.Point(n[0],n[1]):n===i||n===null?n:new r.Point(n,t,u)};r.Bounds=function(n,t){var r,i,u;if(n)for(r=t?[n,t]:n,i=0,u=r.length;i<u;i++)this.extend(r[i])};r.Bounds.prototype={extend:function(n){return n=r.point(n),this.min||this.max?(this.min.x=Math.min(n.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(n.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=n.clone(),this.max=n.clone()),this},getCenter:function(n){return new r.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return new r.Point(this.min.x,this.max.y)},getTopRight:function(){return new r.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var t,i;return n=typeof n[0]=="number"||n instanceof r.Point?r.point(n):r.bounds(n),n instanceof r.Bounds?(t=n.min,i=n.max):t=i=n,t.x>=this.min.x&&i.x<=this.max.x&&t.y>=this.min.y&&i.y<=this.max.y},intersects:function(n){n=r.bounds(n);var t=this.min,i=this.max,u=n.min,f=n.max,e=f.x>=t.x&&u.x<=i.x,o=f.y>=t.y&&u.y<=i.y;return e&&o},isValid:function(){return!!(this.min&&this.max)}};r.bounds=function(n,t){return!n||n instanceof r.Bounds?n:new r.Bounds(n,t)};r.Transformation=function(n,t,i,r){this._a=n;this._b=t;this._c=i;this._d=r};r.Transformation.prototype={transform:function(n,t){return this._transform(n.clone(),t)},_transform:function(n,t){return t=t||1,n.x=t*(this._a*n.x+this._b),n.y=t*(this._c*n.y+this._d),n},untransform:function(n,t){return t=t||1,new r.Point((n.x/t-this._b)/this._a,(n.y/t-this._d)/this._c)}};r.DomUtil={get:function(n){return typeof n=="string"?t.getElementById(n):n},getStyle:function(n,i){var r=n.style[i],u;return!r&&n.currentStyle&&(r=n.currentStyle[i]),(!r||r==="auto")&&t.defaultView&&(u=t.defaultView.getComputedStyle(n,null),r=u?u[i]:null),r==="auto"?null:r},getViewportOffset:function(n){var u=0,f=0,i=n,e=t.body,s=t.documentElement,o;do{if(u+=i.offsetTop||0,f+=i.offsetLeft||0,u+=parseInt(r.DomUtil.getStyle(i,"borderTopWidth"),10)||0,f+=parseInt(r.DomUtil.getStyle(i,"borderLeftWidth"),10)||0,o=r.DomUtil.getStyle(i,"position"),i.offsetParent===e&&o==="absolute")break;if(o==="fixed"){u+=e.scrollTop||s.scrollTop||0;f+=e.scrollLeft||s.scrollLeft||0;break}if(o==="relative"&&!i.offsetLeft){var c=r.DomUtil.getStyle(i,"width"),l=r.DomUtil.getStyle(i,"max-width"),h=i.getBoundingClientRect();(c!=="none"||l!=="none")&&(f+=h.left+i.clientLeft);u+=h.top+(e.scrollTop||s.scrollTop||0);break}i=i.offsetParent}while(i);i=n;do{if(i===e)break;u-=i.scrollTop||0;f-=i.scrollLeft||0;i=i.parentNode}while(i);return new r.Point(f,u)},documentIsLtr:function(){return r.DomUtil._docIsLtrCached||(r.DomUtil._docIsLtrCached=!0,r.DomUtil._docIsLtr=r.DomUtil.getStyle(t.body,"direction")==="ltr"),r.DomUtil._docIsLtr},create:function(n,i,r){var u=t.createElement(n);return u.className=i,r&&r.appendChild(u),u},hasClass:function(n,t){if(n.classList!==i)return n.classList.contains(t);var u=r.DomUtil._getClass(n);return u.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(u)},addClass:function(n,t){var f,u,o,e;if(n.classList!==i)for(f=r.Util.splitWords(t),u=0,o=f.length;u<o;u++)n.classList.add(f[u]);else r.DomUtil.hasClass(n,t)||(e=r.DomUtil._getClass(n),r.DomUtil._setClass(n,(e?e+" ":"")+t))},removeClass:function(n,t){n.classList!==i?n.classList.remove(t):r.DomUtil._setClass(n,r.Util.trim((" "+r.DomUtil._getClass(n)+" ").replace(" "+t+" "," ")))},_setClass:function(n,t){n.className.baseVal===i?n.className=t:n.className.baseVal=t},_getClass:function(n){return n.className.baseVal===i?n.className:n.className.baseVal},setOpacity:function(n,t){if("opacity"in n.style)n.style.opacity=t;else if("filter"in n.style){var i=!1,r="DXImageTransform.Microsoft.Alpha";try{i=n.filters.item(r)}catch(u){if(t===1)return}t=Math.round(t*100);i?(i.Enabled=t!==100,i.Opacity=t):n.style.filter+=" progid:"+r+"(opacity="+t+")"}},testProp:function(n){for(var r=t.documentElement.style,i=0;i<n.length;i++)if(n[i]in r)return n[i];return!1},getTranslateString:function(n){var t=r.Browser.webkit3d,i="translate"+(t?"3d":"")+"(",u=(t?",0":"")+")";return i+n.x+"px,"+n.y+"px"+u},getScaleString:function(n,t){var i=r.DomUtil.getTranslateString(t.add(t.multiplyBy(-1*n))),u=" scale("+n+") ";return i+u},setPosition:function(n,t,i){n._leaflet_pos=t;!i&&r.Browser.any3d?n.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(t):(n.style.left=t.x+"px",n.style.top=t.y+"px")},getPosition:function(n){return n._leaflet_pos}};r.DomUtil.TRANSFORM=r.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);r.DomUtil.TRANSITION=r.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);r.DomUtil.TRANSITION_END=r.DomUtil.TRANSITION==="webkitTransition"||r.DomUtil.TRANSITION==="OTransition"?r.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in t)r.extend(r.DomUtil,{disableTextSelection:function(){r.DomEvent.on(n,"selectstart",r.DomEvent.preventDefault)},enableTextSelection:function(){r.DomEvent.off(n,"selectstart",r.DomEvent.preventDefault)}});else{var i=r.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);r.extend(r.DomUtil,{disableTextSelection:function(){if(i){var n=t.documentElement.style;this._userSelect=n[i];n[i]="none"}},enableTextSelection:function(){i&&(t.documentElement.style[i]=this._userSelect,delete this._userSelect)}})}r.extend(r.DomUtil,{disableImageDrag:function(){r.DomEvent.on(n,"dragstart",r.DomEvent.preventDefault)},enableImageDrag:function(){r.DomEvent.off(n,"dragstart",r.DomEvent.preventDefault)}})}();r.LatLng=function(n,t,r){if(n=parseFloat(n),t=parseFloat(t),isNaN(n)||isNaN(t))throw new Error("Invalid LatLng object: ("+n+", "+t+")");this.lat=n;this.lng=t;r!==i&&(this.alt=parseFloat(r))};r.extend(r.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9});r.LatLng.prototype={equals:function(n){if(!n)return!1;n=r.latLng(n);var t=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return t<=r.LatLng.MAX_MARGIN},toString:function(n){return"LatLng("+r.Util.formatNum(this.lat,n)+", "+r.Util.formatNum(this.lng,n)+")"},distanceTo:function(n){n=r.latLng(n);var t=r.LatLng.DEG_TO_RAD,e=(n.lat-this.lat)*t,o=(n.lng-this.lng)*t,s=this.lat*t,h=n.lat*t,i=Math.sin(e/2),u=Math.sin(o/2),f=i*i+u*u*Math.cos(s)*Math.cos(h);return 12756274*Math.atan2(Math.sqrt(f),Math.sqrt(1-f))},wrap:function(n,t){var i=this.lng;return n=n||-180,t=t||180,i=(i+t)%(t-n)+(i<n||i===t?t:n),new r.LatLng(this.lat,i)}};r.latLng=function(n,t){return n instanceof r.LatLng?n:r.Util.isArray(n)?typeof n[0]=="number"||typeof n[0]=="string"?new r.LatLng(n[0],n[1],n[2]):null:n===i||n===null?n:typeof n=="object"&&"lat"in n?new r.LatLng(n.lat,"lng"in n?n.lng:n.lon):t===i?null:new r.LatLng(n,t)};r.LatLngBounds=function(n,t){var r,i,u;if(n)for(r=t?[n,t]:n,i=0,u=r.length;i<u;i++)this.extend(r[i])};r.LatLngBounds.prototype={extend:function(n){if(!n)return this;var t=r.latLng(n);return n=t!==null?t:r.latLngBounds(n),n instanceof r.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(n.lat,this._southWest.lat),this._southWest.lng=Math.min(n.lng,this._southWest.lng),this._northEast.lat=Math.max(n.lat,this._northEast.lat),this._northEast.lng=Math.max(n.lng,this._northEast.lng)):(this._southWest=new r.LatLng(n.lat,n.lng),this._northEast=new r.LatLng(n.lat,n.lng)):n instanceof r.LatLngBounds&&(this.extend(n._southWest),this.extend(n._northEast)),this},pad:function(n){var t=this._southWest,i=this._northEast,u=Math.abs(t.lat-i.lat)*n,f=Math.abs(t.lng-i.lng)*n;return new r.LatLngBounds(new r.LatLng(t.lat-u,t.lng-f),new r.LatLng(i.lat+u,i.lng+f))},getCenter:function(){return new r.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new r.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new r.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){n=typeof n[0]=="number"||n instanceof r.LatLng?r.latLng(n):r.latLngBounds(n);var u=this._southWest,f=this._northEast,t,i;return n instanceof r.LatLngBounds?(t=n.getSouthWest(),i=n.getNorthEast()):t=i=n,t.lat>=u.lat&&i.lat<=f.lat&&t.lng>=u.lng&&i.lng<=f.lng},intersects:function(n){n=r.latLngBounds(n);var t=this._southWest,i=this._northEast,u=n.getSouthWest(),f=n.getNorthEast(),e=f.lat>=t.lat&&u.lat<=i.lat,o=f.lng>=t.lng&&u.lng<=i.lng;return e&&o},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n){return n?(n=r.latLngBounds(n),this._southWest.equals(n.getSouthWest())&&this._northEast.equals(n.getNorthEast())):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};r.latLngBounds=function(n,t){return!n||n instanceof r.LatLngBounds?n:new r.LatLngBounds(n,t)};r.Projection={};r.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(n){var i=r.LatLng.DEG_TO_RAD,u=this.MAX_LATITUDE,f=Math.max(Math.min(u,n.lat),-u),e=n.lng*i,t=f*i;return t=Math.log(Math.tan(Math.PI/4+t/2)),new r.Point(e,t)},unproject:function(n){var t=r.LatLng.RAD_TO_DEG,i=n.x*t,u=(2*Math.atan(Math.exp(n.y))-Math.PI/2)*t;return new r.LatLng(u,i)}};r.Projection.LonLat={project:function(n){return new r.Point(n.lng,n.lat)},unproject:function(n){return new r.LatLng(n.y,n.x)}};r.CRS={latLngToPoint:function(n,t){var i=this.projection.project(n),r=this.scale(t);return this.transformation._transform(i,r)},pointToLatLng:function(n,t){var i=this.scale(t),r=this.transformation.untransform(n,i);return this.projection.unproject(r)},project:function(n){return this.projection.project(n)},scale:function(n){return 256*Math.pow(2,n)},getSize:function(n){var t=this.scale(n);return r.point(t,t)}};r.CRS.Simple=r.extend({},r.CRS,{projection:r.Projection.LonLat,transformation:new r.Transformation(1,0,-1,0),scale:function(n){return Math.pow(2,n)}});r.CRS.EPSG3857=r.extend({},r.CRS,{code:"EPSG:3857",projection:r.Projection.SphericalMercator,transformation:new r.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(n){var t=this.projection.project(n);return t.multiplyBy(6378137)}});r.CRS.EPSG900913=r.extend({},r.CRS.EPSG3857,{code:"EPSG:900913"});r.CRS.EPSG4326=r.extend({},r.CRS,{code:"EPSG:4326",projection:r.Projection.LonLat,transformation:new r.Transformation(1/360,.5,-1/360,.5)});r.Map=r.Class.extend({includes:r.Mixin.Events,options:{crs:r.CRS.EPSG3857,fadeAnimation:r.DomUtil.TRANSITION&&!r.Browser.android23,trackResize:!0,markerZoomAnimation:r.DomUtil.TRANSITION&&r.Browser.any3d},initialize:function(n,t){t=r.setOptions(this,t);this._initContainer(n);this._initLayout();this._onResize=r.bind(this._onResize,this);this._initEvents();t.maxBounds&&this.setMaxBounds(t.maxBounds);t.center&&t.zoom!==i&&this.setView(r.latLng(t.center),t.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._tileLayersNum=0;this.callInitHooks();this._addLayers(t.layers)},setView:function(n,t){return t=t===i?this.getZoom():t,this._resetView(r.latLng(n),this._limitZoom(t)),this},setZoom:function(n,t){return this._loaded?this.setView(this.getCenter(),n,{zoom:t}):(this._zoom=this._limitZoom(n),this)},zoomIn:function(n,t){return this.setZoom(this._zoom+(n||1),t)},zoomOut:function(n,t){return this.setZoom(this._zoom-(n||1),t)},setZoomAround:function(n,t,i){var f=this.getZoomScale(t),u=this.getSize().divideBy(2),e=n instanceof r.Point?n:this.latLngToContainerPoint(n),o=e.subtract(u).multiplyBy(1-1/f),s=this.containerPointToLatLng(u.add(o));return this.setView(s,t,{zoom:i})},fitBounds:function(n,t){t=t||{};n=n.getBounds?n.getBounds():r.latLngBounds(n);var u=r.point(t.paddingTopLeft||t.padding||[0,0]),f=r.point(t.paddingBottomRight||t.padding||[0,0]),i=this.getBoundsZoom(n,!1,u.add(f));i=t.maxZoom?Math.min(t.maxZoom,i):i;var e=f.subtract(u).divideBy(2),o=this.project(n.getSouthWest(),i),s=this.project(n.getNorthEast(),i),h=this.unproject(o.add(s).divideBy(2).add(e),i);return this.setView(h,i,t)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,t){return this.setView(n,this._zoom,{pan:t})},panBy:function(n){return this.fire("movestart"),this._rawPanBy(r.point(n)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(n){if(n=r.latLngBounds(n),this.options.maxBounds=n,!n)return this.off("moveend",this._panInsideMaxBounds,this);this._loaded&&this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(n,t){var i=this.getCenter(),r=this._limitCenter(i,this._zoom,n);return i.equals(r)?this:this.panTo(r,t)},addLayer:function(n){var t=r.stamp(n);if(this._layers[t])return this;if(this._layers[t]=n,!n.options||isNaN(n.options.maxZoom)&&isNaN(n.options.minZoom)||(this._zoomBoundLayers[t]=n,this._updateZoomLevels()),this.options.zoomAnimation&&r.TileLayer&&n instanceof r.TileLayer){this._tileLayersNum++;this._tileLayersToLoad++;n.on("load",this._onTileLayerLoad,this)}return this._loaded&&this._layerAdd(n),this},removeLayer:function(n){var t=r.stamp(n);if(!this._layers[t])return this;if(this._loaded)n.onRemove(this);return delete this._layers[t],this._loaded&&this.fire("layerremove",{layer:n}),this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels()),this.options.zoomAnimation&&r.TileLayer&&n instanceof r.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,n.off("load",this._onTileLayerLoad,this)),this},hasLayer:function(n){return n?r.stamp(n)in this._layers:!1},eachLayer:function(n,t){for(var i in this._layers)n.call(t,this._layers[i]);return this},invalidateSize:function(n){var i;if(!this._loaded)return this;n=r.extend({animate:!1,pan:!0},n===!0?{animate:!0}:n);i=this.getSize();this._sizeChanged=!0;this._initialCenter=null;var u=this.getSize(),f=i.divideBy(2).round(),e=u.divideBy(2).round(),t=f.subtract(e);return!t.x&&!t.y?this:(n.animate&&n.pan?this.panBy(t):(n.pan&&this._rawPanBy(t),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:u}))},addHandler:function(n,t){if(!t)return this;var i=this[n]=new t(this);return this._handlers.push(i),this.options[n]&&i.enable(),this},remove:function(){this._loaded&&this.fire("unload");this._initEvents("off");try{delete this._container._leaflet}catch(n){this._container._leaflet=i}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return(this._checkIfLoaded(),this._initialCenter&&!this._moved())?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),t=this.unproject(n.getBottomLeft()),i=this.unproject(n.getTopRight());return new r.LatLngBounds(t,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom===i?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,t,i){n=r.latLngBounds(n);var u=this.getMinZoom()-(t?1:0),s=this.getMaxZoom(),e=this.getSize(),h=n.getNorthWest(),c=n.getSouthEast(),o=!0,f;i=r.point(i||[0,0]);do u++,f=this.project(c,u).subtract(this.project(h,u)).add(i),o=t?f.x<e.x||f.y<e.y:e.contains(f);while(o&&u<=s);return o&&t?null:t?u:u-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new r.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var n=this._getTopLeftPoint();return new r.Bounds(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n){var t=this.options.crs;return t.scale(n)/t.scale(this._zoom)},getScaleZoom:function(n){return this._zoom+Math.log(n)/Math.LN2},project:function(n,t){return t=t===i?this._zoom:t,this.options.crs.latLngToPoint(r.latLng(n),t)},unproject:function(n,t){return t=t===i?this._zoom:t,this.options.crs.pointToLatLng(r.point(n),t)},layerPointToLatLng:function(n){var t=r.point(n).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(n){var t=this.project(r.latLng(n))._round();return t._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(n){return r.point(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return r.point(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var t=this.containerPointToLayerPoint(r.point(n));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(r.latLng(n)))},mouseEventToContainerPoint:function(n){return r.DomEvent.getMousePosition(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var t=this._container=r.DomUtil.get(n);if(t){if(t._leaflet)throw new Error("Map container is already initialized.");}else throw new Error("Map container not found.");t._leaflet=!0},_initLayout:function(){var t=this._container,n;r.DomUtil.addClass(t,"leaflet-container"+(r.Browser.touch?" leaflet-touch":"")+(r.Browser.retina?" leaflet-retina":"")+(r.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));n=r.DomUtil.getStyle(t,"position");n!=="absolute"&&n!=="relative"&&n!=="fixed"&&(t.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={},t;this._mapPane=n.mapPane=this._createPane("leaflet-map-pane",this._container);this._tilePane=n.tilePane=this._createPane("leaflet-tile-pane",this._mapPane);n.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane);n.shadowPane=this._createPane("leaflet-shadow-pane");n.overlayPane=this._createPane("leaflet-overlay-pane");n.markerPane=this._createPane("leaflet-marker-pane");n.popupPane=this._createPane("leaflet-popup-pane");t=" leaflet-zoom-hide";this.options.markerZoomAnimation||(r.DomUtil.addClass(n.markerPane,t),r.DomUtil.addClass(n.shadowPane,t),r.DomUtil.addClass(n.popupPane,t))},_createPane:function(n,t){return r.DomUtil.create("div",n,t||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(n){n=n?r.Util.isArray(n)?n:[n]:[];for(var t=0,i=n.length;t<i;t++)this.addLayer(n[t])},_resetView:function(n,t,i,u){var f=this._zoom!==t,e;u||(this.fire("movestart"),f&&this.fire("zoomstart"));this._zoom=t;this._initialCenter=n;this._initialTopLeftPoint=this._getNewTopLeftPoint(n);i?this._initialTopLeftPoint._add(this._getMapPanePos()):r.DomUtil.setPosition(this._mapPane,new r.Point(0,0));this._tileLayersToLoad=this._tileLayersNum;e=!this._loaded;this._loaded=!0;this.fire("viewreset",{hard:!i});e&&(this.fire("load"),this.eachLayer(this._layerAdd,this));this.fire("move");(f||u)&&this.fire("zoomend");this.fire("moveend",{hard:!i})},_rawPanBy:function(n){r.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,r=Infinity,u=-Infinity,f=this._getZoomSpan(),n;for(t in this._zoomBoundLayers)n=this._zoomBoundLayers[t],isNaN(n.options.minZoom)||(r=Math.min(r,n.options.minZoom)),isNaN(n.options.maxZoom)||(u=Math.max(u,n.options.maxZoom));t===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=u,this._layersMinZoom=r);f!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.");},_initEvents:function(t){if(r.DomEvent){t=t||"on";r.DomEvent[t](this._container,"click",this._onMouseClick,this);for(var u=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"],i=0,f=u.length;i<f;i++)r.DomEvent[t](this._container,u[i],this._fireMouseEvent,this);this.options.trackResize&&r.DomEvent[t](n,"resize",this._onResize,this)}},_onResize:function(){r.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=r.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(n){!this._loaded||!n._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||r.DomEvent._skipped(n)||(this.fire("preclick"),this._fireMouseEvent(n))},_fireMouseEvent:function(n){var t;if(this._loaded&&!r.DomEvent._skipped(n)&&(t=n.type,t=t==="mouseenter"?"mouseover":t==="mouseleave"?"mouseout":t,this.hasEventListeners(t))){t==="contextmenu"&&r.DomEvent.preventDefault(n);var i=this.mouseEventToContainerPoint(n),u=this.containerPointToLayerPoint(i),f=this.layerPointToLatLng(u);this.fire(t,{latlng:f,layerPoint:u,containerPoint:i,originalEvent:n})}},_onTileLayerLoad:function(){this._tileLayersToLoad--;this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var n=0,t=this._handlers.length;n<t;n++)this._handlers[n].disable()},whenReady:function(n,t){if(this._loaded)n.call(t||this,this);else this.on("load",n,t);return this},_layerAdd:function(n){n.onAdd(this);this.fire("layeradd",{layer:n})},_getMapPanePos:function(){return r.DomUtil.getPosition(this._mapPane)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(n,t){var i=this.getSize()._divideBy(2);return this.project(n,t)._subtract(i)._round()},_latLngToNewLayerPoint:function(n,t,i){var r=this._getNewTopLeftPoint(i,t).add(this._getMapPanePos());return this.project(n,t)._subtract(r)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,t,i){if(!i)return n;var u=this.project(n,t),f=this.getSize().divideBy(2),e=new r.Bounds(u.subtract(f),u.add(f)),o=this._getBoundsOffset(e,i,t);return this.unproject(u.add(o),t)},_limitOffset:function(n,t){if(!t)return n;var i=this.getPixelBounds(),u=new r.Bounds(i.min.add(n),i.max.add(n));return n.add(this._getBoundsOffset(u,t))},_getBoundsOffset:function(n,t,i){var u=this.project(t.getNorthWest(),i).subtract(n.min),f=this.project(t.getSouthEast(),i).subtract(n.max),e=this._rebound(u.x,-f.x),o=this._rebound(u.y,-f.y);return new r.Point(e,o)},_rebound:function(n,t){return n+t>0?Math.round(n-t)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(t))},_limitZoom:function(n){var t=this.getMinZoom(),i=this.getMaxZoom();return Math.max(t,Math.min(i,n))}});r.map=function(n,t){return new r.Map(n,t)};r.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142451793,R_MAJOR:6378137,project:function(n){var f=r.LatLng.DEG_TO_RAD,e=this.MAX_LATITUDE,c=Math.max(Math.min(e,n.lat),-e),u=this.R_MAJOR,l=this.R_MINOR,a=n.lng*f*u,t=c*f,o=l/u,s=Math.sqrt(1-o*o),i=s*Math.sin(t),h;return i=Math.pow((1-i)/(1+i),s*.5),h=Math.tan(.5*(Math.PI*.5-t))/i,t=-u*Math.log(h),new r.Point(a,t)},unproject:function(n){for(var e=r.LatLng.RAD_TO_DEG,i=this.R_MAJOR,c=this.R_MINOR,l=n.x*e/i,o=c/i,s=Math.sqrt(1-o*o),h=Math.exp(-n.y/i),t=Math.PI/2-2*Math.atan(h),a=15,u=.1,f;Math.abs(u)>1e-7&&--a>0;)f=s*Math.sin(t),u=Math.PI/2-2*Math.atan(h*Math.pow((1-f)/(1+f),.5*s))-t,t+=u;return new r.LatLng(t*e,l)}};r.CRS.EPSG3395=r.extend({},r.CRS,{code:"EPSG:3395",projection:r.Projection.Mercator,transformation:function(){var t=r.Projection.Mercator,i=t.R_MAJOR,n=.5/(Math.PI*i);return new r.Transformation(n,.5,-n,.5)}()});r.TileLayer=r.Class.extend({includes:r.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:r.Browser.mobile,updateWhenIdle:r.Browser.mobile},initialize:function(n,t){t=r.setOptions(this,t);t.detectRetina&&r.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomOffset++,t.minZoom>0&&t.minZoom--,this.options.maxZoom--);t.bounds&&(t.bounds=r.latLngBounds(t.bounds));this._url=n;var i=this.options.subdomains;typeof i=="string"&&(this.options.subdomains=i.split(""))},onAdd:function(n){this._map=n;this._animated=n._zoomAnimated;this._initContainer();n.on({viewreset:this._reset,moveend:this._update},this);if(this._animated)n.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);if(!this.options.updateWhenIdle){this._limitedUpdate=r.Util.limitExecByInterval(this._update,150,this);n.on("move",this._limitedUpdate,this)}this._reset();this._update()},addTo:function(n){return n.addLayer(this),this},onRemove:function(n){this._container.parentNode.removeChild(this._container);n.off({viewreset:this._reset,moveend:this._update},this);this._animated&&n.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);this.options.updateWhenIdle||n.off("move",this._limitedUpdate,this);this._container=null;this._map=null},bringToFront:function(){var n=this._map._panes.tilePane;return this._container&&(n.appendChild(this._container),this._setAutoZIndex(n,Math.max)),this},bringToBack:function(){var n=this._map._panes.tilePane;return this._container&&(n.insertBefore(this._container,n.firstChild),this._setAutoZIndex(n,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},setUrl:function(n,t){return this._url=n,t||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n,t){for(var u=n.children,r=-t(Infinity,-Infinity),f,i=0,e=u.length;i<e;i++)u[i]!==this._container&&(f=parseInt(u[i].style.zIndex,10),isNaN(f)||(r=t(r,f)));this.options.zIndex=this._container.style.zIndex=(isFinite(r)?r:0)+t(1,-1)},_updateOpacity:function(){var n,t=this._tiles;if(r.Browser.ielt9)for(n in t)r.DomUtil.setOpacity(t[n],this.options.opacity);else r.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane,n;this._container||(this._container=r.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated?(n="leaflet-tile-container",this._bgBuffer=r.DomUtil.create("div",n,this._container),this._tileContainer=r.DomUtil.create("div",n,this._container)):this._tileContainer=this._container,t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity())},_reset:function(n){for(var t in this._tiles)this.fire("tileunload",{tile:this._tiles[t]});this._tiles={};this._tilesToLoad=0;this.options.reuseTiles&&(this._unusedTiles=[]);this._tileContainer.innerHTML="";this._animated&&n&&n.hard&&this._clearBgBuffer();this._initContainer()},_getTileSize:function(){var n=this._map,r=n.getZoom()+this.options.zoomOffset,t=this.options.maxNativeZoom,i=this.options.tileSize;return t&&r>t&&(i=Math.round(n.getZoomScale(r)/n.getZoomScale(t)*i)),i},_update:function(){var n;if(this._map){var t=this._map,i=t.getPixelBounds(),u=t.getZoom(),f=this._getTileSize();u>this.options.maxZoom||u<this.options.minZoom||(n=r.bounds(i.min.divideBy(f)._floor(),i.max.divideBy(f)._floor()),this._addTilesFromCenterOut(n),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(n))}},_addTilesFromCenterOut:function(n){for(var u=[],h=n.getCenter(),i,o,e,s,f=n.min.y;f<=n.max.y;f++)for(i=n.min.x;i<=n.max.x;i++)o=new r.Point(i,f),this._tileShouldBeLoaded(o)&&u.push(o);if(e=u.length,e!==0){for(u.sort(function(n,t){return n.distanceTo(h)-t.distanceTo(h)}),s=t.createDocumentFragment(),this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=e,i=0;i<e;i++)this._addTile(u[i],s);this._tileContainer.appendChild(s)}},_tileShouldBeLoaded:function(n){var t,i;if(n.x+":"+n.y in this._tiles||(t=this.options,!t.continuousWorld&&(i=this._getWrapTileNum(),t.noWrap&&(n.x<0||n.x>=i.x)||n.y<0||n.y>=i.y)))return!1;if(t.bounds){var r=this._getTileSize(),e=n.multiplyBy(r),o=e.add([r,r]),u=this._map.unproject(e),f=this._map.unproject(o);if(t.continuousWorld||t.noWrap||(u=u.wrap(),f=f.wrap()),!t.bounds.intersects([u,f]))return!1}return!0},_removeOtherTiles:function(n){var t,i,r;for(var u in this._tiles)t=u.split(":"),i=parseInt(t[0],10),r=parseInt(t[1],10),(i<n.min.x||i>n.max.x||r<n.min.y||r>n.max.y)&&this._removeTile(u)},_removeTile:function(n){var t=this._tiles[n];this.fire("tileunload",{tile:t,url:t.src});this.options.reuseTiles?(r.DomUtil.removeClass(t,"leaflet-tile-loaded"),this._unusedTiles.push(t)):t.parentNode===this._tileContainer&&this._tileContainer.removeChild(t);r.Browser.android||(t.onload=null,t.src=r.Util.emptyImageUrl);delete this._tiles[n]},_addTile:function(n,t){var u=this._getTilePos(n),i=this._getTile();r.DomUtil.setPosition(i,u,r.Browser.chrome);this._tiles[n.x+":"+n.y]=i;this._loadTile(i,n);i.parentNode!==this._tileContainer&&t.appendChild(i)},_getZoomForUrl:function(){var n=this.options,t=this._map.getZoom();return n.zoomReverse&&(t=n.maxZoom-t),t+=n.zoomOffset,n.maxNativeZoom?Math.min(t,n.maxNativeZoom):t},_getTilePos:function(n){var t=this._map.getPixelOrigin(),i=this._getTileSize();return n.multiplyBy(i).subtract(t)},getTileUrl:function(n){return r.Util.template(this._url,r.extend({s:this._getSubdomain(n),z:n.z,x:n.x,y:n.y},this.options))},_getWrapTileNum:function(){var n=this._map.options.crs,t=n.getSize(this._map.getZoom());return t.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(n){var t=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(n.x=(n.x%t.x+t.x)%t.x);this.options.tms&&(n.y=t.y-n.y-1);n.z=this._getZoomForUrl()},_getSubdomain:function(n){var t=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[t]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var n=this._unusedTiles.pop();return this._resetTile(n),n}return this._createTile()},_resetTile:function(){},_createTile:function(){var n=r.DomUtil.create("img","leaflet-tile");return n.style.width=n.style.height=this._getTileSize()+"px",n.galleryimg="no",n.onselectstart=n.onmousemove=r.Util.falseFn,r.Browser.ielt9&&this.options.opacity!==i&&r.DomUtil.setOpacity(n,this.options.opacity),r.Browser.mobileWebkit3d&&(n.style.WebkitBackfaceVisibility="hidden"),n},_loadTile:function(n,t){n._layer=this;n.onload=this._tileOnLoad;n.onerror=this._tileOnError;this._adjustTilePoint(t);n.src=this.getTileUrl(t);this.fire("tileloadstart",{tile:n,url:n.src})},_tileLoaded:function(){this._tilesToLoad--;this._animated&&r.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated");this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(r.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var n=this._layer;this.src!==r.Util.emptyImageUrl&&(r.DomUtil.addClass(this,"leaflet-tile-loaded"),n.fire("tileload",{tile:this,url:this.src}));n._tileLoaded()},_tileOnError:function(){var n=this._layer,t;n.fire("tileerror",{tile:this,url:this.src});t=n.options.errorTileUrl;t&&(this.src=t);n._tileLoaded()}});r.tileLayer=function(n,t){return new r.TileLayer(n,t)};r.TileLayer.WMS=r.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(n,t){var i,f,u;this._url=n;i=r.extend({},this.defaultWmsParams);f=t.tileSize||this.options.tileSize;i.width=t.detectRetina&&r.Browser.retina?i.height=f*2:i.height=f;for(u in t)this.options.hasOwnProperty(u)||u==="crs"||(i[u]=t[u]);this.wmsParams=i;r.setOptions(this,t)},onAdd:function(n){this._crs=this.options.crs||n.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code;r.TileLayer.prototype.onAdd.call(this,n)},getTileUrl:function(n){var f=this._map,u=this.options.tileSize,e=n.multiplyBy(u),s=e.add([u,u]),t=this._crs.project(f.unproject(e,n.z)),i=this._crs.project(f.unproject(s,n.z)),h=this._wmsVersion>=1.3&&this._crs===r.CRS.EPSG4326?[i.y,t.x,t.y,i.x].join(","):[t.x,i.y,i.x,t.y].join(","),o=r.Util.template(this._url,{s:this._getSubdomain(n)});return o+r.Util.getParamString(this.wmsParams,o,!0)+"&BBOX="+h},setParams:function(n,t){return r.extend(this.wmsParams,n),t||this.redraw(),this}});r.tileLayer.wms=function(n,t){return new r.TileLayer.WMS(n,t)};r.TileLayer.Canvas=r.TileLayer.extend({options:{async:!1},initialize:function(n){r.setOptions(this,n)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var n in this._tiles)this._redrawTile(this._tiles[n]);return this},_redrawTile:function(n){this.drawTile(n,n._tilePoint,this._map._zoom)},_createTile:function(){var n=r.DomUtil.create("canvas","leaflet-tile");return n.width=n.height=this.options.tileSize,n.onselectstart=n.onmousemove=r.Util.falseFn,n},_loadTile:function(n,t){n._layer=this;n._tilePoint=t;this._redrawTile(n);this.options.async||this.tileDrawn(n)},drawTile:function(){},tileDrawn:function(n){this._tileOnLoad.call(n)}});r.tileLayer.canvas=function(n){return new r.TileLayer.Canvas(n)};r.ImageOverlay=r.Class.extend({includes:r.Mixin.Events,options:{opacity:1},initialize:function(n,t,i){this._url=n;this._bounds=r.latLngBounds(t);r.setOptions(this,i)},onAdd:function(n){this._map=n;this._image||this._initImage();n._panes.overlayPane.appendChild(this._image);n.on("viewreset",this._reset,this);if(n.options.zoomAnimation&&r.Browser.any3d)n.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(n){n.getPanes().overlayPane.removeChild(this._image);n.off("viewreset",this._reset,this);n.options.zoomAnimation&&n.off("zoomanim",this._animateZoom,this)},addTo:function(n){return n.addLayer(this),this},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var n=this._map._panes.overlayPane;return this._image&&n.insertBefore(this._image,n.firstChild),this},setUrl:function(n){this._url=n;this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=r.DomUtil.create("img","leaflet-image-layer");this._map.options.zoomAnimation&&r.Browser.any3d?r.DomUtil.addClass(this._image,"leaflet-zoom-animated"):r.DomUtil.addClass(this._image,"leaflet-zoom-hide");this._updateOpacity();r.extend(this._image,{galleryimg:"no",onselectstart:r.Util.falseFn,onmousemove:r.Util.falseFn,onload:r.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(n){var t=this._map,f=this._image,i=t.getZoomScale(n.zoom),e=this._bounds.getNorthWest(),o=this._bounds.getSouthEast(),u=t._latLngToNewLayerPoint(e,n.zoom,n.center),s=t._latLngToNewLayerPoint(o,n.zoom,n.center)._subtract(u),h=u._add(s._multiplyBy(1/2*(1-1/i)));f.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(h)+" scale("+i+") "},_reset:function(){var n=this._image,t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),i=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(t);r.DomUtil.setPosition(n,t);n.style.width=i.x+"px";n.style.height=i.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){r.DomUtil.setOpacity(this._image,this.options.opacity)}});r.imageOverlay=function(n,t,i){return new r.ImageOverlay(n,t,i)};r.Icon=r.Class.extend({options:{className:""},initialize:function(n){r.setOptions(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,t){var i=this._getIconUrl(n),r;if(!i){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}return r=t&&t.tagName==="IMG"?this._createImg(i,t):this._createImg(i),this._setIconStyles(r,n),r},_setIconStyles:function(n,t){var u=this.options,f=r.point(u[t+"Size"]),i;i=t==="shadow"?r.point(u.shadowAnchor||u.iconAnchor):r.point(u.iconAnchor);!i&&f&&(i=f.divideBy(2,!0));n.className="leaflet-marker-"+t+" "+u.className;i&&(n.style.marginLeft=-i.x+"px",n.style.marginTop=-i.y+"px");f&&(n.style.width=f.x+"px",n.style.height=f.y+"px")},_createImg:function(n,i){return i=i||t.createElement("img"),i.src=n,i},_getIconUrl:function(n){return r.Browser.retina&&this.options[n+"RetinaUrl"]?this.options[n+"RetinaUrl"]:this.options[n+"Url"]}});r.icon=function(n){return new r.Icon(n)};r.Icon.Default=r.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(n){var i=n+"Url",t;if(this.options[i])return this.options[i];if(r.Browser.retina&&n==="icon"&&(n+="-2x"),t=r.Icon.Default.imagePath,!t)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return t+"/marker-"+n+".png"}});r.Icon.Default.imagePath=function(){for(var u=t.getElementsByTagName("script"),f=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/,i,o,r,n=0,e=u.length;n<e;n++)if(i=u[n].src,o=i.match(f),o)return r=i.split(f)[0],(r?r+"/":"")+"images"}();r.Marker=r.Class.extend({includes:r.Mixin.Events,options:{icon:new r.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(n,t){r.setOptions(this,t);this._latlng=r.latLng(n)},onAdd:function(n){this._map=n;n.on("viewreset",this.update,this);if(this._initIcon(),this.update(),this.fire("add"),n.options.zoomAnimation&&n.options.markerZoomAnimation)n.on("zoomanim",this._animateZoom,this)},addTo:function(n){return n.addLayer(this),this},onRemove:function(n){this.dragging&&this.dragging.disable();this._removeIcon();this._removeShadow();this.fire("remove");n.off({viewreset:this.update,zoomanim:this._animateZoom},this);this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=r.latLng(n),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update(),this},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var n=this.options,e=this._map,h=e.options.zoomAnimation&&e.options.markerZoomAnimation,o=h?"leaflet-zoom-animated":"leaflet-zoom-hide",t=n.icon.createIcon(this._icon),s=!1,i,u,f;if(t!==this._icon&&(this._icon&&this._removeIcon(),s=!0,n.title&&(t.title=n.title),n.alt&&(t.alt=n.alt)),r.DomUtil.addClass(t,o),n.keyboard&&(t.tabIndex="0"),this._icon=t,this._initInteraction(),n.riseOnHover)r.DomEvent.on(t,"mouseover",this._bringToFront,this).on(t,"mouseout",function(){this._popup&&!this._popup._isOpen&&this._resetZIndex()},this);i=n.icon.createShadow(this._shadow);u=!1;i!==this._shadow&&(this._removeShadow(),u=!0);i&&r.DomUtil.addClass(i,o);this._shadow=i;n.opacity<1&&this._updateOpacity();f=this._map._panes;s&&f.markerPane.appendChild(this._icon);i&&u&&f.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&r.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex);this._map._panes.markerPane.removeChild(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow);this._shadow=null},_setPos:function(n){r.DomUtil.setPosition(this._icon,n);this._shadow&&r.DomUtil.setPosition(this._shadow,n);this._zIndex=n.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(n){this._icon.style.zIndex=this._zIndex+n},_animateZoom:function(n){var t=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(t)},_initInteraction:function(){var n,i,t;if(this.options.clickable){n=this._icon;i=["dblclick","mousedown","mouseover","mouseout","contextmenu"];r.DomUtil.addClass(n,"leaflet-clickable");r.DomEvent.on(n,"click",this._onMouseClick,this);r.DomEvent.on(n,"keypress",this._onKeyPress,this);for(t=0;t<i.length;t++)r.DomEvent.on(n,i[t],this._fireMouseEvent,this);r.Handler.MarkerDrag&&(this.dragging=new r.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(n){var t=this.dragging&&this.dragging.moved();((this.hasEventListeners(n.type)||t)&&r.DomEvent.stopPropagation(n),t)||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(n.type,{originalEvent:n,latlng:this._latlng})},_onKeyPress:function(n){n.keyCode===13&&this.fire("click",{originalEvent:n,latlng:this._latlng})},_fireMouseEvent:function(n){this.fire(n.type,{originalEvent:n,latlng:this._latlng});n.type==="contextmenu"&&this.hasEventListeners(n.type)&&r.DomEvent.preventDefault(n);n.type!=="mousedown"?r.DomEvent.stopPropagation(n):r.DomEvent.preventDefault(n)},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){r.DomUtil.setOpacity(this._icon,this.options.opacity);this._shadow&&r.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}});r.marker=function(n,t){return new r.Marker(n,t)};r.DivIcon=r.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(n){var r=n&&n.tagName==="DIV"?n:t.createElement("div"),i=this.options;return r.innerHTML=i.html!==!1?i.html:"",i.bgPos&&(r.style.backgroundPosition=-i.bgPos.x+"px "+-i.bgPos.y+"px"),this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});r.divIcon=function(n){return new r.DivIcon(n)};r.Map.mergeOptions({closePopupOnClick:!0});r.Popup=r.Class.extend({includes:r.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(n,t){r.setOptions(this,n);this._source=t;this._animated=r.Browser.any3d&&this.options.zoomAnimation;this._isOpen=!1},onAdd:function(n){this._map=n;this._container||this._initLayout();var t=n.options.fadeAnimation;t&&r.DomUtil.setOpacity(this._container,0);n._panes.popupPane.appendChild(this._container);n.on(this._getEvents(),this);this.update();t&&r.DomUtil.setOpacity(this._container,1);this.fire("open");n.fire("popupopen",{popup:this});this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(n){return n.addLayer(this),this},openOn:function(n){return n.openPopup(this),this},onRemove:function(n){n._panes.popupPane.removeChild(this._container);r.Util.falseFn(this._container.offsetWidth);n.off(this._getEvents(),this);n.options.fadeAnimation&&r.DomUtil.setOpacity(this._container,0);this._map=null;this.fire("close");n.fire("popupclose",{popup:this});this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=r.latLng(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var n={viewreset:this._updatePosition};return this._animated&&(n.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this._close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var n="leaflet-popup",f=n+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),u=this._container=r.DomUtil.create("div",f),t,i;if(this.options.closeButton){t=this._closeButton=r.DomUtil.create("a",n+"-close-button",u);t.href="#close";t.innerHTML="&#215;";r.DomEvent.disableClickPropagation(t);r.DomEvent.on(t,"click",this._onCloseButtonClick,this)}this._tipContainer=r.DomUtil.create("div",n+"-tip-container",u);this._tip=r.DomUtil.create("div",n+"-tip",this._tipContainer);i=this._wrapper=r.DomUtil.create("div",n+"-content-wrapper",u);r.DomEvent.disableClickPropagation(i);this._contentNode=r.DomUtil.create("div",n+"-content",i);r.DomEvent.disableScrollPropagation(this._contentNode);r.DomEvent.on(i,"contextmenu",r.DomEvent.stopPropagation)},_updateContent:function(){if(this._content){if(typeof this._content=="string")this._contentNode.innerHTML=this._content;else{while(this._contentNode.hasChildNodes())this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var i=this._contentNode,n=i.style,t;n.width="";n.whiteSpace="nowrap";t=i.offsetWidth;t=Math.min(t,this.options.maxWidth);t=Math.max(t,this.options.minWidth);n.width=t+10+"px";n.whiteSpace="";n.height="";var e=i.offsetHeight,u=this.options.maxHeight,f="leaflet-popup-scrolled";u&&e>u?(n.height=u+"px",r.DomUtil.addClass(i,f)):r.DomUtil.removeClass(i,f);this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),t=this._animated,i=r.point(this.options.offset);t&&r.DomUtil.setPosition(this._container,n);this._containerBottom=-i.y-(t?0:n.y);this._containerLeft=-Math.round(this._containerWidth/2)+i.x+(t?0:n.x);this._container.style.bottom=this._containerBottom+"px";this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(n){var t=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);r.DomUtil.setPosition(this._container,t)},_adjustPan:function(){if(this.options.autoPan){var o=this._map,s=this._container.offsetHeight,h=this._containerWidth,c=new r.Point(this._containerLeft,-s-this._containerBottom);this._animated&&c._add(r.DomUtil.getPosition(this._container));var n=o.layerPointToContainerPoint(c),l=r.point(this.options.autoPanPadding),u=r.point(this.options.autoPanPaddingTopLeft||l),f=r.point(this.options.autoPanPaddingBottomRight||l),e=o.getSize(),t=0,i=0;n.x+h+f.x>e.x&&(t=n.x+h-e.x+f.x);n.x-t-u.x<0&&(t=n.x-u.x);n.y+s+f.y>e.y&&(i=n.y+s-e.y+f.y);n.y-i-u.y<0&&(i=n.y-u.y);(t||i)&&o.fire("autopanstart").panBy([t,i])}},_onCloseButtonClick:function(n){this._close();r.DomEvent.stop(n)}});r.popup=function(n,t){return new r.Popup(n,t)};r.Map.include({openPopup:function(n,t,i){if(this.closePopup(),!(n instanceof r.Popup)){var u=n;n=new r.Popup(i).setLatLng(t).setContent(u)}return n._isOpen=!0,this._popup=n,this.addLayer(n)},closePopup:function(n){return n&&n!==this._popup||(n=this._popup,this._popup=null),n&&(this.removeLayer(n),n._isOpen=!1),this}});r.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(n,t){var i=r.point(this.options.icon.options.popupAnchor||[0,0]);if(i=i.add(r.Popup.prototype.options.offset),t&&t.offset&&(i=i.add(t.offset)),t=r.extend({offset:i},t),!this._popupHandlersAdded){this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this);this._popupHandlersAdded=!0}return n instanceof r.Popup?(r.setOptions(n,t),this._popup=n,n._source=this):this._popup=new r.Popup(t,this).setContent(n),this},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(n){this._popup.setLatLng(n.latlng)}});r.LayerGroup=r.Class.extend({initialize:function(n){this._layers={};var t,i;if(n)for(t=0,i=n.length;t<i;t++)this.addLayer(n[t])},addLayer:function(n){var t=this.getLayerId(n);return this._layers[t]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var t=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(n){return n?n in this._layers||this.getLayerId(n)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(n){var r=Array.prototype.slice.call(arguments,1),i,t;for(i in this._layers)t=this._layers[i],t[n]&&t[n].apply(t,r);return this},onAdd:function(n){this._map=n;this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n);this._map=null},addTo:function(n){return n.addLayer(this),this},eachLayer:function(n,t){for(var i in this._layers)n.call(t,this._layers[i]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];for(var t in this._layers)n.push(this._layers[t]);return n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return r.stamp(n)}});r.layerGroup=function(n){return new r.LayerGroup(n)};r.FeatureGroup=r.LayerGroup.extend({includes:r.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(n){if(this.hasLayer(n))return this;if("on"in n)n.on(r.FeatureGroup.EVENTS,this._propagateEvent,this);return r.LayerGroup.prototype.addLayer.call(this,n),this._popupContent&&n.bindPopup&&n.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:n})},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.off(r.FeatureGroup.EVENTS,this._propagateEvent,this),r.LayerGroup.prototype.removeLayer.call(this,n),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:n})):this},bindPopup:function(n,t){return this._popupContent=n,this._popupOptions=t,this.invoke("bindPopup",n,t)},openPopup:function(n){for(var t in this._layers){this._layers[t].openPopup(n);break}return this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new r.LatLngBounds;return this.eachLayer(function(t){n.extend(t instanceof r.Marker?t.getLatLng():t.getBounds())}),n},_propagateEvent:function(n){n=r.extend({layer:n.target,target:this},n);this.fire(n.type,n)}});r.featureGroup=function(n){return new r.FeatureGroup(n)};r.Path=r.Class.extend({includes:[r.Mixin.Events],statics:{CLIP_PADDING:function(){var t=r.Browser.mobile?1280:2e3,i=(t/Math.max(n.outerWidth,n.outerHeight)-1)/2;return Math.max(0,Math.min(.5,i))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(n){r.setOptions(this,n)},onAdd:function(n){this._map=n;this._container||(this._initElements(),this._initEvents());this.projectLatlngs();this._updatePath();this._container&&this._map._pathRoot.appendChild(this._container);this.fire("add");n.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(n){return n.addLayer(this),this},onRemove:function(n){n._pathRoot.removeChild(this._container);this.fire("remove");this._map=null;r.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null);n.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(n){return r.setOptions(this,n),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}});r.Map.include({_updatePathViewport:function(){var n=r.Path.CLIP_PADDING,t=this.getSize(),u=r.DomUtil.getPosition(this._mapPane),i=u.multiplyBy(-1)._subtract(t.multiplyBy(n)._round()),f=i.add(t.multiplyBy(1+n*2)._round());this._pathViewport=new r.Bounds(i,f)}});r.Path.SVG_NS="http://www.w3.org/2000/svg";r.Browser.svg=!!(t.createElementNS&&t.createElementNS(r.Path.SVG_NS,"svg").createSVGRect);r.Path=r.Path.extend({statics:{SVG:r.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,n=this._container;return n&&t.lastChild!==n&&t.appendChild(n),this},bringToBack:function(){var t=this._map._pathRoot,n=this._container,i=t.firstChild;return n&&i!==n&&t.insertBefore(n,i),this},getPathString:function(){},_createElement:function(n){return t.createElementNS(r.Path.SVG_NS,n)},_initElements:function(){this._map._initPathRoot();this._initPath();this._initStyle()},_initPath:function(){this._container=this._createElement("g");this._path=this._createElement("path");this.options.className&&r.DomUtil.addClass(this._path,this.options.className);this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round"));this.options.fill&&this._path.setAttribute("fill-rule","evenodd");this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents);this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none");this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none");this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var n=this.getPathString();n||(n="M0 0");this._path.setAttribute("d",n)},_initEvents:function(){var t,n;if(this.options.clickable){(r.Browser.svg||!r.Browser.vml)&&r.DomUtil.addClass(this._path,"leaflet-clickable");r.DomEvent.on(this._container,"click",this._onMouseClick,this);for(t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],n=0;n<t.length;n++)r.DomEvent.on(this._container,t[n],this._fireMouseEvent,this)}},_onMouseClick:function(n){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(n)},_fireMouseEvent:function(n){if(this.hasEventListeners(n.type)){var t=this._map,i=t.mouseEventToContainerPoint(n),u=t.containerPointToLayerPoint(i),f=t.layerPointToLatLng(u);this.fire(n.type,{latlng:f,layerPoint:u,containerPoint:i,originalEvent:n});n.type==="contextmenu"&&r.DomEvent.preventDefault(n);n.type!=="mousemove"&&r.DomEvent.stopPropagation(n)}}});r.Map.include({_initPathRoot:function(){if(!this._pathRoot){if(this._pathRoot=r.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&r.Browser.any3d){r.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated");this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})}else r.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide");this.on("moveend",this._updateSvgViewport);this._updateSvgViewport()}},_animatePathZoom:function(n){var t=this.getZoomScale(n.zoom),i=this._getCenterOffset(n.center)._multiplyBy(-t)._add(this._pathViewport.min);this._pathRoot.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(i)+" scale("+t+") ";this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var i=this._pathViewport,t=i.min,u=i.max,f=u.x-t.x,e=u.y-t.y,n=this._pathRoot,o=this._panes.overlayPane;r.Browser.mobileWebkit&&o.removeChild(n);r.DomUtil.setPosition(n,t);n.setAttribute("width",f);n.setAttribute("height",e);n.setAttribute("viewBox",[t.x,t.y,f,e].join(" "));r.Browser.mobileWebkit&&o.appendChild(n)}}});r.Path.include({bindPopup:function(n,t){if(n instanceof r.Popup?this._popup=n:((!this._popup||t)&&(this._popup=new r.Popup(t,this)),this._popup.setContent(n)),!this._popupHandlersAdded){this.on("click",this._openPopup,this).on("remove",this.closePopup,this);this._popupHandlersAdded=!0}return this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(n){return this._popup&&(n=n||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:n})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(n){this._popup.setLatLng(n.latlng);this._map.openPopup(this._popup)}});r.Browser.vml=!r.Browser.svg&&function(){var i,n;try{return i=t.createElement("div"),i.innerHTML='<v:shape adj="1"/>',n=i.firstChild,n.style.behavior="url(#default#VML)",n&&typeof n.adj=="object"}catch(r){return!1}}();r.Path=r.Browser.svg||!r.Browser.vml?r.Path:r.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return t.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return t.createElement("<lvml:"+n+' class="lvml">')}}catch(n){return function(n){return t.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var n=this._container=this._createElement("shape");r.DomUtil.addClass(n,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:""));this.options.clickable&&r.DomUtil.addClass(n,"leaflet-clickable");n.coordsize="1 1";this._path=this._createElement("path");n.appendChild(this._path);this._map._pathRoot.appendChild(n)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,i=this._fill,n=this.options,u=this._container;u.stroked=n.stroke;u.filled=n.fill;n.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",u.appendChild(t)),t.weight=n.weight+"px",t.color=n.color,t.opacity=n.opacity,t.dashStyle=n.dashArray?r.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):"",n.lineCap&&(t.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(t.joinstyle=n.lineJoin)):t&&(u.removeChild(t),this._stroke=null);n.fill?(i||(i=this._fill=this._createElement("fill"),u.appendChild(i)),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(u.removeChild(i),this._fill=null)},_updatePath:function(){var n=this._container.style;n.display="none";this._path.v=this.getPathString()+" ";n.display=""}});r.Map.include(r.Browser.svg||!r.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var n=this._pathRoot=t.createElement("div");n.className="leaflet-vml-container";this._panes.overlayPane.appendChild(n);this.on("moveend",this._updatePathViewport);this._updatePathViewport()}}});r.Browser.canvas=function(){return!!t.createElement("canvas").getContext}();r.Path=r.Path.SVG&&!n.L_PREFER_CANVAS||!r.Browser.canvas?r.Path:r.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(n){return r.setOptions(this,n),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(n){n.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this);this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this));this._requestUpdate();this.fire("remove");this._map=null},_requestUpdate:function(){this._map&&!r.Path._updateRequest&&(r.Path._updateRequest=r.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){r.Path._updateRequest=null;this.fire("moveend")},_initElements:function(){this._map._initPathRoot();this._ctx=this._map._canvasCtx},_updateStyle:function(){var n=this.options;n.stroke&&(this._ctx.lineWidth=n.weight,this._ctx.strokeStyle=n.color);n.fill&&(this._ctx.fillStyle=n.fillColor||n.color);n.lineCap&&(this._ctx.lineCap=n.lineCap);n.lineJoin&&(this._ctx.lineJoin=n.lineJoin)},_drawPath:function(){var n,t,u,f,i,e;for(this._ctx.beginPath(),n=0,u=this._parts.length;n<u;n++){for(t=0,f=this._parts[n].length;t<f;t++)i=this._parts[n][t],e=(t===0?"move":"line")+"To",this._ctx[e](i.x,i.y);this instanceof r.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var n=this._ctx,t=this.options;this._drawPath();n.save();this._updateStyle();t.fill&&(n.globalAlpha=t.fillOpacity,n.fill(t.fillRule||"evenodd"));t.stroke&&(n.globalAlpha=t.opacity,n.stroke());n.restore()}},_initEvents:function(){if(this.options.clickable){this._map.on("mousemove",this._onMouseMove,this);this._map.on("click dblclick contextmenu",this._fireMouseEvent,this)}},_fireMouseEvent:function(n){this._containsPoint(n.layerPoint)&&this.fire(n.type,n)},_onMouseMove:function(n){this._map&&!this._map._animatingZoom&&(this._containsPoint(n.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",n)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",n)))}});r.Map.include(r.Path.SVG&&!n.L_PREFER_CANVAS||!r.Browser.canvas?{}:{_initPathRoot:function(){var n=this._pathRoot,i;if(!n){if(n=this._pathRoot=t.createElement("canvas"),n.style.position="absolute",i=this._canvasCtx=n.getContext("2d"),i.lineCap="round",i.lineJoin="round",this._panes.overlayPane.appendChild(n),this.options.zoomAnimation){this._pathRoot.className="leaflet-zoom-animated";this.on("zoomanim",this._animatePathZoom);this.on("zoomend",this._endPathZoom)}this.on("moveend",this._updateCanvasViewport);this._updateCanvasViewport()}},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var i=this._pathViewport,n=i.min,u=i.max.subtract(n),t=this._pathRoot;r.DomUtil.setPosition(t,n);t.width=u.x;t.height=u.y;t.getContext("2d").translate(-n.x,-n.y)}}});r.LineUtil={simplify:function(n,t){if(!t||!n.length)return n.slice();var i=t*t;return n=this._reducePoints(n,i),this._simplifyDP(n,i)},pointToSegmentDistance:function(n,t,i){return Math.sqrt(this._sqClosestPointOnSegment(n,t,i,!0))},closestPointOnSegment:function(n,t,i){return this._sqClosestPointOnSegment(n,t,i)},_simplifyDP:function(n,t){var u=n.length,o=typeof Uint8Array!=i+""?Uint8Array:Array,f=new o(u),r,e;for(f[0]=f[u-1]=1,this._simplifyDPStep(n,f,t,0,u-1),e=[],r=0;r<u;r++)f[r]&&e.push(n[r]);return e},_simplifyDPStep:function(n,t,i,r,u){for(var o=0,e,s,f=r+1;f<=u-1;f++)s=this._sqClosestPointOnSegment(n[f],n[r],n[u],!0),s>o&&(e=f,o=s);o>i&&(t[e]=1,this._simplifyDPStep(n,t,i,r,e),this._simplifyDPStep(n,t,i,e,u))},_reducePoints:function(n,t){for(var r=[n[0]],i=1,u=0,f=n.length;i<f;i++)this._sqDist(n[i],n[u])>t&&(r.push(n[i]),u=i);return u<f-1&&r.push(n[f-1]),r},clipSegment:function(n,t,i,r){var u=r?this._lastCode:this._getBitCode(n,i),f=this._getBitCode(t,i),o,e,s;for(this._lastCode=f;;)if(u|f){if(u&f)return!1;o=u||f;e=this._getEdgeIntersection(n,t,o,i);s=this._getBitCode(e,i);o===u?(n=e,u=s):(t=e,f=s)}else return[n,t]},_getEdgeIntersection:function(n,t,i,u){var f=t.x-n.x,e=t.y-n.y,o=u.min,s=u.max;return i&8?new r.Point(n.x+f*(s.y-n.y)/e,s.y):i&4?new r.Point(n.x+f*(o.y-n.y)/e,o.y):i&2?new r.Point(s.x,n.y+e*(s.x-n.x)/f):i&1?new r.Point(o.x,n.y+e*(o.x-n.x)/f):void 0},_getBitCode:function(n,t){var i=0;return n.x<t.min.x?i|=1:n.x>t.max.x&&(i|=2),n.y<t.min.y?i|=4:n.y>t.max.y&&(i|=8),i},_sqDist:function(n,t){var i=t.x-n.x,r=t.y-n.y;return i*i+r*r},_sqClosestPointOnSegment:function(n,t,i,u){var o=t.x,s=t.y,f=i.x-o,e=i.y-s,c=f*f+e*e,h;return c>0&&(h=((n.x-o)*f+(n.y-s)*e)/c,h>1?(o=i.x,s=i.y):h>0&&(o+=f*h,s+=e*h)),f=n.x-o,e=n.y-s,u?f*f+e*e:new r.Point(o,s)}};r.Polyline=r.Path.extend({initialize:function(n,t){r.Path.prototype.initialize.call(this,t);this._latlngs=this._convertLatLngs(n)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var n=0,t=this._latlngs.length;n<t;n++)this._originalPoints[n]=this._map.latLngToLayerPoint(this._latlngs[n])},getPathString:function(){for(var n=0,i=this._parts.length,t="";n<i;n++)t+=this._getPathPartStr(this._parts[n]);return t},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._latlngs=this._convertLatLngs(n),this.redraw()},addLatLng:function(n){return this._latlngs.push(r.latLng(n)),this.redraw()},spliceLatLngs:function(){var n=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),n},closestLayerPoint:function(n){for(var u,t,l,h,f=Infinity,c=this._parts,e,o,i=null,s=0,a=c.length;s<a;s++)for(u=c[s],t=1,l=u.length;t<l;t++)e=u[t-1],o=u[t],h=r.LineUtil._sqClosestPointOnSegment(n,e,o,!0),h<f&&(f=h,i=r.LineUtil._sqClosestPointOnSegment(n,e,o));return i&&(i.distance=Math.sqrt(f)),i},getBounds:function(){return new r.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(n,t){for(var f=t?n:[],i=0,u=n.length;i<u;i++){if(r.Util.isArray(n[i])&&typeof n[i][0]!="number")return;f[i]=r.latLng(n[i])}return f},_initEvents:function(){r.Path.prototype._initEvents.call(this)},_getPathPartStr:function(n){for(var f=r.Path.VML,t=0,e=n.length,u="",i;t<e;t++)i=n[t],f&&i._round(),u+=(t?"L":"M")+i.x+" "+i.y;return u},_clipPoints:function(){var i=this._originalPoints,e=i.length,n,t,u;if(this.options.noClip){this._parts=[i];return}this._parts=[];var f=this._parts,o=this._map._pathViewport,s=r.LineUtil;for(n=0,t=0;n<e-1;n++)(u=s.clipSegment(i[n],i[n+1],o,n),u)&&(f[t]=f[t]||[],f[t].push(u[0]),(u[1]!==i[n+1]||n===e-2)&&(f[t].push(u[1]),t++))},_simplifyPoints:function(){for(var t=this._parts,i=r.LineUtil,n=0,u=t.length;n<u;n++)t[n]=i.simplify(t[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),r.Path.prototype._updatePath.call(this))}});r.polyline=function(n,t){return new r.Polyline(n,t)};r.PolyUtil={};r.PolyUtil.clipPolygon=function(n,t){for(var e,v=[1,4,2,8],a,l,o,s,f,u,c=r.LineUtil,i=0,h=n.length;i<h;i++)n[i]._code=c._getBitCode(n[i],t);for(l=0;l<4;l++){for(f=v[l],e=[],i=0,h=n.length,a=h-1;i<h;a=i++)o=n[i],s=n[a],o._code&f?s._code&f||(u=c._getEdgeIntersection(s,o,f,t),u._code=c._getBitCode(u,t),e.push(u)):(s._code&f&&(u=c._getEdgeIntersection(s,o,f,t),u._code=c._getBitCode(u,t),e.push(u)),e.push(o));n=e}return n};r.Polygon=r.Polyline.extend({options:{fill:!0},initialize:function(n,t){r.Polyline.prototype.initialize.call(this,n,t);this._initWithHoles(n)},_initWithHoles:function(n){var t,u,i;if(n&&r.Util.isArray(n[0])&&typeof n[0][0]!="number")for(this._latlngs=this._convertLatLngs(n[0]),this._holes=n.slice(1),t=0,u=this._holes.length;t<u;t++)i=this._holes[t]=this._convertLatLngs(this._holes[t]),i[0].equals(i[i.length-1])&&i.pop();n=this._latlngs;n.length>=2&&n[0].equals(n[n.length-1])&&n.pop()},projectLatlngs:function(){if(r.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(var t,u,n=0,i=this._holes.length;n<i;n++)for(this._holePoints[n]=[],t=0,u=this._holes[n].length;t<u;t++)this._holePoints[n][t]=this._map.latLngToLayerPoint(this._holes[n][t])},setLatLngs:function(n){return n&&r.Util.isArray(n[0])&&typeof n[0][0]!="number"?(this._initWithHoles(n),this.redraw()):r.Polyline.prototype.setLatLngs.call(this,n)},_clipPoints:function(){var f=this._originalPoints,i=[],n,u,t;if(this._parts=[f].concat(this._holePoints),!this.options.noClip){for(n=0,u=this._parts.length;n<u;n++)t=r.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport),t.length&&i.push(t);this._parts=i}},_getPathPartStr:function(n){var t=r.Polyline.prototype._getPathPartStr.call(this,n);return t+(r.Browser.svg?"z":"x")}});r.polygon=function(n,t){return new r.Polygon(n,t)},function(){function n(n){return r.FeatureGroup.extend({initialize:function(n,t){this._layers={};this._options=t;this.setLatLngs(n)},setLatLngs:function(t){var i=0,r=t.length;for(this.eachLayer(function(n){i<r?n.setLatLngs(t[i++]):this.removeLayer(n)},this);i<r;)this.addLayer(new n(t[i++],this._options));return this},getLatLngs:function(){var n=[];return this.eachLayer(function(t){n.push(t.getLatLngs())}),n}})}r.MultiPolyline=n(r.Polyline);r.MultiPolygon=n(r.Polygon);r.multiPolyline=function(n,t){return new r.MultiPolyline(n,t)};r.multiPolygon=function(n,t){return new r.MultiPolygon(n,t)}}();r.Rectangle=r.Polygon.extend({initialize:function(n,t){r.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(n),t)},setBounds:function(n){this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=r.latLngBounds(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});r.rectangle=function(n,t){return new r.Rectangle(n,t)};r.Circle=r.Path.extend({initialize:function(n,t,i){r.Path.prototype.initialize.call(this,i);this._latlng=r.latLng(n);this._mRadius=t},options:{fill:!0},setLatLng:function(n){return this._latlng=r.latLng(n),this.redraw()},setRadius:function(n){return this._mRadius=n,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),n=this._latlng,i=this._map.latLngToLayerPoint([n.lat,n.lng-t]);this._point=this._map.latLngToLayerPoint(n);this._radius=Math.max(this._point.x-i.x,1)},getBounds:function(){var t=this._getLngRadius(),i=this._mRadius/40075017*360,n=this._latlng;return new r.LatLngBounds([n.lat-i,n.lng-t],[n.lat+i,n.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,n=this._radius;return this._checkIfEmpty()?"":r.Browser.svg?"M"+t.x+","+(t.y-n)+"A"+n+","+n+",0,1,1,"+(t.x-.1)+","+(t.y-n)+" z":(t._round(),n=Math.round(n),"AL "+t.x+","+t.y+" "+n+","+n+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(r.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var n=this._map._pathViewport,t=this._radius,i=this._point;return i.x-t>n.max.x||i.y-t>n.max.y||i.x+t<n.min.x||i.y+t<n.min.y}});r.circle=function(n,t,i){return new r.Circle(n,t,i)};r.CircleMarker=r.Circle.extend({options:{radius:10,weight:2},initialize:function(n,t){r.Circle.prototype.initialize.call(this,n,null,t);this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){r.Circle.prototype._updateStyle.call(this);this.setRadius(this.options.radius)},setLatLng:function(n){return r.Circle.prototype.setLatLng.call(this,n),this._popup&&this._popup._isOpen&&this._popup.setLatLng(n),this},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius}});r.circleMarker=function(n,t){return new r.CircleMarker(n,t)};r.Polyline.include(r.Path.CANVAS?{_containsPoint:function(n,t){var u,i,e,s,o,h,f,c=this.options.weight/2;for(r.Browser.touch&&(c+=10),u=0,s=this._parts.length;u<s;u++)for(f=this._parts[u],i=0,o=f.length,e=o-1;i<o;e=i++)if((t||i!==0)&&(h=r.LineUtil.pointToSegmentDistance(n,f[e],f[i]),h<=c))return!0;return!1}}:{});r.Polygon.include(r.Path.CANVAS?{_containsPoint:function(n){var o=!1,i,t,u,f,e,s,c,h;if(r.Polyline.prototype._containsPoint.call(this,n,!0))return!0;for(f=0,c=this._parts.length;f<c;f++)for(i=this._parts[f],e=0,h=i.length,s=h-1;e<h;s=e++)t=i[e],u=i[s],t.y>n.y!=u.y>n.y&&n.x<(u.x-t.x)*(n.y-t.y)/(u.y-t.y)+t.x&&(o=!o);return o}}:{});r.Circle.include(r.Path.CANVAS?{_drawPath:function(){var n=this._point;this._ctx.beginPath();this._ctx.arc(n.x,n.y,this._radius,0,Math.PI*2,!1)},_containsPoint:function(n){var t=this._point,i=this.options.stroke?this.options.weight/2:0;return n.distanceTo(t)<=this._radius+i}}:{});r.CircleMarker.include(r.Path.CANVAS?{_updateStyle:function(){r.Path.prototype._updateStyle.call(this)}}:{});r.GeoJSON=r.FeatureGroup.extend({initialize:function(n,t){r.setOptions(this,t);this._layers={};n&&this.addData(n)},addData:function(n){var e=r.Util.isArray(n)?n:n.features,u,o,f,t,i;if(e){for(u=0,o=e.length;u<o;u++)f=e[u],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(e[u]);return this}if(t=this.options,!t.filter||t.filter(n)){if(i=r.GeoJSON.geometryToLayer(n,t.pointToLayer,t.coordsToLatLng,t),i.feature=r.GeoJSON.asFeature(n),i.defaultOptions=i.options,this.resetStyle(i),t.onEachFeature)t.onEachFeature(n,i);return this.addLayer(i)}},resetStyle:function(n){var t=this.options.style;t&&(r.Util.extend(n.options,n.defaultOptions),this._setLayerStyle(n,t))},setStyle:function(n){this.eachLayer(function(t){this._setLayerStyle(t,n)},this)},_setLayerStyle:function(n,t){typeof t=="function"&&(t=t(n.feature));n.setStyle&&n.setStyle(t)}});r.extend(r.GeoJSON,{geometryToLayer:function(n,t,i,u){var h=n.type==="Feature"?n.geometry:n,f=h.coordinates,c=[],s,e,o,l;i=i||this.coordsToLatLng;switch(h.type){case"Point":return s=i(f),t?t(n,s):new r.Marker(s);case"MultiPoint":for(o=0,l=f.length;o<l;o++)s=i(f[o]),c.push(t?t(n,s):new r.Marker(s));return new r.FeatureGroup(c);case"LineString":return e=this.coordsToLatLngs(f,0,i),new r.Polyline(e,u);case"Polygon":if(f.length===2&&!f[1].length)throw new Error("Invalid GeoJSON object.");return e=this.coordsToLatLngs(f,1,i),new r.Polygon(e,u);case"MultiLineString":return e=this.coordsToLatLngs(f,1,i),new r.MultiPolyline(e,u);case"MultiPolygon":return e=this.coordsToLatLngs(f,2,i),new r.MultiPolygon(e,u);case"GeometryCollection":for(o=0,l=h.geometries.length;o<l;o++)c.push(this.geometryToLayer({geometry:h.geometries[o],type:"Feature",properties:n.properties},t,i,u));return new r.FeatureGroup(c);default:throw new Error("Invalid GeoJSON object.");}},coordsToLatLng:function(n){return new r.LatLng(n[1],n[0],n[2])},coordsToLatLngs:function(n,t,i){for(var u,e=[],r=0,f=n.length;r<f;r++)u=t?this.coordsToLatLngs(n[r],t-1,i):(i||this.coordsToLatLng)(n[r]),e.push(u);return e},latLngToCoords:function(n){var t=[n.lng,n.lat];return n.alt!==i&&t.push(n.alt),t},latLngsToCoords:function(n){for(var i=[],t=0,u=n.length;t<u;t++)i.push(r.GeoJSON.latLngToCoords(n[t]));return i},getFeature:function(n,t){return n.feature?r.extend({},n.feature,{geometry:t}):r.GeoJSON.asFeature(t)},asFeature:function(n){return n.type==="Feature"?n:{type:"Feature",properties:{},geometry:n}}});f={toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"Point",coordinates:r.GeoJSON.latLngToCoords(this.getLatLng())})}};r.Marker.include(f);r.Circle.include(f);r.CircleMarker.include(f);r.Polyline.include({toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"LineString",coordinates:r.GeoJSON.latLngsToCoords(this.getLatLngs())})}});r.Polygon.include({toGeoJSON:function(){var n=[r.GeoJSON.latLngsToCoords(this.getLatLngs())],t,u,i;if(n[0].push(n[0][0]),this._holes)for(t=0,u=this._holes.length;t<u;t++)i=r.GeoJSON.latLngsToCoords(this._holes[t]),i.push(i[0]),n.push(i);return r.GeoJSON.getFeature(this,{type:"Polygon",coordinates:n})}}),function(){function n(n){return function(){var t=[];return this.eachLayer(function(n){t.push(n.toGeoJSON().geometry.coordinates)}),r.GeoJSON.getFeature(this,{type:n,coordinates:t})}}r.MultiPolyline.include({toGeoJSON:n("MultiLineString")});r.MultiPolygon.include({toGeoJSON:n("MultiPolygon")});r.LayerGroup.include({toGeoJSON:function(){var t=this.feature&&this.feature.geometry,i=[],u,f;return t&&t.type==="MultiPoint"?n("MultiPoint").call(this):(f=t&&t.type==="GeometryCollection",this.eachLayer(function(n){n.toGeoJSON&&(u=n.toGeoJSON(),i.push(f?u.geometry:r.GeoJSON.asFeature(u)))}),f)?r.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}();r.geoJson=function(n,t){return new r.GeoJSON(n,t)};r.DomEvent={addListener:function(n,t,i,u){var o=r.stamp(i),s="_leaflet_"+t+o,f,e,h;return n[s]?this:(f=function(t){return i.call(u||n,t||r.DomEvent._getEvent())},r.Browser.pointer&&t.indexOf("touch")===0)?this.addPointerListener(n,t,f,o):(r.Browser.touch&&t==="dblclick"&&this.addDoubleTapListener&&this.addDoubleTapListener(n,f,o),"addEventListener"in n?t==="mousewheel"?(n.addEventListener("DOMMouseScroll",f,!1),n.addEventListener(t,f,!1)):t==="mouseenter"||t==="mouseleave"?(e=f,h=t==="mouseenter"?"mouseover":"mouseout",f=function(t){if(r.DomEvent._checkMouse(n,t))return e(t)},n.addEventListener(h,f,!1)):t==="click"&&r.Browser.android?(e=f,f=function(n){return r.DomEvent._filterClick(n,e)},n.addEventListener(t,f,!1)):n.addEventListener(t,f,!1):"attachEvent"in n&&n.attachEvent("on"+t,f),n[s]=f,this)},removeListener:function(n,t,i){var f=r.stamp(i),e="_leaflet_"+t+f,u=n[e];return u?(r.Browser.pointer&&t.indexOf("touch")===0?this.removePointerListener(n,t,f):r.Browser.touch&&t==="dblclick"&&this.removeDoubleTapListener?this.removeDoubleTapListener(n,f):"removeEventListener"in n?t==="mousewheel"?(n.removeEventListener("DOMMouseScroll",u,!1),n.removeEventListener(t,u,!1)):t==="mouseenter"||t==="mouseleave"?n.removeEventListener(t==="mouseenter"?"mouseover":"mouseout",u,!1):n.removeEventListener(t,u,!1):"detachEvent"in n&&n.detachEvent("on"+t,u),n[e]=null,this):this},stopPropagation:function(n){return n.stopPropagation?n.stopPropagation():n.cancelBubble=!0,r.DomEvent._skipped(n),this},disableScrollPropagation:function(n){var t=r.DomEvent.stopPropagation;return r.DomEvent.on(n,"mousewheel",t).on(n,"MozMousePixelScroll",t)},disableClickPropagation:function(n){for(var i=r.DomEvent.stopPropagation,t=r.Draggable.START.length-1;t>=0;t--)r.DomEvent.on(n,r.Draggable.START[t],i);return r.DomEvent.on(n,"click",r.DomEvent._fakeStop).on(n,"dblclick",i)},preventDefault:function(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this},stop:function(n){return r.DomEvent.preventDefault(n).stopPropagation(n)},getMousePosition:function(n,t){if(!t)return new r.Point(n.clientX,n.clientY);var i=t.getBoundingClientRect();return new r.Point(n.clientX-i.left-t.clientLeft,n.clientY-i.top-t.clientTop)},getWheelDelta:function(n){var t=0;return n.wheelDelta&&(t=n.wheelDelta/120),n.detail&&(t=-n.detail/3),t},_skipEvents:{},_fakeStop:function(n){r.DomEvent._skipEvents[n.type]=!0},_skipped:function(n){var t=this._skipEvents[n.type];return this._skipEvents[n.type]=!1,t},_checkMouse:function(n,t){var i=t.relatedTarget;if(!i)return!0;try{while(i&&i!==n)i=i.parentNode}catch(r){return!1}return i!==n},_getEvent:function(){var t=n.event,i;if(!t)for(i=arguments.callee.caller;i;){if(t=i.arguments[0],t&&n.Event===t.constructor)break;i=i.caller}return t},_filterClick:function(n,t){var u=n.timeStamp||n.originalEvent.timeStamp,i=r.DomEvent._lastClick&&u-r.DomEvent._lastClick;if(i&&i>100&&i<500||n.target._simulatedClick&&!n._simulated){r.DomEvent.stop(n);return}return r.DomEvent._lastClick=u,t(n)}};r.DomEvent.on=r.DomEvent.addListener;r.DomEvent.off=r.DomEvent.removeListener;r.Draggable=r.Class.extend({includes:r.Mixin.Events,statics:{START:r.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(n,t){this._element=n;this._dragStartTarget=t||n},enable:function(){if(!this._enabled){for(var n=r.Draggable.START.length-1;n>=0;n--)r.DomEvent.on(this._dragStartTarget,r.Draggable.START[n],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var n=r.Draggable.START.length-1;n>=0;n--)r.DomEvent.off(this._dragStartTarget,r.Draggable.START[n],this._onDown,this);this._enabled=!1;this._moved=!1}},_onDown:function(n){if((this._moved=!1,!n.shiftKey&&(n.which===1||n.button===1||n.touches))&&(r.DomEvent.stopPropagation(n),!r.Draggable._disabled)&&(r.DomUtil.disableImageDrag(),r.DomUtil.disableTextSelection(),!this._moving)){var i=n.touches?n.touches[0]:n;this._startPoint=new r.Point(i.clientX,i.clientY);this._startPos=this._newPos=r.DomUtil.getPosition(this._element);r.DomEvent.on(t,r.Draggable.MOVE[n.type],this._onMove,this).on(t,r.Draggable.END[n.type],this._onUp,this)}},_onMove:function(n){if(n.touches&&n.touches.length>1){this._moved=!0;return}var u=n.touches&&n.touches.length===1?n.touches[0]:n,f=new r.Point(u.clientX,u.clientY),i=f.subtract(this._startPoint);(i.x||i.y)&&(r.Browser.touch&&Math.abs(i.x)+Math.abs(i.y)<3||(r.DomEvent.preventDefault(n),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=r.DomUtil.getPosition(this._element).subtract(i),r.DomUtil.addClass(t.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,r.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,r.Util.cancelAnimFrame(this._animRequest),this._animRequest=r.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag");r.DomUtil.setPosition(this._element,this._newPos);this.fire("drag")},_onUp:function(){r.DomUtil.removeClass(t.body,"leaflet-dragging");this._lastTarget&&(r.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var n in r.Draggable.MOVE)r.DomEvent.off(t,r.Draggable.MOVE[n],this._onMove).off(t,r.Draggable.END[n],this._onUp);r.DomUtil.enableImageDrag();r.DomUtil.enableTextSelection();this._moved&&this._moving&&(r.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1}});r.Handler=r.Class.extend({initialize:function(n){this._map=n},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}});r.Map.mergeOptions({dragging:!0,inertia:!r.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,inertiaThreshold:r.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1});r.Map.Drag=r.Handler.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new r.Draggable(n._mapPane,n._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);if(n.options.worldCopyJump){this._draggable.on("predrag",this._onPreDrag,this);n.on("viewreset",this._onViewReset,this);n.whenReady(this._onViewReset,this)}}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var n=this._map;n._panAnim&&n._panAnim.stop();n.fire("movestart").fire("dragstart");n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var n=this._lastTime=+new Date,t=this._lastPos=this._draggable._newPos;this._positions.push(t);this._times.push(n);n-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var n=this._map.getSize()._divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(n).x;this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var i=this._worldWidth,t=Math.round(i/2),n=this._initialWorldOffset,r=this._draggable._newPos.x,u=(r-t+n)%i+t-n,f=(r+t+n)%i-t-n,e=Math.abs(u+n)<Math.abs(f+n)?u:f;this._draggable._newPos.x=e},_onDragEnd:function(n){var t=this._map,i=t.options,e=+new Date-this._lastTime,l=!i.inertia||e>i.inertiaThreshold||!this._positions[0];if(t.fire("dragend",n),l)t.fire("moveend");else{var a=this._lastPos.subtract(this._positions[0]),v=(this._lastTime+e-this._times[0])/1e3,f=i.easeLinearity,o=a.multiplyBy(f/v),s=o.distanceTo([0,0]),h=Math.min(i.inertiaMaxSpeed,s),y=o.multiplyBy(h/s),c=h/(i.inertiaDeceleration*f),u=y.multiplyBy(-c/2).round();u.x&&u.y?(u=t._limitOffset(u,t.options.maxBounds),r.Util.requestAnimFrame(function(){t.panBy(u,{duration:c,easeLinearity:f,noMoveStart:!0})})):t.fire("moveend")}}});r.Map.addInitHook("addHandler","dragging",r.Map.Drag);r.Map.mergeOptions({doubleClickZoom:!0});r.Map.DoubleClickZoom=r.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var t=this._map,i=t.getZoom()+(n.originalEvent.shiftKey?-1:1);t.options.doubleClickZoom==="center"?t.setZoom(i):t.setZoomAround(n.containerPoint,i)}});r.Map.addInitHook("addHandler","doubleClickZoom",r.Map.DoubleClickZoom);r.Map.mergeOptions({scrollWheelZoom:!0});r.Map.ScrollWheelZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);r.DomEvent.on(this._map._container,"MozMousePixelScroll",r.DomEvent.preventDefault);this._delta=0},removeHooks:function(){r.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll);r.DomEvent.off(this._map._container,"MozMousePixelScroll",r.DomEvent.preventDefault)},_onWheelScroll:function(n){var i=r.DomEvent.getWheelDelta(n),t;this._delta+=i;this._lastMousePos=this._map.mouseEventToContainerPoint(n);this._startTime||(this._startTime=+new Date);t=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(r.bind(this._performZoom,this),t);r.DomEvent.preventDefault(n);r.DomEvent.stopPropagation(n)},_performZoom:function(){var t=this._map,n=this._delta,i=t.getZoom();(n=n>0?Math.ceil(n):Math.floor(n),n=Math.max(Math.min(n,4),-4),n=t._limitZoom(i+n)-i,this._delta=0,this._startTime=null,n)&&(t.options.scrollWheelZoom==="center"?t.setZoom(i+n):t.setZoomAround(this._lastMousePos,i+n))}});r.Map.addInitHook("addHandler","scrollWheelZoom",r.Map.ScrollWheelZoom);r.extend(r.DomEvent,{_touchstart:r.Browser.msPointer?"MSPointerDown":r.Browser.pointer?"pointerdown":"touchstart",_touchend:r.Browser.msPointer?"MSPointerUp":r.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(n,i,u){function y(n){var i,t,u;(r.Browser.pointer?(e.push(n.pointerId),i=e.length):i=n.touches.length,i>1)||(t=Date.now(),u=t-(o||t),f=n.touches?n.touches[0]:n,c=u>0&&u<=p,o=t)}function s(n){var u,s,t,h;if(r.Browser.pointer){if(u=e.indexOf(n.pointerId),u===-1)return;e.splice(u,1)}if(c){if(r.Browser.pointer){s={};for(h in f)t=f[h],s[h]=typeof t=="function"?t.bind(f):t;f=s}f.type="dblclick";i(f);o=null}}var o,c=!1,p=250,f,l="_leaflet_",a=this._touchstart,v=this._touchend,e=[],h;return n[l+a+u]=y,n[l+v+u]=s,h=r.Browser.pointer?t.documentElement:n,n.addEventListener(a,y,!1),h.addEventListener(v,s,!1),r.Browser.pointer&&h.addEventListener(r.DomEvent.POINTER_CANCEL,s,!1),this},removeDoubleTapListener:function(n,i){var u="_leaflet_";return n.removeEventListener(this._touchstart,n[u+this._touchstart+i],!1),(r.Browser.pointer?t.documentElement:n).removeEventListener(this._touchend,n[u+this._touchend+i],!1),r.Browser.pointer&&t.documentElement.removeEventListener(r.DomEvent.POINTER_CANCEL,n[u+this._touchend+i],!1),this}});r.extend(r.DomEvent,{POINTER_DOWN:r.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:r.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:r.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:r.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(n,t,i,r){switch(t){case"touchstart":return this.addPointerListenerStart(n,t,i,r);case"touchend":return this.addPointerListenerEnd(n,t,i,r);case"touchmove":return this.addPointerListenerMove(n,t,i,r);default:throw"Unknown touch event type";}},addPointerListenerStart:function(n,i,u,f){var e=this._pointers,s=function(n){var i,t;for(r.DomEvent.preventDefault(n),i=!1,t=0;t<e.length;t++)if(e[t].pointerId===n.pointerId){i=!0;break}i||e.push(n);n.touches=e.slice();n.changedTouches=[n];u(n)},o;return n["_leaflet_touchstart"+f]=s,n.addEventListener(this.POINTER_DOWN,s,!1),this._pointerDocumentListener||(o=function(n){for(var t=0;t<e.length;t++)if(e[t].pointerId===n.pointerId){e.splice(t,1);break}},t.documentElement.addEventListener(this.POINTER_UP,o,!1),t.documentElement.addEventListener(this.POINTER_CANCEL,o,!1),this._pointerDocumentListener=!0),this},addPointerListenerMove:function(n,t,i,r){function f(n){if(n.pointerType!==n.MSPOINTER_TYPE_MOUSE&&n.pointerType!=="mouse"||n.buttons!==0){for(var t=0;t<u.length;t++)if(u[t].pointerId===n.pointerId){u[t]=n;break}n.touches=u.slice();n.changedTouches=[n];i(n)}}var u=this._pointers;return n["_leaflet_touchmove"+r]=f,n.addEventListener(this.POINTER_MOVE,f,!1),this},addPointerListenerEnd:function(n,t,i,r){var u=this._pointers,f=function(n){for(var t=0;t<u.length;t++)if(u[t].pointerId===n.pointerId){u.splice(t,1);break}n.touches=u.slice();n.changedTouches=[n];i(n)};return n["_leaflet_touchend"+r]=f,n.addEventListener(this.POINTER_UP,f,!1),n.addEventListener(this.POINTER_CANCEL,f,!1),this},removePointerListener:function(n,t,i){var r=n["_leaflet_"+t+i];switch(t){case"touchstart":n.removeEventListener(this.POINTER_DOWN,r,!1);break;case"touchmove":n.removeEventListener(this.POINTER_MOVE,r,!1);break;case"touchend":n.removeEventListener(this.POINTER_UP,r,!1);n.removeEventListener(this.POINTER_CANCEL,r,!1)}return this}});r.Map.mergeOptions({touchZoom:r.Browser.touch&&!r.Browser.android23,bounceAtZoomLimits:!0});r.Map.TouchZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var i=this._map;if(n.touches&&n.touches.length===2&&!i._animatingZoom&&!this._zooming){var u=i.mouseEventToLayerPoint(n.touches[0]),f=i.mouseEventToLayerPoint(n.touches[1]),e=i._getCenterLayerPoint();this._startCenter=u.add(f)._divideBy(2);this._startDist=u.distanceTo(f);this._moved=!1;this._zooming=!0;this._centerOffset=e.subtract(this._startCenter);i._panAnim&&i._panAnim.stop();r.DomEvent.on(t,"touchmove",this._onTouchMove,this).on(t,"touchend",this._onTouchEnd,this);r.DomEvent.preventDefault(n)}},_onTouchMove:function(n){var t=this._map,i,u;n.touches&&n.touches.length===2&&this._zooming&&(i=t.mouseEventToLayerPoint(n.touches[0]),u=t.mouseEventToLayerPoint(n.touches[1]),this._scale=i.distanceTo(u)/this._startDist,this._delta=i._add(u)._divideBy(2)._subtract(this._startCenter),this._scale!==1)&&(!t.options.bounceAtZoomLimits&&(t.getZoom()===t.getMinZoom()&&this._scale<1||t.getZoom()===t.getMaxZoom()&&this._scale>1)||(this._moved||(r.DomUtil.addClass(t._mapPane,"leaflet-touching"),t.fire("movestart").fire("zoomstart"),this._moved=!0),r.Util.cancelAnimFrame(this._animRequest),this._animRequest=r.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),r.DomEvent.preventDefault(n)))},_updateOnMove:function(){var n=this._map,t=this._getScaleOrigin(),i=n.layerPointToLatLng(t),r=n.getScaleZoom(this._scale);n._animateZoom(i,r,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){var n;if(!this._moved||!this._zooming){this._zooming=!1;return}n=this._map;this._zooming=!1;r.DomUtil.removeClass(n._mapPane,"leaflet-touching");r.Util.cancelAnimFrame(this._animRequest);r.DomEvent.off(t,"touchmove",this._onTouchMove).off(t,"touchend",this._onTouchEnd);var u=this._getScaleOrigin(),o=n.layerPointToLatLng(u),f=n.getZoom(),i=n.getScaleZoom(this._scale)-f,s=i>0?Math.ceil(i):Math.floor(i),e=n._limitZoom(f+s),h=n.getZoomScale(e)/this._scale;n._animateZoom(o,e,u,h)},_getScaleOrigin:function(){var n=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(n)}});r.Map.addInitHook("addHandler","touchZoom",r.Map.TouchZoom);r.Map.mergeOptions({tap:!0,tapTolerance:15});r.Map.Tap=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(n.touches){if(r.DomEvent.preventDefault(n),this._fireClick=!0,n.touches.length>1){this._fireClick=!1;clearTimeout(this._holdTimeout);return}var i=n.touches[0],u=i.target;this._startPos=this._newPos=new r.Point(i.clientX,i.clientY);u.tagName&&u.tagName.toLowerCase()==="a"&&r.DomUtil.addClass(u,"leaflet-active");this._holdTimeout=setTimeout(r.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3);r.DomEvent.on(t,"touchmove",this._onMove,this).on(t,"touchend",this._onUp,this)}},_onUp:function(n){if(clearTimeout(this._holdTimeout),r.DomEvent.off(t,"touchmove",this._onMove,this).off(t,"touchend",this._onUp,this),this._fireClick&&n&&n.changedTouches){var u=n.changedTouches[0],i=u.target;i&&i.tagName&&i.tagName.toLowerCase()==="a"&&r.DomUtil.removeClass(i,"leaflet-active");this._isTapValid()&&this._simulateEvent("click",u)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(n){var t=n.touches[0];this._newPos=new r.Point(t.clientX,t.clientY)},_simulateEvent:function(i,r){var u=t.createEvent("MouseEvents");u._simulated=!0;r.target._simulatedClick=!0;u.initMouseEvent(i,!0,!0,n,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null);r.target.dispatchEvent(u)}});r.Browser.touch&&!r.Browser.pointer&&r.Map.addInitHook("addHandler","tap",r.Map.Tap);r.Map.mergeOptions({boxZoom:!0});r.Map.BoxZoom=r.Handler.extend({initialize:function(n){this._map=n;this._container=n._container;this._pane=n._panes.overlayPane;this._moved=!1},addHooks:function(){r.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){r.DomEvent.off(this._container,"mousedown",this._onMouseDown);this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(n){if(this._moved=!1,!n.shiftKey||n.which!==1&&n.button!==1)return!1;r.DomUtil.disableTextSelection();r.DomUtil.disableImageDrag();this._startLayerPoint=this._map.mouseEventToLayerPoint(n);r.DomEvent.on(t,"mousemove",this._onMouseMove,this).on(t,"mouseup",this._onMouseUp,this).on(t,"keydown",this._onKeyDown,this)},_onMouseMove:function(n){this._moved||(this._box=r.DomUtil.create("div","leaflet-zoom-box",this._pane),r.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var t=this._startLayerPoint,i=this._box,u=this._map.mouseEventToLayerPoint(n),f=u.subtract(t),e=new r.Point(Math.min(u.x,t.x),Math.min(u.y,t.y));r.DomUtil.setPosition(i,e);this._moved=!0;i.style.width=Math.max(0,Math.abs(f.x)-4)+"px";i.style.height=Math.max(0,Math.abs(f.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor="");r.DomUtil.enableTextSelection();r.DomUtil.enableImageDrag();r.DomEvent.off(t,"mousemove",this._onMouseMove).off(t,"mouseup",this._onMouseUp).off(t,"keydown",this._onKeyDown)},_onMouseUp:function(n){var t,i,u;(this._finish(),t=this._map,i=t.mouseEventToLayerPoint(n),this._startLayerPoint.equals(i))||(u=new r.LatLngBounds(t.layerPointToLatLng(this._startLayerPoint),t.layerPointToLatLng(i)),t.fitBounds(u),t.fire("boxzoomend",{boxZoomBounds:u}))},_onKeyDown:function(n){n.keyCode===27&&this._finish()}});r.Map.addInitHook("addHandler","boxZoom",r.Map.BoxZoom);r.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1});r.Map.Keyboard=r.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(n){this._map=n;this._setPanOffset(n.options.keyboardPanOffset);this._setZoomOffset(n.options.keyboardZoomOffset)},addHooks:function(){var n=this._map._container;n.tabIndex===-1&&(n.tabIndex="0");r.DomEvent.on(n,"focus",this._onFocus,this).on(n,"blur",this._onBlur,this).on(n,"mousedown",this._onMouseDown,this);this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var n=this._map._container;r.DomEvent.off(n,"focus",this._onFocus,this).off(n,"blur",this._onBlur,this).off(n,"mousedown",this._onMouseDown,this);this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var i=t.body,r=t.documentElement,u=i.scrollTop||r.scrollTop,f=i.scrollLeft||r.scrollLeft;this._map._container.focus();n.scrollTo(f,u)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanOffset:function(n){for(var u=this._panKeys={},i=this.keyCodes,t=0,r=i.left.length;t<r;t++)u[i.left[t]]=[-1*n,0];for(t=0,r=i.right.length;t<r;t++)u[i.right[t]]=[n,0];for(t=0,r=i.down.length;t<r;t++)u[i.down[t]]=[0,n];for(t=0,r=i.up.length;t<r;t++)u[i.up[t]]=[0,-1*n]},_setZoomOffset:function(n){for(var u=this._zoomKeys={},i=this.keyCodes,t=0,r=i.zoomIn.length;t<r;t++)u[i.zoomIn[t]]=n;for(t=0,r=i.zoomOut.length;t<r;t++)u[i.zoomOut[t]]=-n},_addHooks:function(){r.DomEvent.on(t,"keydown",this._onKeyDown,this)},_removeHooks:function(){r.DomEvent.off(t,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){var i=n.keyCode,t=this._map;if(i in this._panKeys){if(t._panAnim&&t._panAnim._inProgress)return;t.panBy(this._panKeys[i]);t.options.maxBounds&&t.panInsideBounds(t.options.maxBounds)}else if(i in this._zoomKeys)t.setZoom(t.getZoom()+this._zoomKeys[i]);else return;r.DomEvent.stop(n)}});r.Map.addInitHook("addHandler","keyboard",r.Map.Keyboard);r.Handler.MarkerDrag=r.Handler.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new r.Draggable(n,n));this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this);this._draggable.enable();r.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this);this._draggable.disable();r.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var n=this._marker,t=n._shadow,i=r.DomUtil.getPosition(n._icon),u=n._map.layerPointToLatLng(i);t&&r.DomUtil.setPosition(t,i);n._latlng=u;n.fire("move",{latlng:u}).fire("drag")},_onDragEnd:function(n){this._marker.fire("moveend").fire("dragend",n)}});r.Control=r.Class.extend({options:{position:"topright"},initialize:function(n){r.setOptions(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var t=this._map;return t&&t.removeControl(this),this.options.position=n,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this._map=n;var t=this._container=this.onAdd(n),u=this.getPosition(),i=n._controlCorners[u];return r.DomUtil.addClass(t,"leaflet-control"),u.indexOf("bottom")!==-1?i.insertBefore(t,i.firstChild):i.appendChild(t),this},removeFrom:function(n){var t=this.getPosition(),i=n._controlCorners[t];if(i.removeChild(this._container),this._map=null,this.onRemove)this.onRemove(n);return this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}});r.control=function(n){return new r.Control(n)};r.Map.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.removeFrom(this),this},_initControlPos:function(){function n(n,f){var e=t+n+" "+t+f;i[n+f]=r.DomUtil.create("div",e,u)}var i=this._controlCorners={},t="leaflet-",u=this._controlContainer=r.DomUtil.create("div",t+"control-container",this._container);n("top","left");n("top","right");n("bottom","left");n("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}});r.Control.Zoom=r.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(n){var t="leaflet-control-zoom",i=r.DomUtil.create("div",t+" leaflet-bar");this._map=n;this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,t+"-in",i,this._zoomIn,this);this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,t+"-out",i,this._zoomOut,this);this._updateDisabled();n.on("zoomend zoomlevelschange",this._updateDisabled,this);return i},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(n){this._map.zoomIn(n.shiftKey?3:1)},_zoomOut:function(n){this._map.zoomOut(n.shiftKey?3:1)},_createButton:function(n,t,i,u,f,e){var o=r.DomUtil.create("a",i,u),s;o.innerHTML=n;o.href="#";o.title=t;s=r.DomEvent.stopPropagation;r.DomEvent.on(o,"click",s).on(o,"mousedown",s).on(o,"dblclick",s).on(o,"click",r.DomEvent.preventDefault).on(o,"click",f,e).on(o,"click",this._refocusOnMap,e);return o},_updateDisabled:function(){var n=this._map,t="leaflet-disabled";r.DomUtil.removeClass(this._zoomInButton,t);r.DomUtil.removeClass(this._zoomOutButton,t);n._zoom===n.getMinZoom()&&r.DomUtil.addClass(this._zoomOutButton,t);n._zoom===n.getMaxZoom()&&r.DomUtil.addClass(this._zoomInButton,t)}});r.Map.mergeOptions({zoomControl:!0});r.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new r.Control.Zoom,this.addControl(this.zoomControl))});r.control.zoom=function(n){return new r.Control.Zoom(n)};r.Control.Attribution=r.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet<\/a>'},initialize:function(n){r.setOptions(this,n);this._attributions={}},onAdd:function(n){this._container=r.DomUtil.create("div","leaflet-control-attribution");r.DomEvent.disableClickPropagation(this._container);for(var t in n._layers)n._layers[t].getAttribution&&this.addAttribution(n._layers[t].getAttribution());n.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this);return this._update(),this._container},onRemove:function(n){n.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){if(n)return this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this},removeAttribution:function(n){if(n)return this._attributions[n]&&(this._attributions[n]--,this._update()),this},_update:function(){var n,i,t;if(this._map){n=[];for(i in this._attributions)this._attributions[i]&&n.push(i);t=[];this.options.prefix&&t.push(this.options.prefix);n.length&&t.push(n.join(", "));this._container.innerHTML=t.join(" | ")}},_onLayerAdd:function(n){n.layer.getAttribution&&this.addAttribution(n.layer.getAttribution())},_onLayerRemove:function(n){n.layer.getAttribution&&this.removeAttribution(n.layer.getAttribution())}});r.Map.mergeOptions({attributionControl:!0});r.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new r.Control.Attribution).addTo(this))});r.control.attribution=function(n){return new r.Control.Attribution(n)};r.Control.Scale=r.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(n){this._map=n;var t="leaflet-control-scale",i=r.DomUtil.create("div",t),u=this.options;this._addScales(u,t,i);n.on(u.updateWhenIdle?"moveend":"move",this._update,this);return n.whenReady(this._update,this),i},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,t,i){n.metric&&(this._mScale=r.DomUtil.create("div",t+"-line",i));n.imperial&&(this._iScale=r.DomUtil.create("div",t+"-line",i))},_update:function(){var n=this._map.getBounds(),u=n.getCenter().lat,f=6378137*Math.PI*Math.cos(u*Math.PI/180),e=f*(n.getNorthEast().lng-n.getSouthWest().lng)/180,t=this._map.getSize(),i=this.options,r=0;t.x>0&&(r=e*(i.maxWidth/t.x));this._updateScales(i,r)},_updateScales:function(n,t){n.metric&&t&&this._updateMetric(t);n.imperial&&t&&this._updateImperial(t)},_updateMetric:function(n){var t=this._getRoundNum(n);this._mScale.style.width=this._getScaleWidth(t/n)+"px";this._mScale.innerHTML=t<1e3?t+" m":t/1e3+" km"},_updateImperial:function(n){var t=n*3.2808399,i=this._iScale,r,u,f;t>5280?(r=t/5280,u=this._getRoundNum(r),i.style.width=this._getScaleWidth(u/r)+"px",i.innerHTML=u+" mi"):(f=this._getRoundNum(t),i.style.width=this._getScaleWidth(f/t)+"px",i.innerHTML=f+" ft")},_getScaleWidth:function(n){return Math.round(this.options.maxWidth*n)-10},_getRoundNum:function(n){var i=Math.pow(10,(Math.floor(n)+"").length-1),t=n/i;return t=t>=10?10:t>=5?5:t>=3?3:t>=2?2:1,i*t}});r.control.scale=function(n){return new r.Control.Scale(n)};r.Control.Layers=r.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(n,t,i){r.setOptions(this,i);this._layers={};this._lastZIndex=0;this._handlingClick=!1;for(var u in n)this._addLayer(n[u],u);for(u in t)this._addLayer(t[u],u,!0)},onAdd:function(n){this._initLayout();this._update();n.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this);return this._container},onRemove:function(n){n.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(n,t){return this._addLayer(n,t),this._update(),this},addOverlay:function(n,t){return this._addLayer(n,t,!0),this._update(),this},removeLayer:function(n){var t=r.stamp(n);return delete this._layers[t],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",n=this._container=r.DomUtil.create("div",t),i,u;if(n.setAttribute("aria-haspopup",!0),r.Browser.touch)r.DomEvent.on(n,"click",r.DomEvent.stopPropagation);else r.DomEvent.disableClickPropagation(n).disableScrollPropagation(n);if(i=this._form=r.DomUtil.create("form",t+"-list"),this.options.collapsed){if(!r.Browser.android)r.DomEvent.on(n,"mouseover",this._expand,this).on(n,"mouseout",this._collapse,this);if(u=this._layersLink=r.DomUtil.create("a",t+"-toggle",n),u.href="#",u.title="Layers",r.Browser.touch)r.DomEvent.on(u,"click",r.DomEvent.stop).on(u,"click",this._expand,this);else r.DomEvent.on(u,"focus",this._expand,this);r.DomEvent.on(i,"click",function(){setTimeout(r.bind(this._onInputClick,this),0)},this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=r.DomUtil.create("div",t+"-base",i);this._separator=r.DomUtil.create("div",t+"-separator",i);this._overlaysList=r.DomUtil.create("div",t+"-overlays",i);n.appendChild(i)},_addLayer:function(n,t,i){var u=r.stamp(n);this._layers[u]={layer:n,name:t,overlay:i};this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="";this._overlaysList.innerHTML="";var t=!1,i=!1,r,n;for(r in this._layers)n=this._layers[r],this._addItem(n),i=i||n.overlay,t=t||!n.overlay;this._separator.style.display=i&&t?"":"none"}},_onLayerChange:function(n){var t=this._layers[r.stamp(n.layer)],i;t&&(this._handlingClick||this._update(),i=t.overlay?n.type==="layeradd"?"overlayadd":"overlayremove":n.type==="layeradd"?"baselayerchange":null,i&&this._map.fire(i,t))},_createRadioElement:function(n,i){var r='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"',u;return i&&(r+=' checked="checked"'),r+="/>",u=t.createElement("div"),u.innerHTML=r,u.firstChild},_addItem:function(n){var u=t.createElement("label"),i,e=this._map.hasLayer(n.layer),f,o;n.overlay?(i=t.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=e):i=this._createRadioElement("leaflet-base-layers",e);i.layerId=r.stamp(n.layer);r.DomEvent.on(i,"click",this._onInputClick,this);return f=t.createElement("span"),f.innerHTML=" "+n.name,u.appendChild(i),u.appendChild(f),o=n.overlay?this._overlaysList:this._baseLayersList,o.appendChild(u),u},_onInputClick:function(){var t,i,n,r=this._form.getElementsByTagName("input"),u=r.length;for(this._handlingClick=!0,t=0;t<u;t++)i=r[t],n=this._layers[i.layerId],i.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!i.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1;this._refocusOnMap()},_expand:function(){r.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}});r.control.layers=function(n,t,i){return new r.Control.Layers(n,t,i)};r.PosAnimation=r.Class.extend({includes:r.Mixin.Events,run:function(n,t,i,u){this.stop();this._el=n;this._inProgress=!0;this._newPos=t;this.fire("start");n.style[r.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(u||.5)+",1)";r.DomEvent.on(n,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this);r.DomUtil.setPosition(n,t);r.Util.falseFn(n.offsetWidth);this._stepTimer=setInterval(r.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(r.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),r.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var n=this._getPos();if(!n){this._onTransitionEnd();return}this._el._leaflet_pos=n;this.fire("step")},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var i,u,t,e=this._el,f=n.getComputedStyle(e);if(r.Browser.any3d){if(t=f[r.DomUtil.TRANSFORM].match(this._transformRe),!t)return;i=parseFloat(t[1]);u=parseFloat(t[2])}else i=parseFloat(f.left),u=parseFloat(f.top);return new r.Point(i,u,!0)},_onTransitionEnd:function(){(r.DomEvent.off(this._el,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress)&&(this._inProgress=!1,this._el.style[r.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}});r.Map.include({setView:function(n,t,u){if(t=t===i?this._zoom:this._limitZoom(t),n=this._limitCenter(r.latLng(n),t,this.options.maxBounds),u=u||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!u.reset&&u!==!0){u.animate!==i&&(u.zoom=r.extend({animate:u.animate},u.zoom),u.pan=r.extend({animate:u.animate},u.pan));var f=this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,t,u.zoom):this._tryAnimatedPan(n,u.pan);if(f)return clearTimeout(this._sizeTimer),this}return this._resetView(n,t),this},panBy:function(n,t){if(n=r.point(n).round(),t=t||{},!n.x&&!n.y)return this;if(!this._panAnim){this._panAnim=new r.PosAnimation;this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)}if(t.noMoveStart||this.fire("movestart"),t.animate!==!1){r.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(n);this._panAnim.run(this._mapPane,i,t.duration||.25,t.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){r.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(n,t){var i=this._getCenterOffset(n)._floor();return(t&&t.animate)!==!0&&!this.getSize().contains(i)?!1:(this.panBy(i,t),!0)}});r.PosAnimation=r.DomUtil.TRANSITION?r.PosAnimation:r.PosAnimation.extend({run:function(n,t,i,u){this.stop();this._el=n;this._inProgress=!0;this._duration=i||.25;this._easeOutPower=1/Math.max(u||.5,.2);this._startPos=r.DomUtil.getPosition(n);this._offset=t.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=r.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(){var n=+new Date-this._startTime,t=this._duration*1e3;n<t?this._runFrame(this._easeOut(n/t)):(this._runFrame(1),this._complete())},_runFrame:function(n){var t=this._startPos.add(this._offset.multiplyBy(n));r.DomUtil.setPosition(this._el,t);this.fire("step")},_complete:function(){r.Util.cancelAnimFrame(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}});r.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});r.DomUtil.TRANSITION&&r.Map.addInitHook(function(){if(this._zoomAnimated=this.options.zoomAnimation&&r.DomUtil.TRANSITION&&r.Browser.any3d&&!r.Browser.android23&&!r.Browser.mobileOpera,this._zoomAnimated)r.DomEvent.on(this._mapPane,r.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)});r.Map.include(r.DomUtil.TRANSITION?{_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,t,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var r=this.getZoomScale(t),u=this._getCenterOffset(n)._divideBy(1-1/r),f=this._getCenterLayerPoint()._add(u);return i.animate!==!0&&!this.getSize().contains(u)?!1:(this.fire("movestart").fire("zoomstart"),this._animateZoom(n,t,f,r,null,!0),!0)},_animateZoom:function(n,t,i,u,f,e,o){o||(this._animatingZoom=!0);r.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim");this._animateToCenter=n;this._animateToZoom=t;r.Draggable&&(r.Draggable._disabled=!0);r.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:n,zoom:t,origin:i,scale:u,delta:f,backwards:e});setTimeout(r.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,r.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),r.Draggable&&(r.Draggable._disabled=!1))}}:{});r.TileLayer.include({_animateZoom:function(n){this._animating||(this._animating=!0,this._prepareBgBuffer());var t=this._bgBuffer,i=r.DomUtil.TRANSFORM,u=n.delta?r.DomUtil.getTranslateString(n.delta):t.style[i],f=r.DomUtil.getScaleString(n.scale,n.origin);t.style[i]=n.backwards?f+" "+u:u+" "+f},_endZoomAnim:function(){var n=this._tileContainer,i=this._bgBuffer,t;n.style.visibility="";n.parentNode.appendChild(n);r.Util.falseFn(i.offsetWidth);t=this._map.getZoom();(t>this.options.maxZoom||t<this.options.minZoom)&&this._clearBgBuffer();this._animating=!1},_clearBgBuffer:function(){var n=this._map;!n||n._animatingZoom||n.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[r.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,n=this._bgBuffer,i=this._getLoadedTilesPercentage(n),u=this._getLoadedTilesPercentage(t);if(n&&i>.5&&u<.5){t.style.visibility="hidden";this._stopLoadingImages(t);return}n.style.visibility="hidden";n.style[r.DomUtil.TRANSFORM]="";this._tileContainer=n;n=this._bgBuffer=t;this._stopLoadingImages(n);clearTimeout(this._clearBgBufferTimer)},_getLoadedTilesPercentage:function(n){for(var r=n.getElementsByTagName("img"),u=0,t=0,i=r.length;t<i;t++)r[t].complete&&u++;return u/i},_stopLoadingImages:function(n){for(var u=Array.prototype.slice.call(n.getElementsByTagName("img")),t,i=0,f=u.length;i<f;i++)t=u[i],t.complete||(t.onload=r.Util.falseFn,t.onerror=r.Util.falseFn,t.src=r.Util.emptyImageUrl,t.parentNode.removeChild(t))}});r.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:Infinity,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(n){if(n=this._locateOptions=r.extend(this._defaultLocateOptions,n),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=r.bind(this._handleGeolocationResponse,this),i=r.bind(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,i,n):navigator.geolocation.getCurrentPosition(t,i,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){var t=n.code,i=n.message||(t===1?"permission denied":t===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:t,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(n){var t=n.coords.latitude,u=n.coords.longitude,o=new r.LatLng(t,u),f=180*n.coords.accuracy/40075017,s=f/Math.cos(r.LatLng.DEG_TO_RAD*t),h=r.latLngBounds([t-f,u-s],[t+f,u+s]),c=this._locateOptions,l,e,i;c.setView&&(l=Math.min(this.getBoundsZoom(h),c.maxZoom),this.setView(o,l));e={latlng:o,bounds:h,timestamp:n.timestamp};for(i in n.coords)typeof n.coords[i]=="number"&&(e[i]=n.coords[i]);this.fire("locationfound",e)}})}(window,document),function(n){var t=n.L;t.labelVersion="0.2.2-dev";t.Label=(t.Layer?t.Layer:t.Class).extend({includes:t.Mixin.Events,options:{className:"",clickable:!1,direction:"right",noHide:!1,offset:[12,-15],opacity:1,zoomAnimation:!0},initialize:function(n,i){t.setOptions(this,n);this._source=i;this._animated=t.Browser.any3d&&this.options.zoomAnimation;this._isOpen=!1},onAdd:function(n){this._map=n;this._pane=this.options.pane?n._panes[this.options.pane]:this._source instanceof t.Marker?n._panes.markerPane:n._panes.popupPane;this._container||this._initLayout();this._pane.appendChild(this._container);this._initInteraction();this._update();this.setOpacity(this.options.opacity);n.on("moveend",this._onMoveEnd,this).on("viewreset",this._onViewReset,this);if(this._animated)n.on("zoomanim",this._zoomAnimation,this);if(t.Browser.touch&&!this.options.noHide){t.DomEvent.on(this._container,"click",this.close,this);n.on("click",this.close,this)}},onRemove:function(n){this._pane.removeChild(this._container);n.off({zoomanim:this._zoomAnimation,moveend:this._onMoveEnd,viewreset:this._onViewReset},this);this._removeInteraction();this._map=null},setLatLng:function(n){return this._latlng=t.latLng(n),this._map&&this._updatePosition(),this},setContent:function(n){return this._previousContent=this._content,this._content=n,this._updateContent(),this},close:function(){var n=this._map;n&&(t.Browser.touch&&!this.options.noHide&&(t.DomEvent.off(this._container,"click",this.close),n.off("click",this.close,this)),n.removeLayer(this))},updateZIndex:function(n){this._zIndex=n;this._container&&this._zIndex&&(this._container.style.zIndex=n)},setOpacity:function(n){this.options.opacity=n;this._container&&t.DomUtil.setOpacity(this._container,n)},_initLayout:function(){this._container=t.DomUtil.create("div","leaflet-label "+this.options.className+" leaflet-zoom-animated");this.updateZIndex(this._zIndex)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updatePosition(),this._container.style.visibility="")},_updateContent:function(){this._content&&this._map&&this._prevContent!==this._content&&typeof this._content=="string"&&(this._container.innerHTML=this._content,this._prevContent=this._content,this._labelWidth=this._container.offsetWidth)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},_setPosition:function(n){var r=this._map,i=this._container,e=r.latLngToContainerPoint(r.getCenter()),o=r.layerPointToContainerPoint(n),f=this.options.direction,s=this._labelWidth,u=t.point(this.options.offset);f==="right"||f==="auto"&&o.x<e.x?(t.DomUtil.addClass(i,"leaflet-label-right"),t.DomUtil.removeClass(i,"leaflet-label-left"),n=n.add(u)):(t.DomUtil.addClass(i,"leaflet-label-left"),t.DomUtil.removeClass(i,"leaflet-label-right"),n=n.add(t.point(-u.x-s,u.y)));t.DomUtil.setPosition(i,n)},_zoomAnimation:function(n){var t=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPosition(t)},_onMoveEnd:function(){this._animated&&this.options.direction!=="auto"||this._updatePosition()},_onViewReset:function(n){n&&n.hard&&this._update()},_initInteraction:function(){var n,r,i;if(this.options.clickable){n=this._container;r=["dblclick","mousedown","mouseover","mouseout","contextmenu"];t.DomUtil.addClass(n,"leaflet-clickable");t.DomEvent.on(n,"click",this._onMouseClick,this);for(i=0;i<r.length;i++)t.DomEvent.on(n,r[i],this._fireMouseEvent,this)}},_removeInteraction:function(){var n,r,i;if(this.options.clickable)for(n=this._container,r=["dblclick","mousedown","mouseover","mouseout","contextmenu"],t.DomUtil.removeClass(n,"leaflet-clickable"),t.DomEvent.off(n,"click",this._onMouseClick,this),i=0;i<r.length;i++)t.DomEvent.off(n,r[i],this._fireMouseEvent,this)},_onMouseClick:function(n){this.hasEventListeners(n.type)&&t.DomEvent.stopPropagation(n);this.fire(n.type,{originalEvent:n})},_fireMouseEvent:function(n){this.fire(n.type,{originalEvent:n});n.type==="contextmenu"&&this.hasEventListeners(n.type)&&t.DomEvent.preventDefault(n);n.type!=="mousedown"?t.DomEvent.stopPropagation(n):t.DomEvent.preventDefault(n)}});t.BaseMarkerMethods={showLabel:function(){return this.label&&this._map&&(this.label.setLatLng(this._latlng),this._map.showLabel(this.label)),this},hideLabel:function(){return this.label&&this.label.close(),this},setLabelNoHide:function(n){this._labelNoHide!==n&&(this._labelNoHide=n,n?(this._removeLabelRevealHandlers(),this.showLabel()):(this._addLabelRevealHandlers(),this.hideLabel()))},bindLabel:function(n,i){var u=this.options.icon?this.options.icon.options.labelAnchor:this.options.labelAnchor,r=t.point(u)||t.point(0,0);if(r=r.add(t.Label.prototype.options.offset),i&&i.offset&&(r=r.add(i.offset)),i=t.Util.extend({offset:r},i),this._labelNoHide=i.noHide,!this.label){this._labelNoHide||this._addLabelRevealHandlers();this.on("remove",this.hideLabel,this).on("move",this._moveLabel,this).on("add",this._onMarkerAdd,this);this._hasLabelHandlers=!0}return this.label=new t.Label(i,this).setContent(n),this},unbindLabel:function(){return this.label&&(this.hideLabel(),this.label=null,this._hasLabelHandlers&&(this._labelNoHide||this._removeLabelRevealHandlers(),this.off("remove",this.hideLabel,this).off("move",this._moveLabel,this).off("add",this._onMarkerAdd,this)),this._hasLabelHandlers=!1),this},updateLabelContent:function(n){this.label&&this.label.setContent(n)},getLabel:function(){return this.label},_onMarkerAdd:function(){this._labelNoHide&&this.showLabel()},_addLabelRevealHandlers:function(){this.on("mouseover",this.showLabel,this).on("mouseout",this.hideLabel,this);if(t.Browser.touch)this.on("click",this.showLabel,this)},_removeLabelRevealHandlers:function(){this.off("mouseover",this.showLabel,this).off("mouseout",this.hideLabel,this);t.Browser.touch&&this.off("click",this.showLabel,this)},_moveLabel:function(n){this.label.setLatLng(n.latlng)}};t.Icon.Default.mergeOptions({labelAnchor:new t.Point(9,-20)});t.Marker.mergeOptions({icon:new t.Icon.Default});t.Marker.include(t.BaseMarkerMethods);t.Marker.include({_originalUpdateZIndex:t.Marker.prototype._updateZIndex,_updateZIndex:function(n){var t=this._zIndex+n;this._originalUpdateZIndex(n);this.label&&this.label.updateZIndex(t)},_originalSetOpacity:t.Marker.prototype.setOpacity,setOpacity:function(n,t){this.options.labelHasSemiTransparency=t;this._originalSetOpacity(n)},_originalUpdateOpacity:t.Marker.prototype._updateOpacity,_updateOpacity:function(){var n=this.options.opacity===0?0:1;this._originalUpdateOpacity();this.label&&this.label.setOpacity(this.options.labelHasSemiTransparency?this.options.opacity:n)},_originalSetLatLng:t.Marker.prototype.setLatLng,setLatLng:function(n){return this.label&&!this._labelNoHide&&this.hideLabel(),this._originalSetLatLng(n)}});t.CircleMarker.mergeOptions({labelAnchor:new t.Point(0,0)});t.CircleMarker.include(t.BaseMarkerMethods);t.Path.include({bindLabel:function(n,i){if(this.label&&this.label.options===i||(this.label=new t.Label(i,this)),this.label.setContent(n),!this._showLabelAdded){this.on("mouseover",this._showLabel,this).on("mousemove",this._moveLabel,this).on("mouseout remove",this._hideLabel,this);if(t.Browser.touch)this.on("click",this._showLabel,this);this._showLabelAdded=!0}return this},unbindLabel:function(){return this.label&&(this._hideLabel(),this.label=null,this._showLabelAdded=!1,this.off("mouseover",this._showLabel,this).off("mousemove",this._moveLabel,this).off("mouseout remove",this._hideLabel,this)),this},updateLabelContent:function(n){this.label&&this.label.setContent(n)},_showLabel:function(n){this.label.setLatLng(n.latlng);this._map.showLabel(this.label)},_moveLabel:function(n){this.label.setLatLng(n.latlng)},_hideLabel:function(){this.label.close()}});t.Map.include({showLabel:function(n){return this.addLayer(n)}});t.FeatureGroup.include({clearLayers:function(){return this.unbindLabel(),this.eachLayer(this.removeLayer,this),this},bindLabel:function(n,t){return this.invoke("bindLabel",n,t)},unbindLabel:function(){return this.invoke("unbindLabel")},updateLabelContent:function(n){this.invoke("updateLabelContent",n)}})}(window,document);var htmlEncode=function(n){return n=n.replace(/&/g,"&amp;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/</g,"&lt;"),n=n.replace(/"/g,"&quot;"),n.replace(/'/g,"&#039;")},fileNameEncode=function(n){return n=n.replace(/ /g,""),n=n.replace(/#/g,""),n=n.replace(/&/g,""),n=n.replace(/>/g,""),n=n.replace(/</g,""),n=n.replace(/"/g,""),n.replace(/'/g,"")},htmlDecode=function(n){return n.replace(/\n/g,"<br />")};replaceAt=function(n,t,i){return n.substr(0,t)+i+n.substr(t+i.length)};$(document).ready(function(){var n=window.location;console.log(n.origin+window.location.pathname);FoodParent.Setting.setBaseUrl(n.origin+window.location.pathname);Backbone.history.start()}),function(n){var t=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use Setting.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.getIsMobile=function(){var i=n._instance,t=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(t=!0),t},n.setBaseUrl=function(t){return n._instance._baseUrl=t},n.getBaseUrl=function(){return n._instance._baseUrl},n.getPhpDir=function(){return n._instance._baseUrl+"core/php/"},n.getContentPictureDir=function(){return n._instance._baseUrl+"content/picture/"},n.getContentIconDir=function(){return n._instance._baseUrl+"content/icon/"},n.getCoreImageDir=function(){return n._instance._baseUrl+"core/image/"},n.getMarkerShadowPath=function(){return n.getCoreImageDir()+"marker-shadow.png"},n.getBlankImagePath=function(){return n.getCoreImageDir()+"picture-blank.jpg"},n.getFileUploadPath=function(){return n.getPhpDir()+"upload.php"},n.getRelativeFileUploadPath=function(){return"../../content/picture/"},n.getNavWrapperElement=function(){return $("#wrapper-nav")},n.getMainWrapperElement=function(){return $("#wrapper-main")},n.getPopWrapperElement=function(){return $("#wrapper-pop")},n.getMessageWrapperElement=function(){return $("#wrapper-message")},n.getNavAnimDuration=function(){return 100},n.getFilterAnimDuration=function(){return 250},n.getRemovePopupDuration=function(){return 100},n.getDefaultMapZoomLevel=function(){return 12},n.getTileMapAddress=function(){return"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png"},n.getReverseGeoCodingAddress=function(n){return"http://nominatim.openstreetmap.org/reverse?format=json&lat="+n.lat+"&lon="+n.lng+"&zoom=18&addressdetails=1"},n.getMapMinZoomLevel=function(){return 5},n.getMapMaxZoomLevel=function(){return 19},n.getMapCenterZoomLevel=function(){return 15},n.getDateForDatePicker=function(){return"YYYY/MM/DD"},n.getDateFormat=function(){return"DD MMM YYYY"},n.getDateFormat2=function(){return"Do MMM YYYY"},n.getDateTimeFormat=function(){return"YYYY-MM-DD HH:mm:ss"},n.getDateHourFormat=function(){return"ha ddd Do MMM YYYY"},n.getDevContact=function(){return"captainwhale52@gmail.com"},n.getManagerContact=function(){return"captainwhale52@gmail.com"},n.getNumRecentActivitiesShown=function(){return 5},n.getLargeNumRecentActivitiesShown=function(){return 10},n.getNoDataText=function(){return"No Data"},n.getMaxRating=function(){return 10},n.getResizeTimeout=function(){return 50},n.getLogoSplashDefaultImage=function(){return n.getCoreImageDir()+"logo-splash-default.png"},n.getLogoSplashMouseOverImage=function(){return n.getCoreImageDir()+"logo-splash-mouseover.png"},n.getApplicationDescription=function(){return"Manage, parent, and care food assets"},n.getErrorMessage=function(n){switch(parseInt(n)){case 400:return"No error occured.";case 404:return"Server connection error occured.";case 604:return"Please enter your <strong>first and last name<\/strong>.";case 605:return"Please enter a <strong>name of location<\/strong> near you live.";case 803:return"Please put a <strong>valid e-mail address<\/strong>.";case 804:return"The <strong>e-mail address<\/strong> that you entered <strong>already exists<\/strong>.<br>Please selecting <strong>'PARENT IN'<\/strong> menu to sign in.";case 805:return"You have entered an <strong>incorrect username or password<\/strong>.";case 901:return"You need to sign in first by selecting <strong>'PARENT IN'<\/strong> menu.";case 902:return"You need to sign in as <strong>admin<\/strong> to perform this action."}return""},n._instance=new n,n}();n.Setting=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var i=function(){function t(){if(this.bDebug=!0,t._instance)throw new Error("Error: Instantiation failed: Use Controller.getInstance() instead of new.");t._instance=this;t._instance.xhrPool=[]}return t.getInstance=function(){return t._instance},t.pushXHR=function(n){var i=t._instance;i.xhrPool.push(n)},t.removeXHR=function(n){var i=t._instance,r=i.xhrPool.indexOf(n);r>-1&&i.xhrPool.splice(r,1)},t.abortAllXHR=function(){var n=t._instance;$.each(n.xhrPool,function(n,t){t!=undefined&&t.abort()});n.xhrPool=[]},t.updateGeoLocation=function(n,t){navigator.geolocation&&navigator.geolocation.getCurrentPosition(n,t)},t.fetchAllTrees=function(i,r){var u=n.Model.fetchAllFoods(),f=n.Model.fetchAllTrees(),e=n.Model.fetchAllAdopts(),o=n.Model.fetchAllPersons(),s=n.Model.fetchAllFlags(),h=n.Model.fetchAllOwnerships();t.pushXHR(u);t.pushXHR(f);t.pushXHR(e);t.pushXHR(o);t.pushXHR(s);t.pushXHR(h);$.when(u,f,e,o).then(function(){t.removeXHR(u);t.removeXHR(f);t.removeXHR(e);t.removeXHR(o);t.removeXHR(s);t.removeXHR(h);n.Model.getTrees().updateParents();i&&i()},function(){t.removeXHR(u);t.removeXHR(f);t.removeXHR(e);t.removeXHR(o);t.removeXHR(s);t.removeXHR(h);r&&r(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchAllFlagsAndOwners=function(i,r){var u=n.Model.fetchAllFlags(),f=n.Model.fetchAllOwnerships();t.pushXHR(u);t.pushXHR(f);$.when(u,f).then(function(){t.removeXHR(u);t.removeXHR(f);i&&i()},function(){t.removeXHR(u);t.removeXHR(f);r&&r(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchAllPersonsAndAuthsAndFoodAndTreesAndAdopts=function(i,r){var u=n.Model.fetchAllAuths(),f=n.Model.fetchAllPersons(),e=n.Model.fetchAllAdopts(),o=n.Model.fetchAllTrees(),s=n.Model.fetchAllFoods();t.pushXHR(u);t.pushXHR(f);t.pushXHR(e);t.pushXHR(o);t.pushXHR(s);$.when(u,f,e,o,s).then(function(){t.removeXHR(u);t.removeXHR(f);t.removeXHR(e);t.removeXHR(o);t.removeXHR(s);n.Model.getPersons().updateTrees();i&&i()},function(){t.removeXHR(u);t.removeXHR(f);t.removeXHR(e);t.removeXHR(o);t.removeXHR(s);r&&r(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchAllPersons=function(i,r){var u=n.Model.fetchAllPersons();t.pushXHR(u);$.when(u).then(function(){t.removeXHR(u);i&&i()},function(){t.removeXHR(u);r&&r(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchAllFoods=function(i,r){var u=n.Model.fetchAllFoods();t.pushXHR(u);$.when(u).then(function(){t.removeXHR(u);i&&i()},function(){t.removeXHR(u);r&&r(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchCommentsOfTreesDuringPeriod=function(i,r,u,f,e,o,s){var c=[],h;$.each(i,function(n,t){c.push(t.getId())});h=n.Model.fetchCommentsOfTreesDuringPeriod(c,r,u,f,e);t.pushXHR(h);$.when(h).then(function(){t.removeXHR(h);o&&o()},function(){t.removeXHR(h);s&&s(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchLatestCommentOfTrees=function(i,r,u){var e=[],f;$.each(i,function(n,t){e.push(t.getId())});f=n.Model.fetchLatestCommentOfTrees(e);t.pushXHR(f);$.when(f).then(function(){t.removeXHR(f);r&&r()},function(){t.removeXHR(f);u&&u(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchNotesOfTrees=function(i,r,u,f,e,o){var h=[],s;$.each(i,function(n,t){h.push(t.getId())});s=n.Model.fetchNotesOfTrees(h,r,u,f);t.pushXHR(s);$.when(s).then(function(){t.removeXHR(s);e&&e()},function(){t.removeXHR(s);o&&o(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.uploadNotePictureFile=function(i,r,u,f){var o=new FormData,e;o.append("filename",i);e=$.ajax({url:n.Setting.getFileUploadPath()+"?foodname="+htmlEncode(r)+"&files",type:"POST",data:o,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(i){t.removeXHR(e);typeof i.error=="undefined"?u&&u(i.files[0].replace(n.Setting.getRelativeFileUploadPath(),"")):f&&f()},error:function(){t.removeXHR(e);f&&f()}});t.pushXHR(e)},t.fetchAllLocations=function(i,r){var u=n.Model.fetchAllPlaces(),f=n.Model.fetchAllTrees(),e=n.Model.fetchAllFoods();$.when(u,f,e).then(function(){t.removeXHR(u);t.removeXHR(f);t.removeXHR(e);i&&i()},function(){t.removeXHR(u);t.removeXHR(f);t.removeXHR(e);r&&r(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchDonationsOfPlaces=function(i,r,u,f,e){var s=[],o;$.each(i,function(n,t){s.push(t.getId())});o=n.Model.fetchDonationsOfPlaces(s,r,u);t.pushXHR(o);$.when(o).then(function(){t.removeXHR(o);f&&f()},function(){t.removeXHR(o);e&&e(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.fetchDonationsOfPlacesDuringPeriod=function(i,r,u,f,e,o,s){var c=[],h;$.each(i,function(n,t){c.push(t.getId())});h=n.Model.fetchDonationsOfPlacesDuringPeriod(c,r,u,f,e);t.pushXHR(h);$.when(h).then(function(){t.removeXHR(h);o&&o()},function(){t.removeXHR(h);s&&s(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.checkIsAdmin=function(i,r,u){var f=$.ajax({url:n.Setting.getPhpDir()+"admincheck.php",type:"POST",data:{},cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(n){t.removeXHR(f);parseInt(n.code)==400?i&&i(n):r&&r(n)},error:function(n){t.removeXHR(f);u&&u(n)}});t.pushXHR(f)},t.checkIsLoggedIn=function(i,r,u){var f=$.ajax({url:n.Setting.getPhpDir()+"logincheck.php",type:"POST",data:{},cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(n){t.removeXHR(f);parseInt(n.code)==400?i&&i(n):r&&r(n)},error:function(n){t.removeXHR(f);u&&u(n)}});t.pushXHR(f)},t.checkLogin=function(i,r){var u=$.ajax({url:n.Setting.getPhpDir()+"logincheck.php",type:"POST",data:{},cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(n){t.removeXHR(u);typeof n.error=="undefined"?i&&i(n):r&&r(n)},error:function(n){t.removeXHR(u);r&&r(n)}});t.pushXHR(u)},t.checkAdmin=function(i,r){var u=$.ajax({url:n.Setting.getPhpDir()+"admincheck.php",type:"POST",data:{},cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(n){t.removeXHR(u);typeof n.error=="undefined"?i&&i(n):r&&r()},error:function(){t.removeXHR(u);r&&r()}});t.pushXHR(u)},t.processLogin=function(i,r,u,f,e){var o=$.ajax({url:n.Setting.getPhpDir()+"login.php",type:"POST",data:{contact:i,p:r},cache:!1,dataType:"json",success:function(n){t.removeXHR(o);parseInt(n.code)==400?u&&u(n):f&&f(n)},error:function(n){t.removeXHR(o);e&&e(n)}});t.pushXHR(o)},t.processLogout=function(i,r){var u=$.ajax({url:n.Setting.getPhpDir()+"logout.php",type:"POST",data:{},cache:!1,dataType:"json",success:function(n){t.removeXHR(u);parseInt(n.code)==400?i&&i(n):r&&r(n)},error:function(n){t.removeXHR(u);r&&r(n)}});t.pushXHR(u)},t.processSignup=function(i,r,u,f,e){var o=$.ajax({url:n.Setting.getPhpDir()+"signup.php",type:"POST",data:{contact:i,name:r,neighborhood:u},cache:!1,dataType:"json",success:function(n){t.removeXHR(o);console.log(n);typeof n.error=="undefined"?f&&f(n):e&&e(n)},error:function(n){t.removeXHR(o);e&&e(n)}});t.pushXHR(o)},t.changePassword=function(i,r,u,f){var e=$.ajax({url:n.Setting.getPhpDir()+"password.php",type:"POST",data:{id:i,password:r},cache:!1,dataType:"json",success:function(n){t.removeXHR(e);console.log(n);typeof n.error=="undefined"?u&&u(n):f&&f(n)},error:function(n){t.removeXHR(e);f&&f(n)}});t.pushXHR(e)},t._instance=new t,t.TAG="Controller - ",t}(),t;n.Controller=i;t=function(t){function i(n){if(i._instance)throw new Error("Error: Instantiation failed: Use Router.getInstance() instead of new.");i._instance=this;this.routes={"":"home","trees/:id":"trees","tree/:id":"tree","mpeople/:id":"managePeople","mdonations/:id":"manageDonations","mdonation/:id":"manageDonation"};t.call(this,n)}return __extends(i,t),i.getInstance=function(){return i._instance},i.prototype.home=function(){n.EventHandler.handleNavigate(n.VIEW_STATUS.HOME)},i.prototype.trees=function(t){n.EventHandler.handleNavigate(n.VIEW_STATUS.TREES,{id:t})},i.prototype.tree=function(t){n.EventHandler.handleNavigate(n.VIEW_STATUS.TREE,{id:t})},i.prototype.managePeople=function(t){n.EventHandler.handleNavigate(n.VIEW_STATUS.MANAGE_PEOPLE,{id:t})},i.prototype.manageDonations=function(t){n.EventHandler.handleNavigate(n.VIEW_STATUS.MANAGE_DONATIONS,{id:t})},i.prototype.manageDonation=function(t){n.EventHandler.handleNavigate(n.VIEW_STATUS.DETAIL_DONATION,{id:t})},i._instance=new i,i.TAG="Router - ",i}(Backbone.Router);n.Router=t}(FoodParent||(FoodParent={})),function(n){var t,i,u,r,f;(function(n){n[n.NONE=0]="NONE";n[n.CREATE=1]="CREATE";n[n.DELETE=2]="DELETE";n[n.UPDATE_LOCATION=3]="UPDATE_LOCATION";n[n.UPDATE_FLAG=4]="UPDATE_FLAG";n[n.UPDATE_OWNERSHIP=5]="UPDATE_OWNERSHIP";n[n.UPDATE_FOODTYPE=6]="UPDATE_FOODTYPE";n[n.UPDATE_DESCRIPTION=7]="UPDATE_DESCRIPTION";n[n.UPDATE_NAME=8]="UPDATE_NAME";n[n.UPDATE_ADDRESS=9]="UPDATE_ADDRESS";n[n.UPDATE_CONTACT=10]="UPDATE_CONTACT";n[n.UPDATE_NEIGHBORHOOD=11]="UPDATE_NEIGHBORHOOD";n[n.UPDATE_AUTH=12]="UPDATE_AUTH";n[n.UPDATE_COMMENT=13]="UPDATE_COMMENT";n[n.UPDATE_RATING=14]="UPDATE_RATING";n[n.UPDATE_COVER=15]="UPDATE_COVER";n[n.UPDATE_DATE=16]="UPDATE_DATE";n[n.ADD_PICTURE=17]="ADD_PICTURE";n[n.ADD_DONATION_TREE=18]="ADD_DONATION_TREE";n[n.REMOVE_DONATION_TREE=19]="REMOVE_DONATION_TREE";n[n.UPDATE_DONATION_AMOUNT=20]="UPDATE_DONATION_AMOUNT"})(n.DATA_MODE||(n.DATA_MODE={}));t=n.DATA_MODE,function(n){n[n.NONE=0]="NONE";n[n.HOME=1]="HOME";n[n.CONFIRM=2]="CONFIRM";n[n.TREES=3]="TREES";n[n.TREES_TABLE=4]="TREES_TABLE";n[n.TREE=5]="TREE";n[n.PARENT_TREES=6]="PARENT_TREES";n[n.GEO_ERROR=7]="GEO_ERROR";n[n.NETWORK_ERROR=8]="NETWORK_ERROR";n[n.MANAGE_PEOPLE=9]="MANAGE_PEOPLE";n[n.MANAGE_ADOPTION=10]="MANAGE_ADOPTION";n[n.IMAGENOTE_TREE=11]="IMAGENOTE_TREE";n[n.POST_NOTE=12]="POST_NOTE";n[n.MANAGE_DONATIONS=13]="MANAGE_DONATIONS";n[n.ADD_DONATION=14]="ADD_DONATION";n[n.DETAIL_DONATION=15]="DETAIL_DONATION";n[n.EDIT_DONATION=16]="EDIT_DONATION";n[n.LOGIN=17]="LOGIN";n[n.SERVER_RESPONSE_ERROR=18]="SERVER_RESPONSE_ERROR";n[n.SIGNUP=19]="SIGNUP";n[n.ADOPT_TREE=20]="ADOPT_TREE";n[n.UNADOPT_TREE=21]="UNADOPT_TREE";n[n.CHANGE_PASSWORD=22]="CHANGE_PASSWORD"}(n.VIEW_STATUS||(n.VIEW_STATUS={}));i=n.VIEW_STATUS,function(n){n[n.NONE=0]="NONE";n[n.GUEST=1]="GUEST";n[n.PARENT=2]="PARENT";n[n.ADMIN=3]="ADMIN"}(n.CREDENTIAL_MODE||(n.CREDENTIAL_MODE={}));u=n.CREDENTIAL_MODE,function(n){n[n.NONE=0]="NONE";n[n.GEO_PERMISSION_ERROR=1]="GEO_PERMISSION_ERROR";n[n.SEVER_CONNECTION_ERROR=2]="SEVER_CONNECTION_ERROR";n[n.SEVER_RESPONSE_ERROR=3]="SEVER_RESPONSE_ERROR"}(n.ERROR_MODE||(n.ERROR_MODE={}));r=n.ERROR_MODE;f=function(){function f(){if(this.bDebug=!0,f._instance)throw new Error("Error: Instantiation failed: Use EventHandler.getInstance() instead of new.");f._instance=this}return f.getInstance=function(){return f._instance},f.undoLastCommand=function(){var n=f._instance;n._lastCommand&&(n._lastCommand.undo(),n._lastCommand=null)},f.handleKeyCode=function(t){var r=f._instance;switch(n.View.getViewStatus()){case i.TREES:switch(t){}}},f.handleNavigate=function(t,r){var e=f._instance;n.Controller.abortAllXHR();Pace.restart();new n.RemoveChildViewCommand({parent:n.View}).execute();new n.RenderNavViewCommand({el:n.Setting.getNavWrapperElement(),viewStatus:t}).execute();switch(t){case i.HOME:new n.RenderHomeViewCommand({el:n.Setting.getMainWrapperElement()}).execute();break;case i.TREES:n.Controller.checkIsLoggedIn(function(){n.Controller.checkIsAdmin(function(){e.bDebug&&console.log(f.TAG+"Logged in as admin");new n.RenderTreesViewCommand({el:n.Setting.getMainWrapperElement(),id:r.id,credential:u.ADMIN}).execute()},function(){e.bDebug&&console.log(f.TAG+"Logged in as parent");new n.RenderTreesViewCommand({el:n.Setting.getMainWrapperElement(),id:r.id,credential:u.PARENT}).execute()},function(){e.bDebug&&console.log(f.TAG+"Error occured")})},function(){e.bDebug&&console.log(f.TAG+"Not logged in");new n.RenderTreesViewCommand({el:n.Setting.getMainWrapperElement(),id:r.id,credential:u.GUEST}).execute()},function(){e.bDebug&&console.log(f.TAG+"Error occured")});break;case i.TREE:new n.RenderTreeViewCommand({el:n.Setting.getMainWrapperElement(),viewMode:r.viewMode,id:r.id}).execute()}n.View.setViewStatus(t)},f.handleMouseClick=function(u,e,o){var h=f._instance,s;u.hasClass("undo")&&f.undoLastCommand();n.View.getMessageView()&&n.View.getMessageView().setInvisible();e instanceof n.NavView&&(u.hasClass("evt-title")?((new n.ResetPopupViewCommand).execute(),new n.NavigateCommand({hash:"trees",id:0}).execute(),Backbone.history.loadUrl(Backbone.history.fragment)):u.hasClass("evt-trees")?n.View.getViewStatus()!=i.TREES&&((new n.ResetPopupViewCommand).execute(),new n.NavigateCommand({hash:"trees",id:0}).execute(),(new n.RefreshCurrentViewCommand).execute()):u.hasClass("people")?n.Controller.checkAdmin(function(t){t.result==!0||t.result=="true"?new n.NavigateCommand({hash:"mpeople",id:0}).execute():(t.result==!1||t.result=="false")&&new n.NavigateCommand({hash:"mtrees",id:0}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)}):u.hasClass("donations")?n.Controller.checkAdmin(function(t){t.result==!0||t.result=="true"?new n.NavigateCommand({hash:"mdonations",id:0}).execute():(t.result==!1||t.result=="false")&&new n.NavigateCommand({hash:"mtrees",id:0}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)}):u.hasClass("evt-login")?n.View.getViewStatus()!=i.LOGIN&&n.Controller.checkIsLoggedIn(function(){n.Controller.checkIsAdmin(function(){new n.RenderAccountViewCommand({el:n.Setting.getPopWrapperElement()}).execute()},function(){new n.RenderAccountViewCommand({el:n.Setting.getPopWrapperElement()}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)})},function(){new n.RenderLogInViewCommand({el:n.Setting.getPopWrapperElement()}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)}):u.hasClass("evt-logout")||u.hasClass("signup")&&n.View.getViewStatus()!=i.SIGNUP&&new n.RenderSignUpViewCommand({el:n.Setting.getPopWrapperElement()}).execute());switch(n.View.getViewStatus()){case i.HOME:u.hasClass("button-logo")&&new n.NavigateCommand({hash:"trees",id:0}).execute();break;case i.GEO_ERROR:case i.NETWORK_ERROR:u.hasClass("alert-confirm")&&new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute();break;case i.CONFIRM:(u.hasClass("evt-close")||u.hasClass("evt-submit"))&&(new n.RemovePopupViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),(new n.RefreshCurrentViewCommand).execute());break;case i.TREES:u.hasClass("marker-control-adoption")||u.hasClass("button-manage-adoption")?new n.RenderManageAdoptionViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree}).execute():u.hasClass("marker-control-info")||u.hasClass("button-tree-detail")?new n.NavigateCommand({hash:"mtree",id:o.tree}).execute():u.hasClass("marker-control-delete")?(s=n.Model.getTrees().findWhere({id:o.marker.options.id}),e.deleteTree(s)):u.hasClass("switch-table")?new n.NavigateCommand({hash:"mtrees",id:0}).execute():u.hasClass("switch-map")?new n.NavigateCommand({hash:"mtrees",id:0}).execute():u.hasClass("mapview-item")?new n.NavigateCommand({hash:"mtrees",id:o.id}).execute():u.hasClass("evt-manage-adopt")?new n.RenderManageAdoptionViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree}).execute():u.hasClass("evt-tree-table")?new n.RenderTreesTableViewCommand({el:n.Setting.getPopWrapperElement()}).execute():u.hasClass("tree-detail")?new n.NavigateCommand({hash:"mtree",id:o.tree}).execute():u.hasClass("evt-adopt")?n.Controller.checkIsLoggedIn(function(){new n.RenderAdoptTreeViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree}).execute()},function(t){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)}):u.hasClass("evt-unadopt")?n.Controller.checkIsLoggedIn(function(){new n.RenderUnadoptTreeViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree}).execute()},function(t){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)}):u.hasClass("evt-location")?(new n.UpdateCurrentPositionCommand).execute():u.hasClass("button-new-note")?(s=n.Model.getTrees().findWhere({id:parseInt(o.tree)}),new n.RenderPostNoteViewCommand({el:n.Setting.getPopWrapperElement(),tree:s}).execute()):u.hasClass("evt-add-tree")?(s=o.tree,f.handleTreeData(s,t.CREATE,{},function(){var t=n.Model.getFoods().findWhere({id:s.getFoodId()});(new n.RefreshCurrentViewCommand).execute();n.Router.getInstance().navigate("trees/"+s.getId(),{trigger:!0,replace:!0});f.handleDataChange("<strong><i>"+t.getName()+" "+s.getName()+"<\/i><\/strong> has been created successfully.",!0)},function(){f.handleError(r.SEVER_CONNECTION_ERROR)},function(){var t=n.Model.getFoods().findWhere({id:s.getFoodId()});f.handleDataChange("<strong><i>"+t.getName()+" "+s.getName()+"<\/i><\/strong> has been deleted successfully.",!1);(new n.RefreshCurrentViewCommand).execute()})):u.hasClass("evt-tree-remove")?(s=n.Model.getTrees().findWhere({id:o.marker.options.id}),f.handleTreeData(s,t.DELETE,{},function(){var t=n.Model.getFoods().findWhere({id:s.getFoodId()});(new n.RefreshCurrentViewCommand).execute();f.handleDataChange("<strong><i>"+t.getName()+" "+s.getName()+"<\/i><\/strong> has deleted successfully.",!1)},function(){f.handleError(r.SEVER_CONNECTION_ERROR)})):u.hasClass("evt-detail")&&new n.NavigateCommand({hash:"tree",id:o.tree}).execute();break;case i.TREES_TABLE:u.hasClass("evt-close")?(new n.RemovePopupViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),(new n.RefreshCurrentViewCommand).execute()):u.hasClass("evt-manage-adopt")&&new n.RenderManageAdoptionViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree}).execute();break;case i.MANAGE_ADOPTION:u.hasClass("evt-close")&&(new n.RemovePopupViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),(new n.RefreshCurrentViewCommand).execute());break;case i.TREE:u.hasClass("content-chart")?o.note&&new n.RenderImageNoteViewCommand({el:n.Setting.getPopWrapperElement(),note:o.note}).execute():u.hasClass("button-manage-adoption")?new n.RenderManageAdoptionViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree.getId()}).execute():u.hasClass("button-new-note")?new n.RenderPostNoteViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree}).execute():u.hasClass("button-back-map")?Backbone.history.history.back():u.hasClass("button-tree-adopt")?n.Controller.checkLogin(function(t){t.result==!0||t.result=="true"?new n.RenderAdoptTreeViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree.getId()}).execute():new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)}):u.hasClass("button-tree-unadopt")&&n.Controller.checkLogin(function(t){t.result==!0||t.result=="true"?new n.RenderUnadoptTreeViewCommand({el:n.Setting.getPopWrapperElement(),tree:o.tree.getId()}).execute():new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)});break;case i.IMAGENOTE_TREE:u.hasClass("button-close")&&(new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),n.View.getDetailTreeView()&&n.View.getDetailTreeView().refreshTreeInfo());break;case i.POST_NOTE:u.hasClass("button-close")&&(new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),n.View.getDetailTreeView()&&n.View.getDetailTreeView().refreshTreeInfo());break;case i.MANAGE_DONATIONS:u.hasClass("manage-donation-item")?o.place!=undefined&&new n.RenderAddDonationViewCommand({el:n.Setting.getPopWrapperElement(),place:o.place}).execute():u.hasClass("location-detail")&&new n.NavigateCommand({hash:"mdonation",id:o.place.getId()}).execute();break;case i.ADD_DONATION:u.hasClass("button-submit-donation")||u.hasClass("button-close")&&(new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),n.View.getDetailDonationView()&&n.View.getDetailDonationView().refreshDonationInfo());break;case i.DETAIL_DONATION:u.hasClass("content-chart")?o.donation&&new n.RenderEditDonationViewCommand({el:n.Setting.getPopWrapperElement(),donation:o.donation}).execute():u.hasClass("button-new-donation")&&o.place&&new n.RenderAddDonationViewCommand({el:n.Setting.getPopWrapperElement(),place:o.place}).execute();break;case i.EDIT_DONATION:u.hasClass("button-close")?(new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),n.View.getDetailDonationView()&&n.View.getDetailDonationView().refreshDonationInfo()):u.hasClass("delete-donation");break;case i.LOGIN:u.hasClass("evt-close")?(new n.RemovePopupViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),(new n.RefreshCurrentViewCommand).execute()):u.hasClass("evt-submit")?o.contact!=undefined&&o.password!=undefined&&n.Controller.processLogin(o.contact,o.password,function(){(new n.ResetPopupViewCommand).execute();Backbone.history.loadUrl(Backbone.history.fragment)},function(t){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)}):u.hasClass("evt-logout")&&n.Controller.processLogout(function(){(new n.ResetPopupViewCommand).execute();Backbone.history.loadUrl(Backbone.history.fragment)},function(){f.handleError(r.SEVER_CONNECTION_ERROR)});break;case i.SIGNUP:(u.hasClass("signup-cancel")||u.hasClass("button-close"))&&new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute();break;case i.ADOPT_TREE:u.hasClass("evt-close")?new n.RemovePopupViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute():u.hasClass("evt-submit")&&o.tree&&n.Controller.checkIsLoggedIn(function(i){var e=n.Model.getFoods().findWhere({id:o.tree.getFoodId()}),u=n.Model.getPersons().findWhere({id:parseInt(i.id)});f.handleAdoptionData(o.tree,u,t.CREATE,{},function(){f.handleDataChange("<strong><i>"+u.getName()+"<\/i><\/strong> has adopted <strong><i>"+e.getName()+" "+o.tree.getName()+"<\/i><\/strong> successfully.",!1);new n.RemovePopupViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute();(new n.RefreshCurrentViewCommand).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)},function(){f.handleDataChange("<strong><i>"+u.getName()+"<\/i><\/strong> has unadopted <strong><i>"+e.getName()+" "+o.tree.getName()+"<\/i><\/strong> successfully.",!1);(new n.RefreshCurrentViewCommand).execute()})},function(t){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)});break;case i.UNADOPT_TREE:u.hasClass("evt-close")?new n.RemovePopupViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute():u.hasClass("evt-submit")&&o.tree&&n.Controller.checkIsLoggedIn(function(i){var e=n.Model.getFoods().findWhere({id:o.tree.getFoodId()}),u=n.Model.getPersons().findWhere({id:parseInt(i.id)});f.handleAdoptionData(o.tree,u,t.DELETE,{},function(){f.handleDataChange("<strong><i>"+u.getName()+"<\/i><\/strong> has unadopted <strong><i>"+e.getName()+" "+o.tree.getName()+"<\/i><\/strong> successfully.",!1);new n.RemovePopupViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute();(new n.RefreshCurrentViewCommand).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)},function(){f.handleDataChange("<strong><i>"+u.getName()+"<\/i><\/strong> has adopted <strong><i>"+e.getName()+" "+o.tree.getName()+"<\/i><\/strong> successfully.",!1);(new n.RefreshCurrentViewCommand).execute()})},function(t){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){f.handleError(r.SEVER_CONNECTION_ERROR)});break;case i.MANAGE_PEOPLE:u.hasClass("change-password")&&n.Controller.checkAdmin(function(t){parseInt(t.auth)!=0&&parseInt(t.auth)>o.person.getAuth()?new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"You <strong>don't<\/strong> have privilege to change <strong>higher level<\/strong> of authorization.",undoable:!1}).execute():new n.RenderChangePasswordViewCommand({el:n.Setting.getPopWrapperElement(),person:o.person}).execute()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)});break;case i.CHANGE_PASSWORD:(u.hasClass("password-cancel")||u.hasClass("button-close"))&&new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute()}},f.handleMouseEnter=function(){switch(n.View.getViewStatus()){}},f.handleError=function(t,i){new n.RenderAlertViewCommand({el:n.Setting.getPopWrapperElement(),errorMode:t,customMessage:i}).execute()},f.handleDataChange=function(t){var i=f._instance;i._lastCommand?new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:t,undoable:!0}).execute():new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:t,undoable:!1}).execute()},f.handlePersonData=function(i,r,u,e,o){var s=f._instance,h;s._lastCommand=null;switch(r){case t.UPDATE_NAME:s._lastCommand=new n.UpdatePersonName({person:i,name:u.name},e,o);break;case t.UPDATE_ADDRESS:s._lastCommand=new n.UpdatePersonAddress({person:i,address:u.address},e,o);break;case t.UPDATE_CONTACT:s._lastCommand=new n.UpdatePersonContact({person:i,contact:u.contact},e,o);break;case t.UPDATE_NEIGHBORHOOD:s._lastCommand=new n.UpdatePersonNeightborhood({person:i,neighborhood:u.neighborhood},e,o);break;case t.DELETE:h=new n.DeletePerson({person:i},e,o);new n.RenderConfirmViewCommand({el:n.Setting.getPopWrapperElement(),message:"Are you sure to delete "+i.getName()+"?",command:h}).execute();break;case t.UPDATE_AUTH:s._lastCommand=new n.UpdatePersonAuth({person:i,auth:u.auth},e,o);break;case t.CREATE:s._lastCommand=new n.CreatePerson({person:i},e,o)}s._lastCommand!=undefined&&s._lastCommand.execute()},f.handleNoteData=function(i,r,u,e,o,s){var h=f._instance,c;h._lastCommand=null;switch(r){case t.UPDATE_COMMENT:h._lastCommand=new n.UpdateNoteComment({note:i,comment:u.comment},e,o);break;case t.UPDATE_RATING:h._lastCommand=new n.UpdateNoteRating({note:i,rate:u.rate},e,o);break;case t.UPDATE_COVER:h._lastCommand=new n.UpdateNoteCover({note:i,cover:u.cover},e,o);break;case t.UPDATE_DATE:h._lastCommand=new n.UpdateNoteDate({note:i,date:u.date},e,o);break;case t.ADD_PICTURE:h._lastCommand=new n.AddNotePicture({note:i,filename:u.filename},e,o,s);break;case t.CREATE:new n.CreateNote({note:i},e,o).execute();break;case t.DELETE:n.View.popViewStatus();c=new n.DeleteNote({note:i},e,o);new n.RenderConfirmViewCommand({el:n.Setting.getPopWrapperElement(),message:"Are you sure to delete this note?",command:c}).execute()}h._lastCommand!=undefined&&h._lastCommand.execute()},f.handleTreeData=function(i,r,u,e,o,s){var h=f._instance,c,l;h._lastCommand=null;switch(r){case t.UPDATE_LOCATION:h._lastCommand=new n.UpdateTreeLocation({tree:i,marker:u.marker,location:u.location},e,o);break;case t.UPDATE_FLAG:h._lastCommand=new n.UpdateTreeFlag({tree:i,flag:u.flag,addmode:u.addmode},e,o);break;case t.UPDATE_OWNERSHIP:h._lastCommand=new n.UpdateTreeOwnership({tree:i,ownership:u.ownership},e,o);break;case t.UPDATE_FOODTYPE:h._lastCommand=new n.UpdateTreeFoodType({tree:i,food:u.food},e,o);break;case t.UPDATE_DESCRIPTION:h._lastCommand=new n.UpdateTreeDescription({tree:i,description:u.description},e,o);break;case t.UPDATE_ADDRESS:h._lastCommand=new n.UpdateTreeAddress({tree:i,address:u.address},e,o);break;case t.CREATE:h._lastCommand=new n.AddNewTree({tree:i},e,o,s);break;case t.DELETE:c=n.Model.getFoods().findWhere({id:i.getFoodId()});l=new n.DeleteTree({tree:i},e,o);new n.RenderConfirmViewCommand({el:n.Setting.getPopWrapperElement(),message:"Are you sure to delete '"+c.getName()+" "+i.getName()+"' ?",command:l}).execute()}h._lastCommand!=undefined&&h._lastCommand.execute()},f.handleAdoptionData=function(i,r,u,e,o,s,h){var c=f._instance;c._lastCommand=null;switch(u){case t.CREATE:c._lastCommand=new n.CreateAdoption({tree:i,person:r},o,s,h);break;case t.DELETE:c._lastCommand=new n.DeleteAdoption({tree:i,person:r},o,s,h)}c._lastCommand!=undefined&&c._lastCommand.execute()},f.handleDonationData=function(i,r,u,e,o,s){var h=f._instance,c;h._lastCommand=null;switch(r){case t.CREATE:h._lastCommand=new n.CreateDonation({donation:i},e,o,s);break;case t.ADD_PICTURE:h._lastCommand=new n.AddDonationPicture({donation:i,filename:u.filename},e,o,s);break;case t.UPDATE_COVER:h._lastCommand=new n.UpdateDonationCover({donation:i,cover:u.cover},e,o);break;case t.UPDATE_DATE:h._lastCommand=new n.UpdateDonationDate({donation:i,date:u.date},e,o);break;case t.ADD_DONATION_TREE:h._lastCommand=new n.AddDonationTree({donation:i,tree:u.tree},e,o,s);break;case t.REMOVE_DONATION_TREE:h._lastCommand=new n.RemoveDonationTree({donation:i,tree:u.tree},e,o,s);break;case t.UPDATE_DONATION_AMOUNT:h._lastCommand=new n.UpdateDonationAmount({donation:i,amount:u.amount},e,o,s);break;case t.DELETE:n.View.popViewStatus();c=new n.DeleteDonation({donation:i},e,o);new n.RenderConfirmViewCommand({el:n.Setting.getPopWrapperElement(),message:"Are you sure to delete this donation?",command:c}).execute()}h._lastCommand!=undefined&&h._lastCommand.execute()},f.handlePlaceData=function(i,r,u,e,o,s){var h=f._instance,c;h._lastCommand=null;switch(r){case t.CREATE:h._lastCommand=new n.CreateLocation({place:i},e,o,s);break;case t.UPDATE_NAME:h._lastCommand=new n.UpdateLocationName({place:i,name:u.name},e,o,s);break;case t.UPDATE_DESCRIPTION:h._lastCommand=new n.UpdateLocationDescription({place:i,description:u.description},e,o,s);break;case t.UPDATE_LOCATION:h._lastCommand=new n.UpdateLocationLocation({place:i,marker:u.marker,location:u.location},e,o);break;case t.UPDATE_ADDRESS:h._lastCommand=new n.UpdateLocationAddress({place:i,address:u.address},e,o);break;case t.DELETE:c=new n.DeleteLocation({place:i},e,o);new n.RenderConfirmViewCommand({el:n.Setting.getPopWrapperElement(),message:"Are you sure to delete this location?",command:c}).execute()}h._lastCommand!=undefined&&h._lastCommand.execute()},f._instance=new f,f.TAG="Controller - ",f}();n.EventHandler=f}(FoodParent||(FoodParent={})),function(n){var t=function(){function t(){if(this.bDebug=!0,t._instance)throw new Error("Error: Instantiation failed: Use GeoLocation.getInstance() instead of new.");t._instance=this;t._instance.xhrPool=[]}return t.getInstance=function(){return t._instance},t.reverseGeocoding=function(t,i,r){var u=$.getJSON(n.Setting.getReverseGeoCodingAddress(t),function(n){i&&i({city:n.address.city,country:n.address.country,county:n.address.county,postcode:n.address.postcode,road:n.address.road,state:n.address.state,latitude:n.lat,longitude:n.lon})}).fail(function(){r&&r()})},t._instance=new t,t.TAG="GeoLocation - ",t}();n.GeoLocation=t}(FoodParent||(FoodParent={})),function(n){var ht=function(){function n(){}return n.prototype.execute=function(){},n.prototype.undo=function(){},n}(),i,r,u,t,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st;n.Command=ht;i=function(){function n(n){var t=this;t._parent=n.parent}return n.prototype.execute=function(){var n=this;n._parent.removeAllChildren()},n.prototype.undo=function(){},n}();n.RemoveChildViewCommand=i;r=function(){function t(n){var t=this;t._el=n.el}return t.prototype.execute=function(){var t=this;n.View.addChild(n.HomeViewFractory.create(t._el).render())},t.prototype.undo=function(){},t}();n.RenderHomeViewCommand=r;u=function(){function t(n){var t=this;t._el=n.el;t._viewStatus=n.viewStatus}return t.prototype.execute=function(){var t=this;n.View.getNavView()?n.View.getNavView().render({viewStatus:t._viewStatus}):n.View.setNavView(n.NavViewFractory.create(t._el).render({viewStatus:t._viewStatus}))},t.prototype.undo=function(){},t}();n.RenderNavViewCommand=u;t=function(){function t(n){var t=this;t._el=n.el;t._viewStatus=n.viewStatus}return t.prototype.execute=function(){var t=this;n.View.getNavView()?n.View.getNavView().setActiveNavItem(t._viewStatus):n.View.setNavView(n.NavViewFractory.create(t._el).render({viewStatus:t._viewStatus}))},t.prototype.undo=function(){},t}();n.SetActiveNavItemCommand=t;f=function(){function t(n){var t=this;t._el=n.el;t._id=n.id;t._credential=n.credential}return t.prototype.execute=function(){var t=this,i;n.View.getTreesView()?n.View.getTreesView().render():(i=n.TreesViewFractory.create(t._el,t._id,t._credential).render(),n.View.addChild(i),n.View.setTreesView(i))},t.prototype.undo=function(){},t}();n.RenderTreesViewCommand=f;e=function(){function t(n){var t=this;t._el=n.el;t._id=n.id}return t.prototype.execute=function(){var i=this,t;n.View.getManagePeopleView()||(t=n.ManagePeopleViewFractory.create(i._el,i._id).render(),n.View.addChild(t),n.View.setManagePeopleView(t))},t.prototype.undo=function(){},t}();n.RenderManagePeopleViewCommand=e;o=function(){function t(n){var t=this;t._el=n.el;t._id=n.id}return t.prototype.execute=function(){var i=this,t;n.View.getTreeView()||(t=n.TreeViewFractory.create(i._el,i._id).render(),n.View.addChild(t),n.View.setTreeView(t))},t.prototype.undo=function(){},t}();n.RenderTreeViewCommand=o;s=function(){function t(n){var t=this;t._el=n.el;t._message=n.message;t._command=n.command}return t.prototype.execute=function(){var t=this,i=n.ConfirmViewFractory.create(t._el,t._message,t._command).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.CONFIRM)},t.prototype.undo=function(){},t}();n.RenderConfirmViewCommand=s;h=function(){function t(n){var t=this;t._el=n.el;t._tree=n.tree}return t.prototype.execute=function(){var t=this,i=n.AdoptionManageViewFactory.create(t._el,t._tree).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.MANAGE_ADOPTION)},t.prototype.undo=function(){},t}();n.RenderManageAdoptionViewCommand=h;c=function(){function t(n){var t=this;t._el=n.el}return t.prototype.execute=function(){var t=this,i=n.TreesTableViewFactory.create(t._el).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.TREES_TABLE)},t.prototype.undo=function(){},t}();n.RenderTreesTableViewCommand=c;l=function(){function t(n){var t=this;t._el=n.el;t._tree=n.tree}return t.prototype.execute=function(){var t=this,i=n.AdoptTreeViewFactory.create(t._el,t._tree).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.ADOPT_TREE)},t.prototype.undo=function(){},t}();n.RenderAdoptTreeViewCommand=l;a=function(){function t(n){var t=this;t._el=n.el;t._tree=n.tree}return t.prototype.execute=function(){var t=this,i=n.UnadoptTreeViewFactory.create(t._el,t._tree).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.UNADOPT_TREE)},t.prototype.undo=function(){},t}();n.RenderUnadoptTreeViewCommand=a;v=function(){function t(n){var t=this;t._el=n.el;t._note=n.note}return t.prototype.execute=function(){var t=this,i=n.ImageNoteViewFactory.create(t._el,t._note).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.IMAGENOTE_TREE)},t.prototype.undo=function(){},t}();n.RenderImageNoteViewCommand=v;y=function(){function t(n){var t=this;t._el=n.el;t._tree=n.tree}return t.prototype.execute=function(){var t=this,i=n.PostNoteViewFactory.create(t._el,t._tree).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.POST_NOTE)},t.prototype.undo=function(){},t}();n.RenderPostNoteViewCommand=y;p=function(){function t(n){var t=this;t._el=n.el;t._errorMode=n.errorMode;n.customMessage&&(t._customMessage=n.customMessage)}return t.prototype.execute=function(){var t=this,i=n.AlertViewFractory.create(t._el,t._errorMode,t._customMessage).render();n.View.addPopupView(i);switch(t._errorMode){case n.ERROR_MODE.GEO_PERMISSION_ERROR:n.View.setViewStatus(n.VIEW_STATUS.GEO_ERROR);break;case n.ERROR_MODE.SEVER_CONNECTION_ERROR:n.View.setViewStatus(n.VIEW_STATUS.NETWORK_ERROR);break;case n.ERROR_MODE.SEVER_RESPONSE_ERROR:n.View.setViewStatus(n.VIEW_STATUS.SERVER_RESPONSE_ERROR)}},t.prototype.undo=function(){},t}();n.RenderAlertViewCommand=p;w=function(){function t(){var n=this}return t.prototype.execute=function(){for(var t=this;n.View.getPopupView()!=undefined;)n.Setting.getPopWrapperElement().children(".frame-pop").last().remove(),n.View.removePopupView(),console.log(n.View.getPopupViews()),n.View.getPopupView()==undefined&&n.Setting.getPopWrapperElement().addClass("hidden"),n.View.popViewStatus()},t.prototype.undo=function(){},t}();n.ResetPopupViewCommand=w;b=function(){function t(n){var t=this;t._delay=n!=undefined&&n.delay!=undefined?n.delay:0}return t.prototype.execute=function(){var t=this;n.View.getPopupView()&&(setTimeout(function(){n.Setting.getPopWrapperElement().children(".frame-pop").last().remove();n.View.removePopupView();console.log(n.View.getPopupViews());n.View.getPopupView()==undefined&&n.Setting.getPopWrapperElement().addClass("hidden")},t._delay),n.View.popViewStatus(),console.log(n.View.getViewStatus()))},t.prototype.undo=function(){},t}();n.RemovePopupViewCommand=b;k=function(){function i(){var n=this}return i.prototype.execute=function(){var i=this;setTimeout(function(){n.View.getViewStatus()==n.VIEW_STATUS.TREES&&n.View.getTreesView()&&(n.View.getTreesView()._applyFilter(),n.View.getTreesView().renderTreeInfo());n.View.getViewStatus()==n.VIEW_STATUS.TREES_TABLE?n.View.getPopupView()&&n.View.getPopupView()._applyFilter():n.View.getViewStatus()==n.VIEW_STATUS.TREE?n.View.getTreeView()&&n.View.getTreeView().renderMenu():n.View.getViewStatus()==n.VIEW_STATUS.MANAGE_ADOPTION&&n.View.getPopupView()&&n.View.getPopupView()._applyFilter();new t({el:n.Setting.getNavWrapperElement(),viewStatus:n.View.getViewStatus()}).execute()},n.Setting.getRemovePopupDuration())},i.prototype.undo=function(){},i}();n.RefreshCurrentViewCommand=k;d=function(){function t(){var n=this}return t.prototype.execute=function(){var t=this;n.View.getViewStatus()==n.VIEW_STATUS.TREES&&n.View.getTreesView()&&n.View.getTreesView().panToCurrentLocation()},t.prototype.undo=function(){},t}();n.UpdateCurrentPositionCommand=d;g=function(){function t(n){var t=this;t._hash=n.hash;n.id!=undefined&&(t._id=n.id)}return t.prototype.execute=function(){var t=this;t._id!=undefined?n.Router.getInstance().navigate(t._hash+"/"+t._id,{trigger:!0,replace:!1}):n.Router.getInstance().navigate(t._hash,{trigger:!0,replace:!1})},t.prototype.undo=function(){},t}();n.NavigateCommand=g;nt=function(){function t(n){var t=this;t._el=n.el;t._message=n.message;t._undoable=n.undoable}return t.prototype.execute=function(){var t=this,i;n.View.getMessageView()&&n.View.getMessageView().setInvisible();i=n.MessageViewFractory.create(t._el,t._message,t._undoable).render();n.View.setMessageView(i)},t.prototype.undo=function(){},t}();n.RenderMessageViewCommand=nt;tt=function(){function t(n){var t=this;t._el=n.el;t._id=n.id}return t.prototype.execute=function(){var i=this,t;n.View.getManageDonationsView()||(t=n.ManageDonationsViewFractory.create(i._el,i._id).render(),n.View.addChild(t),n.View.setManageDonationsView(t))},t.prototype.undo=function(){},t}();n.RenderManageDonationsViewCommand=tt;it=function(){function t(n){var t=this;t._el=n.el;t._place=n.place}return t.prototype.execute=function(){var t=this,i=n.AddDonationViewFactory.create(t._el,t._place).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.ADD_DONATION)},t.prototype.undo=function(){},t}();n.RenderAddDonationViewCommand=it;rt=function(){function t(n){var t=this;t._el=n.el;t._id=n.id}return t.prototype.execute=function(){var i=this,t;n.View.getDetailDonationView()||(t=n.DetailDonationViewFractory.create(i._el,i._id).render(),n.View.addChild(t),n.View.setDetailDonationView(t))},t.prototype.undo=function(){},t}();n.RenderDetailDonationViewCommand=rt;ut=function(){function t(n){var t=this;t._donation=n.donation}return t.prototype.execute=function(){var t=this,i=n.EditDonationViewFactory.create(t._el,t._donation).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.EDIT_DONATION)},t.prototype.undo=function(){},t}();n.RenderEditDonationViewCommand=ut;ft=function(){function i(n){var t=this;t._el=n.el}return i.prototype.execute=function(){var i=this,r=n.AccountViewFactory.create(i._el).render();n.View.addPopupView(r);n.View.setViewStatus(n.VIEW_STATUS.LOGIN);new t({el:n.Setting.getNavWrapperElement(),viewStatus:n.VIEW_STATUS.LOGIN}).execute()},i.prototype.undo=function(){},i}();n.RenderAccountViewCommand=ft;et=function(){function i(n){var t=this;t._el=n.el}return i.prototype.execute=function(){var i=this,r=n.LogInViewFactory.create(i._el).render();n.View.addPopupView(r);n.View.setViewStatus(n.VIEW_STATUS.LOGIN);new t({el:n.Setting.getNavWrapperElement(),viewStatus:n.VIEW_STATUS.LOGIN}).execute()},i.prototype.undo=function(){},i}();n.RenderLogInViewCommand=et;ot=function(){function t(n){var t=this;t._el=n.el}return t.prototype.execute=function(){var t=this,i=n.SignUpViewFactory.create(t._el).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.SIGNUP)},t.prototype.undo=function(){},t}();n.RenderSignUpViewCommand=ot;st=function(){function t(n){var t=this;t._el=n.el;t._person=n.person}return t.prototype.execute=function(){var t=this,i=n.ChangePasswordViewFactory.create(t._el,t._person).render();n.View.addPopupView(i);n.View.setViewStatus(n.VIEW_STATUS.CHANGE_PASSWORD)},t.prototype.undo=function(){},t}();n.RenderChangePasswordViewCommand=st}(FoodParent||(FoodParent={})),function(n){var s=function(){function t(n,t,i){var r=this;n!=undefined&&n.tree!=undefined&&n.flag!=undefined&&n.addmode!=undefined&&(r._tree=n.tree,r._flag=n.flag,r._addmode=n.addmode);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;t._previousFlag=t._tree.getCopiedFlags();t._addmode?(t._tree.addFlag(t._flag),t._tree.removeFlag(0)):t._tree.removeFlag(t._flag);t._tree.save({},{wait:!0,success:function(){t._note=t._addmode?new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:0,comment:"Status '"+n.Model.getFlags().findWhere({id:t._flag}).getName()+"' has added.",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())}):new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:0,comment:"Status '"+n.Model.getFlags().findWhere({id:t._flag}).getName()+"' has removed.",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;t._tree.setFlags(t._previousFlag);t._tree.save({},{wait:!0,success:function(){n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}(),t,i,r,u,f,e,o;n.UpdateTreeFlag=s;t=function(){function t(n,t,i){var r=this;n!=undefined&&n.tree!=undefined&&n.ownership!=undefined&&(r._tree=n.tree,r._ownership=n.ownership);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;t._previousOwnership=t._tree.getOwnershipId();t._tree.save({ownership:t._ownership},{wait:!0,success:function(){t._note=new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:0,comment:"Ownership has changed as '"+n.Model.getOwnerships().findWhere({id:t._ownership}).getName()+"'",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;t._tree.save({ownership:t._previousOwnership},{wait:!0,success:function(){n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}();n.UpdateTreeOwnership=t;i=function(){function t(n,t,i){var r=this;n!=undefined&&n.tree!=undefined&&n.location!=undefined&&(r._tree=n.tree,r._location=n.location);n.marker&&(r._marker=n.marker);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;t._prevLocation=t._tree.getLocation();t._prevAddress=t._tree.getAddress();n.GeoLocation.reverseGeocoding(t._tree.getLocation(),function(i){t._tree.save({lat:t._location.lat,lng:t._location.lng,address:i.road+", "+i.county+", "+i.state+", "+i.country+", "+i.postcode},{wait:!0,success:function(){t._note=new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:0,comment:"Location has changed as '@ "+t._location.lat.toFixed(4)+", "+t._location.lng.toFixed(4)+"'",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},t.prototype.undo=function(){var t=this;t._tree.save({lat:t._prevLocation.lat,lng:t._prevLocation.lng,address:t._prevAddress},{wait:!0,success:function(){n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._success&&t._success();t._marker&&t._marker.setLatLng(t._prevLocation)},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}();n.UpdateTreeLocation=i;r=function(){function t(n,t,i){var r=this;n!=undefined&&n.tree!=undefined&&n.food!=undefined&&(r._tree=n.tree,r._food=n.food);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;t._previousFood=t._tree.getFoodId();t._tree.save({food:t._food},{wait:!0,success:function(){t._note=new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:0,comment:"Food type has changed as '"+n.Model.getFoods().findWhere({id:t._food}).getName()+"'",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;t._tree.save({food:t._previousFood},{wait:!0,success:function(){n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}();n.UpdateTreeFoodType=r;u=function(){function t(n,t,i){var r=this;n!=undefined&&n.tree!=undefined&&n.description!=undefined&&(r._tree=n.tree,r._description=n.description);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;t._previousDescription=t._tree.getDescription();t._tree.save({description:t._description},{wait:!0,success:function(){t._note=new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:0,comment:"Description has changed as '"+t._description+"'",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;t._tree.save({description:t._previousDescription},{wait:!0,success:function(){n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}();n.UpdateTreeDescription=u;f=function(){function t(n,t,i,r){var u=this;n!=undefined&&n.tree!=undefined&&(u._tree=n.tree);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return t.prototype.execute=function(){var t=this,i=n.Model.getFoods().findWhere({id:t._tree.getFoodId()});t._tree.save({},{wait:!0,success:function(){n.Model.getTrees().add(t._tree);t._note=new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:0,comment:"'"+i.getName()+" "+t._tree.getName()+"' has been added.",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;n.Model.getTrees().remove(t._tree);t._tree.destroy({wait:!0,success:function(){n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._undoSuccess&&t._undoSuccess()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}();n.AddNewTree=f;e=function(){function t(n,t,i){var r=this;n!=undefined&&n.tree!=undefined&&(r._tree=n.tree);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;n.Model.getTrees().remove(t._tree);t._tree.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){},t}();n.DeleteTree=e;o=function(){function t(n,t,i){var r=this;n!=undefined&&n.tree!=undefined&&n.address!=undefined&&(r._tree=n.tree,r._address=n.address);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;t._previousAddress=t._tree.getAddress();t._tree.save({address:t._address},{wait:!0,success:function(){t._note=new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:0,comment:"Address has changed as '"+t._address+"'",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;t._tree.save({address:t._previousAddress},{wait:!0,success:function(){n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}();n.UpdateTreeAddress=o}(FoodParent||(FoodParent={})),function(n){var o=function(){function n(n,t,i){var r=this;n!=undefined&&n.person!=undefined&&n.name!=undefined&&(r._person=n.person,r._name=n.name);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousName=n._person.getName();n._person.save({name:n._name},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._person.save({name:n._previousName},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}(),t,i,r,u,f,e;n.UpdatePersonName=o;t=function(){function n(n,t,i){var r=this;n!=undefined&&n.person!=undefined&&n.address!=undefined&&(r._person=n.person,r._address=n.address);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousAddress=n._person.getAddress();n._person.save({address:n._address},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._person.save({address:n._previousAddress},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdatePersonAddress=t;i=function(){function n(n,t,i){var r=this;n!=undefined&&n.person!=undefined&&n.contact!=undefined&&(r._person=n.person,r._contact=n.contact);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousContact=n._person.getContact();n._person.save({contact:n._contact},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._person.save({contact:n._previousContact},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdatePersonContact=i;r=function(){function n(n,t,i){var r=this;n!=undefined&&n.person!=undefined&&n.neighborhood!=undefined&&(r._person=n.person,r._neighborhood=n.neighborhood);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousNeighborhood=n._person.getNeighboorhood();n._person.save({neighborhood:n._neighborhood},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._person.save({neighborhood:n._previousNeighborhood},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdatePersonNeightborhood=r;u=function(){function n(n,t,i){var r=this;n!=undefined&&n.person!=undefined&&n.auth!=undefined&&(r._person=n.person,r._auth=n.auth);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousAuth=n._person.getAuth();n._person.save({auth:n._auth},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._person.save({auth:n._previousAuth},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdatePersonAuth=u;f=function(){function t(n,t,i){var r=this;n!=undefined&&n.person!=undefined&&(r._person=n.person);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;n.Model.getPersons().remove(t._person);t._person.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){},t}();n.DeletePerson=f;e=function(){function t(n,t,i,r){var u=this;n!=undefined&&n.person!=undefined&&(u._person=n.person);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return t.prototype.execute=function(){var t=this;t._person.save({},{wait:!0,success:function(){n.Model.getPersons().add(t._person);t._success&&t._success()},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;n.Model.getPersons().remove(t._person);t._person.destroy({wait:!0,success:function(){t._undoSuccess&&t._undoSuccess()},error:function(){t._error&&t._error()}})},t}();n.CreatePerson=e}(FoodParent||(FoodParent={})),function(n){var i=function(){function t(n,t,i,r){var u=this;n!=undefined&&n.tree!=undefined&&n.person!=undefined&&(u._tree=n.tree,u._person=n.person);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return t.prototype.execute=function(){var t=this;t._adopt=new n.Adopt({tree:t._tree.getId(),parent:t._person.getId()});t._adopt.save({},{wait:!0,success:function(){n.Model.getAdopts().add(t._adopt);t._tree.updateParents();t._person.updateTrees();t._note=new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:t._person.getId(),comment:t._person.getName()+" has adopted this tree.",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;n.Model.getAdopts().remove(t._adopt);t._tree.updateParents();t._person.updateTrees();t._adopt.destroy({wait:!0,success:function(){n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._undoSuccess&&t._undoSuccess()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}(),t;n.CreateAdoption=i;t=function(){function t(n,t,i,r){var u=this;n!=undefined&&n.tree!=undefined&&n.person!=undefined&&(u._tree=n.tree,u._person=n.person);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return t.prototype.execute=function(){var t=this;t._adopt=n.Model.getAdopts().findWhere({tree:t._tree.getId(),parent:t._person.getId()});t._adopt!=undefined&&(n.Model.getAdopts().remove(t._adopt),t._tree.updateParents(),t._person.updateTrees(),t._adopt.destroy({wait:!0,success:function(){t._note=new n.Note({type:n.NoteType.INFO,tree:t._tree.getId(),person:t._person.getId(),comment:t._person.getName()+" has unadopted this tree.",picture:"",rate:-1,date:moment(new Date).format(n.Setting.getDateTimeFormat())});t._note.save({},{wait:!0,success:function(i){n.Model.getNotes().add(i);t._success&&t._success()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}}))},t.prototype.undo=function(){var t=this;t._adopt=new n.Adopt({tree:t._tree.getId(),parent:t._person.getId()});t._adopt.save({},{wait:!0,success:function(){n.Model.getAdopts().add(t._adopt);t._tree.updateParents();t._person.updateTrees();n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._undoSuccess&&t._undoSuccess()},error:function(){t._error&&t._error()}})},error:function(){t._error&&t._error()}})},t}();n.DeleteAdoption=t}(FoodParent||(FoodParent={})),function(n){var o=function(){function n(n,t,i){var r=this;n!=undefined&&n.note!=undefined&&n.comment!=undefined&&(r._note=n.note,r._comment=n.comment);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousComment=n._note.getComment();n._note.save({comment:n._comment},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._note.save({comment:n._previousComment},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}(),t,i,r,u,f,e;n.UpdateNoteComment=o;t=function(){function n(n,t,i){var r=this;n!=undefined&&n.note!=undefined&&n.rate!=undefined&&(r._note=n.note,r._rate=n.rate);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousRate=n._note.getRate();n._note.save({rate:n._rate},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._note.save({rate:n._previousRate},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateNoteRating=t;i=function(){function n(n,t,i){var r=this;n!=undefined&&n.note!=undefined&&n.cover!=undefined&&(r._note=n.note,r._picture=r._note.getPicture(n.cover));t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousPicture=n._note.getPicture(0);n._note.setCoverPicture(n._picture);n._note.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._note.setCoverPicture(n._previousPicture);n._note.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateNoteCover=i;r=function(){function n(n,t,i){var r=this;n!=undefined&&n.note!=undefined&&n.date!=undefined&&(r._note=n.note,r._date=n.date);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousDate=n._note.getFormattedDateTime();n._note.save({date:n._date},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._note.save({date:n._previousDate},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateNoteDate=r;u=function(){function n(n,t,i,r){var u=this;console.log(n.note);console.log(n.filename);n!=undefined&&n.note!=undefined&&n.filename!=undefined&&(u._note=n.note,u._filename=n.filename);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return n.prototype.execute=function(){var n=this;n._note.addPicture(n._filename);n._note.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._note.removePicture(n._filename);n._note.save({},{wait:!0,success:function(){n._undoSuccess&&n._undoSuccess()},error:function(){n._error&&n._error()}})},n}();n.AddNotePicture=u;f=function(){function t(n,t,i){var r=this;n!=undefined&&n.note!=undefined&&(r._note=n.note);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;t._note.save({},{wait:!0,success:function(){n.Model.getNotes().add(t._note);t._success&&t._success()},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},t}();n.CreateNote=f;e=function(){function t(n,t,i){var r=this;n!=undefined&&n.note!=undefined&&(r._note=n.note);t&&(r._success=t);i&&(r._error=i)}return t.prototype.execute=function(){var t=this;n.Model.getNotes().remove(t._note);t._note.destroy({wait:!0,success:function(){t._success&&t._success()},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){},t}();n.DeleteNote=e}(FoodParent||(FoodParent={})),function(n){var s=function(){function t(n,t,i,r){var u=this;n!=undefined&&n.donation!=undefined&&(u._donation=n.donation);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return t.prototype.execute=function(){var t=this;t._donation.save({},{wait:!0,success:function(){n.Model.getDonations().add(t._donation);t._success&&t._success()},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;n.Model.getDonations().remove(t._donation);t._donation.destroy({wait:!0,success:function(){t._undoSuccess&&t._undoSuccess()},error:function(){t._error&&t._error()}})},t}(),t,i,r,u,f,e,o;n.CreateDonation=s;t=function(){function n(n,t,i,r){var u=this;console.log(n.note);console.log(n.filename);n!=undefined&&n.donation!=undefined&&n.filename!=undefined&&(u._donation=n.donation,u._filename=n.filename);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return n.prototype.execute=function(){var n=this;n._donation.addPicture(n._filename);n._donation.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._donation.removePicture(n._filename);n._donation.save({},{wait:!0,success:function(){n._undoSuccess&&n._undoSuccess()},error:function(){n._error&&n._error()}})},n}();n.AddDonationPicture=t;i=function(){function n(n,t,i){var r=this;n!=undefined&&n.donation!=undefined&&n.cover!=undefined&&(r._donation=n.donation,r._picture=r._donation.getPicture(n.cover));t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousPicture=n._donation.getPicture(0);n._donation.setCoverPicture(n._picture);n._donation.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._donation.setCoverPicture(n._previousPicture);n._donation.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateDonationCover=i;r=function(){function n(n,t,i){var r=this;n!=undefined&&n.donation!=undefined&&n.date!=undefined&&(r._donation=n.donation,r._date=n.date);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousDate=n._donation.getFormattedDateTime();n._donation.save({date:n._date},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._donation.save({date:n._previousDate},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateDonationDate=r;u=function(){function n(n,t,i,r){var u=this;n!=undefined&&n.donation!=undefined&&n.tree!=undefined&&(u._donation=n.donation,u._tree=n.tree);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return n.prototype.execute=function(){var n=this;n._donation.addTreeId(n._tree.getId());n._donation.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._donation.removeTreeId(n._tree.getId());n._donation.save({},{wait:!0,success:function(){n._undoSuccess&&n._undoSuccess()},error:function(){n._error&&n._error()}})},n}();n.AddDonationTree=u;f=function(){function n(n,t,i,r){var u=this;n!=undefined&&n.donation!=undefined&&n.tree!=undefined&&(u._donation=n.donation,u._tree=n.tree);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return n.prototype.execute=function(){var n=this;n._donation.removeTreeId(n._tree.getId());n._donation.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._donation.addTreeId(n._tree.getId());n._donation.save({},{wait:!0,success:function(){n._undoSuccess&&n._undoSuccess()},error:function(){n._error&&n._error()}})},n}();n.RemoveDonationTree=f;e=function(){function n(n,t,i,r){var u=this;n!=undefined&&n.donation!=undefined&&n.amount!=undefined&&(u._donation=n.donation,u._amount=n.amount);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return n.prototype.execute=function(){var n=this;n._prevAmount=n._donation.getQuantity();n._donation.setQuantity(n._amount);n._donation.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._donation.setQuantity(n._prevAmount);n._donation.save({},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateDonationAmount=e;o=function(){function n(n,t,i){var r=this;n!=undefined&&n.donation!=undefined&&(r._donation=n.donation);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._donation.destroy({wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){},n}();n.DeleteDonation=o}(FoodParent||(FoodParent={})),function(n){var e=function(){function t(n,t,i,r){var u=this;n!=undefined&&n.place!=undefined&&(u._place=n.place);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return t.prototype.execute=function(){var t=this;t._place.save({},{wait:!0,success:function(){n.Model.getPlaces().add(t._place);t._success&&t._success()},error:function(){t._error&&t._error()}})},t.prototype.undo=function(){var t=this;n.Model.getPlaces().remove(t._place);t._place.destroy({wait:!0,success:function(){t._undoSuccess&&t._undoSuccess()},error:function(){t._error&&t._error()}})},t}(),t,i,r,u,f;n.CreateLocation=e;t=function(){function n(n,t,i){var r=this;n!=undefined&&n.place!=undefined&&(r._place=n.place);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._place.destroy({wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){},n}();n.DeleteLocation=t;i=function(){function n(n,t,i,r){var u=this;n!=undefined&&n.place!=undefined&&n.name!=undefined&&(u._place=n.place,u._name=n.name);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return n.prototype.execute=function(){var n=this;n._prevName=n._place.getName();n._place.save({name:n._name},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._place.save({name:n._prevName},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateLocationName=i;r=function(){function n(n,t,i,r){var u=this;n!=undefined&&n.place!=undefined&&n.description!=undefined&&(u._place=n.place,u._description=n.description);t&&(u._success=t);i&&(u._error=i);r&&(u._undoSuccess=r)}return n.prototype.execute=function(){var n=this;n._prevDescription=n._place.getDescription();n._place.save({description:n._description},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._place.save({description:n._prevDescription},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateLocationDescription=r;u=function(){function n(n,t,i){var r=this;n!=undefined&&n.place!=undefined&&n.location!=undefined&&(r._place=n.place,r._location=n.location);n.marker&&(r._marker=n.marker);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._prevLocation=n._place.getLocation();n._place.save({lat:n._location.lat,lng:n._location.lng},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._place.save({lat:n._prevLocation.lat,lng:n._prevLocation.lng},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateLocationLocation=u;f=function(){function n(n,t,i){var r=this;n!=undefined&&n.place!=undefined&&n.address!=undefined&&(r._place=n.place,r._address=n.address);t&&(r._success=t);i&&(r._error=i)}return n.prototype.execute=function(){var n=this;n._previousAddress=n._place.getAddress();n._place.save({address:n._address},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n.prototype.undo=function(){var n=this;n._place.save({address:n._previousAddress},{wait:!0,success:function(){n._success&&n._success()},error:function(){n._error&&n._error()}})},n}();n.UpdateLocationAddress=f}(FoodParent||(FoodParent={}));var DatePickerCellEditor=Backgrid.InputCellEditor.extend({events:{},initialize:function(){Backgrid.InputCellEditor.prototype.initialize.apply(this,arguments);var n=this;$(this.el).datetimepicker({defaultDate:n.model.get("date"),format:FoodParent.Setting.getDateTimeFormat()}).on("dp.hide",function(){if($(this).data("date")!=undefined){var t=new Backgrid.Command({});n.model.set(n.column.get("name"),$(this).data("date"));n.model.trigger("backgrid:edited",n.model,n.column,t)}})}}),TreeDateCell=Backgrid.Cell.extend({template:_.template('<div class="text-date btn-date"><%= date %><\/div>'),events:{"click .btn-date":"_updateDate"},_updateDate:function(){},render:function(){var n=this,t=this.model;return $(n.el).html(n.template({date:t.getUpdatedDate()})),this.delegateEvents(),this}}),TreeDescriptionCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var s=this,r=this.model,h=this.formatter,t=this.model,u=this.column,i=new Backgrid.Command(n),c=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||c?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=h.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,u,e):r.getId()==undefined?(t.set(u.get("name"),f),t.trigger("backgrid:edited",t,u,i)):f.trim()!=r.getDescription().trim()&&f.trim()!=""?(o=f,r.getDescription().trim()!=o.trim()?FoodParent.EventHandler.handleTreeData(r,FoodParent.DATA_MODE.UPDATE_DESCRIPTION,{description:o},function(){var n=FoodParent.Model.getFoods().findWhere({id:r.getFoodId()});t.trigger("backgrid:edited",t,u,i);FoodParent.EventHandler.handleDataChange("Description of <strong><i>"+n.getName()+" "+r.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}):s.renderTreeInfo(r)):t.trigger("backgrid:edited",t,u,i)):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,u,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),TreeLatitudeCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var c=this,r=this.model,s=this.formatter,t=this.model,u=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=s.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,u,e):r.getId()==undefined?(t.set(u.get("name"),f),t.trigger("backgrid:edited",t,u,i)):f!=r.getLat()?(o=new L.LatLng(f,r.getLng()),FoodParent.EventHandler.handleTreeData(r,FoodParent.DATA_MODE.UPDATE_LOCATION,{location:o},function(){var n=FoodParent.Model.getFoods().findWhere({id:r.getFoodId()});t.trigger("backgrid:edited",t,u,i);FoodParent.EventHandler.handleDataChange("Location of <strong><i>"+n.getName()+" "+r.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):t.trigger("backgrid:edited",t,u,i)):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,u,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),TreeLongitudeCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var r=this.model,s=this.formatter,t=this.model,u=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=s.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,u,e):r.getId()==undefined?(t.set(u.get("name"),f),t.trigger("backgrid:edited",t,u,i)):f!=r.getLng()?(o=new L.LatLng(r.getLat(),f),FoodParent.EventHandler.handleTreeData(r,FoodParent.DATA_MODE.UPDATE_LOCATION,{location:o},function(){var n=FoodParent.Model.getFoods().findWhere({id:r.getFoodId()});t.trigger("backgrid:edited",t,u,i);FoodParent.EventHandler.handleDataChange("Location of <strong><i>"+n.getName()+" "+r.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):t.trigger("backgrid:edited",t,u,i)):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,u,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),TreeAddressCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var s=this,r=this.model,h=this.formatter,t=this.model,u=this.column,i=new Backgrid.Command(n),c=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||c?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=h.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,u,e):r.getId()==undefined?(t.set(u.get("name"),f),t.trigger("backgrid:edited",t,u,i)):(console.log(f),f.trim()==""?(r=this.model,FoodParent.GeoLocation.reverseGeocoding(s.model.getLocation(),function(n){FoodParent.EventHandler.handleTreeData(r,FoodParent.DATA_MODE.UPDATE_ADDRESS,{address:n.road+", "+n.county+", "+n.state+", "+n.postcode},function(){var f=FoodParent.Model.getFoods().findWhere({id:r.getFoodId()});FoodParent.EventHandler.handleDataChange("Address of <strong><i>"+f.getName()+" "+r.getName()+"<\/i><\/strong> has been changed successfully.",!0);t.set(u.get("name"),n.road+", "+n.county+", "+n.state+", "+n.postcode);t.trigger("backgrid:edited",t,u,i)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):f.trim()!=r.getAddress().trim()?(o=f,FoodParent.EventHandler.handleTreeData(r,FoodParent.DATA_MODE.UPDATE_ADDRESS,{address:o},function(){var n=FoodParent.Model.getFoods().findWhere({id:r.getFoodId()});t.trigger("backgrid:edited",t,u,i);FoodParent.EventHandler.handleDataChange("Address of <strong><i>"+n.getName()+" "+r.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):t.trigger("backgrid:edited",t,u,i))):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,u,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),TreeMapViewCell=Backgrid.Cell.extend({template:_.template('<div class="btn-table" data-target="<%= treeid %>"><i class="fa fa-map-marker"><\/i><\/div>'),events:{"click .btn-table":"_panToTree"},_panToTree:function(n){var t=parseInt($(n.currentTarget).attr("data-target"));(new FoodParent.ResetPopupViewCommand).execute();FoodParent.Router.getInstance().navigate("trees/"+$(n.currentTarget).attr("data-target"),{trigger:!0,replace:!0})},render:function(){return $(this.el).html(this.template({treeid:this.model.getId()})),this.delegateEvents(),this}}),ManageAdoptionViewCell=Backgrid.Cell.extend({template:_.template('<div class="btn-table evt-manage-adopt" data-target="<%= treeid %>"><i class="fa fa-users"><\/i><\/div>'),events:{"click .btn-table":"_manageAdoption"},_manageAdoption:function(n){var t=parseInt($(n.currentTarget).attr("data-target"));FoodParent.EventHandler.handleMouseClick($(n.currentTarget),this,{tree:t})},render:function(){return $(this.el).html(this.template({treeid:this.model.getId()})),this.delegateEvents(),this}}),TreeDetailCell=Backgrid.Cell.extend({template:_.template('<div class="btn-table" data-target="<%= treeid %>"><i class="fa fa-heartbeat"><\/i><\/div>'),events:{"click .btn-table":"_showDetail"},_showDetail:function(n){var t=parseInt($(n.target).attr("data-target"));FoodParent.EventHandler.handleMouseClick($(n.currentTarget),this,{tree:t})},render:function(){return $(this.el).html(this.template({treeid:this.model.getId()})),this.delegateEvents(),this}}),TreeCreateCell=Backgrid.Cell.extend({template:_.template('<div class="btn-table"><i class="fa fa-save"><\/i><\/div>'),events:{"click .btn-table":"_createRow"},_createRow:function(){var n=this.model;n.getAddress().trim()==""?FoodParent.GeoLocation.reverseGeocoding(n.getLocation(),function(t){n.set({address:t.road+", "+t.county+", "+t.state+", "+t.country+", "+t.postcode});FoodParent.EventHandler.handleTreeData(n,FoodParent.DATA_MODE.CREATE,{},function(){var t=FoodParent.Model.getFoods().findWhere({id:n.getFoodId()});FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+" "+n.getName()+"<\/i><\/strong> has been created successfully.",!0);$("#wrapper-tree-list .new-tree").addClass("hidden");(new FoodParent.RefreshCurrentViewCommand).execute()},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){var t=FoodParent.Model.getFoods().findWhere({id:n.getFoodId()});FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+" "+n.getName()+"<\/i><\/strong> has been deleted successfully.",!1);(new FoodParent.RefreshCurrentViewCommand).execute()})},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}):FoodParent.EventHandler.handleTreeData(n,FoodParent.DATA_MODE.CREATE,{},function(){var t=FoodParent.Model.getFoods().findWhere({id:n.getFoodId()});FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+" "+n.getName()+"<\/i><\/strong> has been created successfully.",!0);$("#wrapper-tree-list .new-tree").addClass("hidden");(new FoodParent.RefreshCurrentViewCommand).execute()},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){var t=FoodParent.Model.getFoods().findWhere({id:n.getFoodId()});FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+" "+n.getName()+"<\/i><\/strong> has been deleted successfully.",!1);(new FoodParent.RefreshCurrentViewCommand).execute()})},render:function(){return $(this.el).html(this.template()),this.delegateEvents(),this}}),TreeDeleteCell=Backgrid.Cell.extend({template:_.template('<div class="btn-table"><i class="fa fa-trash-o"><\/i><\/div>'),events:{"click .btn-table":"_deleteRow"},_deleteRow:function(){var n=this.model;n.getId()==undefined?$("#wrapper-tree-list .new-tree").addClass("hidden"):FoodParent.EventHandler.handleTreeData(n,FoodParent.DATA_MODE.DELETE,{},function(){var t=FoodParent.Model.getFoods().findWhere({id:n.getFoodId()});(new FoodParent.RefreshCurrentViewCommand).execute();FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+" "+n.getName()+"<\/i><\/strong> has deleted successfully.",!1)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})},render:function(){return $(this.el).html(this.template()),this.delegateEvents(),this}}),TreeAdoptionCell=Backgrid.Cell.extend({events:{"click .btn-tree":"_linkTreeDetail"},_linkTreeDetail:function(){},render:function(){this.template=_.template(FoodParent.Template.getAdoptPersonCellTemplate());var n=new FoodParent.Persons(FoodParent.Model.getPersons().filterByIds(this.model.get("parents")));return $(this.el).html(this.template({persons:n})),this.delegateEvents(),this}}),FoodSelectCellEditor=Backgrid.FoodSelectCellEditor=Backgrid.CellEditor.extend({tagName:"select",events:{change:"save",blur:"close",keydown:"close"},template:_.template('<option value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- text %><\/option>',null,{variable:null}),setOptionValues:function(n){this.optionValues=n;this.optionValues=_.result(this,"optionValues")},setMultiple:function(n){this.multiple=n;this.$el.prop("multiple",n)},_renderOptions:function(n,t){for(var r="",i=0;i<n.length;i++)r=r+this.template({text:n[i][0],value:n[i][1],selected:_.indexOf(t,n[i][1])>-1});return r},render:function(){var t,n;this.$el.empty();var i=_.result(this,"optionValues"),u=this.model,f=this.formatter.fromRaw(u.get(this.column.get("name")),u);if(!_.isArray(i))throw new TypeError("optionValues must be an array");var n=null,e=null,n=null,o=null,r=null;for(t=0;t<i.length;t++)if(n=i[t],_.isArray(n))e=n[0],n=n[1],this.$el.append(this.template({text:e,value:n,selected:_.indexOf(f,n)>-1}));else if(_.isObject(n))o=n.name,r=$("<optgroup><\/optgroup>",{label:o}),r.append(this._renderOptions.call(this,n.values,f)),this.$el.append(r);else throw new TypeError("optionValues elements must be a name-value pair or an object hash of { name: 'optgroup label', value: [option name-value pairs] }");return this.delegateEvents(),this},save:function(n){var t=this.model,i=this.column,r=parseInt(this.$el.val()),u=new Backgrid.Command(n);t.getId()==undefined?(t.set(i.get("name"),r),t.trigger("backgrid:edited",t,i,u)):FoodParent.EventHandler.handleTreeData(t,FoodParent.DATA_MODE.UPDATE_FOODTYPE,{food:r},function(){var r=FoodParent.Model.getFoods().findWhere({id:t.getFoodId()});t.trigger("backgrid:edited",t,i,new Backgrid.Command(n));FoodParent.EventHandler.handleDataChange("Food type of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})},close:function(n){var i=this.model,r=this.column,t=new Backgrid.Command(n);t.cancel()?(n.stopPropagation(),i.trigger("backgrid:edited",i,r,new Backgrid.Command(n))):(t.save()||t.moveLeft()||t.moveRight()||t.moveUp()||t.moveDown()||n.type=="blur")&&(n.preventDefault(),n.stopPropagation(),i.trigger("backgrid:edited",i,r,new Backgrid.Command(n)))}}),TreeColumn=[{name:"food",label:"Food Type",editable:!0},{name:"id",label:"#",editable:!1,cell:"string"},{name:"description",label:"Description",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:TreeDescriptionCellEditor})},{name:"address",label:"Address",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:TreeAddressCellEditor})},{name:"lat",label:"Latitude",editable:!0,formatter:Backgrid.NumberFormatter,cell:Backgrid.Cell.extend({editor:TreeLatitudeCellEditor})},{name:"lng",label:"Longitude",editable:!0,formatter:Backgrid.NumberFormatter,cell:Backgrid.Cell.extend({editor:TreeLongitudeCellEditor})},{name:"parents",label:"Adoption",editable:!1,cell:TreeAdoptionCell},{name:"updated",label:"Last Updated",editable:!1,cell:TreeDateCell},{label:"",sortable:!1,editable:!1,cell:TreeMapViewCell},{label:"",sortable:!1,editable:!1,cell:ManageAdoptionViewCell},{label:"",sortable:!1,editable:!1,cell:TreeDetailCell},{label:"",sortable:!1,editable:!1,cell:TreeDeleteCell}],NewTreeColumn=[{name:"food",label:"Food Type",editable:!0},{name:"description",label:"Description",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:TreeDescriptionCellEditor})},{name:"address",label:"Address",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:TreeAddressCellEditor})},{name:"lat",label:"Latitude",editable:!0,formatter:Backgrid.NumberFormatter,cell:Backgrid.Cell.extend({editor:TreeLatitudeCellEditor})},{name:"lng",label:"Longitude",editable:!0,formatter:Backgrid.NumberFormatter,cell:Backgrid.Cell.extend({editor:TreeLongitudeCellEditor})},{label:"",sortable:!1,editable:!1,cell:TreeCreateCell},{label:"",sortable:!1,editable:!1,cell:TreeDeleteCell}],PersonNameCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var c=this,u=this.model,s=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=s.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,r,e):u.getId()==undefined?(t.set(r.get("name"),f),t.trigger("backgrid:edited",t,r,i)):(o=f,o.trim()!=u.getName().trim()?FoodParent.EventHandler.handlePersonData(u,FoodParent.DATA_MODE.UPDATE_NAME,{name:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Name of <strong><i>"+u.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.trigger("backgrid:edited",t,r,i))):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),PersonAddressCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var c=this,u=this.model,s=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=s.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,r,e):u.getId()==undefined?(t.set(r.get("name"),f),t.trigger("backgrid:edited",t,r,i)):(o=f,o.trim()!=u.getAddress().trim()?FoodParent.EventHandler.handlePersonData(u,FoodParent.DATA_MODE.UPDATE_ADDRESS,{address:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Address of <strong><i>"+u.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.trigger("backgrid:edited",t,r,i))):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),PersonContactCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var c=this,u=this.model,s=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=s.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,r,e):u.getId()==undefined?(t.set(r.get("name"),f),t.trigger("backgrid:edited",t,r,i)):(o=f,o.trim()!=u.getContact().trim()?FoodParent.EventHandler.handlePersonData(u,FoodParent.DATA_MODE.UPDATE_CONTACT,{contact:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Contact of <strong><i>"+u.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.trigger("backgrid:edited",t,r,i))):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),PersonNeighborhoodCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var c=this,u=this.model,s=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=s.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,r,e):u.getId()==undefined?(t.set(r.get("name"),f),t.trigger("backgrid:edited",t,r,i)):(o=f,o.trim()!=u.getNeighboorhood().trim()?FoodParent.EventHandler.handlePersonData(u,FoodParent.DATA_MODE.UPDATE_NEIGHBORHOOD,{neighborhood:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Neighborhood of <strong><i>"+u.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.trigger("backgrid:edited",t,r,i))):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),PersonAdoptionCell=Backgrid.Cell.extend({events:{"click .cell-link":"_linkTreeDetail"},_linkTreeDetail:function(){},render:function(){this.template=_.template(FoodParent.Template.getAdoptTreeCellTemplate());var n=new FoodParent.Trees(FoodParent.Model.getTrees().filterByIds(this.model.get("trees")));return $(this.el).html(this.template({trees:n})),this.delegateEvents(),this}}),PersonDetailCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item"><i class="fa fa-arrow-circle-right fa-2x"><\/i><\/div>'),events:{click:"_showDetail"},_showDetail:function(){},render:function(){return $(this.el).html(this.template()),this.delegateEvents(),this}}),PersonPasswordCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item change-password"><i class="fa fa-chain fa-2x"><\/i><\/div>'),events:{click:"_changePassword"},_changePassword:function(n){var t=this.model;FoodParent.EventHandler.handleMouseClick($(n.currentTarget).find(".marker-control-item"),this,{person:t})},render:function(){var n=this,t=this.model;return t.getAuth()==1||t.getAuth()==2?$(n.el).html(this.template()):$(n.el).html('<div class="blank-marker-control-item"><\/div>'),this.delegateEvents(),this}}),PersonDeleteCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item"><i class="fa fa-remove fa-2x"><\/i><\/div>'),events:{click:"_deleteRow"},_deleteRow:function(){var i=this.model,n=this.model,t;n.getId()==undefined?$("#wrapper-mpeople .new-person").addClass("hidden"):(t=!0,FoodParent.Controller.checkAdmin(function(i){i.result=="true"&&parseInt(i.auth)==2&&n.getAuth()==1&&(t=!1);t?FoodParent.EventHandler.handlePersonData(n,FoodParent.DATA_MODE.DELETE,{},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+n.getName()+"<\/i><\/strong> has deleted successfully.",!1)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}):new FoodParent.RenderMessageViewCommand({el:FoodParent.Setting.getMessageWrapperElement(),message:"You <strong>don't<\/strong> have privilege to change <strong>higher level<\/strong> of authorization.",undoable:!1}).execute()},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}))},render:function(){return $(this.el).html(this.template()),this.delegateEvents(),this}}),AuthSelectCellEditor=Backgrid.AuthSelectCellEditor=Backgrid.CellEditor.extend({tagName:"select",events:{change:"save",blur:"close",keydown:"close"},template:_.template('<option value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- text %><\/option>',null,{variable:null}),setOptionValues:function(n){this.optionValues=n;this.optionValues=_.result(this,"optionValues")},setMultiple:function(n){this.multiple=n;this.$el.prop("multiple",n)},_renderOptions:function(n,t){for(var r="",i=0;i<n.length;i++)r=r+this.template({text:n[i][0],value:n[i][1],selected:_.indexOf(t,n[i][1])>-1});return r},render:function(){var t,n;this.$el.empty();var i=_.result(this,"optionValues"),u=this.model,f=this.formatter.fromRaw(u.get(this.column.get("name")),u);if(!_.isArray(i))throw new TypeError("optionValues must be an array");var n=null,e=null,n=null,o=null,r=null;for(t=0;t<i.length;t++)if(n=i[t],_.isArray(n))e=n[0],n=n[1],this.$el.append(this.template({text:e,value:n,selected:_.indexOf(f,n)>-1}));else if(_.isObject(n))o=n.name,r=$("<optgroup><\/optgroup>",{label:o}),r.append(this._renderOptions.call(this,n.values,f)),this.$el.append(r);else throw new TypeError("optionValues elements must be a name-value pair or an object hash of { name: 'optgroup label', value: [option name-value pairs] }");return this.delegateEvents(),this},save:function(n){var t=this.model,i=this.column,f=this.model,r=parseInt(this.$el.val()),e=new Backgrid.Command(n),u;t.getId()==undefined?(t.set(i.get("name"),r),t.trigger("backgrid:edited",t,i,e)):(u=!0,FoodParent.Controller.checkAdmin(function(e){e.result=="true"&&parseInt(e.auth)==2&&(r==1||t.getAuth()==1)&&(u=!1);u?FoodParent.EventHandler.handlePersonData(t,FoodParent.DATA_MODE.UPDATE_AUTH,{auth:r},function(){t.trigger("backgrid:edited",t,i,new Backgrid.Command(n));FoodParent.EventHandler.handleDataChange("Authorization of <strong><i>"+t.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}):(f.trigger("backgrid:edited",f,i,new Backgrid.Command(n)),new FoodParent.RenderMessageViewCommand({el:FoodParent.Setting.getMessageWrapperElement(),message:"You <strong>don't<\/strong> have privilege to change <strong>higher level<\/strong> of authorization.",undoable:!1}).execute())},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}))},close:function(n){var i=this.model,r=this.column,t=new Backgrid.Command(n);t.cancel()?(n.stopPropagation(),i.trigger("backgrid:edited",i,r,new Backgrid.Command(n))):(t.save()||t.moveLeft()||t.moveRight()||t.moveUp()||t.moveDown()||n.type=="blur")&&(n.preventDefault(),n.stopPropagation(),i.trigger("backgrid:edited",i,r,new Backgrid.Command(n)))}}),PersonCreateCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item create-item"><i class="fa fa-save fa-2x"><\/i><\/div>'),events:{click:"_createRow"},_createRow:function(){var n=this.model;FoodParent.EventHandler.handlePersonData(n,FoodParent.DATA_MODE.CREATE,{},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+n.getName()+"<\/i><\/strong> has been created successfully.",!0);$("#wrapper-mpeople .new-person").addClass("hidden");FoodParent.View.getManagePeopleView()._applyFilter()},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+n.getName()+"<\/i><\/strong> has been deleted successfully.",!1)})},render:function(){return $(this.el).html(this.template()),this.delegateEvents(),this}}),PersonColumn=[{name:"auth",label:"Auth",editable:!0},{name:"name",label:"Name",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:PersonNameCellEditor})},{name:"address",label:"Address",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:PersonAddressCellEditor})},{name:"contact",label:"Contact",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:PersonContactCellEditor})},{name:"neighborhood",label:"Neighborhood",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:PersonNeighborhoodCellEditor})},{name:"trees",label:"Adoption",editable:!1,cell:PersonAdoptionCell},{label:"",sortable:!1,editable:!1,cell:PersonPasswordCell},{label:"",sortable:!1,editable:!1,cell:PersonDetailCell},{label:"",sortable:!1,editable:!1,cell:PersonDeleteCell}],NewPersonColumn=[{name:"auth",label:"Auth",editable:!0},{name:"name",label:"Name",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:PersonNameCellEditor})},{name:"address",label:"Address",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:PersonAddressCellEditor})},{name:"contact",label:"Contact",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:PersonContactCellEditor})},{name:"neighborhood",label:"Neighborhood",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:PersonNeighborhoodCellEditor})},{label:"",sortable:!1,editable:!1,cell:PersonCreateCell},{label:"",sortable:!1,editable:!1,cell:PersonDeleteCell}],AdoptionDateCell=Backgrid.Cell.extend({template:_.template('<div class="text-date btn-date"><%= date %><\/div>'),events:{"click .btn-date":"_updateDate"},_updateDate:function(){},render:function(){var n=this,t=this.model;return $(n.el).html(n.template({date:t.getUpdatedDate()})),this.delegateEvents(),this}}),AdoptionAuthCell=Backgrid.Cell.extend({template:_.template("<div><%= auth %><\/div>"),render:function(){var n=this.model;return $(this.el).html(this.template({auth:FoodParent.Model.getAuths().findWhere({id:n.getAuth()}).getName()})),this.delegateEvents(),this}}),AdoptionNameCell=Backgrid.Cell.extend({template:_.template("<div><%= name %><\/div>"),render:function(){var n=this.model;return $(this.el).html(this.template({name:n.getName()})),this.delegateEvents(),this}}),AdoptionContactCell=Backgrid.Cell.extend({template:_.template("<div><%= contact %><\/div>"),render:function(){var n=this.model;return $(this.el).html(this.template({contact:n.getContact()})),this.delegateEvents(),this}}),AdoptionNeighborhoodCell=Backgrid.Cell.extend({template:_.template("<div><%= neighborhood %><\/div>"),render:function(){var n=this.model;return $(this.el).html(this.template({neighborhood:n.getNeighboorhood()})),this.delegateEvents(),this}}),AdoptionAddCell=Backgrid.Cell.extend({template:_.template('<div class="btn-table"><i class="fa fa-plus-square"><\/i><\/div>'),events:{"click .btn-table":"_addAdoption"},_addAdoption:function(){var n=FoodParent.Model.getTrees().findWhere({id:parseInt($(".list-adoption").attr("data-target"))}),i=FoodParent.Model.getFoods().findWhere({id:n.getFoodId()}),t=this.model;FoodParent.EventHandler.handleAdoptionData(n,t,FoodParent.DATA_MODE.CREATE,{},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+"<\/i><\/strong> has adopted <strong><i>"+i.getName()+" "+n.getName()+"<\/i><\/strong> successfully.",!1);FoodParent.View.getPopupView()._applyFilter()},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+"<\/i><\/strong> has unadopted <strong><i>"+i.getName()+" "+n.getName()+"<\/i><\/strong> successfully.",!1);FoodParent.View.getPopupView()._applyFilter()})},render:function(){var n=this,t=this.model,i=parseInt($(".list-adoption").attr("data-target"));return FoodParent.Model.getAdopts().checkAdoption(i,t.getId())?$(n.el).html('<div class="blank-marker-control-item"><\/div>'):$(n.el).html(n.template()),this.delegateEvents(),this}}),AdoptionDeleteCell=Backgrid.Cell.extend({template:_.template('<div class="btn-table"><i class="fa fa-minus-square"><\/i><\/div>'),events:{"click .btn-table":"_removeAdoption"},_removeAdoption:function(){var n=FoodParent.Model.getTrees().findWhere({id:parseInt($(".list-adoption").attr("data-target"))}),i=FoodParent.Model.getFoods().findWhere({id:n.getFoodId()}),t=this.model;FoodParent.EventHandler.handleAdoptionData(n,t,FoodParent.DATA_MODE.DELETE,{},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+"<\/i><\/strong> has unadopted <strong><i>"+i.getName()+" "+n.getName()+"<\/i><\/strong> successfully.",!1);(new FoodParent.RefreshCurrentViewCommand).execute()},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+t.getName()+"<\/i><\/strong> has adopted <strong><i>"+i.getName()+" "+n.getName()+"<\/i><\/strong> successfully.",!1);(new FoodParent.RefreshCurrentViewCommand).execute()})},render:function(){var n=this,t=this.model,i=parseInt($(".list-adoption").attr("data-target"));return FoodParent.Model.getAdopts().checkAdoption(i,t.getId())?$(n.el).html(n.template()):$(n.el).html('<div class="btn-table-blank"><\/div>'),this.delegateEvents(),this}}),AdoptionListCell=Backgrid.Cell.extend({events:{"click .btn-tree":"_panToTree"},_panToTree:function(n){(new FoodParent.ResetPopupViewCommand).execute();FoodParent.Router.getInstance().navigate("trees/"+$(n.currentTarget).attr("data-target"),{trigger:!0,replace:!0})},render:function(){this.template=_.template(FoodParent.Template.getAdoptTreeCellTemplate());var n=new FoodParent.Trees(FoodParent.Model.getTrees().filterByIds(this.model.get("trees")));return $(this.el).html(this.template({trees:n})),this.delegateEvents(),this}}),AdoptionColumn=[{name:"auth",label:"Auth",editable:!1,cell:AdoptionAuthCell},{name:"name",label:"Name",editable:!1,cell:AdoptionNameCell},{name:"contact",label:"Contact",editable:!1,cell:AdoptionContactCell},{name:"neighborhood",label:"Neighborhood",editable:!1,cell:AdoptionNeighborhoodCell},{name:"trees",label:"Adoption",editable:!1,cell:AdoptionListCell},{label:"",sortable:!1,editable:!1,cell:AdoptionAddCell},{label:"",sortable:!1,editable:!1,cell:AdoptionDeleteCell}],LocationNameCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var c=this,f=this.model,s=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,u,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),u=s.toRaw(e,t),_.isUndefined(u)?t.trigger("backgrid:error",t,r,e):f.getId()==undefined?(t.set(r.get("name"),u),t.trigger("backgrid:edited",t,r,i)):u.trim()!=f.getName().trim()&&u.trim()!=""?(o=u,FoodParent.EventHandler.handlePlaceData(f,FoodParent.DATA_MODE.UPDATE_NAME,{name:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Name of <strong><i>Location<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):t.trigger("backgrid:edited",t,r,i)):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),LocationDescriptionCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var c=this,f=this.model,s=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,u,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),u=s.toRaw(e,t),_.isUndefined(u)?t.trigger("backgrid:error",t,r,e):f.getId()==undefined?(t.set(r.get("name"),u),t.trigger("backgrid:edited",t,r,i)):u.trim()!=f.getDescription().trim()&&u.trim()!=""?(o=u,FoodParent.EventHandler.handlePlaceData(f,FoodParent.DATA_MODE.UPDATE_DESCRIPTION,{description:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Description of <strong><i>"+f.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):t.trigger("backgrid:edited",t,r,i)):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),LocationLatitudeCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var c=this,f=this.model,s=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,u,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),u=s.toRaw(e,t),_.isUndefined(u)?t.trigger("backgrid:error",t,r,e):f.getId()==undefined?(t.set(r.get("name"),u),t.trigger("backgrid:edited",t,r,i)):u!=f.getLat()&&u.trim()!=""?(o=new L.LatLng(u,f.getLng()),FoodParent.EventHandler.handlePlaceData(f,FoodParent.DATA_MODE.UPDATE_LOCATION,{location:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Location of <strong><i>"+f.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):t.trigger("backgrid:edited",t,r,i)):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),LocationLongitudeCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var f=this.model,s=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),h=n.type==="blur",e,u,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||h?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),u=s.toRaw(e,t),_.isUndefined(u)?t.trigger("backgrid:error",t,r,e):f.getId()==undefined?(t.set(r.get("name"),u),t.trigger("backgrid:edited",t,r,i)):u!=f.getLng()&&u.trim()!=""?(o=new L.LatLng(f.getLat(),u),FoodParent.EventHandler.handlePlaceData(f,FoodParent.DATA_MODE.UPDATE_LOCATION,{location:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Location of <strong><i>"+f.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):t.trigger("backgrid:edited",t,r,i)):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),LocationAddressCell=Backgrid.Cell.extend({template:_.template('<div class="cell-group"><%= address %><div class="cell-button cell-refresh"><i class="fa fa-refresh fa-1x"><\/i><\/div><\/div>'),events:{"click .cell-refresh":"_refresh"},render:function(){var n=this,t=$(n.el);return FoodParent.GeoLocation.reverseGeocoding(n.model.getLocation(),function(i){t.html(n.template({address:"<div>"+i.road+", "+i.county+", "+i.state+", "+i.postcode+"<\/div>"}))},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)}),n.delegateEvents(),this},_refresh:function(){var n=this,t=$(n.el);FoodParent.GeoLocation.reverseGeocoding(n.model.getLocation(),function(i){t.html(n.template({address:"<div>"+i.road+", "+i.county+", "+i.state+", "+i.postcode+"<\/div>"}))},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})}}),LocationAddressCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var s=this,u=this.model,h=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),c=n.type==="blur",e,f,o;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||c?(n.preventDefault(),n.stopPropagation(),e=this.$el.val(),f=h.toRaw(e,t),_.isUndefined(f)?t.trigger("backgrid:error",t,r,e):u.getId()==undefined?(t.set(r.get("name"),f),t.trigger("backgrid:edited",t,r,i)):(console.log(f),f.trim()==""?(u=this.model,FoodParent.GeoLocation.reverseGeocoding(s.model.getLocation(),function(n){FoodParent.EventHandler.handlePlaceData(u,FoodParent.DATA_MODE.UPDATE_ADDRESS,{address:n.road+", "+n.county+", "+n.state+", "+n.postcode},function(){FoodParent.EventHandler.handleDataChange("Address of <strong><i>"+u.getName()+"<\/i><\/strong> has been changed successfully.",!0);t.set(r.get("name"),n.road+", "+n.county+", "+n.state+", "+n.postcode);t.trigger("backgrid:edited",t,r,i)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):f.trim()!=u.getAddress().trim()?(o=f,FoodParent.EventHandler.handlePlaceData(u,FoodParent.DATA_MODE.UPDATE_ADDRESS,{address:o},function(){t.trigger("backgrid:edited",t,r,i);FoodParent.EventHandler.handleDataChange("Address of <strong><i>"+u.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})):t.trigger("backgrid:edited",t,r,i))):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),LocationMapViewCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item mapview-item" data-target="<%= treeid %>"><i class="fa fa-map-marker fa-2x"><\/i><\/div>'),events:{"click .mapview-item":"_showMapView"},_showMapView:function(n){var t=parseInt($(n.target).attr("data-target"))},render:function(){return $(this.el).html(this.template({treeid:this.model.getId()})),this.delegateEvents(),this}}),ManageDonationViewCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item manage-donation-item" data-target="<%= treeid %>"><i class="fa fa-ambulance fa-2x"><\/i><\/div>'),events:{"click .marker-control-item":"_manageDonation"},_manageDonation:function(n){var t=FoodParent.Model.getPlaces().findWhere({id:parseInt($(n.target).attr("data-target"))});t!=undefined&&FoodParent.EventHandler.handleMouseClick($(n.currentTarget),this,{place:t})},render:function(){return $(this.el).html(this.template({treeid:this.model.getId()})),this.delegateEvents(),this}}),LocationDetailCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item location-detail" data-target="<%= treeid %>"><i class="fa fa-heartbeat fa-2x"><\/i><\/div>'),events:{"click .marker-control-item":"_showDetail"},_showDetail:function(n){var t=FoodParent.Model.getPlaces().findWhere({id:parseInt($(n.target).attr("data-target"))});t!=undefined&&FoodParent.EventHandler.handleMouseClick($(n.currentTarget),this,{place:t})},render:function(){return $(this.el).html(this.template({treeid:this.model.getId()})),this.delegateEvents(),this}}),LocationDeleteCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item"><i class="fa fa-remove fa-2x"><\/i><\/div>'),events:{click:"_deleteRow"},_deleteRow:function(){var n=this.model},render:function(){return $(this.el).html(this.template()),this.delegateEvents(),this}}),LocationCreateCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item create-item"><i class="fa fa-save fa-2x"><\/i><\/div>'),events:{click:"_createRow"},_createRow:function(){var n=this.model;FoodParent.EventHandler.handlePlaceData(n,FoodParent.DATA_MODE.CREATE,{},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+n.getName()+"<\/i><\/strong> has been created successfully.",!0);$("#wrapper-mdonations .new-location").addClass("hidden")},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+n.getName()+"<\/i><\/strong> has been deleted successfully.",!1);$("#wrapper-mdonations .new-location").addClass("hidden")})},render:function(){return $(this.el).html(this.template()),this.delegateEvents(),this}}),LocationDeleteCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item"><i class="fa fa-remove fa-2x"><\/i><\/div>'),events:{click:"_deleteRow"},_deleteRow:function(){var n=this.model;n.getId()==undefined?$("#wrapper-mdonations .new-location").addClass("hidden"):FoodParent.EventHandler.handlePlaceData(n,FoodParent.DATA_MODE.DELETE,{},function(){FoodParent.EventHandler.handleDataChange("<strong><i>"+n.getName()+"<\/i><\/strong> has deleted successfully.",!1)},function(){FoodParent.EventHandler.handleError(FoodParent.ERROR_MODE.SEVER_CONNECTION_ERROR)})},render:function(){return $(this.el).html(this.template()),this.delegateEvents(),this}}),LocationColumn=[{name:"name",label:"Name",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:LocationNameCellEditor})},{name:"description",label:"Description",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:LocationDescriptionCellEditor})},{name:"address",label:"Address",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:LocationAddressCellEditor})},{name:"lat",label:"Latitude",editable:!0,formatter:Backgrid.NumberFormatter,cell:Backgrid.Cell.extend({editor:LocationLatitudeCellEditor})},{name:"lng",label:"Longitude",editable:!0,formatter:Backgrid.NumberFormatter,cell:Backgrid.Cell.extend({editor:LocationLongitudeCellEditor})},{label:"",sortable:!1,editable:!1,cell:LocationMapViewCell},{label:"",sortable:!1,editable:!1,cell:ManageDonationViewCell},{label:"",sortable:!1,editable:!1,cell:LocationDetailCell},{label:"",sortable:!1,editable:!1,cell:LocationDeleteCell}],NewLocationColumn=[{name:"name",label:"Name",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:LocationNameCellEditor})},{name:"description",label:"Description",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:LocationDescriptionCellEditor})},{name:"address",label:"Address",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:LocationAddressCellEditor})},{name:"lat",label:"Latitude",editable:!0,formatter:Backgrid.NumberFormatter,cell:Backgrid.Cell.extend({editor:LocationLatitudeCellEditor})},{name:"lng",label:"Longitude",editable:!0,formatter:Backgrid.NumberFormatter,cell:Backgrid.Cell.extend({editor:LocationLongitudeCellEditor})},{label:"",sortable:!1,editable:!1,cell:LocationCreateCell},{label:"",sortable:!1,editable:!1,cell:LocationDeleteCell}],DonationAddCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item marker-add-adoption"><i class="fa fa-plus-square fa-2x"><\/i><\/div>'),events:{"click .marker-control-item":"_addDonation"},_addDonation:function(){var n=this.model;FoodParent.View.getPopupView().addNewDonation(n)},render:function(){var n=this;return $(n.el).html(n.template()),this.delegateEvents(),this}}),DonationDeleteCell=Backgrid.Cell.extend({template:_.template('<div class="marker-control-item marker-remove-adoption"><i class="fa fa-minus-square fa-2x"><\/i><\/div>'),events:{"click .marker-control-item":"_removeDonation"},_removeDonation:function(){var n=this.model;FoodParent.View.getPopupView().removeNewDonation(n)},render:function(){var n=this;return $(n.el).html(n.template()),this.delegateEvents(),this}}),DonationPlaceCell=Backgrid.Cell.extend({events:{},render:function(){var n=this,t=this.model,i=t.getPlaceId(),r=FoodParent.Model.getPlaces().findWhere({id:i}),u=$(n.el);return u.html(r.getName()),n.delegateEvents(),this}}),DonationQuantityCellEditor=Backgrid.Cell.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(n){Backgrid.InputCellEditor.__super__.initialize.apply(this,arguments);n.placeholder&&this.$el.attr("placeholder",n.placeholder)},render:function(){var n=this.model;return this.$el.val(this.formatter.fromRaw(n.get(this.column.get("name")),n)),this},saveOrCancel:function(n){var h=this,e=this.model,o=this.formatter,t=this.model,r=this.column,i=new Backgrid.Command(n),s=n.type==="blur",u,f;i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()||s?(n.preventDefault(),n.stopPropagation(),u=this.$el.val(),f=o.toRaw(u,t),_.isUndefined(f)?t.trigger("backgrid:error",t,r,u):e.getId()==undefined&&(t.set(r.get("name"),f),t.trigger("backgrid:edited",t,r,i))):i.cancel()&&(n.stopPropagation(),t.trigger("backgrid:edited",t,r,i))},postRender:function(n,t){if(t==null||t.get("name")==this.column.get("name"))if(this.$el.css("text-align")==="right"){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),DonationPickDateCellEditor=Backgrid.Cell.extend({template:_.template('<div class="pickdate"><%= date %><\/div>'),events:{},_changeDate:function(){},render:function(){var n=this,t=this.model,i=t.getDateForDatePicker();return $(n.el).html(n.template({date:t.getFormattedDate()})),$(n.el).find(".pickdate").attr({"data-value":moment(i).format(FoodParent.Setting.getDateFormat())}),$(n.el).find(".pickdate").pickadate({format:"dd mmm yyyy",today:"",max:new Date(moment(new Date).valueOf()),clear:"",close:"Close",onClose:function(){}}),this.delegateEvents(),this}}),DonationColumn=[{name:"food",label:"Food Type",editable:!1},{name:"id",label:"#",editable:!1,cell:"string"},{name:"description",label:"Description",editable:!0,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:TreeDescriptionCellEditor})},{name:"address",label:"Address",editable:!1,formatter:Backgrid.StringFormatter,cell:Backgrid.Cell.extend({editor:TreeAddressCellEditor})},{name:"parents",label:"Adoption",editable:!1,cell:TreeAdoptionCell},{label:"",sortable:!1,editable:!1,cell:DonationAddCell}],FoodParent;(function(n){var t=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use Template.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.getHomeViewTemplate=function(){var n="";return n+='<div id="wrapper-home">',n+='<div id="wrapper-logo">',n+='<img id="content-logo" class="button-logo" src="<%= image %>" />',n+='<div id="wrapper-description">',n+="<%= description %>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getManagePeopleTableViewTemplate=function(){var n="";return n+='<div id="wrapper-mpeople">',n+='<div id="wrapper-mpeople-table">',n+='<div id="wrapper-tablemenu">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 add-person">Add A New Person<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 collapsible-button" data-target="#filter-list">Filter List<\/div><\/div>',n+='<div id="filter-list" class="collapsible-list">',n+="<\/div>",n+="<\/div>",n+='<div id="content-mpeople-table">',n+='<div class="new-person hidden">',n+="<\/div>",n+='<div class="list-title">List of People<\/div>',n+='<div class="list-people">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getManageTreesTableViewTemplate=function(){var n="";return n+='<div id="wrapper-mtrees">',n+='<div id="wrapper-mtrees-table">',n+='<div id="wrapper-tablemenu">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 switch-map">Switch to Map View<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 add-tree">Add A New Tree<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 collapsible-button" data-target="#filter-list">Filter List<\/div><\/div>',n+='<div id="filter-list" class="collapsible-list">',n+="<\/div>",n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 collapsible-button" data-target="#forage-list">Foragable List<\/div><\/div>',n+='<div id="forage-list" class="collapsible-list hidden">',n+="<\/div>",n+="<\/div>",n+='<div id="content-mtrees-table">',n+='<div class="new-tree hidden">',n+="<\/div>",n+='<div class="list-title">List of Trees<\/div>',n+='<div class="list-tree">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getManageTreesMapViewTemplate=function(){var n="";return n+='<div id="wrapper-mtrees">',n+='<div id="content-map">',n+="<\/div>",n+='<div id="wrapper-mapmenu">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 switch-table">Switch to Table View<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 add-tree">Add A New Tree<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 collapsible-button" data-target="#filter-list">Filter List<\/div><\/div>',n+='<div id="filter-list" class="collapsible-list">',n+="<\/div>",n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 collapsible-button" data-target="#forage-list">Foragable List<\/div><\/div>',n+='<div id="forage-list" class="collapsible-list hidden">',n+="<\/div>",n+="<\/div>",n+='<div id="wrapper-treeinfo" class="hidden">',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getTreesMapViewWrapperTemplate=function(){var n="";return n+='<div id="wrapper-trees">',n+"<\/div>"},n.getTreesMapViewTemplateForGuest=function(){var n="";return n+='<div id="content-map">',n+="<\/div>",n+='<div id="wrapper-mapfilter">',n+='<div id="content-mapfilter">',n+="<\/div>",n+='<div id="wrapper-btn-mapfilter">',n+='<div class="btn-mapfilter">',n+='<div class="icon-mapfilter-status"><i class="fa fa-filter"><\/i><\/div>',n+='<div class="text-mapfilter-status">off<\/div>',n+="<\/div>",n+='<div class="btn-location btn-action evt-location">',n+='<div class="icon-location"><i class="fa fa-location-arrow"><\/i><\/div>',n+="<\/div>",n+='<div class="deco-mapfilter">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div id="wrapper-treeinfo" class="hidden">',n+="<\/div>",n+='<div id="wrapper-mapmenu">',n+='<div id="wrapper-food-search">',n+='<div id="wrapper-list-food" class="hidden">',n+='<div id="list-food" class=""><\/div>',n+="<\/div>",n+='<div class="bottom-filters">',n+='<div class="search-box form-group">',n+='<input type="text" class="form-control" id="input-search-food" type="search" placeholder="Search by Food Name" value=""/>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getTreesMapViewTemplateForParent=function(){var n="";return n+='<div id="content-map">',n+="<\/div>",n+='<div id="wrapper-mapfilter">',n+='<div id="content-mapfilter">',n+="<\/div>",n+='<div id="wrapper-btn-mapfilter">',n+='<div class="btn-mapfilter">',n+='<div class="icon-mapfilter-status"><i class="fa fa-filter"><\/i><\/div>',n+='<div class="text-mapfilter-status">off<\/div>',n+="<\/div>",n+='<div class="btn-location btn-action evt-location">',n+='<div class="icon-location"><i class="fa fa-location-arrow"><\/i><\/div>',n+="<\/div>",n+='<div class="deco-mapfilter">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div id="wrapper-treeinfo" class="hidden">',n+="<\/div>",n+='<div id="wrapper-mapmenu">',n+='<div id="wrapper-food-search">',n+='<div id="wrapper-list-food" class="hidden">',n+='<div id="list-food" class=""><\/div>',n+="<\/div>",n+='<div class="bottom-filters">',n+='<input id="checkbox-mytrees" type="checkbox" data-toggle="toggle" />',n+='<div class="search-box form-group">',n+='<input type="text" class="form-control" id="input-search-food" type="search" placeholder="Search by Food Name" value=""/>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getTreesMapViewTemplateForAdmin=function(){var n="";return n+='<div id="content-map">',n+="<\/div>",n+='<div id="wrapper-mapfilter">',n+='<div id="content-mapfilter">',n+="<\/div>",n+='<div id="wrapper-btn-mapfilter">',n+='<div class="btn-mapfilter">',n+='<div class="icon-mapfilter-status"><i class="fa fa-filter"><\/i><\/div>',n+='<div class="text-mapfilter-status">off<\/div>',n+="<\/div>",n+='<div class="btn-location btn-action evt-location">',n+='<div class="icon-location"><i class="fa fa-location-arrow"><\/i><\/div>',n+="<\/div>",n+='<div class="btn-add-tree btn-action evt-add-tree">',n+='<div class="icon-add-tree"><i class="fa fa-plus"><\/i><\/div>',n+="<\/div>",n+='<div class="btn-tree-table btn-action evt-tree-table">',n+='<div class="icon-tree-table"><i class="fa fa-th-list"><\/i><\/div>',n+="<\/div>",n+='<div class="deco-mapfilter">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div id="wrapper-treeinfo" class="hidden">',n+="<\/div>",n+='<div id="wrapper-mapmenu">',n+='<div id="wrapper-food-search">',n+='<div id="wrapper-list-food" class="hidden">',n+='<div id="list-food" class=""><\/div>',n+="<\/div>",n+='<div class="bottom-filters">',n+='<input id="checkbox-mytrees" type="checkbox" data-toggle="toggle" />',n+='<div class="search-box form-group">',n+='<input type="text" class="form-control" id="input-search-food" type="search" placeholder="Search by Food Name" value=""/>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getFoodItemTemplate=function(){var n="";return n+="<% _.each(foods.models, function (food) { %>",n+='<div class="item-food text-food" data-id="<%= food.getId() %>"><span><%= food.getName() %><\/span><\/div>',n+"<% }); %>"},n.getNavViewTemplate=function(){var n="";return n+='<div id="content-nav">',n+"<\/div>"},n.getNavViewTemplateForGuest=function(){var n="";return n+='<div class="item-nav text-title evt-title">FoodParent<\/div>',n+='<div class="item-nav evt-trees">TREES<\/div>',n+='<div class="deco-login"><div><\/div><\/div>',n+'<div class="item-nav text-login evt-login">PARENT IN<\/div>'},n.getNavViewTemplateForParent=function(){var n="";return n+='<div class="item-nav text-title evt-title">FoodParent<\/div>',n+='<div class="item-nav evt-trees">TREES<\/div>',n+='<div class="deco-login"><div><\/div><\/div>',n+'<div class="item-nav text-parent evt-login"><div>you are logged in as:<\/div><div class="text-contact"><span><%= contact %><\/span><\/div><\/div>'},n.getNavViewTemplateForAdmin=function(){var n="";return n+='<div class="item-nav text-title evt-title">FoodParent<\/div>',n+='<div class="item-nav evt-trees">TREES<\/div>',n+='<div class="item-nav evt-parents">PARENTS<\/div>',n+='<div class="item-nav evt-donations">DONATIONS<\/div>',n+='<div class="deco-login"><div><\/div><\/div>',n+'<div class="item-nav text-parent evt-login"><div>you are logged in as:<\/div><div class="text-contact"><span><%= contact %><\/span><\/div><\/div>'},n.getNavViewManageItemsTemplate2=function(){var n="";return n+='<div class="item-nav title">FoodParent<\/div>',n+='<div class="item-nav trees">TREES<\/div>',n+='<div class="item-nav people">PARENTS<\/div>',n+='<div class="item-nav donations">DONATIONS<\/div>',n+'<div class="item-nav login"><div class="login-decoration"><div><\/div><\/div><div class="login-text loggedinas">you are logged in as: <br /> <%= contact %><\/div>'},n.getNavViewManageItemsTemplate3=function(){var n="";return n+='<div class="item-nav title">FoodParent<\/div>',n+='<div class="item-nav trees">TREES<\/div>',n+'<div class="item-nav loggedin"><div class="login-decoration"><div><\/div><\/div><div class="login-text loggedinas">you are logged in as: <br/><span class="loggedin-contact"><%= contact %><\/span><\/div><\/div>'},n.getAlertViewTemplate=function(){var n="";return n+='<div id="wrapper-alert">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+="<%= content %>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getConfirmViewTemplate=function(){var n="";return n+='<div id="wrapper-confirm" class="frame-pop">',n+='<div id="frame-confirm">',n+='<div id="content-header">',n+='<div class="text-header"><%= header %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+='<div class="info-group">',n+='<div class="text-label"><%= message %><br/><i>*This action cannot be undone.<\/i><\/div>',n+="<\/div>",n+="<hr />",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-submit">Submit<\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-close">Cancel<\/div>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getMessageViewTemplate=function(){var n="";return n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+="<%= content %>",n+="<\/div>",n+"<\/div>"},n.getMessageUndoableViewTemplate=function(){var n="";return n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+="<%= content %>",n+='<div class="undo">Undo change<\/div>',n+="<\/div>",n+"<\/div>"},n.getManageTreesPopupTemplateForAdmin=function(){var n="";return n+='<div class="marker-control-wrapper">',n+='<div class="marker-control-item btn-action evt-marker-lock">',n+='<i class="fa fa-lock fa-2x"><\/i>',n+="<\/div>",n+='<div class="marker-control-item btn-action evt-manage-adopt">',n+='<i class="fa fa-users fa-2x"><\/i>',n+="<\/div>",n+='<div class="marker-control-text btn-action evt-detail">',n+='<i class="fa fa-heartbeat fa-2x"><\/i><i class="fa fa-remove"><\/i><span id="text-rating" class="text-marker-control"><\/span>',n+="<\/div>",n+='<div class="marker-control-item btn-action evt-tree-remove">',n+='<i class="fa fa-trash-o fa-2x"><\/i>',n+="<\/div>",n+"<\/div>"},n.getManageTreesPopupTemplate2=function(){var n="";return n+='<div class="marker-control-wrapper">',n+='<div class="marker-control-item marker-control-plus">',n+='<i class="fa fa-plus fa-2x"><\/i>',n+="<\/div>",n+"<\/div>"},n.getManageTreesPopupTemplateForGuestAndParent=function(){var n="";return n+='<div class="marker-control-wrapper">',n+='<div class="marker-control-text btn-action evt-detail">',n+='<i class="fa fa-heartbeat fa-2x"><\/i><i class="fa fa-remove"><\/i><span id="text-rating" class="text-marker-control"><\/span>',n+="<\/div>",n+"<\/div>"},n.FoodSelectTemplate=function(){var n="";return n+='<select class="input-food selectpicker">',n+='<optgroup label="Food">',n+="<% _.each(foods.models, function (food) { %>",n+='<option value="<%= food.getId() %>"><%= food.getName() %><\/option>',n+="<% }); %>",n+="<\/optgroup>",n+"<\/select>"},n.TreeSelectTemplate=function(){var n="";return n+='<select class="input-tree selectpicker" data-size="10">',n+='<option value="0" disabled>Add a Tree<\/option>',n+='<optgroup label="Tree">',n+="<% _.each(trees.models, function (tree) { %>",n+="<% var food = FoodParent.Model.getFoods().findWhere({ id: tree.getFoodId() }); %>",n+='<option value="<%= tree.getId() %>"><%= food.getName() + " " + tree.getName() %><\/option>',n+="<% }); %>",n+="<\/optgroup>",n+"<\/select>"},n.getTreeInfoTemplate=function(){var n="";return n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="tree-info-coordinate"><div>@&nbsp;<\/div><div class="input-lat"><%= lat %><\/div>,&nbsp;<div class="input-lng"><%= lng %><\/div><\/div>',n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-user fa-1x"><\/i> Parents<\/div>',n+='<div class="info-group info-group-flex">',n+="<% _.each(persons.models, function (person, index) { %>",n+="<% if (index < persons.models.length - 1) { %>",n+="<div><%= person.getName() %>,&nbsp;<\/div>",n+="<% } else { %>",n+="<div><%= person.getName() %><\/div>",n+="<% } %>",n+="<% }); %>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-tag fa-1x"><\/i> Status<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(flags.models, function (flag) { %>",n+='<label class="btn flag-radio" data-target="<%= flag.getId() %>">',n+='<input type="checkbox" name="flag">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-home fa-1x"><\/i> Ownership<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(ownerships.models, function (ownership) { %>",n+='<label class="btn ownership-radio" data-target="<%= ownership.getId() %>">',n+='<input type="radio" name="ownership">',n+='<i class="fa fa-circle-o fa-1x"><\/i>',n+='<i class="fa fa-check-circle-o fa-1x"><\/i>',n+=" <%= ownership.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-activities" class="info-group">',n+="<div>&nbsp;<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button">',n+='<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-tree-detail"><i class="fa fa-heartbeat"><\/i> See Tree Detail<\/div><\/div>',n+='<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-manage-adoption"><i class="fa fa-user-plus"><\/i> Manage Adoption<\/div><\/div>',n+'<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-new-note"><i class="fa fa-sticky-note-o"><\/i> Post New Note<\/div><\/div>'},n.getTreeInfoTemplate2=function(){var n="";return n+='<div class="tree-info-name"><div class="info-group-flex"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+="<\/div>",n+='<div class="tree-info-coordinate">@&nbsp;&nbsp;&nbsp;&nbsp;<div class="input-lat"><%= lat %><\/div>,&nbsp;<div class="input-lng"><%= lng %><\/div><\/div>',n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="info-group info-group-flex">',n+='<i class="fa fa-sticky-note fa-1x"><\/i>&nbsp;&nbsp;&nbsp;&nbsp;<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="info-group info-group-flex"><i class="fa fa-user fa-1x"><\/i>&nbsp;&nbsp;&nbsp;&nbsp;',n+="<% _.each(persons.models, function (person, index) { %>",n+="<% if (index < persons.models.length - 1) { %>",n+="<div><%= person.getName() %>,&nbsp;<\/div>",n+="<% } else { %>",n+="<div><%= person.getName() %><\/div>",n+="<% } %>",n+="<% }); %>",n+="<\/div>",n+='<div class="info-group info-group-flex"><div class="button-group-tag"><i class="fa fa-tag fa-1x"><\/i>&nbsp;<\/div>',n+='<div data-toggle="buttons">',n+="<% _.each(flags.models, function (flag) { %>",n+='<label class="btn flag-radio" data-target="<%= flag.getId() %>">',n+='<input type="checkbox" name="flag">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+='<div class="info-group info-group-flex"><div class="button-group-tag"><i class="fa fa-home fa-1x"><\/i>&nbsp;<\/div>',n+='<div data-toggle="buttons">',n+="<% _.each(ownerships.models, function (ownership) { %>",n+='<label class="btn ownership-radio" data-target="<%= ownership.getId() %>">',n+='<input type="radio" name="ownership">',n+='<i class="fa fa-circle-o fa-1x"><\/i>',n+='<i class="fa fa-check-circle-o fa-1x"><\/i>',n+=" <%= ownership.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+"<\/div>"},n.getTreeInfoTemplate3=function(){var n="";return n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="tree-info-coordinate"><div>@&nbsp;<\/div><div class="input-lat"><%= lat %><\/div>,&nbsp;<div class="input-lng"><%= lng %><\/div><\/div>',n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-user fa-1x"><\/i> Parents<\/div>',n+='<div class="info-group info-group-flex">',n+="<% _.each(persons.models, function (person, index) { %>",n+="<% if (index < persons.models.length - 1) { %>",n+="<div><%= person.getName() %>,&nbsp;<\/div>",n+="<% } else { %>",n+="<div><%= person.getName() %><\/div>",n+="<% } %>",n+="<% }); %>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-activities" class="info-group">',n+="<div>&nbsp;<\/div>",n+"<\/div>"},n.getTreeInfoTemplateForGuest=function(){var n="";return n+='<div id="content-header">',n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="content-status">',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-tag fa-1x"><\/i> Status<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(flags.models, function (flag) { %>",n+='<label class="btn flag-radio" data-target="<%= flag.getId() %>">',n+='<input type="checkbox" name="flag">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-comments" class="info-group">',n+="<div>&nbsp;<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button">',n+='<div class="btn-white btn-small btn-action evt-detail"><i class="fa fa-heartbeat"><\/i> See Detail<\/div>',n+='<div class="btn-white btn-small btn-action evt-post"><i class="fa fa-sticky-note-o"><\/i> Post Note<\/div>',n+"<\/div>"},n.getUnadoptedTreeInfoTemplateForParent=function(){var n="";return n+='<div id="content-header">',n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="content-status">',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-tag fa-1x"><\/i> Status<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(flags.models, function (flag) { %>",n+='<label class="btn flag-radio" data-target="<%= flag.getId() %>">',n+='<input type="checkbox" name="flag">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-comments" class="info-group">',n+="<div>&nbsp;<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button">',n+='<div class="btn-white btn-small btn-action evt-detail"><i class="fa fa-heartbeat"><\/i> See Detail<\/div>',n+='<div class="btn-white btn-small btn-action evt-adopt"><i class="fa fa-user-plus"><\/i> Adopt Tree<\/div>',n+='<div class="btn-white btn-small btn-action evt-post"><i class="fa fa-sticky-note-o"><\/i> Post Note<\/div>',n+"<\/div>"},n.getAdoptedTreeInfoTemplateForParent=function(){var n="";return n+='<div id="content-header">',n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="content-status">',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-tag fa-1x"><\/i> Status<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(flags.models, function (flag) { %>",n+='<label class="btn flag-radio" data-target="<%= flag.getId() %>">',n+='<input type="checkbox" name="flag">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-comments" class="info-group">',n+="<div>&nbsp;<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button">',n+='<div class="btn-white btn-small btn-action evt-detail"><i class="fa fa-heartbeat"><\/i> See Detail<\/div>',n+='<div class="btn-white btn-small btn-action evt-unadopt"><i class="fa fa-user-times"><\/i> Unadopt Tree<\/div>',n+='<div class="btn-white btn-small btn-action evt-post"><i class="fa fa-sticky-note-o"><\/i> Post Note<\/div>',n+"<\/div>"},n.getAdoptedTreeInfoTemplateForAdmin=function(){var n="";return n+='<div id="content-header">',n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+='<div class="tree-info-coordinate"><div>@&nbsp;<\/div><div class="input-lat"><%= lat %><\/div>,&nbsp;<div class="input-lng"><%= lng %><\/div><\/div>',n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-user fa-1x"><\/i> Parents<\/div>',n+='<div class="info-group info-group-flex btn-action evt-manage-adopt">',n+="<% _.each(persons.models, function (person, index) { %>",n+="<% if (index < persons.models.length - 1) { %>",n+="<div><%= person.getName() %>,&nbsp;<\/div>",n+="<% } else { %>",n+="<div><%= person.getName() %><\/div>",n+="<% } %>",n+="<% }); %>",n+="<\/div>",n+='<div class="content-status">',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-tag fa-1x"><\/i> Status<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(flags.models, function (flag) { %>",n+='<label class="btn flag-radio" data-target="<%= flag.getId() %>">',n+='<input type="checkbox" name="flag">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-home fa-1x"><\/i> Ownership<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(ownerships.models, function (ownership) { %>",n+='<label class="btn ownership-radio" data-target="<%= ownership.getId() %>">',n+='<input type="radio" name="ownership">',n+='<i class="fa fa-circle-o fa-1x"><\/i>',n+='<i class="fa fa-check-circle-o fa-1x"><\/i>',n+=" <%= ownership.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-comments" class="info-group">',n+="<div>&nbsp;<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button">',n+='<div class="btn-white btn-small btn-action evt-detail"><i class="fa fa-heartbeat"><\/i> See Detail<\/div>',n+='<div class="btn-white btn-small btn-action evt-unadopt"><i class="fa fa-user-times"><\/i> Unadopt Tree<\/div>',n+='<div class="btn-white btn-small btn-action evt-post"><i class="fa fa-sticky-note-o"><\/i> Post Note<\/div>',n+"<\/div>"},n.getUnadoptedTreeInfoTemplateForAdmin=function(){var n="";return n+='<div id="content-header">',n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+='<div class="tree-info-coordinate"><div>@&nbsp;<\/div><div class="input-lat"><%= lat %><\/div>,&nbsp;<div class="input-lng"><%= lng %><\/div><\/div>',n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-user fa-1x"><\/i> Parents<\/div>',n+='<div class="info-group info-group-flex  btn-action evt-manage-adopt">',n+="<% _.each(persons.models, function (person, index) { %>",n+="<% if (index < persons.models.length - 1) { %>",n+="<div><%= person.getName() %>,&nbsp;<\/div>",n+="<% } else { %>",n+="<div><%= person.getName() %><\/div>",n+="<% } %>",n+="<% }); %>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-tag fa-1x"><\/i> Status<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(flags.models, function (flag) { %>",n+='<label class="btn flag-radio" data-target="<%= flag.getId() %>">',n+='<input type="checkbox" name="flag">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-home fa-1x"><\/i> Ownership<\/div>',n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+="<% _.each(ownerships.models, function (ownership) { %>",n+='<label class="btn ownership-radio" data-target="<%= ownership.getId() %>">',n+='<input type="radio" name="ownership">',n+='<i class="fa fa-circle-o fa-1x"><\/i>',n+='<i class="fa fa-check-circle-o fa-1x"><\/i>',n+=" <%= ownership.getName() %><\/label>",n+="<% }); %>",n+="<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-comments" class="info-group">',n+="<div>&nbsp;<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button">',n+='<div class="btn-white btn-small btn-action evt-detail"><i class="fa fa-heartbeat"><\/i> See Detail<\/div>',n+='<div class="btn-white btn-small btn-action evt-adopt"><i class="fa fa-user-plus"><\/i> Adopt Tree<\/div>',n+='<div class="btn-white btn-small btn-action evt-post"><i class="fa fa-sticky-note-o"><\/i> Post Note<\/div>',n+"<\/div>"},n.getTreeInfoTemplate4=function(){var n="";return n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-activities" class="info-group">',n+="<div>&nbsp;<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button">',n+='<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-tree-detail"><i class="fa fa-heartbeat"><\/i> See Tree Detail<\/div><\/div>',n+='<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-tree-adopt"><i class="fa  fa-user-plus"><\/i> Adopt This Tree<\/div><\/div>',n+='<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-new-note"><i class="fa fa-sticky-note-o"><\/i> Post New Note<\/div><\/div>',n+"<\/div>"},n.getTreeInfoTemplate5=function(){var n="";return n+='<div class="tree-info-name"><div class="input-food"><%= foodname %><\/div>&nbsp;<%= treename %><\/div>',n+='<div class="info-group">',n+='<div class="input-address">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-sticky-note fa-1x"><\/i> Description<\/div>',n+='<div class="info-group">',n+='<div class="input-description"><%= description %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-activities" class="info-group">',n+="<div>&nbsp;<\/div>",n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button">',n+='<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-tree-detail"><i class="fa fa-heartbeat"><\/i> See Tree Detail<\/div><\/div>',n+='<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-tree-unadopt"><i class="fa  fa-user-times"><\/i> Unadopt This Tree<\/div><\/div>',n+='<div class="button-outer-frame2 button5"><div class="button-inner-frame2 button-new-note"><i class="fa fa-sticky-note-o"><\/i> Post New Note<\/div><\/div>',n+"<\/div>"},n.getRecentActivitiesTemplate=function(){var n="";return n+="<% _.each(notes.models, function (note, index) { %>",n+="<% if (index < size) { %>",n+="<% var person = FoodParent.Model.getPersons().findWhere({id: note.getPersonId() }); %>",n+="<% if (person != undefined) { %>",n+='<% if (person.getName() != "") { %>',n+='<div class="item-activity"><i class="fa fa-caret-right fa-1x"><\/i> <div><span class="treeinfocomment">"<%= note.getComment() %>"<\/span> by <i><%= person.getName() %><\/i> (<%= note.getFormattedDate() %>)<\/div><\/div>',n+="<% } else { %>",n+='<div class="item-activity"><i class="fa fa-caret-right fa-1x"><\/i> <div><span class="treeinfocomment">"<%= note.getComment() %>"<\/span> by <i><%= person.getContact() %><\/i> (<%= note.getFormattedDate() %>)<\/div><\/div>',n+="<% } %>",n+="<% } else { %>",n+='<div class="item-activity"><i class="fa fa-caret-right fa-1x"><\/i> <div><span class="treeinfocomment">"<%= note.getComment() %>"<\/span> (<%= note.getFormattedDate() %>)<\/div><\/div>',n+="<% } %>",n+="<% } %>",n+"<% }); %>"},n.getRecentCommentsTemplate=function(){var n="";return n+="<% _.each(notes.models, function (note, index) { %>",n+="<% if (index < size) { %>",n+="<% var person = FoodParent.Model.getPersons().findWhere({id: note.getPersonId() }); %>",n+="<% if (person != undefined) { %>",n+='<% if (person.getName() != "") { %>',n+='<div class="item-activity"><i class="fa fa-caret-right fa-1x"><\/i> <div><span class="treeinfocomment">"<%= note.getComment() %>"<\/span> by <i><%= person.getName() %><\/i> (<%= note.getFormattedDate() %>)<\/div><\/div>',n+="<% } else { %>",n+='<div class="item-activity"><i class="fa fa-caret-right fa-1x"><\/i> <div><span class="treeinfocomment">"<%= note.getComment() %>"<\/span> by <i><%= person.getContact() %><\/i> (<%= note.getFormattedDate() %>)<\/div><\/div>',n+="<% } %>",n+="<% } else { %>",n+='<div class="item-activity"><i class="fa fa-caret-right fa-1x"><\/i> <div><span class="treeinfocomment">"<%= note.getComment() %>"<\/span> (<%= note.getFormattedDate() %>)<\/div><\/div>',n+="<% } %>",n+="<% } %>",n+"<% }); %>"},n.getTreesFilterListTemplateForGuest=function(){var n="";return n+='<div class="frame-inner">',n+='<div class="text-header"><%= header %> <span class="icon-header evt-reset-filter"><i class="fa fa-refresh"><\/i><\/span><\/div>',n+='<div id="content-filter-list">',n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Adoption<\/div>',n+='<div class="btn-green btn-small btn-filter filter-adopt-all active">Adopted & Unadopted<\/div>',n+='<div class="info-button-group">',n+='<div class="btn-green btn-small btn-filter filter-adopt-item" data-id="1">Adopted<\/div>',n+='<div class="btn-green btn-small btn-filter filter-adopt-item" data-id="0">Unadopted<\/div>',n+="<\/div>",n+="<hr />",n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Owndership<\/div>',n+='<div class="btn-green btn-small btn-filter filter-owner-all active">All Ownerships<\/div>',n+='<div class="info-button-group">',n+="<% _.each(ownerships.models, function (ownership) { %>",n+='<div class="btn-green btn-small btn-filter filter-owner-item" data-id="<%= ownership.getId() %>"><%= ownership.getName() %><\/div>',n+="<% }); %>",n+="<\/div>",n+="<hr />",n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Status<\/div>',n+='<div class="btn-green btn-small btn-filter filter-flag-all active">All Statuses<\/div>',n+='<div class="info-button-group">',n+='<div class="btn-green btn-small btn-filter filter-flag-item" data-id="0">*Unknown<\/div>',n+="<% _.each(flags.models, function (flag) { %>",n+='<div class="btn-green btn-small btn-filter filter-flag-item" data-id="<%= flag.getId() %>"><%= flag.getName() %><\/div>',n+="<% }); %>",n+="<\/div>",n+="<hr />",n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Rating<\/div>',n+='<div class="btn-green btn-small btn-filter filter-rating-all active">All Ratings<\/div>',n+='<div class="info-button-group">',n+="<% for (var i=0; i<=10; i++) { %>",n+='<div class="btn-green btn-small btn-filter filter-rating-item" data-id="<%= i %>"><i class="fa fa-star"><\/i> x <%= i %><\/div>',n+="<% }; %>",n+="<\/div>",n+="<hr />",n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Last Updated<\/div>',n+='<div class="btn-green btn-small btn-filter filter-last-all active">All Dates<\/div>',n+='<div class="info-button-group">',n+='<div class="btn-green btn-small btn-filter filter-last-item" data-id="0">~1 week<\/div>',n+='<div class="btn-green btn-small btn-filter filter-last-item" data-id="1">~2 weeks<\/div>',n+='<div class="btn-green btn-small btn-filter filter-last-item" data-id="2">~1 month<\/div>',n+='<div class="btn-green btn-small btn-filter filter-last-item" data-id="3">~3 months<\/div>',n+='<div class="btn-green btn-small btn-filter filter-last-item" data-id="4">~6 months<\/div>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getTreesFilterListTemplateForParent=function(){return n.getTreesFilterListTemplateForGuest()},n.getTreesFilterListTemplateForAdmin=function(){return n.getTreesFilterListTemplateForGuest()},n.getTreeFilterListTemplate=function(){var n="";return n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox list-hiearchy1">',n+='<input type="checkbox" name="onlymine" data-target="<%= userid %>">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" My children (only mine / show all)<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="adoptsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Adopting Status (show all / hide)<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-adopt active list-hiearchy2">',n+='<input type="checkbox" name="1" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Assigned<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-adopt active list-hiearchy2">',n+='<input type="checkbox" name="0" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Unassigned<\/label>",n+="<\/div>",n+="<hr />",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="ownershipsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Onwership Type (show all / hide)<\/label>",n+="<\/div>",n+="<% _.each(ownerships.models, function (ownership) { %>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-ownership active list-hiearchy2">',n+='<input type="checkbox" name="<%= ownership.getId() %>" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= ownership.getName() %><\/label>",n+="<\/div>",n+="<% }); %>",n+="<hr />",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="flagsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Flag Type (show all / hide)<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-flag active list-hiearchy2">',n+='<input type="checkbox" name="0" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" *unknown<\/label>",n+="<\/div>",n+="<% _.each(flags.models, function (flag) { %>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-flag active list-hiearchy2">',n+='<input type="checkbox" name="<%= flag.getId() %>" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<\/div>",n+="<% }); %>",n+="<hr />",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="foodsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Food Type (show all / hide)<\/label>",n+="<\/div>",n+="<% _.each(foods.models, function (food) { %>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-food active list-hiearchy2">',n+='<input type="checkbox" name="<%= food.getId() %>" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= food.getName() %><\/label>",n+="<\/div>",n+"<% }); %>"},n.getTreeFilterListTemplate2=function(){var n="";return n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="adoptsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Adopting Status (show all / hide)<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-adopt active list-hiearchy2">',n+='<input type="checkbox" name="1" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Assigned<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-adopt active list-hiearchy2">',n+='<input type="checkbox" name="0" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Unassigned<\/label>",n+="<\/div>",n+="<hr />",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="ownershipsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Onwership Type (show all / hide)<\/label>",n+="<\/div>",n+="<% _.each(ownerships.models, function (ownership) { %>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-ownership active list-hiearchy2">',n+='<input type="checkbox" name="<%= ownership.getId() %>" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= ownership.getName() %><\/label>",n+="<\/div>",n+="<% }); %>",n+="<hr />",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="flagsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Flag Type (show all / hide)<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-flag active list-hiearchy2">',n+='<input type="checkbox" name="0" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" *unknown<\/label>",n+="<\/div>",n+="<% _.each(flags.models, function (flag) { %>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-flag active list-hiearchy2">',n+='<input type="checkbox" name="<%= flag.getId() %>" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= flag.getName() %><\/label>",n+="<\/div>",n+="<% }); %>",n+="<hr />",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="foodsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Food Type (show all / hide)<\/label>",n+="<\/div>",n+="<% _.each(foods.models, function (food) { %>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-food active list-hiearchy2">',n+='<input type="checkbox" name="<%= food.getId() %>" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= food.getName() %><\/label>",n+="<\/div>",n+"<% }); %>"},n.getPersonFilterListTemplate=function(){var n="";return n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="adoptsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Adopting Status (show all / hide)<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-adopt active list-hiearchy2">',n+='<input type="checkbox" name="1" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Adopt<\/label>",n+="<\/div>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-adopt active list-hiearchy2">',n+='<input type="checkbox" name="0" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Unadopt<\/label>",n+="<\/div>",n+="<hr />",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox active list-hiearchy1">',n+='<input type="checkbox" name="authsall" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" Auth Type (show all / hide)<\/label>",n+="<\/div>",n+="<% _.each(auths.models, function (auth) { %>",n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox filter-auth active list-hiearchy2">',n+='<input type="checkbox" name="<%= auth.getId() %>" checked>',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" <%= auth.getName() %><\/label>",n+="<\/div>",n+"<% }); %>"},n.getAdoptionFilterListTemplate=function(){var n="";return n+='<div class="text-header"><%= header %> <span class="icon-header evt-reset-filter"><i class="fa fa-refresh"><\/i><\/span><\/div>',n+='<div id="content-adoptionfilter">',n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Parenting<\/div>',n+='<div class="btn-green btn-small btn-filter filter-parenting-all active">Parenting & Non-Parenting<\/div>',n+='<div class="info-button-group">',n+='<div class="btn-green btn-small btn-filter filter-parenting-item" data-id="1">Parenting<\/div>',n+='<div class="btn-green btn-small btn-filter filter-parenting-item" data-id="0">Non-Parenting<\/div>',n+="<\/div>",n+="<hr />",n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Authorization<\/div>',n+='<div class="btn-green btn-small btn-filter filter-auth-all active">All Authorizations<\/div>',n+='<div class="info-button-group">',n+="<% _.each(auths.models, function (auth) { %>",n+='<div class="btn-green btn-small btn-filter filter-auth-item" data-id="<%= auth.getId() %>"><%= auth.getName() %><\/div>',n+="<% }); %>",n+="<\/div>",n+"<\/div>"},n.getAdoptTreeCellTemplate=function(){var n="";return n+="<% _.each(trees.models, function (tree) { %>",n+="<% var food = FoodParent.Model.getFoods().findWhere({ id: tree.getFoodId() }); %>",n+="<% var name = food.getName() + tree.getName(); %>",n+='<div class="btn-tree" data-target="<%= tree.getId() %>"><%= name %><\/div>',n+"<% }); %>"},n.getAdoptPersonCellTemplate=function(){var n="";return n+="<% _.each(persons.models, function (person) { %>",n+='<div class="btn-tree" data-target="<%= person.getId() %>"><%= person.getName() %><\/div>',n+"<% }); %>"},n.getTreesTableViewTemplateForAdmin=function(){var n="";return n+='<div id="wrapper-tree-list" class="frame-pop">',n+='<div id="frame-tree-list">',n+='<div id="content-header">',n+='<div class="text-header"><%= header %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+="<hr />",n+='<div class="frame-flex-group">',n+='<div class="tree-filter">',n+="<\/div>",n+='<div id="content-tree-list">',n+='<div class="btn-brown btn-medium btn-action evt-add-tree"><i class="fa fa-plus-square"><\/i> Add New Tree<\/div>',n+='<div class="info-group">',n+='<div class="new-tree hidden"><\/div>',n+="<\/div>",n+='<div class="info-group">',n+='<div class="list-tree">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getAdoptionManageViewTemplateForAdmin=function(){var n="";return n+='<div id="wrapper-manage-adoption" class="frame-pop">',n+='<div id="content-header">',n+='<div class="text-header"><%= header %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+="<hr />",n+='<div class="frame-flex-group">',n+='<div class="adoption-filter">',n+="<\/div>",n+='<div id="content-manage-adoption">',n+='<div class="info-group">',n+='<div class="text-label"><i class="fa fa-caret-right"><\/i>  Click <i class="fa fa-plus-square fa-1x"><\/i> or <i class="fa fa-minus-square fa-1x"><\/i> icon to assign (or unassign) a parent for <strong><i><%= treename %><\/i><\/strong>.<\/div>',n+="<\/div>",n+='<div class="info-group">',n+='<div class="list-adoption" data-target="<%= treeId %>">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getDetailMenuTemplate=function(){var n="";return n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-back-map"><i class="fa fa-arrow-left"><\/i> Back To Tree List<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-new-note"><i class="fa fa-sticky-note-o"><\/i> Post New Note<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-manage-adoption"><i class="fa  fa-user-plus"><\/i> Manage Adoption<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-delete-tree"><i class="fa fa-remove"><\/i> Delete Tree*<\/div><\/div>',n+'<div class="button-description2">* marked operation cannot be undone.<\/div>'},n.getDetailMenuTemplate2=function(){var n="";return n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-back-map"><i class="fa fa-arrow-left"><\/i> Back To List<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-tree-adopt"><i class="fa  fa-user-plus"><\/i> Adopt This Tree<\/div><\/div>',n+'<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-new-note"><i class="fa fa-sticky-note-o"><\/i> Post New Note<\/div><\/div>'},n.getDetailMenuTemplate3=function(){var n="";return n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-back-map"><i class="fa fa-arrow-left"><\/i> Back To List<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-tree-unadopt"><i class="fa  fa-user-times"><\/i> Unadopt This Tree<\/div><\/div>',n+'<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-new-note"><i class="fa fa-sticky-note-o"><\/i> Post New Note<\/div><\/div>'},n.getDetailTreeGraphicViewTemplate=function(){var n="";return n+='<div id="wrapper-mtree">',n+='<div id="wrapper-graph">',n+='<div id="wrapper-chart"><\/div>',n+='<div id="wrapper-tooltip" class="hidden"><\/div>',n+='<div id="wrapper-mapmenu">',n+="<\/div>",n+='<div id="wrapper-date-select">',n+='<div class="wrapper-date-preset">',n+='<div class="button-outer-frame2 button3 date-preset 2years"><div class="button-inner-frame2">2 Year<\/div><\/div>',n+='<div class="button-outer-frame2 button3 date-preset 1years"><div class="button-inner-frame2">1 Year<\/div><\/div>',n+='<div class="button-outer-frame2 button3 date-preset 6months"><div class="button-inner-frame2">6 months<\/div><\/div>',n+='<div class="button-outer-frame2 button3 date-preset 3months"><div class="button-inner-frame2">3 months<\/div><\/div>',n+='<div class="button-outer-frame2 button3 date-preset 1month"><div class="button-inner-frame2">1 month<\/div><\/div>',n+="<\/div>",n+='<div class="wrapper-date-select-item"><input type="text" class="form-control tree-graph-start" /><\/div>',n+='<div class="wrapper-date-select-item"><span class="date-select-label">~<\/span><input type="text" class="form-control tree-graph-end" /><\/div>',n+="<\/div>",n+="<\/div>",n+='<div id="wrapper-tree-detail">',n+='<div class="content-tree-info">',n+="<\/div>",n+='<div class="content-tree-recentcomments">',n+='<div class="info-header"><i class="fa fa-comments fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-comments" class="info-group">',n+="<\/div>",n+="<\/div>",n+='<div class="content-tree-recentactivities">',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Changes<\/div>',n+='<div id="list-activities" class="info-group">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getTreeGraphicViewTemplate=function(){var n="";return n+='<div id="wrapper-tree">',n+='<div id="wrapper-graph">',n+='<div id="wrapper-chart">',n+="<\/div>",n+='<div id="wrapper-tooltip" class="hidden">',n+="<\/div>",n+='<div id="content-treemenu">',n+="<\/div>",n+='<div id="wrapper-date-select">',n+='<div class="wrapper-date-preset">',n+='<div class="btn-brown btn-small btn-date 2years">2 Year<\/div>',n+='<div class="btn-brown btn-small btn-date 1years">1 Year<\/div>',n+='<div class="btn-brown btn-small btn-date 6months">6 months<\/div>',n+='<div class="btn-brown btn-small btn-date 3months">3 months<\/div>',n+='<div class="btn-brown btn-small btn-date 1month">1 month<\/div>',n+="<\/div>",n+='<div class="wrapper-date-select-item"><input type="text" class="form-control tree-graph-start" /><\/div>',n+='<div class="wrapper-date-select-item"><span class="date-select-label">~<\/span><input type="text" class="form-control tree-graph-end" /><\/div>',n+="<\/div>",n+="<\/div>",n+='<div id="wrapper-treedetail">',n+='<div class="content-tree-basicinfo">',n+="<\/div>",n+='<div class="content-tree-recentcomments">',n+='<div class="text-header"><i class="fa fa-comments fa-1x"><\/i> Recent Comments<\/div>',n+='<div id="list-comments" class="info-group">',n+="<\/div>",n+="<\/div>",n+='<div class="content-tree-recentactivities">',n+='<div class="text-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Changes<\/div>',n+='<div id="list-activities" class="info-group">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getToolTipTemplate=function(){var n="";return n+='<img src="<%= image %>" />',n+='<div class="rate"><i class="fa fa-star-half-o"><\/i> <%= value %><\/div>',n+='<div class="comment"><i class="fa fa-comment"><\/i> <%= comment %><\/div>',n+'<div class="date"><%= date %><\/div>'},n.getToolTipTemplate2=function(){var n="";return n+='<div class="rate"><%= value %> libs. <span class="startdate">from <%= startdate %><\/span><\/div>',n+='<img src="<%= image %>" />',n+='<div class="comment"><i class="fa fa-ambulance"><\/i> <%= comment %><\/div>',n+'<div class="date"><%= date %><\/div>'},n.getImageNoteViewTemplate=function(){var n="";return n+='<div id="wrapper-note">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div class="wrapper-note-content">',n+='<div class="image-wrapper">',n+='<div class="wrapper-input-upload-picture">',n+='<input class="input-upload-picture fileupload" type="file" accept="image/*" capture="camera" />',n+="<\/div>",n+='<div class="wrapper-uploading-picture hidden">',n+='<div class="uploading-picture">Uploading...<\/div>',n+="<\/div>",n+='<div class="info-header"><i class="fa fa-image"><\/i> Select Cover Picture<\/div>',n+='<div class="image-group"><\/div>',n+="<\/div>",n+='<div class="wrapper-note-info">',n+='<div class="name"><%= name %><\/div>',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 prev-note"><i class="fa fa-caret-left"><\/i><\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 next-note"><i class="fa fa-caret-right"><\/i><\/div><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-star-half-o"><\/i> Rating<\/div>',n+='<div class="info-group">',n+='<div class="input-rating"><%= value %><\/div>',n+='<div class="input-rating-slider"><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-comment"><\/i> Comment<\/div>',n+='<div class="info-group">',n+='<div class="input-comment"><%= comment %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-calendar-o"><\/i> Date<\/div>',n+='<div class="info-group">',n+='<input type="text" class="form-control input-date" />',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-user"><\/i> Author<\/div>',n+='<div class="info-group">',n+='<div class="input-author"><%= author %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 delete-note"><i class="fa fa-remove"><\/i> Delete<\/div><\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getImageNoteViewTemplate2=function(){var n="";return n+='<div id="wrapper-note">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div class="wrapper-note-content">',n+='<div class="image-wrapper">',n+='<div class="image-group"><\/div>',n+="<\/div>",n+='<div class="wrapper-note-info">',n+='<div class="name"><%= name %><\/div>',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 prev-note"><i class="fa fa-caret-left"><\/i><\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 next-note"><i class="fa fa-caret-right"><\/i><\/div><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-star-half-o"><\/i> Rating<\/div>',n+='<div class="info-group">',n+='<div class="input-rating"><%= value %><\/div>',n+='<div class="input-rating-slider"><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-comment"><\/i> Comment<\/div>',n+='<div class="info-group">',n+='<div class="text-comment"><%= comment %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-calendar-o"><\/i> Date<\/div>',n+='<div class="info-group">',n+='<div class="text-date"><%= date %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-user"><\/i> Author<\/div>',n+='<div class="info-group">',n+='<div class="input-author"><%= author %><\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getPostNoteViewTemplate=function(){var n="";return n+='<div id="wrapper-note">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div class="wrapper-post-note-content">',n+='<div class="image-wrapper">',n+='<div class="wrapper-input-upload-picture">',n+='<input class="input-upload-picture fileupload" type="file" accept="image/*" capture="camera" />',n+="<\/div>",n+='<div class="wrapper-uploading-picture hidden">',n+='<div class="uploading-picture">Uploading...<\/div>',n+="<\/div>",n+='<div class="info-header"><i class="fa fa-image"><\/i> Select Cover Picture<\/div>',n+='<div class="image-group"><\/div>',n+="<\/div>",n+='<div class="wrapper-note-info">',n+='<div class="name"><%= name %><\/div>',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-star-half-o"><\/i> Rating<\/div>',n+='<div class="info-group">',n+='<div class="input-rating"><\/div>',n+='<div class="input-rating-slider"><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-comment"><\/i> Comment<\/div>',n+='<div class="info-group">',n+='<div class="input-comment">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-calendar-o"><\/i> Date<\/div>',n+='<div class="info-group">',n+='<input type="text" class="form-control input-date" />',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-user"><\/i> Author<\/div>',n+='<div class="info-group">',n+='<div class="input-author"><%= author %><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 create-note"><i class="fa fa-save"><\/i> Save<\/div><\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getPostNoteViewTemplate2=function(){var n="";return n+='<div id="wrapper-note">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div class="wrapper-post-note-content">',n+='<div class="image-wrapper">',n+='<div class="wrapper-input-upload-picture">',n+='<input class="input-upload-picture fileupload" type="file" accept="image/*" capture="camera" />',n+="<\/div>",n+='<div class="wrapper-uploading-picture hidden">',n+='<div class="uploading-picture">Uploading...<\/div>',n+="<\/div>",n+='<div class="info-header"><i class="fa fa-image"><\/i> Select Cover Picture<\/div>',n+='<div class="image-group"><\/div>',n+="<\/div>",n+='<div class="wrapper-note-info">',n+='<div class="name"><%= name %><\/div>',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-star-half-o"><\/i> Rating<\/div>',n+='<div class="info-group">',n+='<div class="input-rating"><\/div>',n+='<div class="input-rating-slider"><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-comment"><\/i> Comment<\/div>',n+='<div class="info-group">',n+='<div class="input-comment">&nbsp;<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-calendar-o"><\/i> Date<\/div>',n+='<div class="info-group">',n+='<input type="text" class="form-control input-date" />',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-user"><\/i> Author\'s E-mail Address<\/div>',n+='<div class="info-group">',n+='<input type="email" name="email" class="form-control input-author" placeholder="e-mail address" autocomplete="on"/>',n+='<div class="button-description2">* The <strong>e-mail address<\/strong> that you enter will be stored as a perspective foodparent. You can <strong>become a parent<\/strong> using the same e-mail address that you provide.<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 create-note"><i class="fa fa-save"><\/i> Save<\/div><\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getManageDonationsTableViewTemplate=function(){var n="";return n+='<div id="wrapper-mdonations">',n+='<div id="wrapper-mdonations-table">',n+='<div id="wrapper-tablemenu">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 switch-map">Switch to Map View<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 add-location">Add A New Location<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 collapsible-button" data-target="#filter-list">Filter List<\/div><\/div>',n+='<div id="filter-list" class="collapsible-list">',n+="<\/div>",n+="<\/div>",n+='<div id="content-location-table">',n+='<div class="new-location hidden">',n+="<\/div>",n+='<div class="list-title">List of Locations<\/div>',n+='<div class="list-location">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getManageDonationViewTemplate=function(){var n="";return n+='<div id="wrapper-manage-donation">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div id="wrapper-manage-donation-table">',n+='<div id="wrapper-tablemenu">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 switch-map">Switch to Map View<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 collapsible-button" data-target="#filter-list">Filter List<\/div><\/div>',n+='<div id="filter-list" class="collapsible-list">',n+="<\/div>",n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 collapsible-button" data-target="#forage-list">Foragable List<\/div><\/div>',n+='<div id="forage-list" class="collapsible-list hidden">',n+="<\/div>",n+="<\/div>",n+='<div id="content-manage-adoption-table">',n+='<div class="view-title">Food Donation<\/div>',n+='<div class="view-description">Click <i class="fa fa-plus-square fa-1x"><\/i> icon to donate food for <strong><i><%= placename %><\/i><\/strong>.<\/div>',n+='<div id="list-donation" class="list-donation" data-target="<%= placeid %>"><\/div>',n+="<hr>",n+='<div class="new-donation" data-target="<%= placeid %>"><\/div>',n+='<div class="wrapper-input-upload-picture">',n+='<input class="input-upload-picture fileupload" type="file" accept="image/*" capture="camera" />',n+="<\/div>",n+='<div class="wrapper-uploading-picture hidden">',n+='<div class="uploading-picture">Uploading...<\/div>',n+="<\/div>",n+='<div class="info-header"><i class="fa fa-image"><\/i> Select Cover Picture<\/div>',n+='<div class="image-group"><\/div>',n+="<hr>",n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-submit-donation">Submit Donations<\/div><\/div>',n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getAddNewDonationTreeTemplate=function(){var n="";return n+="<% _.each(trees, function (tree) { %>",n+="<% var food = FoodParent.Model.getFoods().findWhere({ id: tree.getFoodId() }); %>",n+='<div class="cell-link cell-tree-detail" data-target="<%= tree.getId() %>"><%= food.getName() + " " + tree.getName() %><i class="fa fa-remove fa-1x"><\/i><\/div>',n+"<% }); %>"},n.getDetailDonationGraphicViewTemplate=function(){var n="";return n+='<div id="wrapper-mdonation">',n+='<div id="wrapper-graph">',n+='<div id="wrapper-chart"><\/div>',n+='<div id="wrapper-tooltip" class="hidden"><\/div>',n+='<div id="wrapper-mapmenu">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2"><i class="fa fa-arrow-left"><\/i> Back to List<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-new-donation"><i class="fa fa-sticky-note-o"><\/i> Post New Donation<\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 button-delete-location"><i class="fa fa-remove"><\/i> Delete Place*<\/div><\/div>',n+='<div class="button-description2">* marked operation cannot be undone.<\/div>',n+="<\/div>",n+='<div id="wrapper-date-select">',n+='<div class="wrapper-date-preset">',n+='<div class="button-outer-frame2 button3 date-preset 2years"><div class="button-inner-frame2">2 Year<\/div><\/div>',n+='<div class="button-outer-frame2 button3 date-preset 1years"><div class="button-inner-frame2">1 Year<\/div><\/div>',n+='<div class="button-outer-frame2 button3 date-preset 6months"><div class="button-inner-frame2">6 months<\/div><\/div>',n+='<div class="button-outer-frame2 button3 date-preset 3months"><div class="button-inner-frame2">3 months<\/div><\/div>',n+='<div class="button-outer-frame2 button3 date-preset 1month"><div class="button-inner-frame2">1 month<\/div><\/div>',n+="<\/div>",n+='<div class="wrapper-date-select-item"><input type="text" class="form-control donation-graph-start" /><\/div>',n+='<div class="wrapper-date-select-item"><span class="date-select-label">~<\/span><input type="text" class="form-control donation-graph-end" /><\/div>',n+="<\/div>",n+="<\/div>",n+='<div id="wrapper-donation-detail">',n+='<div class="content-donation-info">',n+="<\/div>",n+='<div class="content-donation-recentdonations">',n+='<div class="info-header"><i class="fa fa-leaf fa-1x"><\/i> Recent Donations<\/div>',n+='<div id="list-donations" class="info-group">',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getPlaceInfoTemplate2=function(){var n="";return n+='<div class="donation-info-name"><div class="info-group-flex"><div class="input-food"><%= placename %><\/div><\/div>',n+='<div class="donation-info-coordinate">@&nbsp;<div class="input-lat"><%= lat %><\/div>,&nbsp;<div class="input-lng"><%= lng %><\/div><\/div>',n+="<\/div>",n+='<div class="donation-info-address"><div>&nbsp;<\/div><\/div>',n+='<div class="info-group info-group-flex">',n+='<i class="fa fa-sticky-note fa-1x"><\/i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<div class="input-description"><%= description %><\/div>',n+"<\/div>"},n.getRecentDonationsTemplate=function(){var n="";return n+="<% _.each(donations.models, function (donation, index) { %>",n+="<% if (index < size) { %>",n+='<div class="item-activity"><i class="fa fa-caret-right fa-1x"><\/i> <div><%= donation.getCommentWithDate() %><\/div><\/div>',n+="<% } %>",n+"<% }); %>"},n.getEditDonationViewTemplate=function(){var n="";return n+='<div id="wrapper-donation">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div class="wrapper-note-content">',n+='<div class="image-wrapper">',n+='<div class="wrapper-input-upload-picture">',n+='<input class="input-upload-picture fileupload" type="file" accept="image/*" capture="camera" />',n+="<\/div>",n+='<div class="wrapper-uploading-picture hidden">',n+='<div class="uploading-picture">Uploading...<\/div>',n+="<\/div>",n+='<div class="info-header"><i class="fa fa-image"><\/i> Select Cover Picture<\/div>',n+='<div class="image-group"><\/div>',n+="<\/div>",n+='<div class="wrapper-note-info">',n+='<div class="name"><%= name %><\/div>',n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 prev-note"><i class="fa fa-caret-left"><\/i><\/div><\/div>',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 next-note"><i class="fa fa-caret-right"><\/i><\/div><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-ambulance"><\/i> Amount<\/div>',n+='<div class="info-group">',n+='<div class="input-amount"><%= amount %> lbs.<\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-ambulance"><\/i> Trees<\/div>',n+='<div class="info-group">',n+='<div class="new-donation-trees"><\/div>',n+='<div class="add-donation-tree"><\/div>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-header"><i class="fa fa-calendar-o"><\/i> Date<\/div>',n+='<div class="info-group">',n+='<input type="text" class="form-control input-date" />',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 delete-donation"><i class="fa fa-remove"><\/i> Delete<\/div><\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getLogInViewTemplate=function(){var n="";return n+='<div id="wrapper-login" class="frame-pop">',n+='<div id="frame-login">',n+='<div id="content-header">',n+='<div class="text-header"><%= header %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+="<hr />",n+='<div id="content-login">',n+='<div class="info-group">',n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Please put your e-mail address to log in.<\/div>',n+="<\/div>",n+='<div class="info-group">',n+='<input type="email" name="email" class="form-control input-contact" placeholder="e-mail address" autocomplete="on"/>',n+="<\/div>",n+='<div class="info-group invisible">',n+='<input type="password" name="password" class="form-control input-password" placeholder="password"/>',n+="<\/div>",n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+='<label class="btn evt-manager">',n+='<input type="checkbox" name="manager" />',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" I am a manager",n+="<\/label>",n+="<\/div>",n+="<\/div>",n+="<hr />",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-submit">Submit<\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-close">Cancel<\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getAccountViewTemplateForParent=function(){var n="";return n+='<div id="wrapper-login" class="frame-pop">',n+='<div id="frame-login">',n+='<div id="content-header">',n+='<div class="text-header"><%= header %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+="<hr />",n+='<div id="content-login">',n+='<div class="info-group">',n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> <i>Account: <\/i><strong><%= contact %><\/strong><\/div>',n+="<\/div>",n+="<hr />",n+='<div class="info-group">',n+='<div class="text-label"><i class="fa fa-caret-right"><\/i> Information<\/div>',n+="<\/div>",n+='<div class="info-group">',n+='<input type="text" class="form-control input-name" placeholder="first & last name" />',n+="<\/div>",n+='<div class="info-group">',n+='<input type="text" class="form-control input-neighborhood" placeholder="name of place near you (street, park)" />',n+="<\/div>",n+="<hr />",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-logout">Log Out<\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-detail">See Parent Detail<\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-close">Cancel<\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getAccountViewTemplateForAdmin=function(){return n.getAccountViewTemplateForParent()},n.getLoggedInViewTemplate=function(){var n="";return n+='<div id="wrapper-login" class="frame-pop">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div class="wrapper-login-content">',n+='<div class="info-group">',n+='<div class="name"><i>You are logged in as <\/i><strong><%= contact %><\/strong><\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 logged-logout">Log Out<\/div><\/div>',n+="<\/div>",n+="<% if (auth < 3) { %>",n+='<div class="info-group">',n+='<div data-toggle="buttons">',n+='<label class="btn filter-checkbox2 filter-manager">',n+='<input type="checkbox" name="changepassword">',n+='<i class="fa fa-square-o fa-1x"><\/i>',n+='<i class="fa fa-check-square-o fa-1x"><\/i>',n+=" change password<\/label>",n+="<\/div>",n+="<\/div>",n+='<div class="info-group hidden">',n+='<input type="text" class="form-control input-password" placeholder="password"/>',n+='<input type="text" class="form-control input-password2" placeholder="confirm password"/>',n+="<\/div>",n+="<% } %>",n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 logged-submit">See Parent Detail<\/div><\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 logged-cancel">Cancel<\/div><\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getSignUpViewTemplate=function(){var n="";return n+='<div id="wrapper-signup">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div class="wrapper-signup-content">',n+='<div class="info-group">',n+='<div class="name"><i>E-mail address<\/i><\/div>',n+="<\/div>",n+='<div class="info-group">',n+='<input type="email" name="email" class="form-control input-contact" placeholder="e-mail address" autocomplete="on"/>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-group">',n+='<div class="name">Information<\/div>',n+="<\/div>",n+='<div class="info-group">',n+='<input type="text" class="form-control input-name" placeholder="first & last name"/>',n+="<\/div>",n+='<div class="info-group">',n+='<input type="text" class="form-control input-neighborhood" placeholder="name of place near you (street, park)"/>',n+="<\/div>",n+='<div class="hr"><hr /><\/div>',n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 signup-submit">Sign Up<\/div><\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 signup-cancel">Cancel<\/div><\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getAdoptTreeViewTemplate=function(){var n="";return n+='<div id="wrapper-tree-adopt" class="frame-pop">',n+='<div id="frame-tree-adopt">',n+='<div id="content-header">',n+='<div class="text-header"><%= header %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+="<hr />",n+='<div id="content-login">',n+='<div class="info-group">',n+="<div class=\"text-label\">Do you want to adopt <i><strong>'<%= treename %>'<\/strong><\/i> ?<\/div>",n+="<\/div>",n+="<hr />",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-submit">Adopt<\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-close">Cancel<\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getUnadoptTreeViewTemplate=function(){var n="";return n+='<div id="wrapper-tree-adopt" class="frame-pop">',n+='<div id="frame-tree-adopt">',n+='<div id="content-header">',n+='<div class="text-header"><%= header %><\/div>',n+='<div class="btn-close evt-close">',n+='<i class="fa fa-remove"><\/i>',n+="<\/div>",n+="<\/div>",n+="<hr />",n+='<div id="content-login">',n+='<div class="info-group">',n+="<div class=\"text-label\">Do you want to unadopt <i><strong>'<%= treename %>'<\/strong><\/i> ?<\/div>",n+="<\/div>",n+="<hr />",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-submit">Unadopt<\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="btn-brown btn-medium evt-close">Cancel<\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+"<\/div>"},n.getChangePasswordViewTemplate=function(){var n="";return n+='<div id="wrapper-change-password">',n+='<div class="outer-frame">',n+='<div class="inner-frame">',n+='<div class="wrapper-change-password-content">',n+='<div class="info-group">',n+='<div class="name">Please enter a new password for <i><strong><%= personname %><\/strong><\/i>.<\/div>',n+="<\/div>",n+='<div class="info-group">',n+='<input type="password" class="form-control input-password" placeholder="password"/>',n+='<input type="password" class="form-control input-password2" placeholder="confirm password"/>',n+='<div class="button-description2">* The password should be longer than 6 characters.<\/div>',n+='<div class="button-description2">* Changing your own password will sign you out automatically.<\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 password-submit">Change<\/div><\/div>',n+="<\/div>",n+='<div class="info-button-group">',n+='<div class="button-outer-frame2 button3"><div class="button-inner-frame2 password-cancel">Cancel<\/div><\/div>',n+="<\/div>",n+="<\/div>",n+="<\/div>",n+='<div class="top-right-button button-close">',n+='<i class="fa fa-remove fa-2x"><\/i>',n+="<\/div>",n+="<\/div>",n+"<\/div>"},n._instance=new n,n}();n.Template=t})(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};Backbone.View.prototype.destroy=function(){this.children!=undefined&&(_.invoke(this.children,"destroy"),this.children.length=0,delete this.children);this.$el.removeData().unbind();this.remove();this.$el.find("*").remove();Backbone.View.prototype.remove.call(this);this.onDestroy&&this.onDestroy()},function(n){var t=function(n){function t(t){n.call(this,t);this.bDebug=!1;this.bRendered=!1;var i=this}return __extends(t,n),t.prototype.render=function(n){if(this.bRendered)return this.update(n),this;this.bRendered=!0},t.prototype.update=function(n){if(!this.bRendered)return this.render(n),this},t.prototype.resize=function(){},t.prototype.getIsRendered=function(){return this.bRendered},t.prototype.getWidth=function(){return this.$el.innerWidth()},t.prototype.getHeight=function(){return this.$el.innerHeight()},t.prototype.traverse=function(n){n(this);this.children&&this.children.forEach(function(t){t.traverse(n)})},t.prototype.addChild=function(n){var t=this;t.children==undefined&&(t.children=[]);t.children.push(n)},t.prototype.getChildren=function(){var n=this;return n.children},t.prototype.removeAllChildren=function(){var n=this;n.children&&n.children.forEach(function(n){n.traverse(destroyView)})},t.prototype.animActive=function(){},t.prototype.animInactive=function(){},t.prototype.setVisible=function(){this.$el.removeClass("invisible")},t.prototype.setInvisible=function(){this.$el.addClass("invisible")},t}(Backbone.View);n.BaseView=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(r){if(t.call(this,r),i._instance)throw new Error("Error: Instantiation failed: Use View.getInstance() instead of new.");i._instance=this;var u=i._instance;u.bDebug=!0;u._viewStatus=[];u._popupViews=[];$(window).resize(_.debounce(u.resize,n.Setting.getResizeTimeout()));$(document).bind("keydown",function(t){n.EventHandler.handleKeyCode(t.keyCode)})}return __extends(i,t),i.prototype.resize=function(){var n=i._instance;i.getNavView()&&i.getNavView().resize();$.each(n.children,function(n,t){t.resize()})},i.getInstance=function(){return i._instance},i.setElement=function(n){i._instance.setElement(n.el)},i.setViewStatus=function(n){i._instance._viewStatus.push(n)},i.popViewStatus=function(){console.log(i.TAG+"popViewStatus()");i._instance._viewStatus.pop()},i.getViewStatus=function(){return i._instance._viewStatus[i._instance._viewStatus.length-1]},i.getAllViewStatus=function(){return i._instance._viewStatus.toString()},i.addChild=function(n){var t=i._instance;t.children==undefined&&(t.children=[]);t.children.push(n)},i.getChildren=function(){return i._instance.children},i.traverse=function(n){n(i._instance);i._instance.children&&i._instance.children.forEach(function(t){t.traverse(n)})},i.removeAllChildren=function(){var n=i._instance;i._instance.children&&i._instance.children.forEach(function(n){n&&n.traverse(destroyView)});i._instance._treesView=null;i._instance._treeView=null;i._instance._managePeopleView=null;i._instance._manageDonationsView=null;i._instance._detailDonationView=null},i.setMessageView=function(n){i._instance._messageView=n},i.getMessageView=function(){return i._instance._messageView},i.setNavView=function(n){i._instance._navView=n},i.getNavView=function(){return i._instance._navView},i.addPopupView=function(n){i._instance._popupViews.push(n)},i.getPopupView=function(){return i._instance._popupViews[i._instance._popupViews.length-1]},i.getPopupViews=function(){return i._instance._popupViews},i.resetPopupViews=function(){i._instance._popupViews=[]},i.removePopupView=function(){i._instance._popupViews.pop()},i.setManageDonationsView=function(n){i._instance._manageDonationsView=n},i.getManageDonationsView=function(){return i._instance._manageDonationsView},i.setDetailDonationView=function(n){i._instance._detailDonationView=n},i.getDetailDonationView=function(){return i._instance._detailDonationView},i.setTreesView=function(n){i._instance._treesView=n},i.getTreesView=function(){return i._instance._treesView},i.setTreeView=function(n){i._instance._treeView=n},i.getTreeView=function(){return i._instance._treeView},i.setManagePeopleView=function(n){i._instance._managePeopleView=n},i.getManagePeopleView=function(){return i._instance._managePeopleView},i.removeNavView=function(){var n=i._instance;n._navView.destroy();n._navView=null},i.getWidth=function(){return $("body").innerWidth()},i.getHeight=function(){return $("body").innerHeight()},i._instance=new i,i.TAG="View - ",i}(n.BaseView);n.View=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var i=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use HomeViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n){return new t({el:n})},n._instance=new n,n}(),t;n.HomeViewFractory=i;t=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .button-logo":"_mouseClick","mouseenter .button-logo":"_mouseEnter","mouseout .button-logo":"_mouseOut"};i.delegateEvents()}return __extends(i,t),i.prototype.render=function(){var r,u,f;return t.prototype.render.call(this),r=this,r.bDebug&&console.log(i.TAG+"render!!()"),u=_.template(n.Template.getHomeViewTemplate()),f={image:n.Setting.getLogoSplashDefaultImage(),description:n.Setting.getApplicationDescription()},r.$el.html(u(f)),r.setElement(r.$("#wrapper-home")),r.resize(),r},i.prototype.update=function(){t.prototype.update.call(this);var n=this;return n.bDebug&&console.log(i.TAG+"update()"),n.resize(),n},i.prototype.resize=function(){var n=this},i.prototype._mouseEnter=function(){var t=this;t.$(".button-logo").attr({src:n.Setting.getLogoSplashMouseOverImage()})},i.prototype._mouseOut=function(){var t=this;t.$(".button-logo").attr({src:n.Setting.getLogoSplashDefaultImage()})},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.TAG="HomeView - ",i}(n.BaseView);n.HomeView=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var i=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use NavViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n){return new t({el:n})},n._instance=new n,n}(),t;n.NavViewFractory=i;t=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i._contact="";i.events={"click .item-nav":"_mouseClick"};i.delegateEvents()}return __extends(i,t),i.prototype.render=function(r){var u,f;return t.prototype.render.call(this,r),u=this,u.bDebug&&console.log(i.TAG+"render()"),f=_.template(n.Template.getNavViewTemplate()),u.$el.html(f({})),u.setElement(n.Setting.getNavWrapperElement()),u.renderNavItems(),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r.renderNavItems(),r},i.prototype.resize=function(){var n=this;n.bDebug&&console.log(i.TAG+"resize()");n.$(".text-contact").html("");$.each(n.$("#content-nav .item-nav"),function(){$(this).removeAttr("style")});$.each(n.$("#content-nav .item-nav"),function(){$(this).css({width:$(this).outerWidth()})});n.$(".text-contact").html("<span>"+n._contact+"<\/span>");n.$(".text-contact").textfill({maxFontPixels:16})},i.prototype.renderNavItems=function(){var t=this,r;n.Controller.checkIsLoggedIn(function(u){t._contact=u.contact;n.Controller.checkIsAdmin(function(){t.bDebug&&console.log(i.TAG+"Logged in as admin");r=_.template(n.Template.getNavViewTemplateForAdmin());t.$("#content-nav").html(r({contact:""}));t.resize();t.setActiveNavItem(n.View.getViewStatus())},function(){t.bDebug&&console.log(i.TAG+"Logged in as parent");r=_.template(n.Template.getNavViewTemplateForParent());t.$("#content-nav").html(r({contact:""}));t.resize();t.setActiveNavItem(n.View.getViewStatus())},function(){t.bDebug&&console.log(i.TAG+"Error occured")})},function(){t.bDebug&&console.log(i.TAG+"Not logged in");r=_.template(n.Template.getNavViewTemplateForGuest());t.$("#content-nav").html(r({}));t.resize();t.setActiveNavItem(n.View.getViewStatus())},function(){t.bDebug&&console.log(i.TAG+"Error occured")})},i.prototype.setActiveNavItem=function(t){var r=this,u;r.bDebug&&console.log(i.TAG+"setActiveNavItem()");u=t?t:n.View.getViewStatus();switch(u){case n.VIEW_STATUS.HOME:r.$el.addClass("hidden");break;case n.VIEW_STATUS.TREES:case n.VIEW_STATUS.TREE:r.$el.removeClass("hidden");r.$(".item-nav").removeClass("active");r.$(".evt-trees").addClass("active");break;case n.VIEW_STATUS.MANAGE_PEOPLE:r.$el.removeClass("hidden");r.$(".item-nav").removeClass("active");r.$(".people").addClass("active");break;case n.VIEW_STATUS.LOGIN:r.$el.removeClass("hidden");r.$(".item-nav").removeClass("active");r.$(".evt-login").addClass("active")}},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.TAG="NavView - ",i}(n.BaseView);n.NavView=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var i=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use MessageViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,i,r){var u=new t({el:n});return u.setMessage(i),u.setUndoable(r),u},n._instance=new n,n}(),t;n.MessageViewFractory=i;t=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .undo":"_mouseClick"};i.delegateEvents()}return __extends(i,t),i.prototype.render=function(t){var r,u,f;if(this.bRendered){this.update(t);return}return this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=r._undoable?_.template(n.Template.getMessageUndoableViewTemplate()):_.template(n.Template.getMessageViewTemplate()),f={content:r._message},r.$el.html(u(f)),r.setElement(r.$(".outer-frame")),r.setVisible(),r._timer&&clearTimeout(r._timer),r._timer=setTimeout(function(){r.setInvisible()},5e3),r},i.prototype.update=function(n){if(!this.bRendered){this.render(n);return}var t=this;return t.bDebug&&console.log(i.TAG+"update()"),t},i.prototype.setMessage=function(n){var t=this;t._message=n},i.prototype.setUndoable=function(n){var t=this;t._undoable=n},i.prototype._mouseEnter=function(t){var i=this;n.EventHandler.handleMouseEnter($(t.currentTarget),i)},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype.setVisible=function(){var t=this;n.Setting.getMessageWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getMessageWrapperElement().addClass("hidden");clearTimeout(t._timer)},i.TAG="MessageView - ",i}(n.BaseView);n.MessageView=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i}(n.BaseView);n.PopupView=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var f=function(){function t(){if(t._instance)throw new Error("Error: Instantiation failed: Use PostNoteViewFactory.getInstance() instead of new.");t._instance=this}return t.getInstance=function(){return t._instance},t.create=function(t,i){var r=new n.PostNoteView({el:t});return r.setTree(i),r},t._instance=new t,t}(),r,u,t,i;n.PostNoteViewFactory=f;r=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use ImageNoteViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,i){var r=new t({el:n});return r.setNote(i),r},n._instance=new n,n}();n.ImageNoteViewFactory=r;u=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use AlertViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t,r){var u=new i({el:n});return u.setErrorMode(t),r&&u.setCustomMessage(r),u},n._instance=new n,n}();n.AlertViewFractory=u;t=function(t){function i(n){t.call(this,n);this._bAuthor=!1;var i=this;i.bDebug=!0;i.events={"click .alert-confirm":"_mouseClick","click .top-right-button":"_mouseClick","click .prev-note":"_prevNote","click .next-note":"_nextNote","click .image-group img":"_changeCoverImage","click .delete-note":"_deleteNote"};i.delegateEvents()}return __extends(i,t),i.prototype.setNote=function(n){var t=this;t._note=n},i.prototype.render=function(){var t;this.bRendered=!0;t=this;t.bDebug&&console.log(i.TAG+"render()");var r=n.Model.getTrees().findWhere({id:t._note.getTreeId()}),u=n.Model.getFoods().findWhere({id:r.getFoodId()}),f=n.Model.getPersons().findWhere({id:t._note.getPersonId()});return n.Controller.checkLogin(function(i){var e=!1;t._bAuthor=!1;(i.result==!0||i.result=="true")&&(e=!0);e&&parseInt(i.id)==t._note.getPersonId()&&(t._bAuthor=!0);n.Controller.checkAdmin(function(i){var o,e;(i.result==!0||i.result=="true")&&(t._bAuthor=!0);t._bAuthor?(f!=undefined?(o=_.template(n.Template.getImageNoteViewTemplate()),e={name:u.getName()+" "+r.getName(),image:n.Setting.getBlankImagePath(),value:t._note.getRate(),comment:t._note.getComment(),date:t._note.getFormattedHourTime(),author:f.getName()},$("#wrapper-pop").html(o(e))):(o=_.template(n.Template.getImageNoteViewTemplate()),e={name:u.getName()+" "+r.getName(),image:n.Setting.getBlankImagePath(),value:t._note.getRate(),comment:t._note.getComment(),date:t._note.getFormattedHourTime(),author:"Unknown"},$("#wrapper-pop").html(o(e))),t.setElement($("#wrapper-note")),t.renderImageNote(),t.setVisible(),t.resize()):(o=_.template(n.Template.getImageNoteViewTemplate2()),f!=undefined?(e={name:u.getName()+" "+r.getName(),image:n.Setting.getBlankImagePath(),value:t._note.getRate(),comment:t._note.getComment(),date:t._note.getFormattedDate(),author:f.getName()},$("#wrapper-pop").html(o(e)),t.setElement($("#wrapper-note"))):(e={name:u.getName()+" "+r.getName(),image:n.Setting.getBlankImagePath(),value:t._note.getRate(),comment:t._note.getComment(),date:t._note.getFormattedDate(),author:"Unknown"},$("#wrapper-pop").html(o(e)),t.setElement($("#wrapper-note"))),t.renderImageNote(),t.setVisible(),t.resize())},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),t},i.prototype.renderImageNote=function(){var t=this,i=n.Model.getTrees().findWhere({id:t._note.getTreeId()}),r=n.Model.getFoods().findWhere({id:i.getFoodId()}),f,u;if(t.$(".name").html(r.getName()+" "+i.getName()),t.$(".input-rating").replaceWith('<div class="input-rating"><\/div>'),t.$(".input-rating").html(Math.ceil(t._note.getRate()).toFixed(2)+" / "+n.Setting.getMaxRating().toFixed(2)),t.$(".input-rating-slider").html(""),f=rating(t.$(".input-rating-slider")[0],(t._note.getRate()+1).toFixed(2),n.Setting.getMaxRating()+1,function(u){t._bAuthor?Math.ceil(t._note.getRate())!=u-1?n.EventHandler.handleNoteData(t._note,n.DATA_MODE.UPDATE_RATING,{rate:u-1},function(){n.EventHandler.handleDataChange("Rating of <strong><i>"+r.getName()+" "+i.getName()+"<\/i><\/strong> has changed successfully.",!0);t.renderImageNote()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.renderImageNote():t.renderImageNote()}),t._bAuthor){u=new Date;t.$(".input-date").attr({"data-value":t._note.getFormattedDate()});t.$(".input-date").pickadate({format:"dd mmm yyyy",today:"Today",max:u,clear:"",close:"Close",onClose:function(){n.EventHandler.handleNoteData(t._note,n.DATA_MODE.UPDATE_DATE,{date:moment(this.get()).hour(moment(new Date).hour()).format(n.Setting.getDateTimeFormat())},function(){n.EventHandler.handleDataChange("Date of this <strong><i>Note<\/i><\/strong> has changed successfully.",!0);t.renderImageNote()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})}});t.$(".input-date").pickadate("picker").set("select",t._note.getFormattedDate(),{format:"dd mmm yyyy"});t.$(".input-comment").replaceWith('<div class="input-comment"><\/div>');t.$(".input-comment").html(htmlDecode(t._note.getComment()));t.$(".input-comment").on("click",function(){$(this).replaceWith("<textarea rows='5' class='input-comment form-control'>"+t._note.getComment()+"<\/textarea>");t.$(".input-comment").focus();t.$(".input-comment").on("focusout",function(){var u=t.$(".input-comment").val();t._note.getComment().trim()!=u.trim()?n.EventHandler.handleNoteData(t._note,n.DATA_MODE.UPDATE_COMMENT,{comment:u},function(){n.EventHandler.handleDataChange("Comment of <strong><i>"+r.getName()+" "+i.getName()+"<\/i><\/strong> has changed successfully.",!0);t.renderImageNote()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.renderImageNote()})})}if(t.renderNoteImages(),t._bAuthor){t.$("input[type=file]").off("change");t.$("input[type=file]").on("change",function(u){t.$(".wrapper-input-upload-picture").addClass("hidden");t.$(".wrapper-uploading-picture").removeClass("hidden");var f=u.target.files;f.length>0&&n.Controller.uploadNotePictureFile(f[0],r.getName()+"_"+i.getId(),function(i){n.EventHandler.handleNoteData(t._note,n.DATA_MODE.ADD_PICTURE,{filename:i},function(){n.EventHandler.handleDataChange("<strong><i>"+i+"<\/i><\/strong> has been added successfully.",!0);t.$("input[type=file]").val("");t.$(".wrapper-uploading-picture").addClass("hidden");t.$(".wrapper-input-upload-picture").removeClass("hidden");t.renderNoteImages()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){n.EventHandler.handleDataChange("<strong><i>"+i+"<\/i><\/strong> has been removed successfully.",!0);t.$("input[type=file]").val("");t.$(".wrapper-uploading-picture").addClass("hidden");t.$(".wrapper-input-upload-picture").removeClass("hidden");t.renderNoteImages()})},function(){t.$(".wrapper-uploading-picture").addClass("hidden");t.$(".wrapper-input-upload-picture").removeClass("hidden")})})}},i.prototype.renderNoteImages=function(){var t=this,i="";$.each(t._note.getPictures(),function(t){i+=t==0?'<img src="'+n.Setting.getBlankImagePath()+'" data-target="'+t+'" class="selected" />':'<img src="'+n.Setting.getBlankImagePath()+'" data-target="'+t+'" />'});t.$(".image-group").html(i);$.each(t.$(".image-group img"),function(i,r){$(r).attr("src",n.Setting.getContentPictureDir()+t._note.getPictures()[i]).load(function(){}).error(function(){$(r).attr("src",n.Setting.getBlankImagePath())})})},i.prototype.update=function(n){return this.bRendered?self:(this.render(n),self)},i.prototype.resize=function(){var n=this},i.prototype._mouseEnter=function(t){var i=this;n.EventHandler.handleMouseEnter($(t.currentTarget),i)},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._prevNote=function(){var t=this,i=new n.Notes(n.Model.getNotes().where({tree:t._note.getTreeId(),type:n.NoteType.IMAGE})),r;i.sortByAscendingDate();r=!1;$.each(i.models,function(n,u){if(t._note.getId()==u.getId()&&!r){r=!0;t._note=n==0?i.models[i.models.length-1]:i.models[n-1];t.render();return}})},i.prototype._nextNote=function(){var t=this,i=new n.Notes(n.Model.getNotes().where({tree:t._note.getTreeId(),type:n.NoteType.IMAGE})),r;i.sortByAscendingDate();r=!1;$.each(i.models,function(n,u){if(t._note.getId()==u.getId()&&!r){r=!0;t._note=n==i.models.length-1?i.models[0]:i.models[n+1];t.render();return}})},i.prototype._changeCoverImage=function(t){var i=this;if(i._bAuthor){var r=parseInt($(t.target).attr("data-target")),u=n.Model.getTrees().findWhere({id:i._note.getTreeId()}),f=n.Model.getFoods().findWhere({id:u.getFoodId()});r!=0&&n.EventHandler.handleNoteData(i._note,n.DATA_MODE.UPDATE_COVER,{cover:r},function(){n.EventHandler.handleDataChange("Cover picture of <strong><i>"+f.getName()+" "+u.getName()+"<\/i><\/strong> has changed successfully.",!0);i.renderImageNote()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})}},i.prototype._deleteNote=function(){var t=this,i=n.Model.getTrees().findWhere({id:t._note.getTreeId()}),r=n.Model.getFoods().findWhere({id:i.getFoodId()});n.EventHandler.handleNoteData(t._note,n.DATA_MODE.DELETE,{},function(){n.EventHandler.handleDataChange("Note of <strong><i>"+r.getName()+" "+i.getName()+"<\/i><\/strong> has been deleted successfully.",!0);n.View.getDetailTreeView()&&(n.View.getDetailTreeView().refreshTreeInfo(),n.View.getDetailTreeView().resetNote())},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i.TAG="ImageNoteView - ",i}(n.PopupView);n.ImageNoteView=t;i=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .alert-confirm":"_mouseClick","click .alert-cancel":"_mouseClick"};i.delegateEvents()}return __extends(i,t),i.prototype.setErrorMode=function(n){var t=this;t._errorMode=n},i.prototype.setCustomMessage=function(n){var t=this;t._customMessage=n},i.prototype.render=function(t){var u,f,e,r;if(this.bRendered){this.update(t);return}this.bRendered=!0;u=this;u.bDebug&&console.log(i.TAG+"render()");f=_.template(n.Template.getAlertViewTemplate());r="";switch(u._errorMode){case n.ERROR_MODE.GEO_PERMISSION_ERROR:r+="<p>The device cannot find its's location information.<br />Please turn Geolocation setting on & refresh the page.<\/p>";r+="<div class='button-outer-frame button1'><div class='button-inner-frame alert-confirm'>Confirm<\/div><\/div>";break;case n.ERROR_MODE.SEVER_CONNECTION_ERROR:r+="<p>There is a server connection error.<br/>If the issue won't be solved by the refreshing page,";r+="<br/>please contact <a href='mailto:"+n.Setting.getDevContact()+"'>"+n.Setting.getDevContact()+"<\/a>.<\/p>";r+="<div class='button-outer-frame button1'><div class='button-inner-frame alert-confirm'>Confirm<\/div><\/div>";break;case n.ERROR_MODE.SEVER_RESPONSE_ERROR:r+="<p>"+u._customMessage;r+="<br/>please contact <a href='mailto:"+n.Setting.getDevContact()+"'>"+n.Setting.getDevContact()+"<\/a>.<\/p>";r+="<div class='button-outer-frame button1'><div class='button-inner-frame alert-confirm'>Confirm<\/div><\/div>"}return e={content:r},u.$el.html(f(e)),u.setElement(u.$("#wrapper-alert")),u.setVisible(),u},i.prototype.update=function(n){if(!this.bRendered){this.render(n);return}var t=this;return t.bDebug&&console.log(i.TAG+"update()"),t},i.prototype._mouseEnter=function(t){var i=this;n.EventHandler.handleMouseEnter($(t.currentTarget),i)},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i.TAG="AlertView - ",i}(n.PopupView);n.AlertView=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var e=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use LogInViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n){return new t({el:n})},n._instance=new n,n}(),t,u,i,f,r;n.LogInViewFactory=e;t=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .evt-manager":"_toggleManagerLogIn","click .evt-close":"_mouseClick","click .evt-submit":"_loginSubmit","keydown .input-contact":"_keyDown"};i.delegateEvents()}return __extends(i,t),i.prototype.render=function(r){var u,f;return t.prototype.render.call(this,r),u=this,u.bDebug&&console.log(i.TAG+"render()"),f=_.template(n.Template.getLogInViewTemplate()),u.$el.html(f({header:"Parent Sign-In"})),u.setElement($("#wrapper-login")),u.setVisible(),u.resize(),u},i.prototype._toggleManagerLogIn=function(n){var t=this;$(n.target).find("input").prop("name")=="manager"&&setTimeout(function(){$(n.target).find("input").prop("checked")==!0?t.$(".input-password").closest(".info-group").removeClass("invisible"):(t.$(".input-password").closest(".info-group").addClass("invisible"),t.$(".input-password").val(""))},1)},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._keyDown=function(n){var t=this;n.keyCode==13&&t._loginSubmit()},i.prototype._loginSubmit=function(){var t=this;$('input[type="checkbox"][name="manager"]').prop("checked")==!0?isValidEmailAddress($(".input-contact").val())?t.$(".input-password").val().trim()==""?new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please put a <strong>password<\/strong>, or uncheck <strong>manager option<\/strong>.",undoable:!1}).execute():n.EventHandler.handleMouseClick(t.$(".evt-submit"),t,{contact:$(".input-contact").val().trim(),password:$(".input-password").val().trim()}):new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please put a valid <strong><i>e-mail address.",undoable:!1}).execute():isValidEmailAddress($(".input-contact").val())?n.EventHandler.handleMouseClick(t.$(".evt-submit"),t,{contact:$(".input-contact").val().trim(),password:$(".input-contact").val().trim()}):new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please put a valid <strong><i>e-mail address.",undoable:!1}).execute()},i.TAG="LogInView - ",i}(n.PopupView);n.LogInView=t;u=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use AccountViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n){return new i({el:n})},n._instance=new n,n}();n.AccountViewFactory=u;i=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .evt-close":"_mouseClick","click .evt-logout":"_mouseClick"};i.delegateEvents()}return __extends(i,t),i.prototype.render=function(r){t.prototype.render.call(this,r);var u=this;return u.bDebug&&console.log(i.TAG+"render()"),n.Controller.checkIsLoggedIn(function(t){n.Controller.checkIsAdmin(function(){var i=_.template(n.Template.getAccountViewTemplateForAdmin());n.Setting.getPopWrapperElement().append(i({header:"Admin Info",contact:t.contact}));u.setElement($("#wrapper-login"));n.Controller.fetchAllPersons(function(){var i=n.Model.getPersons().findWhere({id:parseInt(t.id)});u.$(".input-name").val(i.getRealName());u.$(".input-neighborhood").val(i.getNeighboorhood())},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){var i=_.template(n.Template.getAccountViewTemplateForParent());n.Setting.getPopWrapperElement().append(i({header:"Parent Info",contact:t.contact}));u.setElement($("#wrapper-login"));n.Controller.fetchAllPersons(function(){var i=n.Model.getPersons().findWhere({id:parseInt(t.id)});u.$(".input-name").val(i.getRealName());u.$(".input-neighborhood").val(i.getNeighboorhood())},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){Backbone.history.loadUrl(Backbone.history.fragment)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),u.setVisible(),u.resize(),u},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.TAG="AccountView - ",i}(n.PopupView);n.AccountView=i;f=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use SignUpViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n){return new r({el:n})},n._instance=new n,n}();n.SignUpViewFactory=f;r=function(t){function i(n){t.call(this,n);this.bProcessing=!1;var i=this;i.bDebug=!0;i.events={"click .top-right-button":"_mouseClick","click .signup-cancel":"_mouseClick","click .signup-submit":"_signupSubmit"};i.delegateEvents()}return __extends(i,t),i.prototype.render=function(t){var r,u;if(this.bRendered){this.update(t);return}return this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=_.template(n.Template.getSignUpViewTemplate()),$("#wrapper-pop").html(u({})),r.setElement($("#wrapper-signup")),r.setVisible(),r.resize(),r},i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._signupSubmit=function(){var t=this;t.bProcessing||(t.bProcessing=!0,isValidEmailAddress($(".input-contact").val())?$(".input-name").val().trim()==""?(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(604),undoable:!1}).execute(),t.bProcessing=!1):$(".input-neighborhood").val().trim()==""?(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(605),undoable:!1}).execute(),t.bProcessing=!1):n.Controller.processSignup($(".input-contact").val().trim(),$(".input-name").val().trim(),$(".input-neighborhood").val().trim(),function(){Backbone.history.loadUrl(Backbone.history.fragment);t.bProcessing=!1},function(i){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(i.error),undoable:!1}).execute();t.bProcessing=!1}):(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(803),undoable:!1}).execute(),t.bProcessing=!1))},i.TAG="SignUpView - ",i}(n.PopupView);n.SignUpView=r}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(n){t.call(this,n);this.bProcessing=!1;var i=this;i.bDebug=!0;i.events={"click .alert-confirm":"_mouseClick","click .top-right-button":"_mouseClick","click .image-group img":"_selectCoverImage","click .create-note":"_createNote"};i.delegateEvents()}return __extends(i,t),i.prototype.setTree=function(n){var t=this;t._tree=n},i.prototype.render=function(t){if(this.bRendered){this.update(t);return}this.bRendered=!0;var r=this;return r.bDebug&&console.log(i.TAG+"render()"),n.Controller.checkLogin(function(t){var f=!1,i,e,u;(t.result==!0||t.result=="true")&&(f=!0);i=n.Model.getFoods().findWhere({id:r._tree.getFoodId()});f?(e=n.Model.getPersons().findWhere({id:parseInt(t.id)}),u=_.template(n.Template.getPostNoteViewTemplate()),r.$el.html(u({name:i.getName()+" "+r._tree.getName(),author:e.getName()}))):(u=_.template(n.Template.getPostNoteViewTemplate2()),r.$el.html(u({name:i.getName()+" "+r._tree.getName()})));r.setElement(r.$("#wrapper-note"));r.setVisible();r._note=new n.Note({type:n.NoteType.IMAGE,tree:r._tree.getId(),person:parseInt(t.id),comment:"",picture:"",rate:0,date:moment(new Date).format(n.Setting.getDateTimeFormat())});r.$("input[type=file]").off("change");r.$("input[type=file]").on("change",function(t){r.$(".wrapper-input-upload-picture").addClass("hidden");r.$(".wrapper-uploading-picture").removeClass("hidden");var u=t.target.files;u.length>0&&n.Controller.uploadNotePictureFile(u[0],i.getName()+"_"+r._tree.getId(),function(n){r._note.addPicture(n);r.$("input[type=file]").val("");r.$(".wrapper-uploading-picture").addClass("hidden");r.$(".wrapper-input-upload-picture").removeClass("hidden");r.renderNoteImages()},function(){r.$(".wrapper-uploading-picture").addClass("hidden");r.$(".wrapper-input-upload-picture").removeClass("hidden")})});r.renderNoteInfo();r.resize()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),r},i.prototype.resize=function(){var n=this;n.$(".image-group").css({height:n.$(".image-wrapper").innerHeight()-60})},i.prototype.renderNoteInfo=function(){var t=this,r,i;t.$(".input-rating").replaceWith('<div class="input-rating"><\/div>');t.$(".input-rating").html(Math.ceil(t._note.getRate()).toFixed(2)+" / "+n.Setting.getMaxRating().toFixed(2));t.$(".input-rating-slider").html("");r=rating(t.$(".input-rating-slider")[0],(t._note.getRate()+1).toFixed(2),n.Setting.getMaxRating()+1,function(n){t._note.setRate(n-1);t.renderNoteInfo()});t.$(".input-comment").replaceWith('<div class="input-comment"><\/div>');t.$(".input-comment").html(htmlDecode(t._note.getComment()));t.$(".input-comment").on("click",function(){$(this).replaceWith("<textarea rows='5' class='input-comment form-control'>"+t._note.getComment()+"<\/textarea>");t.$(".input-comment").focus();t.$(".input-comment").on("focusout",function(){console.log(t.$(".input-comment").val());var n=t.$(".input-comment").val();t._note.setComment(n);t.renderNoteInfo()})});i=new Date;t.$(".input-date").attr({"data-value":t._note.getFormattedDate()});t.$(".input-date").pickadate({format:"dd mmm yyyy",today:"Today",max:i,clear:"",close:"Close",onClose:function(){t._note.setDate(moment(this.get()).hour(moment(new Date).hour()));t.renderNoteInfo()}})},i.prototype.renderNoteImages=function(){var t=this,i="";$.each(t._note.getPictures(),function(t){i+=t==0?'<img src="'+n.Setting.getBlankImagePath()+'" data-target="'+t+'" class="selected" />':'<img src="'+n.Setting.getBlankImagePath()+'" data-target="'+t+'" />'});t.$(".image-group").html(i);$.each(t.$(".image-group img"),function(i,r){$(r).attr("src",n.Setting.getContentPictureDir()+t._note.getPictures()[i]).load(function(){}).error(function(){$(r).attr("src",n.Setting.getBlankImagePath())})})},i.prototype._selectCoverImage=function(n){var t=this;$.each(t.$(".image-group img"),function(n,t){$(t).removeClass("selected")});$(n.target).addClass("selected");t._note.setCover(parseInt($(n.target).attr("data-target")));t.renderNoteImages()},i.prototype._createNote=function(){var t=this;t.bProcessing||(t.bProcessing=!0,n.Controller.checkLogin(function(i){if(i.result==!0||i.result=="true"){var r=n.Model.getFoods().findWhere({id:t._tree.getFoodId()});t._note.setPersonId(parseInt(i.id));n.EventHandler.handleNoteData(t._note,n.DATA_MODE.CREATE,{},function(){n.EventHandler.handleDataChange("New note for <strong><i>"+r.getName()+" "+t._tree.getName()+"<\/i><\/strong> has been created.",!1);new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute();n.View.getDetailTreeView()&&n.View.getDetailTreeView().refreshTreeInfo();t.bProcessing=!1},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR);t.bProcessing=!1})}else isValidEmailAddress($(".input-author").val())?n.Controller.processSignup($(".input-author").val().trim(),"","",function(i){var r=n.Model.getFoods().findWhere({id:t._tree.getFoodId()});t._note.setPersonId(parseInt(i.id));n.EventHandler.handleNoteData(t._note,n.DATA_MODE.CREATE,{},function(){n.EventHandler.handleDataChange("New note for <strong><i>"+r.getName()+" "+t._tree.getName()+"<\/i><\/strong> has been created.",!1);new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute();n.View.getDetailTreeView()&&n.View.getDetailTreeView().refreshTreeInfo();t.bProcessing=!1},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR);t.bProcessing=!1});Backbone.history.loadUrl(Backbone.history.fragment);t.bProcessing=!1},function(i){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(i.error),undoable:!1}).execute();t.bProcessing=!1}):(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please put a valid <strong><i>e-mail address.",undoable:!1}).execute(),t.bProcessing=!1)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}))},i.prototype.update=function(n){return this.bRendered?self:(this.render(n),self)},i.prototype._mouseEnter=function(t){var i=this;n.EventHandler.handleMouseEnter($(t.currentTarget),i)},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i.TAG="PostNoteView - ",i}(n.PopupView);n.PostNoteView=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var i=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use ConfirmViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,i,r){var u=new t({el:n});return u.setMessage(i),u.setCommand(r),u},n._instance=new n,n}(),t;n.ConfirmViewFractory=i;t=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .evt-submit":"_executeCommand","click .evt-close":"_mouseClick"};i.delegateEvents()}return __extends(i,t),i.prototype.setMessage=function(n){var t=this;t._message=n},i.prototype.setCommand=function(n){var t=this;t._command=n},i.prototype.render=function(r){var u,f,e;return t.prototype.render.call(this,r),u=this,u.bDebug&&console.log(i.TAG+"render()"),f=_.template(n.Template.getConfirmViewTemplate()),e={header:"Deleting Tree",message:u._message},u.$el.append(f(e)),u.setElement(u.$("#wrapper-confirm")),u.setVisible(),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.prototype._mouseEnter=function(t){var i=this;n.EventHandler.handleMouseEnter($(t.currentTarget),i)},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._executeCommand=function(t){var i=this;i._command.execute();n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i.TAG="ConfirmView - ",i}(n.PopupView);n.ConfirmView=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var r=function(){function t(){if(t._instance)throw new Error("Error: Instantiation failed: Use TreesViewFractory.getInstance() instead of new.");t._instance=this}return t.getInstance=function(){return t._instance},t.create=function(t,i,r){var u;return r==n.CREDENTIAL_MODE.GUEST?u=new n.TreesMapViewForGuest({el:t}):r==n.CREDENTIAL_MODE.PARENT?u=new n.TreesMapViewForParent({el:t}):r==n.CREDENTIAL_MODE.ADMIN&&(u=new n.TreesMapViewForAdmin({el:t})),u.setTreeId(i),u},t._instance=new t,t}(),t,i;n.TreesViewFractory=r;t=function(n){function t(){n.apply(this,arguments);this.renderTreeInfo=function(){};this.removeTreeInfo=function(){};this.renderFilterList=function(){};this.closeMapFilter=function(){};this.panToCurrentLocation=function(){}}return __extends(t,n),t.prototype.render=function(t){n.prototype.render.call(this,t);return this},t.prototype.update=function(t){n.prototype.update.call(this,t);return this},t.prototype.resize=function(){n.prototype.resize.call(this);var t=this},t.prototype.setTreeId=function(n){this._id=n},t.prototype._applyFilter=function(){},t}(n.BaseView);n.TreesView=t;i=function(t){function i(r){var u=this,f;t.call(this,r);this._bClosePopupOnClick=!0;this.renderMapError=function(t){var i=u;switch(t.code){case t.PERMISSION_DENIED:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR);break;case t.POSITION_UNAVAILABLE:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR)}i.renderMap({coords:{accuracy:4196,altitude:null,altitudeAccuracy:null,heading:null,latitude:33.7946333,longitude:-84.448771,speed:null},timestamp:(new Date).valueOf()})};this.renderMap=function(t){var r=u,f;if(r.bDebug&&console.log(i.TAG+"renderMap()"),f=t.coords.accuracy,r._id!=0)n.Controller.fetchAllTrees(function(){var i=n.Model.getTrees().findWhere({id:Math.floor(r._id)}),t;if(r._location=i.getLocation(),t=L.CRS.EPSG3857.latLngToPoint(r._location,n.Setting.getMapCenterZoomLevel()),n.View.getWidth()>n.View.getHeight()?t.x+=r.$("#content-map").outerWidth()*.2:t.y-=r.$("#content-map").outerHeight()*.2,r._map==undefined){r.$("#list-donation").css({height:n.View.getHeight()-60});r.setLocation(L.CRS.EPSG3857.pointToLatLng(t,n.Setting.getMapCenterZoomLevel()));r._map=L.map($("#content-map")[0].id,{zoomControl:!1,closePopupOnClick:r._bClosePopupOnClick,doubleClickZoom:!0,touchZoom:!0,zoomAnimation:!0,markerZoomAnimation:!0}).setView(r._location,n.Setting.getMapCenterZoomLevel());L.tileLayer(n.Setting.getTileMapAddress(),{minZoom:n.Setting.getMapMinZoomLevel(),maxZoom:n.Setting.getMapMaxZoomLevel()}).addTo(r._map);r._map.invalidateSize(!1);r._map.whenReady(r.renderTrees);r._map.on("moveend",r.afterMoveMap);r._map.on("popupopen",function(t){var u=t.popup._source,i,f;u._bringToFront();$(u.label._container).addClass("active");i=n.Model.getTrees().findWhere({id:u.options.id});r.renderTreeInfo(i);r._selectedMarker=u;n.View.getMessageView()&&n.View.getMessageView().setInvisible();f=L.CRS.EPSG3857.latLngToPoint(r._selectedMarker.getLatLng(),r._map.getZoom());n.View.getWidth()>n.View.getHeight()?f.x+=r._map.getSize().x*.225:f.y-=r._map.getSize().y*.25;r._map.panTo(L.CRS.EPSG3857.pointToLatLng(f,r._map.getZoom()));n.View.getWidth()<n.View.getHeight()&&r.closeMapFilter();n.Controller.fetchLatestCommentOfTrees([i],function(){var t=n.Model.getNotes().getLatestImageNoteOfDate(i.getId(),(new Date).valueOf(),n.NoteType.IMAGE);t==null?r.$("#text-rating").html("0"):r.$("#text-rating").html(t.getRate().toString())},function(t){n.EventHandler.handleError(t)});n.Router.getInstance().navigate("trees/"+i.getId(),{trigger:!1,replace:!0})});r._map.on("popupclose",function(t){var i=t.popup._source;i._resetZIndex();$(i.label._container).removeClass("active");r.$("#wrapper-treeinfo").addClass("hidden");r._selectedMarker=null;n.Router.getInstance().navigate("trees/0",{trigger:!1,replace:!0})})}},function(t){n.EventHandler.handleError(t)});else if(r._location=new L.LatLng(t.coords.latitude,t.coords.longitude),r._map==undefined){r.$("#list-donation").css({height:n.View.getHeight()-60});r.setLocation(new L.LatLng(t.coords.latitude,t.coords.longitude));r._map=L.map($("#content-map")[0].id,{zoomControl:!1,closePopupOnClick:r._bClosePopupOnClick,doubleClickZoom:!0,touchZoom:!0,zoomAnimation:!0,markerZoomAnimation:!0}).setView(r._location,r._zoom);L.tileLayer(n.Setting.getTileMapAddress(),{minZoom:n.Setting.getMapMinZoomLevel(),maxZoom:n.Setting.getMapMaxZoomLevel()}).addTo(r._map);r._map.invalidateSize(!1);r._map.whenReady(r.renderTrees);r._map.on("moveend",r.afterMoveMap);r._map.on("popupopen",function(t){var u=t.popup._source,i,f;u._bringToFront();$(u.label._container).addClass("active");i=n.Model.getTrees().findWhere({id:u.options.id});r.renderTreeInfo(i);r._selectedMarker=u;n.View.getMessageView()&&n.View.getMessageView().setInvisible();f=L.CRS.EPSG3857.latLngToPoint(r._selectedMarker.getLatLng(),r._map.getZoom());n.View.getWidth()>n.View.getHeight()?f.x+=r._map.getSize().x*.225:f.y-=r._map.getSize().y*.25;r._map.panTo(L.CRS.EPSG3857.pointToLatLng(f,r._map.getZoom()));n.View.getWidth()<n.View.getHeight()&&r.closeMapFilter();n.Controller.fetchLatestCommentOfTrees([i],function(){var t=n.Model.getNotes().getLatestImageNoteOfDate(i.getId(),(new Date).valueOf(),n.NoteType.IMAGE);t==null?r.$("#text-rating").html("0"):r.$("#text-rating").html(t.getRate().toString())},function(t){n.EventHandler.handleError(t)});n.Router.getInstance().navigate("trees/"+i.getId(),{trigger:!1,replace:!0})});r._map.on("popupclose",function(t){var i=t.popup._source;i._resetZIndex();$(i.label._container).removeClass("active");r.$("#wrapper-treeinfo").addClass("hidden");r._selectedMarker=null;n.Router.getInstance().navigate("trees/0",{trigger:!1,replace:!0})})}};this.afterMoveMap=function(){var n=u;n._selectedMarker&&n._selectedMarker._bringToFront()};this.renderTrees=function(){var t=u;n.Controller.fetchAllTrees(function(){t.renderFilterList();t.renderMarkers()},function(t){n.EventHandler.handleError(t)})};this.renderMarkers=function(){var t=u,r;if(console.log(i.TAG+"renderMarkers()"),$.each(n.Model.getTrees().models,function(n,i){for(var r=!1,u=0;u<t._markers.length&&!r;u++)i.getId()==t._markers[u].options.id&&(r=!0);r||t.addMarker(i,!1)}),t._id!=undefined&&t._id!=0)for(r=0;r<t._markers.length;r++)if(t._markers[r].options.id==t._id){t._markers[r].openPopup();break}};this.updateMarkers=function(n){var t=u,r,f;for(console.log(i.TAG+"updateMarkers()"),$.each(n.models,function(n,i){for(var r=!1,u=0;u<t._markers.length&&!r;u++)i.getId()==t._markers[u].options.id&&(r=!0);r||t.addMarker(i,!1)}),r=0;r<t._markers.length;)f=!1,$.each(n.models,function(n,i){i.getId()==t._markers[r].options.id&&(f=!0)}),f||(t._markers[r]==t._selectedMarker&&t._selectedMarker.closePopup(),t.removeMarker(t._markers[r]),t._markers=_.without(t._markers,t._markers[r]),r--),r++};this.removeTreeInfo=function(){var n=u;n._map.closePopup()};this.closeMapFilter=function(){var t=u;t.$("#wrapper-mapfilter").animate({left:-260},n.Setting.getFilterAnimDuration())};this.openMapFilter=function(){var t=u;t.$("#wrapper-mapfilter").animate({left:0},n.Setting.getFilterAnimDuration())};this.panToCurrentLocation=function(){var t=u;n.Controller.updateGeoLocation(function(i){t._location=new L.LatLng(i.coords.latitude,i.coords.longitude);var r=L.CRS.EPSG3857.latLngToPoint(t._location,t._map.getZoom());n.View.getWidth()>n.View.getHeight()?r.x+=t._map.getSize().x*.2:r.y-=t._map.getSize().y*.2;t._map.panTo(L.CRS.EPSG3857.pointToLatLng(r,t._map.getZoom()))},t.renderMapError)};f=this;f.bDebug=!0;f._zoom=n.Setting.getDefaultMapZoomLevel();f._markers=[];f.events={"click .evt-close":"removeTreeInfo","click .btn-mapfilter":"_toggleMapFilter","click .evt-marker-lock":"_toggleMarkerLock"};f.delegateEvents()}return __extends(i,t),i.prototype.resize=function(){var t=this,i;t._map.invalidateSize(!1);t._selectedMarker&&(i=L.CRS.EPSG3857.latLngToPoint(t._selectedMarker.getLatLng(),t._map.getZoom()),n.View.getWidth()>n.View.getHeight()?i.x+=t._map.getSize().x*.225:i.y-=t._map.getSize().y*.25,t._map.panTo(L.CRS.EPSG3857.pointToLatLng(i,t._map.getZoom())))},i.prototype.render=function(r){var u,f;return t.prototype.render.call(this,r),u=this,u.bDebug&&console.log(i.TAG+"render()"),f=_.template(n.Template.getTreesMapViewWrapperTemplate()),u.$el.html(f({})),u.setElement(u.$("#wrapper-trees")),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.prototype.setLocation=function(n){var t=this;t._location=n},i.prototype.addMarker=function(t,i){var u=this,r=n.MarkerFractory.create(t,!0,i);u._markers.push(r);r.addTo(u._map);r.on("dragend",function(){if(r.options.id!=undefined){var t=n.Model.getTrees().findWhere({id:r.options.id});n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_LOCATION,{marker:r,location:r.getLatLng()},function(){var i=n.Model.getFoods().findWhere({id:t.getFoodId()});u.renderRecentComments(t);n.EventHandler.handleDataChange("Location of <strong><i>"+i.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);u.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})}})},i.prototype.removeMarker=function(n){var t=this;t._map.removeLayer(n)},i.prototype.renderRecentComments=function(t){var r=this,i=[];i.push(t);n.Controller.fetchNotesOfTrees(i,n.NoteType.IMAGE,n.Setting.getNumRecentActivitiesShown(),0,function(){var i=new n.Notes(n.Model.getNotes().where({tree:t.getId(),type:n.NoteType.IMAGE})),u,f;i.sortByDescendingDate();u=_.template(n.Template.getRecentCommentsTemplate());f={notes:i,size:n.Setting.getNumRecentActivitiesShown(),coordinate:"@ "+t.getLat().toFixed(4)+", "+t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()};r.$("#list-comments").html(u(f))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype._toggleMapFilter=function(){var n=this;parseFloat(n.$("#wrapper-mapfilter").css("left"))==0?n.closeMapFilter():n.openMapFilter()},i.prototype._searchFood=function(n){var t=this;t._timeout1&&clearTimeout(t._timeout1);t._timeout2&&clearTimeout(t._timeout2);t._timeout1=setTimeout(function(){n.keyCode==27?(t.$("#input-search-food").val(""),t._resetSearchFood()):t.$("#input-search-food").val().trim()!=""?t._timeout2=setTimeout(function(){t.$("#wrapper-list-food").removeClass("hidden");t.$("#wrapper-list-food").scrollTop(0)},500):(t.$("#wrapper-list-food").addClass("hidden"),t._resetSearchFood())},10)},i.prototype._resetSearchFood=function(){var n=this;n._selectedFood=null;n.$("#input-search-food").val("");n.$("#wrapper-list-food").addClass("hidden");n._applyFilter()},i.prototype._applySearch=function(t){var i=this,r=n.Model.getFoods().findWhere({id:parseInt($(t.currentTarget).attr("data-id"))});r!=null&&(i._selectedFood=r,i.$("#search-food").val(r.getName()));i.$("#input-search-food").val(r.getName());i.$("#wrapper-list-food").addClass("hidden");i._applyFilter()},i.prototype._resetFilter=function(){var n=this;n.$(".filter-owner-all").addClass("active");n.$(".filter-adopt-all").addClass("active");n.$(".filter-flag-all").addClass("active");n.$(".filter-rating-all").addClass("active");n.$(".filter-last-all").addClass("active");n.$(".filter-owner-item").removeClass("active");n.$(".filter-adopt-item").removeClass("active");n.$(".filter-flag-item").removeClass("active");n.$(".filter-rating-item").removeClass("active");n.$(".filter-last-item").removeClass("active");n.$(".filter-owner-all").hasClass("active")&&n.$(".filter-adopt-all").hasClass("active")&&n.$(".filter-flag-all").hasClass("active")&&n.$(".filter-rating-all").hasClass("active")&&n.$(".filter-last-all").hasClass("active")?(n.$(".icon-mapfilter-status").removeClass("active"),n.$(".text-mapfilter-status").removeClass("active"),n.$(".text-mapfilter-status").html("off")):(n.$(".icon-mapfilter-status").addClass("active"),n.$(".text-mapfilter-status").addClass("active"),n.$(".text-mapfilter-status").html("on"));n._applyFilter()},i.prototype._clickFilter=function(n){var t=this;$(n.currentTarget).hasClass("filter-owner-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-owner-item").length==t.$(".filter-owner-item.active").length?t.$(".filter-owner-all").addClass("active"):t.$(".filter-owner-all").removeClass("active"));$(n.currentTarget).hasClass("filter-owner-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-owner-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-owner-item").addClass("active")));$(n.currentTarget).hasClass("filter-adopt-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-adopt-item").length==t.$(".filter-adopt-item.active").length?t.$(".filter-adopt-all").addClass("active"):t.$(".filter-adopt-all").removeClass("active"));$(n.currentTarget).hasClass("filter-adopt-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-adopt-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-adopt-item").addClass("active")));$(n.currentTarget).hasClass("filter-flag-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-flag-item").length==t.$(".filter-flag-item.active").length?t.$(".filter-flag-all").addClass("active"):t.$(".filter-flag-all").removeClass("active"));$(n.currentTarget).hasClass("filter-flag-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-flag-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-flag-item").addClass("active")));$(n.currentTarget).hasClass("filter-rating-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-rating-item").length==t.$(".filter-rating-item.active").length?t.$(".filter-rating-all").addClass("active"):t.$(".filter-rating-all").removeClass("active"));$(n.currentTarget).hasClass("filter-rating-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-rating-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-rating-item").addClass("active")));$(n.currentTarget).hasClass("filter-last-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-last-item").length==t.$(".filter-last-item.active").length?t.$(".filter-last-all").addClass("active"):t.$(".filter-last-all").removeClass("active"));$(n.currentTarget).hasClass("filter-last-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-last-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-last-item").addClass("active")));t.$(".filter-owner-all").hasClass("active")&&t.$(".filter-adopt-all").hasClass("active")&&t.$(".filter-flag-all").hasClass("active")&&t.$(".filter-rating-all").hasClass("active")&&t.$(".filter-last-all").hasClass("active")?(t.$(".icon-mapfilter-status").removeClass("active"),t.$(".text-mapfilter-status").removeClass("active"),t.$(".text-mapfilter-status").html("off")):(t.$(".icon-mapfilter-status").addClass("active"),t.$(".text-mapfilter-status").addClass("active"),t.$(".text-mapfilter-status").html("on"));t._applyFilter()},i.prototype._applyFilter=function(){var t=this,i=n.Model.getTrees(),r,u,f;t._selectedFood!=null&&(i=i.filterByFoodIds([t._selectedFood.getId()]));r=[];t.$(".filter-owner-all").hasClass("active")?$.each(t.$(".filter-owner-item"),function(n,t){r.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-owner-item"),function(n,t){$(t).hasClass("active")&&r.push(parseInt($(t).attr("data-id")))});i=i.filterByOwnershipIds(r);u=[];t.$(".filter-adopt-all").hasClass("active")?$.each(t.$(".filter-adopt-item"),function(n,t){u.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-adopt-item"),function(n,t){$(t).hasClass("active")&&u.push(parseInt($(t).attr("data-id")))});i=i.filterByAdoptStatus(u);f=[];t.$(".filter-flag-all").hasClass("active")?$.each(t.$(".filter-flag-item"),function(n,t){f.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-flag-item"),function(n,t){$(t).hasClass("active")&&f.push(parseInt($(t).attr("data-id")))});i=i.filterByFlagIds(f);t.updateMarkers(i)},i.prototype._mouseClick=function(t){var i=this;i._selectedMarker!=undefined?n.EventHandler.handleMouseClick($(t.currentTarget),i,{marker:i._selectedMarker,tree:i._selectedMarker.options.id}):n.EventHandler.handleMouseClick($(t.currentTarget),i,{marker:i._selectedMarker})},i.prototype.renderFlagInfo=function(t){var i=this;n.Controller.checkIsAdmin(function(){$.each(i.$(".flag-radio"),function(n,i){var r=!1;$.each(t,function(n,t){parseInt($(i).attr("data-target"))==t&&(r=!0)});r?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""}));parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled"))})},function(){$.each(i.$(".flag-radio"),function(n,i){var r=!1;$.each(t,function(n,t){parseInt($(i).attr("data-target"))==t&&(r=!0)});r?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"}),$(i).removeClass("hidden")):($(i).removeClass("active"),$(i).find("input").prop({checked:""}),$(i).addClass("hidden"));parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled"));$(i).css({"pointer-events":"none"})})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.renderOwnershipInfo=function(t){var i=this;n.Controller.checkIsAdmin(function(){$.each(i.$(".ownership-radio"),function(n,i){t!=undefined&&(parseInt($(i).attr("data-target"))==t.getId()?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""})),parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled")))})},function(){$.each(i.$(".ownership-radio"),function(n,i){t!=undefined&&(parseInt($(i).attr("data-target"))==t.getId()?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""}),$(i).addClass("hidden")),parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled")),$(i).css({"pointer-events":"none"}))})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.updateTreeAddress=function(t,i){var r=this;i.trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(i){i.road+", "+i.county+", "+i.state+", "+i.postcode!=t.getAddress()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_ADDRESS,{address:i.road+", "+i.county+", "+i.state+", "+i.postcode},function(){var i=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Address of <strong><i>"+i.getName()+" "+t.getName()+"<\/i><\/strong> has been changed successfully.",!0);r.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):r.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.getAddress().trim()!=i.trim()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_ADDRESS,{address:i.trim()},function(){var i=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Address of <strong><i>"+i.getName()+" "+t.getName()+"<\/i><\/strong> has been changed successfully.",!0);r.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):r.renderTreeInfo(t)},i.prototype.updateTreeDescription=function(t,i){var r=this;t.getDescription().trim()!=i.trim()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_DESCRIPTION,{description:i},function(){var i=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Description of <strong><i>"+i.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);r.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):r.renderTreeInfo(t)},i.prototype.updateTreeFoodType=function(t,i){var r=this;t.getFoodId()!=i?(n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_FOODTYPE,{food:i},function(){var i=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Food type of <strong><i>"+i.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);r._selectedMarker.label._container.innerHTML=i.getName()+" "+t.getName();r._selectedMarker.setIcon(n.MarkerFractory.getIcon(i));r.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),r.renderTreeInfo(t)):r.renderTreeInfo(t)},i.prototype.updateTreeLocation=function(t,i){var r=this;i.lat!=r._selectedMarker.getLatLng().lat||i.lng!=r._selectedMarker.getLatLng().lng?r._selectedMarker!=undefined&&r._selectedMarker.options.id!=undefined&&n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_LOCATION,{marker:r._selectedMarker,location:i},function(){var i=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Location of <strong><i>"+i.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);r._selectedMarker.setLatLng(t.getLocation());r._map.setView(t.getLocation());r.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):r.renderTreeInfo(t)},i.prototype._updateFlag=function(t){var r=this,i=n.Model.getTrees().findWhere({id:r._selectedMarker.options.id}),u=parseInt($(t.target).attr("data-target"));setTimeout(function(){$(t.target).find('input[type="checkbox"]').prop("checked")?n.EventHandler.handleTreeData(i,n.DATA_MODE.UPDATE_FLAG,{flag:u,addmode:!0},function(){var t=n.Model.getFoods().findWhere({id:i.getFoodId()});r.renderFlagInfo(i.getFlags());n.EventHandler.handleDataChange("Status of <strong><i>"+t.getName()+" "+i.getName()+"<\/i><\/strong> has changed successfully.",!0);r._applyFilter()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):n.EventHandler.handleTreeData(i,n.DATA_MODE.UPDATE_FLAG,{flag:u,addmode:!1},function(){var t=n.Model.getFoods().findWhere({id:i.getFoodId()});r.renderFlagInfo(i.getFlags());n.EventHandler.handleDataChange("Status of <strong><i>"+t.getName()+" "+i.getName()+"<\/i><\/strong> has changed successfully.",!0);r._applyFilter()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},1)},i.prototype._updateOwnership=function(t){var r=this,i=n.Model.getTrees().findWhere({id:r._selectedMarker.options.id}),u=parseInt($(t.target).attr("data-target"));i.getOwnershipId()!=u&&n.EventHandler.handleTreeData(i,n.DATA_MODE.UPDATE_OWNERSHIP,{ownership:u},function(){var t=n.Model.getFoods().findWhere({id:i.getFoodId()}),u=n.Model.getOwnerships().findWhere({id:i.getOwnershipId()});r.renderOwnershipInfo(u);n.EventHandler.handleDataChange("Ownership of <strong><i>"+t.getName()+" "+i.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype._toggleMarkerLock=function(n){var t=this;t._selectedMarker.options.draggable?(t._selectedMarker.options.draggable=!1,t._selectedMarker.dragging.disable(),$(n.target).html('<i class="fa fa-lock fa-2x"><\/i>'),t._selectedMarker._popup.setContent('<div class="marker-control-wrapper">'+$(".marker-control-wrapper").html()+"<\/div>")):(t._selectedMarker.options.draggable=!0,t._selectedMarker.dragging.enable(),$(n.target).html('<i class="fa fa-unlock-alt fa-2x"><\/i>'),t._selectedMarker._popup.setContent('<div class="marker-control-wrapper">'+$(".marker-control-wrapper").html()+"<\/div>"))},i.TAG="TreesMapView - ",i}(t);n.TreesMapView=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i){var u=this,r;t.call(this,i);this.renderFilterList=function(){var t=u,i=_.template(n.Template.getTreesFilterListTemplateForGuest());n.Controller.fetchAllFlagsAndOwners(function(){t.$("#content-mapfilter").html(i({header:"Filter List",flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()}))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)});n.Controller.fetchAllFoods(function(){var i=_.template(n.Template.getFoodItemTemplate());t.$("#list-food").html(i({foods:n.Model.getFoods()}));$("#list-food").btsListFilter("#input-search-food",{itemChild:"span",itemEl:".item-food",emptyNode:function(){return""}})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderTreeInfo=function(t){var i=u,t;t==undefined&&i._selectedMarker!=undefined&&(t=n.Model.getTrees().findWhere({id:parseInt(i._selectedMarker.options.id)}));n.Controller.fetchAllFlagsAndOwners(function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()}),e=n.Model.getOwnerships().findWhere({id:t.getOwnershipId()}),u=_.template(n.Template.getTreeInfoTemplateForGuest()),f={foodname:r.getName(),treename:t.getName(),description:t.getDescription(),flags:n.Model.getFlags()};i.$("#wrapper-treeinfo").html(u(f));i.$("#wrapper-treeinfo").removeClass("hidden");i.renderFlagInfo(t.getFlags());i.renderRecentComments(t);i.$(".input-address").replaceWith('<div class="input-address"><\/div>');t.getAddress().trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(n){i.$(".input-address").html(n.road+", "+n.county+", "+n.state+", "+n.country+", "+n.postcode)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.$(".input-address").html(t.getAddress())},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};r=this;r.events={"click .evt-close":"removeTreeInfo","click .btn-mapfilter":"_toggleMapFilter","click .btn-filter":"_clickFilter","keydown #wrapper-food-search":"_searchFood","click #input-search-food":"_searchFood","click #wrapper-food-search .form-control-feedback":"_resetSearchFood","click .item-food":"_applySearch","click .evt-reset-filter":"_resetFilter","click .btn-action":"_mouseClick"};r.delegateEvents()}return __extends(i,t),i.prototype.resize=function(){t.prototype.resize.call(this);var n=this},i.prototype.render=function(r){var u,f;return t.prototype.render.call(this,r),u=this,u.bDebug&&console.log(i.TAG+"render()"),f=_.template(n.Template.getTreesMapViewTemplateForGuest()),u.$el.html(f({})),n.Controller.updateGeoLocation(u.renderMap,u.renderMapError),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.TAG="TreesMapViewForGuest - ",i}(n.TreesMapView);n.TreesMapViewForGuest=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i){var u=this,r;t.call(this,i);this.renderFilterList=function(){var t=u,i=_.template(n.Template.getTreesFilterListTemplateForParent());n.Controller.fetchAllFlagsAndOwners(function(){t.$("#content-mapfilter").html(i({header:"Filter List",flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()}))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)});n.Controller.fetchAllFoods(function(){var i=_.template(n.Template.getFoodItemTemplate());t.$("#list-food").html(i({foods:n.Model.getFoods()}));$("#list-food").btsListFilter("#input-search-food",{itemChild:"span",itemEl:".item-food",emptyNode:function(){return""}})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)});n.Controller.checkIsLoggedIn(function(n){t.$("#checkbox-mytrees").attr({"data-id":n.id})},function(t){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderTreeInfo=function(t){var i=u,t;t==undefined&&i._selectedMarker!=undefined&&(t=n.Model.getTrees().findWhere({id:parseInt(i._selectedMarker.options.id)}));n.Controller.fetchAllFlagsAndOwners(function(){n.Controller.checkIsLoggedIn(function(r){var u;if(i._selectedMarker){var f=n.Model.getAdopts().findWhere({tree:i._selectedMarker.options.id,parent:parseInt(r.id)}),e=n.Model.getFoods().findWhere({id:t.getFoodId()}),o=n.Model.getOwnerships().findWhere({id:t.getOwnershipId()});u=f?_.template(n.Template.getAdoptedTreeInfoTemplateForParent()):_.template(n.Template.getUnadoptedTreeInfoTemplateForParent());i.$("#wrapper-treeinfo").html(u({foodname:e.getName(),treename:t.getName(),description:t.getDescription(),flags:n.Model.getFlags()}));i.$("#wrapper-treeinfo").removeClass("hidden");i.renderFlagInfo(t.getFlags());i.renderRecentComments(t);i.$(".input-address").replaceWith('<div class="input-address"><\/div>');t.getAddress().trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(n){i.$(".input-address").html(n.road+", "+n.county+", "+n.state+", "+n.country+", "+n.postcode)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.$(".input-address").html(t.getAddress())}},function(t){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};r=this;r.events={"click .evt-close":"removeTreeInfo","click .btn-mapfilter":"_toggleMapFilter","click .btn-filter":"_clickFilter","keydown #wrapper-food-search":"_searchFood","click #input-search-food":"_searchFood","click #wrapper-food-search .form-control-feedback":"_resetSearchFood","click .item-food":"_applySearch","change #checkbox-mytrees":"_toggleMyTrees","click .evt-reset-filter":"_resetFilter","click .btn-action":"_mouseClick"};r.delegateEvents()}return __extends(i,t),i.prototype.resize=function(){t.prototype.resize.call(this);var n=this},i.prototype.render=function(r){var u,f;return t.prototype.render.call(this,r),u=this,u.bDebug&&console.log(i.TAG+"render()"),f=_.template(n.Template.getTreesMapViewTemplateForParent()),u.$el.html(f({})),u.$("#checkbox-mytrees").bootstrapToggle({on:"My Trees (On)",off:"My Trees (Off)"}),n.Controller.updateGeoLocation(u.renderMap,u.renderMapError),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.prototype._toggleMyTrees=function(){var n=this;n._applyFilter()},i.prototype._applyFilter=function(){var t=this,i=n.Model.getTrees(),r,u,f;t._selectedFood!=null&&(i=i.filterByFoodIds([t._selectedFood.getId()]));r=[];t.$(".filter-owner-all").hasClass("active")?$.each(t.$(".filter-owner-item"),function(n,t){r.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-owner-item"),function(n,t){$(t).hasClass("active")&&r.push(parseInt($(t).attr("data-id")))});i=i.filterByOwnershipIds(r);u=[];t.$(".filter-adopt-all").hasClass("active")?$.each(t.$(".filter-adopt-item"),function(n,t){u.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-adopt-item"),function(n,t){$(t).hasClass("active")&&u.push(parseInt($(t).attr("data-id")))});i=i.filterByAdoptStatus(u);f=[];t.$(".filter-flag-all").hasClass("active")?$.each(t.$(".filter-flag-item"),function(n,t){f.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-flag-item"),function(n,t){$(t).hasClass("active")&&f.push(parseInt($(t).attr("data-id")))});i=i.filterByFlagIds(f);t.$("#checkbox-mytrees").prop("checked")&&(i=i.filterByParent(parseInt(t.$("#checkbox-mytrees").attr("data-id"))));t.updateMarkers(i)},i.TAG="TreesMapViewForParent - ",i}(n.TreesMapView);n.TreesMapViewForParent=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i){var r=this,u;t.call(this,i);this.renderFilterList=function(){var t=r,i=_.template(n.Template.getTreesFilterListTemplateForAdmin());n.Controller.fetchAllFlagsAndOwners(function(){t.$("#content-mapfilter").html(i({header:"Filter List",flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()}))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)});n.Controller.fetchAllFoods(function(){var i=_.template(n.Template.getFoodItemTemplate());t.$("#list-food").html(i({foods:n.Model.getFoods()}));$("#list-food").btsListFilter("#input-search-food",{itemChild:"span",itemEl:".item-food",emptyNode:function(){return""}})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)});n.Controller.checkIsLoggedIn(function(n){t.$("#checkbox-mytrees").attr({"data-id":n.id})},function(){Backbone.history.loadUrl(Backbone.history.fragment)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderMarkers=function(){var t=r,i;if(console.log(n.TreesMapView.TAG+"renderMarkers()"),$.each(n.Model.getTrees().models,function(n,i){for(var r=!1,u=0;u<t._markers.length&&!r;u++)i.getId()==t._markers[u].options.id&&(r=!0);r||t.addMarker(i,!0)}),t._id!=undefined&&t._id!=0)for(i=0;i<t._markers.length;i++)if(t._markers[i].options.id==t._id){t._markers[i].openPopup();break}};this.updateMarkers=function(t){var i=r,u,f;for(console.log(n.TreesMapView.TAG+"updateMarkers()"),$.each(t.models,function(n,t){for(var r=!1,u=0;u<i._markers.length&&!r;u++)t.getId()==i._markers[u].options.id&&(r=!0);r||i.addMarker(t,!0)}),u=0;u<i._markers.length;)f=!1,$.each(t.models,function(n,t){t.getId()==i._markers[u].options.id&&(f=!0)}),f||(i._markers[u]==i._selectedMarker&&i._selectedMarker.closePopup(),i.removeMarker(i._markers[u]),i._markers=_.without(i._markers,i._markers[u]),u--),u++};this.renderTreeInfo=function(t){var i=r,t;t==undefined&&i._selectedMarker!=undefined&&(t=n.Model.getTrees().findWhere({id:parseInt(i._selectedMarker.options.id)}));n.Controller.fetchAllFlagsAndOwners(function(){n.Controller.checkIsLoggedIn(function(r){var f;if(i._selectedMarker){var e=n.Model.getAdopts().findWhere({tree:i._selectedMarker.options.id,parent:parseInt(r.id)}),u=n.Model.getFoods().findWhere({id:t.getFoodId()}),o=n.Model.getOwnerships().findWhere({id:t.getOwnershipId()});f=e?_.template(n.Template.getAdoptedTreeInfoTemplateForAdmin()):_.template(n.Template.getUnadoptedTreeInfoTemplateForAdmin());i.$("#wrapper-treeinfo").html(f({foodname:u.getName(),treename:t.getName(),lat:t.getLat().toFixed(4),lng:t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships(),description:t.getDescription(),persons:t.getParents()}));i.$("#wrapper-treeinfo").removeClass("hidden");i.renderFlagInfo(t.getFlags());i.renderOwnershipInfo(o);i.renderRecentComments(t);i.$(".input-address").replaceWith('<div class="input-address"><\/div>');t.getAddress().trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(n){i.$(".input-address").html(n.road+", "+n.county+", "+n.state+", "+n.country+", "+n.postcode)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.$(".input-address").html(t.getAddress());i.$(".input-address").on("click",function(){$(this).replaceWith("<input type='text' class='input-address form-control' value='"+htmlEncode($(this).text())+"' />");i.$(".input-address").focus();i.$(".input-address").on("focusout",function(){i.updateTreeAddress(t,i.$(".input-address").val())});i.$(".input-address").on("keydown",function(n){n.keyCode==13?i.updateTreeAddress(t,i.$(".input-address").val()):n.keyCode==27&&i.renderTreeInfo(t)})});i.$(".input-description").on("click",function(){$(this).replaceWith("<input type='text' class='input-description form-control' value='"+htmlEncode($(this).text())+"' />");i.$(".input-description").focus();i.$(".input-description").on("focusout",function(){i.updateTreeDescription(t,i.$(".input-description").val())});i.$(".input-description").on("keydown",function(n){n.keyCode==13?i.updateTreeDescription(t,i.$(".input-description").val()):n.keyCode==27&&i.renderTreeInfo(t)})});i.$(".input-food").on("click",function(){var r=_.template(n.Template.FoodSelectTemplate()),f={foods:n.Model.getFoods()};$(this).replaceWith(r(f));i.$(".input-food").selectpicker();i.$(".input-food").selectpicker("val",u.getId());i.$(".input-food").on("hide.bs.dropdown",function(){i.updateTreeFoodType(t,parseInt($(this).find("option:selected").val()))});i.$(".input-lat").on("focusout",function(){i.renderTreeInfo(t)});i.$(".input-lat").on("keydown",function(n){n.keyCode==27&&i.renderTreeInfo(t)})});i.$(".input-lat").on("click",function(){$(this).replaceWith("<input class='input-lat form-control' value='"+$(this).html()+"' />");i.$(".input-lat").focus();i.$(".input-lat").on("focusout",function(){i.updateTreeLocation(t,new L.LatLng(parseFloat(i.$(".input-lat").val()),i._selectedMarker.getLatLng().lng))});i.$(".input-lat").on("keydown",function(n){n.keyCode==13?i.updateTreeLocation(t,new L.LatLng(parseFloat(i.$(".input-lat").val()),i._selectedMarker.getLatLng().lng)):n.keyCode==27&&i.renderTreeInfo(t)})});i.$(".input-lng").on("click",function(){var n=i.$(".input-lng").outerWidth()+8;$(this).replaceWith("<input class='input-lng form-control' value='"+$(this).html()+"' />");i.$(".input-lng").focus();i.$(".input-lng").on("focusout",function(){i.updateTreeLocation(t,new L.LatLng(i._selectedMarker.getLatLng().lat,parseFloat(i.$(".input-lng").val())))});i.$(".input-lng").on("keydown",function(n){n.keyCode==13?i.updateTreeLocation(t,new L.LatLng(i._selectedMarker.getLatLng().lat,parseFloat(i.$(".input-lng").val()))):n.keyCode==27&&i.renderTreeInfo(t)})})}},function(t){new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(t.code),undoable:!1}).execute()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};u=this;u.events={"click .evt-close":"removeTreeInfo","click .btn-mapfilter":"_toggleMapFilter","click .evt-marker-lock":"_toggleMarkerLock","click .btn-filter":"_clickFilter","keydown #wrapper-food-search":"_searchFood","click #input-search-food":"_searchFood","click #wrapper-food-search .form-control-feedback":"_resetSearchFood","click .item-food":"_applySearch","change #checkbox-mytrees":"_toggleMyTrees","click .evt-reset-filter":"_resetFilter","click .btn-action":"_mouseClick","click .flag-radio":"_updateFlag","click .ownership-radio":"_updateOwnership"};u.delegateEvents()}return __extends(i,t),i.prototype.resize=function(){t.prototype.resize.call(this);var n=this},i.prototype.render=function(r){var u,f;return t.prototype.render.call(this,r),u=this,u.bDebug&&console.log(i.TAG+"render()"),f=_.template(n.Template.getTreesMapViewTemplateForAdmin()),u.$el.html(f({})),u.$("#checkbox-mytrees").bootstrapToggle({on:"My Trees (On)",off:"My Trees (Off)"}),n.Controller.updateGeoLocation(u.renderMap,u.renderMapError),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.prototype._toggleMyTrees=function(){var n=this;n._applyFilter()},i.prototype._applyFilter=function(){var t=this,i=n.Model.getTrees(),r,u,f;t._selectedFood!=null&&(i=i.filterByFoodIds([t._selectedFood.getId()]));r=[];t.$(".filter-owner-all").hasClass("active")?$.each(t.$(".filter-owner-item"),function(n,t){r.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-owner-item"),function(n,t){$(t).hasClass("active")&&r.push(parseInt($(t).attr("data-id")))});i=i.filterByOwnershipIds(r);u=[];t.$(".filter-adopt-all").hasClass("active")?$.each(t.$(".filter-adopt-item"),function(n,t){u.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-adopt-item"),function(n,t){$(t).hasClass("active")&&u.push(parseInt($(t).attr("data-id")))});i=i.filterByAdoptStatus(u);f=[];t.$(".filter-flag-all").hasClass("active")?$.each(t.$(".filter-flag-item"),function(n,t){f.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-flag-item"),function(n,t){$(t).hasClass("active")&&f.push(parseInt($(t).attr("data-id")))});i=i.filterByFlagIds(f);t.$("#checkbox-mytrees").prop("checked")&&(i=i.filterByParent(parseInt(t.$("#checkbox-mytrees").attr("data-id"))));t.updateMarkers(i)},i.prototype._mouseClick=function(t){var i=this,r;$(t.currentTarget).hasClass("evt-add-tree")?(r=new n.Tree({lat:i._map.getCenter().lat,lng:i._map.getCenter().lng,food:1,type:0,flag:0,owner:0,ownership:1,description:"",address:""}),n.EventHandler.handleMouseClick($(t.currentTarget),i,{tree:r})):i._selectedMarker!=undefined?n.EventHandler.handleMouseClick($(t.currentTarget),i,{marker:i._selectedMarker,tree:i._selectedMarker.options.id}):n.EventHandler.handleMouseClick($(t.currentTarget),i,{marker:i._selectedMarker})},i.TAG="TreesMapViewForAdmin - ",i}(n.TreesMapView);n.TreesMapViewForAdmin=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var i=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use TreesTableViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n){return new t({el:n})},n._instance=new n,n}(),t;n.TreesTableViewFactory=i;t=function(t){function i(i){var r=this,u;t.call(this,i);this.renderTrees=function(){var t=r;n.Controller.fetchAllTrees(function(){t.renderTreeList(n.Model.getTrees());t.renderFilterList()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderTreeList=function(t){var f=r,u=[],i;u.push({name:"Food",values:n.Model.getFoods().toArray()});TreeColumn[0].cell=Backgrid.SelectCell.extend({editor:Backgrid.FoodSelectCellEditor,optionValues:u});i=new Backgrid.Grid({columns:TreeColumn,collection:t,emptyText:n.Setting.getNoDataText()});i.render();i.sort("id","ascending");f.$(".list-tree").html(i.el)};this.renderFilterList=function(){var t=r,i=_.template(n.Template.getTreesFilterListTemplateForAdmin()),u={header:"Filter List",flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()};t.$(".tree-filter").html(i(u));t._applyFilter()};this._addTree=function(){var t=r;t.$(".new-tree").hasClass("hidden")?n.Controller.updateGeoLocation(t.renderNewTree,t.renderGeoLocationError):t.$(".new-tree").addClass("hidden")};this.renderNewTree=function(t){var f=r,o=new n.Tree({lat:t.coords.latitude,lng:t.coords.longitude,food:1,type:0,flag:0,owner:0,ownership:1,description:"",address:""}),e=new n.Trees,i,u;e.add(o);i=[];i.push({name:"Food",values:n.Model.getFoods().toArray()});NewTreeColumn[0].cell=Backgrid.SelectCell.extend({editor:Backgrid.FoodSelectCellEditor,optionValues:i});u=new Backgrid.Grid({columns:NewTreeColumn,collection:e,emptyText:n.Setting.getNoDataText()});u.render();f.$(".new-tree").html(u.el);f.$(".new-tree").removeClass("hidden")};this.renderGeoLocationError=function(t){var i=r;switch(t.code){case t.PERMISSION_DENIED:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR);break;case t.POSITION_UNAVAILABLE:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR)}};u=this;u.bDebug=!0;u.events={"click .evt-close":"_mouseClick","click .btn-filter":"_clickFilter","click .evt-reset-filter":"_resetFilter","click .evt-add-tree":"_addTree"};u.delegateEvents()}return __extends(i,t),i.prototype.render=function(r){var u,f,e;return t.prototype.render.call(this,r),u=this,u.bDebug&&console.log(i.TAG+"render()"),f=_.template(n.Template.getTreesTableViewTemplateForAdmin()),e={header:"Tree List"},u.$el.html(f(e)),u.setElement(u.$("#wrapper-tree-list")),u.renderTrees(),u.setVisible(),u.resize(),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.prototype.resize=function(){var n=this},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._clickFilter=function(n){var t=this;$(n.currentTarget).hasClass("filter-owner-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-owner-item").length==t.$(".filter-owner-item.active").length?t.$(".filter-owner-all").addClass("active"):t.$(".filter-owner-all").removeClass("active"));$(n.currentTarget).hasClass("filter-owner-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-owner-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-owner-item").addClass("active")));$(n.currentTarget).hasClass("filter-adopt-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-adopt-item").length==t.$(".filter-adopt-item.active").length?t.$(".filter-adopt-all").addClass("active"):t.$(".filter-adopt-all").removeClass("active"));$(n.currentTarget).hasClass("filter-adopt-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-adopt-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-adopt-item").addClass("active")));$(n.currentTarget).hasClass("filter-flag-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-flag-item").length==t.$(".filter-flag-item.active").length?t.$(".filter-flag-all").addClass("active"):t.$(".filter-flag-all").removeClass("active"));$(n.currentTarget).hasClass("filter-flag-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-flag-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-flag-item").addClass("active")));$(n.currentTarget).hasClass("filter-rating-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-rating-item").length==t.$(".filter-rating-item.active").length?t.$(".filter-rating-all").addClass("active"):t.$(".filter-rating-all").removeClass("active"));$(n.currentTarget).hasClass("filter-rating-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-rating-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-rating-item").addClass("active")));$(n.currentTarget).hasClass("filter-last-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-last-item").length==t.$(".filter-last-item.active").length?t.$(".filter-last-all").addClass("active"):t.$(".filter-last-all").removeClass("active"));$(n.currentTarget).hasClass("filter-last-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-last-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-last-item").addClass("active")));t._applyFilter()},i.prototype._resetFilter=function(){var n=this;n.$(".filter-owner-all").addClass("active");n.$(".filter-adopt-all").addClass("active");n.$(".filter-flag-all").addClass("active");n.$(".filter-rating-all").addClass("active");n.$(".filter-last-all").addClass("active");n.$(".filter-owner-item").removeClass("active");n.$(".filter-adopt-item").removeClass("active");n.$(".filter-flag-item").removeClass("active");n.$(".filter-rating-item").removeClass("active");n.$(".filter-last-item").removeClass("active");n._applyFilter()},i.prototype._applyFilter=function(){var t=this,i=n.Model.getTrees(),f=[],r,u;t.$(".filter-owner-all").hasClass("active")?$.each(t.$(".filter-owner-item"),function(n,t){f.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-owner-item"),function(n,t){$(t).hasClass("active")&&f.push(parseInt($(t).attr("data-id")))});i=i.filterByOwnershipIds(f);r=[];t.$(".filter-adopt-all").hasClass("active")?$.each(t.$(".filter-adopt-item"),function(n,t){r.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-adopt-item"),function(n,t){$(t).hasClass("active")&&r.push(parseInt($(t).attr("data-id")))});i=i.filterByAdoptStatus(r);u=[];t.$(".filter-flag-all").hasClass("active")?$.each(t.$(".filter-flag-item"),function(n,t){u.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-flag-item"),function(n,t){$(t).hasClass("active")&&u.push(parseInt($(t).attr("data-id")))});i=i.filterByFlagIds(u);t.renderTreeList(i)},i.TAG="TreesTableView - ",i}(n.PopupView);n.TreesTableView=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var r=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use TreeViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var r=new i({el:n});return r.setTreeId(t),r},n._instance=new n,n}(),t,i;n.TreeViewFractory=r;t=function(n){function t(){n.apply(this,arguments);this._bAuthor=!1}return __extends(t,n),t.prototype.setTreeId=function(n){this._id=Math.floor(n)},t}(n.BaseView);n.TreeView=t;i=function(t){function i(r){var f=this,u;t.call(this,r);this.renderChartDatePicker=function(){var t=f,i;t._tree=n.Model.getTrees().findWhere({id:t._id});t.$(".tree-graph-start").attr({"data-value":moment(new Date).subtract(3,"month").format(n.Setting.getDateFormat())});t._startDate=moment(moment(new Date).subtract(3,"month").format(n.Setting.getDateFormat())).format(n.Setting.getDateTimeFormat());t.$(".tree-graph-start").pickadate({format:"dd mmm yyyy",today:"",max:new Date(moment(new Date).subtract("day",2).valueOf()),clear:"",close:"Close",onClose:function(){t._startDate=moment(this.get()).startOf("day").format(n.Setting.getDateTimeFormat());t.renderTreeChart(t._tree,t._startDate,t._endDate)}});i=new Date;t._endDate=moment(i).endOf("day").format(n.Setting.getDateTimeFormat());t.$(".tree-graph-end").attr({"data-value":moment(new Date).format(n.Setting.getDateFormat())});t.$(".tree-graph-end").pickadate({format:"dd mmm yyyy",today:"Today",max:i,clear:"",close:"Close",onClose:function(){t._endDate=moment(this.get()).endOf("day").format(n.Setting.getDateTimeFormat());t.renderTreeChart(t._tree,t._startDate,t._endDate)}});t.renderTreeChart(t._tree,t._startDate,t._endDate)};this.renderTreeChart=function(t,r,u){var e=f;e.bDebug&&console.log(i.TAG+"renderTreeChart()");n.Controller.fetchCommentsOfTreesDuringPeriod([e._tree],r,u,1e4,0,function(){var h,c,t,s,l;e.$("#wrapper-chart").html('<canvas id="content-chart" class="content-chart" />');h=e.$("#content-chart")[0];e.$("#content-chart").attr({width:e.$("#content-chart").innerWidth(),height:e.$("#content-chart").innerHeight()});c=h.getContext("2d");e.$("#wrapper-graph").on("mousemove",function(n){n.clientX-24-$("#wrapper-tooltip").outerWidth()<0?e.$("#wrapper-tooltip").css({top:n.clientY-60,left:n.clientX+24}):e.$("#wrapper-tooltip").css({top:n.clientY-60,left:n.clientX-24-e.$("#wrapper-tooltip").outerWidth()})});e.$("#wrapper-graph").on("mouseleave",function(){e.$("#wrapper-tooltip").addClass("hidden")});var o=[],f=[],a=moment(r).set("hour",13).set("minute",0).set("seconds",0).set("milliseconds",0);for(t=moment(a).valueOf();t<moment(u).add("day",1).valueOf();t+=864e5)o.push(moment(t).format(n.Setting.getDateHourFormat())),s=n.Model.getNotes().getLatestImageNoteOfDate(e._tree.getId(),t,n.NoteType.IMAGE),s?f.push(s):f.push(new n.Note({type:n.NoteType.IMAGE,tree:e._tree.getId(),person:0,comment:"",picture:"",rate:0,cover:0,date:moment(t).format(n.Setting.getDateTimeFormat())}));e.bDebug&&console.log(i.TAG+"Graph Points Length: "+f.length);l=Math.floor(o.length/(e.$("#content-chart").innerWidth()/150));e._chart&&e._chart.destroy();e._chart=new Chart(c).Line({labels:o,datasets:[{label:"My First dataset",fillColor:"rgba(132,167,87,0.4)",strokeColor:"rgba(132,167,87,1)",pointColor:"rgba(132,167,87,1)",pointStrokeColor:"rgba(132,167,87,1)",pointHighlightFill:"rgba(220,220,220,1)",pointHighlightStroke:"rgba(132,167,87,1)",data:f},]},{scaleOverride:!0,scaleSteps:1,scaleStepWidth:10,scaleStartValue:0,pointDotRadius:3,pointDotStrokeWidth:2,bezierCurve:!1,pointHitDetectionRadius:e.$("#content-chart").innerWidth()/f.length*.5,pointDot:!1,labelskip:l,customTooltips:function(t){if(!t||!t.id){e.$("#wrapper-tooltip").addClass("hidden");return}if(e._note=n.Model.getNotes().findWhere({id:t.id}),e._note){var i=_.template(n.Template.getToolTipTemplate()),r={image:n.Setting.getBlankImagePath(),value:e._note.getRate().toFixed(2)+" / "+n.Setting.getMaxRating().toFixed(2),comment:htmlDecode(e._note.getComment()),date:t.label};e.$("#wrapper-tooltip").html(i(r));e._note.getPictures().length>0?e.$("#wrapper-tooltip img").attr("src",n.Setting.getContentPictureDir()+e._note.getPictures()[0]).load(function(){$(this).removeClass("hidden")}).error(function(){$(this).attr("src",n.Setting.getBlankImagePath());$(this).addClass("hidden")}):e.$("#wrapper-tooltip img").addClass("hidden")}else e.$("#wrapper-tooltip img").addClass("hidden");e.$("#wrapper-tooltip").removeClass("hidden")}})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderTreeInfo=function(){var n=f;n._bAuthor=!1};u=this;u.bDebug=!0;u.events={"click .btn-date":"_applyDatePreset"};u.delegateEvents()}return __extends(i,t),i.prototype.resetNote=function(){var n=this;n._note=null},i.prototype.render=function(r){var u,f;t.prototype.render.call(this,r);u=this;u.bDebug&&console.log(i.TAG+"render()");f=_.template(n.Template.getTreeGraphicViewTemplate());u.$el.html(f({}));u.setElement(u.$("#wrapper-tree"));u.resize();n.Controller.fetchAllTrees(function(){u.renderChartDatePicker()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.update=function(n){t.prototype.update.call(this,n);var i=this},i.prototype.resize=function(){var n=this},i.prototype._applyDatePreset=function(t){var i=this;$(t.currentTarget).hasClass("4years")?i._startDate=moment(i._endDate).subtract(4,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("2years")?i._startDate=moment(i._endDate).subtract(2,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("1year")?i._startDate=moment(i._endDate).subtract(1,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("6months")?i._startDate=moment(i._endDate).subtract(6,"months").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("3months")?i._startDate=moment(i._endDate).subtract(3,"months").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("1month")&&(i._startDate=moment(i._endDate).subtract(1,"months").startOf("day").format(n.Setting.getDateTimeFormat()));i.$(".tree-graph-start").pickadate("picker").set("select",moment(i._startDate).format(n.Setting.getDateFormat()),{format:"dd mmm yyyy"});i.renderTreeChart(i._tree,i._startDate,i._endDate)},i.TAG="TreeGraphicView - ",i}(t);n.TreeGraphicView=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var u=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use ManageTreesViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(){var n;return n},n._instance=new n,n}(),t,i,r;n.ManageTreesViewFractory=u;t=function(n){function t(){n.apply(this,arguments);this.renderTreeInfo=function(){};this.renderFilterList=function(){}}return __extends(t,n),t.prototype.setTreeId=function(n){this._id=n},t.prototype._applyFilter=function(){},t}(n.BaseView);n.ManageTreesView=t;i=function(t){function i(i){var r=this,u;t.call(this,i);this.renderTrees=function(){var t=r;n.Controller.fetchAllTrees(function(){t.renderTreeList(n.Model.getTrees());t.renderFilterList()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderTreeList=function(t){var f=r,u=[],i;u.push({name:"Food",values:n.Model.getFoods().toArray()});TreeColumn[0].cell=Backgrid.SelectCell.extend({editor:Backgrid.FoodSelectCellEditor,optionValues:u});i=new Backgrid.Grid({columns:TreeColumn,collection:t,emptyText:n.Setting.getNoDataText()});i.render();i.sort("id","ascending");f.$(".list-tree").html(i.el)};this._addNewTree=function(){var t=r;t.$(".new-tree").hasClass("hidden")?n.Controller.updateGeoLocation(t.renderNewTree,t.renderGeoLocationError):t.$(".new-tree").addClass("hidden")};this.renderNewTree=function(t){var i=r,o=new n.Tree({lat:t.coords.latitude,lng:t.coords.longitude,food:1,type:0,flag:0,owner:0,ownership:1,description:"",address:""}),e=new n.Trees,u,f;e.add(o);u=[];u.push({name:"Food",values:n.Model.getFoods().toArray()});NewTreeColumn[0].cell=Backgrid.SelectCell.extend({editor:Backgrid.FoodSelectCellEditor,optionValues:u});f=new Backgrid.Grid({columns:NewTreeColumn,collection:e,emptyText:n.Setting.getNoDataText()});f.render();i.$(".new-tree").html('<div class="list-title">Add a New Tree<\/div>');i.$(".new-tree").append(f.el);i.$(".new-tree").removeClass("hidden")};this.renderGeoLocationError=function(t){var i=r;switch(t.code){case t.PERMISSION_DENIED:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR);break;case t.POSITION_UNAVAILABLE:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR)}};this.renderFilterList=function(){var t=r;n.Controller.checkLogin(function(i){var r;i.result==!0||i.result=="true"?(r=_.template(n.Template.getTreeFilterListTemplate()),t.$("#filter-list").html(r({foods:n.Model.getFoods(),userid:parseInt(i.id),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()}))):(i.result==!1||i.result=="false")&&(r=_.template(n.Template.getTreeFilterListTemplate2()),t.$("#filter-list").html(r({foods:n.Model.getFoods(),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()})))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};u=this;u.bDebug=!0;u.events={"click .switch-map":"_mouseClick","click .filter-checkbox":"_applyFilter","click .add-tree":"_addNewTree"};u.delegateEvents()}return __extends(i,t),i.prototype.render=function(t){var r,u,f;return this.bRendered?(this.update(t),r):(this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=_.template(n.Template.getManageTreesTableViewTemplate()),f={},r.$el.html(u(f)),r.setElement(r.$("#wrapper-mtrees")),r.resize(),r.renderTrees(),r)},i.prototype.resize=function(){$("#content-mtrees-table").css({width:n.View.getWidth()-$("#wrapper-tablemenu").outerWidth()});$(".collapsible-list").css({height:n.View.getHeight()-216})},i.prototype._applyFilter=function(t){var r=this,i=n.Model.getTrees();setTimeout(function(){var n,u,f,e;r.$('input[name="onlymine"]').prop("checked")==!0&&(i=i.filterByParent(parseInt(r.$('input[name="onlymine"]').attr("data-target"))));t!=undefined&&$(t.target).find("input").prop("name")=="ownershipsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-ownership").addClass("active"),$(".filter-ownership input").prop({checked:"checked"})):($(".filter-ownership").removeClass("active"),$(".filter-ownership input").prop({checked:""})));n=[];$.each(r.$(".filter-ownership input"),function(t,i){$(i).prop("checked")==!0&&n.push(Math.floor($(i).prop("name")))});i=i.filterByOwnershipIds(n);t!=undefined&&$(t.target).find("input").prop("name")=="flagsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-flag").addClass("active"),$(".filter-flag input").prop({checked:"checked"})):($(".filter-flag").removeClass("active"),$(".filter-flag input").prop({checked:""})));u=[];$.each(r.$(".filter-flag input"),function(n,t){$(t).prop("checked")==!0&&u.push(Math.floor($(t).prop("name")))});i=i.filterByFlagIds(u);t!=undefined&&$(t.target).find("input").prop("name")=="foodsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-food").addClass("active"),$(".filter-food input").prop({checked:"checked"})):($(".filter-food").removeClass("active"),$(".filter-food input").prop({checked:""})));f=[];$.each(r.$(".filter-food input"),function(n,t){$(t).prop("checked")==!0&&f.push(Math.floor($(t).prop("name")))});i=i.filterByFoodIds(f);t!=undefined&&$(t.target).find("input").prop("name")=="adoptsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-adopt").addClass("active"),$(".filter-adopt input").prop({checked:"checked"})):($(".filter-adopt").removeClass("active"),$(".filter-adopt input").prop({checked:""})));e=[];$.each(r.$(".filter-adopt input"),function(n,t){$(t).prop("checked")==!0&&e.push(Math.floor($(t).prop("name")))});i=i.filterByAdoptStatus(e);r.renderTreeList(i)},1)},i.prototype._mouseOver=function(){var n=this},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.TAG="ManageTreesMapView - ",i}(t);n.ManageTreesTableView=i;r=function(t){function i(r){var u=this,f;t.call(this,r);this._bClosePopupOnClick=!0;this.renderFilterList=function(){var t=u;n.Controller.checkLogin(function(i){var r;i.result==!0||i.result=="true"?(r=_.template(n.Template.getTreeFilterListTemplate()),t.$("#filter-list").html(r({foods:n.Model.getFoods(),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships(),userid:parseInt(i.id)}))):i.result==!1||i.result=="false";r=_.template(n.Template.getFoodItemTemplate());t.$("#list-food").html(r({foods:n.Model.getFoods()}));$("#list-food").btsListFilter("#search-food",{itemChild:"span",itemEl:".food-item",emptyNode:function(){return'<div class="user-item-none">No Result<\/div><div class="clear" />'}})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderForagableList=function(){};this.renderTreeInfo=function(t){var i=u,r=!1,f=!1;n.Controller.checkLogin(function(u){f=u.result==!0||u.result=="true"?!0:!1;n.Controller.checkAdmin(function(e){e.result==!0||e.result=="true"?r=!0:(e.result==!1||e.result=="false")&&(r=!1);n.Controller.fetchAllFlagsAndOwners(function(){var s=n.Model.getFoods().findWhere({id:t.getFoodId()}),c=n.Model.getOwnerships().findWhere({id:t.getOwnershipId()}),h,e,o;if(f?r?(e=_.template(n.Template.getTreeInfoTemplate()),o={foodname:s.getName(),treename:t.getName(),lat:t.getLat().toFixed(4),lng:t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships(),description:t.getDescription(),persons:t.getParents()},i.$("#wrapper-treeinfo").html(e(o))):(i._selectedMarker&&(h=n.Model.getAdopts().findWhere({tree:i._selectedMarker.options.id,parent:parseInt(u.id)})),h?(e=_.template(n.Template.getTreeInfoTemplate5()),o={foodname:s.getName(),treename:t.getName(),lat:t.getLat().toFixed(4),lng:t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships(),description:t.getDescription(),persons:t.getParents()},i.$("#wrapper-treeinfo").html(e(o))):(e=_.template(n.Template.getTreeInfoTemplate4()),o={foodname:s.getName(),treename:t.getName(),lat:t.getLat().toFixed(4),lng:t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships(),description:t.getDescription(),persons:t.getParents()},i.$("#wrapper-treeinfo").html(e(o)))):(e=_.template(n.Template.getTreeInfoTemplate4()),o={foodname:s.getName(),treename:t.getName(),lat:t.getLat().toFixed(4),lng:t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships(),description:t.getDescription(),persons:t.getParents()},i.$("#wrapper-treeinfo").html(e(o))),i.$("#wrapper-treeinfo").removeClass("hidden"),i.renderFlagInfo(t.getFlags()),i.renderOwnershipInfo(c),i.renderRecentActivities(t),i.$(".input-address").replaceWith('<div class="input-address"><\/div>'),t.getAddress().trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(n){i.$(".input-address").html(n.road+", "+n.county+", "+n.state+", "+n.country+", "+n.postcode)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.$(".input-address").html(t.getAddress()),r){i.$(".input-address").on("click",function(){$(this).replaceWith("<input type='text' class='input-address form-control' value='"+htmlEncode($(this).text())+"' />");i.$(".input-address").focus();i.$(".input-address").on("focusout",function(){var r=i.$(".input-address").val();r.trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(r){r.road+", "+r.county+", "+r.state+", "+r.postcode!=t.getAddress()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_ADDRESS,{address:r.road+", "+r.county+", "+r.state+", "+r.postcode},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Address of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has been changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.getAddress().trim()!=r.trim()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_ADDRESS,{address:r.trim()},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Address of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has been changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)})});i.$(".input-description").on("click",function(){$(this).replaceWith("<input type='text' class='input-description form-control' value='"+htmlEncode($(this).text())+"' />");i.$(".input-description").focus();i.$(".input-description").on("focusout",function(){var r=i.$(".input-description").val();t.getDescription().trim()!=r.trim()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_DESCRIPTION,{description:r},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});i.renderRecentActivities(t);n.EventHandler.handleDataChange("Description of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)})});i.$(".input-food").on("click",function(){var r=_.template(n.Template.FoodSelectTemplate()),u={foods:n.Model.getFoods()};$(this).replaceWith(r(u));i.$(".input-food").selectpicker();i.$(".input-food").selectpicker("val",s.getId());i.$(".input-food").on("hide.bs.dropdown",function(){var r=parseInt($(this).find("option:selected").val());t.getFoodId()!=r?(n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_FOODTYPE,{food:r},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Food type of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);i._selectedMarker.label._container.innerHTML=r.getName()+" "+t.getName();i._selectedMarker.setIcon(n.MarkerFractory.getIcon(r));i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),i.renderTreeInfo(t)):i.renderTreeInfo(t)})});i.$(".input-lat").on("click",function(){$(this).replaceWith("<input class='input-lat form-control' value='"+$(this).html()+"' />");i.$(".input-lat").focus();i.$(".input-lat").on("focusout",function(){var r=new L.LatLng(parseFloat(i.$(".input-lat").val()),i._selectedMarker.getLatLng().lng);r.lat!=i._selectedMarker.getLatLng().lat?i._selectedMarker!=undefined&&i._selectedMarker.options.id!=undefined&&n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_LOCATION,{marker:i._selectedMarker,location:r},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});i.renderRecentActivities(t);n.EventHandler.handleDataChange("Location of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);i._selectedMarker.setLatLng(t.getLocation());i._map.setView(t.getLocation());i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)})});i.$(".input-lng").on("click",function(){var r=i.$(".input-lng").outerWidth()+8;$(this).replaceWith("<input class='input-lng form-control' value='"+$(this).html()+"' />");i.$(".input-lng").focus();i.$(".input-lng").on("focusout",function(){var r=new L.LatLng(i._selectedMarker.getLatLng().lat,parseFloat(i.$(".input-lng").val()));r.lng!=i._selectedMarker.getLatLng().lng?i._selectedMarker!=undefined&&i._selectedMarker.options.id!=undefined&&n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_LOCATION,{marker:i._selectedMarker,location:r},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});i.renderRecentActivities(t);n.EventHandler.handleDataChange("Location of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);i._selectedMarker.setLatLng(t.getLocation());i._map.setView(t.getLocation());i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)})})}},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderMapError=function(t){var i=u;switch(t.code){case t.PERMISSION_DENIED:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR);break;case t.POSITION_UNAVAILABLE:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR)}i.renderMap({coords:{accuracy:4196,altitude:null,altitudeAccuracy:null,heading:null,latitude:33.7946333,longitude:-84.448771,speed:null},timestamp:(new Date).valueOf()})};this.renderMap=function(t){var i=u,r=t.coords.accuracy;if(i._location=new L.LatLng(t.coords.latitude,t.coords.longitude),i._map==undefined){i.$("#list-donation").css({height:n.View.getHeight()-60});i.setLocation(new L.LatLng(t.coords.latitude,t.coords.longitude));i._map=L.map($("#content-map")[0].id,{zoomControl:!1,closePopupOnClick:i._bClosePopupOnClick,doubleClickZoom:!0,touchZoom:!0,zoomAnimation:!0,markerZoomAnimation:!0}).setView(i._location,i._zoom);L.tileLayer(n.Setting.getTileMapAddress(),{minZoom:n.Setting.getMapMinZoomLevel(),maxZoom:n.Setting.getMapMaxZoomLevel()}).addTo(i._map);i._map.invalidateSize(!1);i._map.whenReady(i.renderTrees);i._map.on("moveend",i.afterMoveMap);i._map.on("popupopen",function(t){var r=t.popup._source,u;r._bringToFront();$(r.label._container).addClass("active");u=n.Model.getTrees().findWhere({id:r.options.id});i.renderTreeInfo(u);i._selectedMarker=r;n.View.getMessageView()&&n.View.getMessageView().setInvisible();n.Router.getInstance().navigate("mtrees/"+u.getId(),{trigger:!1,replace:!0})});i._map.on("popupclose",function(n){var t=n.popup._source;t._resetZIndex();$(t.label._container).removeClass("active");i.$("#wrapper-treeinfo").addClass("hidden");i._selectedMarker=null})}};this.afterMoveMap=function(){var n=u;n._selectedMarker&&n._selectedMarker._bringToFront()};this.renderTrees=function(){var t=u;n.Controller.fetchAllTrees(t.renderMarkers,t.renderMarkersError)};this.renderMarkers=function(){var t=u;console.log(i.TAG+"renderMarkers()");n.Controller.checkAdmin(function(i){if($.each(n.Model.getTrees().models,function(n,r){for(var u=!1,f=0;f<t._markers.length&&!u;f++)r.getId()==t._markers[f].options.id&&(u=!0);u||(i.result==!0||i.result=="true"?t.addMarker(r,!0):(i.result==!1||i.result=="false")&&t.addMarker(r,!1))}),t._id!=undefined&&t._id!=0)for(var r=0;r<t._markers.length;r++)if(t._markers[r].options.id==t._id){t._markers[r].openPopup();t._map.setView(t._markers[r].getLatLng());break}t.renderFilterList()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.updateMarkers=function(t){var r=u;console.log(i.TAG+"updateMarkers()");n.Controller.checkAdmin(function(n){var i,u;for($.each(t.models,function(t,i){for(var u=!1,f=0;f<r._markers.length&&!u;f++)i.getId()==r._markers[f].options.id&&(u=!0);u||(n.result==!0||n.result=="true"?r.addMarker(i,!0):(n.result==!1||n.result=="false")&&r.addMarker(i,!1))}),i=0;i<r._markers.length;)u=!1,$.each(t.models,function(n,t){t.getId()==r._markers[i].options.id&&(u=!0)}),u||(r._markers[i]==r._selectedMarker&&r._selectedMarker.closePopup(),r.removeMarker(r._markers[i]),r._markers=_.without(r._markers,r._markers[i]),i--),i++},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderMarkersError=function(t){var r=u;console.log(i.TAG+"renderMarkersError()");n.EventHandler.handleError(t)};f=this;f.bDebug=!0;f._zoom=n.Setting.getDefaultMapZoomLevel();f._markers=[];f.events={"click .food-item":"_applySearch","click #wrapper-food-search span.btn":"_resetSearch","click .marker-control-item":"_mouseClick","click .collapsible-button":"_openCollapsible","click .filter-checkbox":"_applyFilter","click .flag-radio":"_applyFlag","click .ownership-radio":"_applyOwnership","click .add-tree":"_addNewTree","click .switch-table":"_mouseClick","click .button-tree-detail":"_mouseClick","click .button-manage-adoption":"_mouseClick","click .button-tree-adopt":"_mouseClick","click .button-tree-unadopt":"_mouseClick","click .button-new-note":"_mouseClick","keydown #search-food":"_searchKeyDown"};f.delegateEvents()}return __extends(i,t),i.prototype.resize=function(){n.Controller.checkAdmin(function(t){t.result==!0||t.result=="true"?$(".collapsible-list").css({height:n.View.getHeight()-216}):(t.result==!1||t.result=="false")&&$(".collapsible-list").css({height:n.View.getHeight()-148})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.render=function(t){if(this.bRendered)return this.update(t),r;this.bRendered=!0;var r=this;return n.Controller.checkAdmin(function(t){if(t.result==!0||t.result=="true"){r.bDebug&&console.log(i.TAG+"render()");var u=_.template(n.Template.getManageTreesMapViewTemplate());r.$el.html(u({}));r.setElement(r.$("#wrapper-mtrees"));$(".collapsible-list").css({height:n.View.getHeight()-216})}else(t.result==!1||t.result=="false")&&(r.bDebug&&console.log(i.TAG+"render()"),r.setElement(r.$("#wrapper-mtrees")),$(".collapsible-list").css({height:n.View.getHeight()-148}),$("#mytrees-toggle").bootstrapToggle());n.Controller.updateGeoLocation(r.renderMap,r.renderMapError)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),r},i.prototype.update=function(n){if(!this.bRendered)return this.render(n),t;var t=this;return t.bDebug&&console.log(i.TAG+"update()"),t},i.prototype.renderOwnershipInfo=function(t){var i=this;n.Controller.checkAdmin(function(n){n.result==!0||n.result=="true"?$.each(i.$(".ownership-radio"),function(n,i){t!=undefined&&(parseInt($(i).attr("data-target"))==t.getId()?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""})),parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled")))}):(n.result==!1||n.result=="false")&&$.each(i.$(".ownership-radio"),function(n,i){t!=undefined&&(parseInt($(i).attr("data-target"))==t.getId()?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""})),parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled")),$(i).css({"pointer-events":"none"}))})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.renderFlagInfo=function(t){var i=this;n.Controller.checkAdmin(function(n){n.result==!0||n.result=="true"?$.each(i.$(".flag-radio"),function(n,i){var r=!1;$.each(t,function(n,t){parseInt($(i).attr("data-target"))==t&&(r=!0)});r?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""}));parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled"))}):(n.result==!1||n.result=="false")&&$.each(i.$(".flag-radio"),function(n,i){var r=!1;$.each(t,function(n,t){parseInt($(i).attr("data-target"))==t&&(r=!0)});r?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""}));parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled"));$(i).css({"pointer-events":"none"})})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.renderRecentActivities=function(t){var r=this,i=[];i.push(t);n.Controller.fetchNotesOfTrees(i,n.NoteType.IMAGE,n.Setting.getNumRecentActivitiesShown(),0,function(){var i=new n.Notes(n.Model.getNotes().where({tree:t.getId(),type:n.NoteType.IMAGE})),u,f;i.sortByDescendingDate();u=_.template(n.Template.getRecentCommentsTemplate());f={notes:i,size:n.Setting.getNumRecentActivitiesShown(),coordinate:"@ "+t.getLat().toFixed(4)+", "+t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()};r.$("#list-activities").html(u(f))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.removeMarker=function(n){var t=this;t._map.removeLayer(n)},i.prototype.addMarker=function(t,i){var u=this,r=n.MarkerFractory.create(t,!0,i);u._markers.push(r);r.addTo(u._map);r.on("dragend",function(){if(r.options.id!=undefined){var t=n.Model.getTrees().findWhere({id:r.options.id});n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_LOCATION,{marker:r,location:r.getLatLng()},function(){var i=n.Model.getFoods().findWhere({id:t.getFoodId()});u.renderRecentActivities(t);n.EventHandler.handleDataChange("Location of <strong><i>"+i.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);u.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})}})},i.prototype.deleteTree=function(t){var i=this;n.EventHandler.handleTreeData(t,n.DATA_MODE.DELETE,{},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});i.updateMarkers(n.Model.getTrees());n.EventHandler.handleDataChange("<strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has deleted successfully.",!1)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.setLocation=function(n){var t=this;t._location=n},i.prototype._mouseOver=function(){var n=this},i.prototype._mouseClick=function(t){var i=this;i._selectedMarker!=undefined?n.EventHandler.handleMouseClick($(t.currentTarget),i,{marker:i._selectedMarker,tree:i._selectedMarker.options.id}):n.EventHandler.handleMouseClick($(t.currentTarget),i,{marker:i._selectedMarker})},i.prototype._openCollapsible=function(n){var t=this;$(".collapsible-list").addClass("hidden");$($(n.currentTarget).attr("data-target")).removeClass("hidden")},i.prototype._applyFilter=function(t){var r=this,i=n.Model.getTrees();setTimeout(function(){var n,u,f,e;r.$('input[name="onlymine"]').prop("checked")==!0&&(i=i.filterByParent(parseInt(r.$('input[name="onlymine"]').attr("data-target"))));t!=undefined&&$(t.target).find("input").prop("name")=="ownershipsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-ownership").addClass("active"),$(".filter-ownership input").prop({checked:"checked"})):($(".filter-ownership").removeClass("active"),$(".filter-ownership input").prop({checked:""})));n=[];$.each(r.$(".filter-ownership input"),function(t,i){$(i).prop("checked")==!0&&n.push(Math.floor($(i).prop("name")))});i=i.filterByOwnershipIds(n);t!=undefined&&$(t.target).find("input").prop("name")=="flagsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-flag").addClass("active"),$(".filter-flag input").prop({checked:"checked"})):($(".filter-flag").removeClass("active"),$(".filter-flag input").prop({checked:""})));u=[];$.each(r.$(".filter-flag input"),function(n,t){$(t).prop("checked")==!0&&u.push(Math.floor($(t).prop("name")))});i=i.filterByFlagIds(u);t!=undefined&&$(t.target).find("input").prop("name")=="foodsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-food").addClass("active"),$(".filter-food input").prop({checked:"checked"})):($(".filter-food").removeClass("active"),$(".filter-food input").prop({checked:""})));f=[];$.each(r.$(".filter-food input"),function(n,t){$(t).prop("checked")==!0&&f.push(Math.floor($(t).prop("name")))});i=i.filterByFoodIds(f);t!=undefined&&$(t.target).find("input").prop("name")=="adoptsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-adopt").addClass("active"),$(".filter-adopt input").prop({checked:"checked"})):($(".filter-adopt").removeClass("active"),$(".filter-adopt input").prop({checked:""})));e=[];$.each(r.$(".filter-adopt input"),function(n,t){$(t).prop("checked")==!0&&e.push(Math.floor($(t).prop("name")))});i=i.filterByAdoptStatus(e);r.updateMarkers(i)},1)},i.prototype._applyFlag=function(t){var i=this;n.Controller.checkAdmin(function(r){var f,u;r.result==!0||r.result=="true"?(u=n.Model.getTrees().findWhere({id:i._selectedMarker.options.id}),f=parseInt($(t.target).attr("data-target")),$(t.target).find('input[type="checkbox"]').prop("checked")?n.EventHandler.handleTreeData(u,n.DATA_MODE.UPDATE_FLAG,{flag:f,addmode:!0},function(){var t=n.Model.getFoods().findWhere({id:u.getFoodId()});i.renderFlagInfo(u.getFlags());i.renderRecentActivities(u);n.EventHandler.handleDataChange("Status of <strong><i>"+t.getName()+" "+u.getName()+"<\/i><\/strong> has changed successfully.",!0);i._applyFilter()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):n.EventHandler.handleTreeData(u,n.DATA_MODE.UPDATE_FLAG,{flag:f,addmode:!1},function(){var t=n.Model.getFoods().findWhere({id:u.getFoodId()});i.renderFlagInfo(u.getFlags());i.renderRecentActivities(u);n.EventHandler.handleDataChange("Status of <strong><i>"+t.getName()+" "+u.getName()+"<\/i><\/strong> has changed successfully.",!0);i._applyFilter()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})):(u=n.Model.getTrees().findWhere({id:i._selectedMarker.options.id}),i.renderFlagInfo(u.getFlags()))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype._applyOwnership=function(t){var i=this;n.Controller.checkAdmin(function(r){var f,u;r.result==!0||r.result=="true"?(u=n.Model.getTrees().findWhere({id:i._selectedMarker.options.id}),f=parseInt($(t.target).attr("data-target")),u.getOwnershipId()!=f&&n.EventHandler.handleTreeData(u,n.DATA_MODE.UPDATE_OWNERSHIP,{ownership:f},function(){var t=n.Model.getFoods().findWhere({id:u.getFoodId()}),r=n.Model.getOwnerships().findWhere({id:u.getOwnershipId()});i.renderOwnershipInfo(r);i.renderRecentActivities(u);n.EventHandler.handleDataChange("Ownership of <strong><i>"+t.getName()+" "+u.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})):(u=n.Model.getTrees().findWhere({id:i._selectedMarker.options.id}),i.renderOwnershipInfo(n.Model.getOwnerships().findWhere({id:u.getOwnershipId()})))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype._addNewTree=function(){var t=this,i=new n.Tree({lat:t._map.getCenter().lat,lng:t._map.getCenter().lng,food:1,type:0,flag:0,owner:0,ownership:1,description:"",address:""});n.EventHandler.handleTreeData(i,n.DATA_MODE.CREATE,{},function(){var u=n.Model.getFoods().findWhere({id:i.getFoodId()}),r;for(t._applyFilter(),r=0;r<t._markers.length;r++)if(t._markers[r].options.id==i.getId()){t._markers[r].openPopup();break}n.EventHandler.handleDataChange("<strong><i>"+u.getName()+" "+i.getName()+"<\/i><\/strong> has been created successfully.",!0)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){var r=n.Model.getFoods().findWhere({id:i.getFoodId()});n.EventHandler.handleDataChange("<strong><i>"+r.getName()+" "+i.getName()+"<\/i><\/strong> has been deleted successfully.",!1);t.updateMarkers(n.Model.getTrees())})},i.prototype._searchKeyDown=function(n){var t=this;console.log($(n.currentTarget));setTimeout(function(){t.$("#search-food").val().trim()!=""?setTimeout(function(){t.$("#wrapper-list-food").removeClass("hidden")},500):t.$("#wrapper-list-food").addClass("hidden")},10)},i.prototype._applySearch=function(t){var u=this,r,i;console.log($(t.currentTarget).attr("data-id"));r=n.Model.getFoods().findWhere({id:parseInt($(t.currentTarget).attr("data-id"))});console.log(r.getName());u.$("#search-food").val(r.getName());i=n.Model.getTrees();i=i.filterByFoodIds([parseInt($(t.currentTarget).attr("data-id"))]);u.updateMarkers(i)},i.prototype._resetSearch=function(){var t=this,i;t.$("#search-food").val("");i=n.Model.getTrees();t.updateMarkers(i);t.$("#wrapper-list-food").addClass("hidden")},i.TAG="ManageTreesMapView - ",i}(t);n.ManageTreesMapView=r}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var r=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use DetailTreeViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var r;return r=new i({el:n}),r.setTreeId(t),r},n._instance=new n,n}(),t,i;n.DetailTreeViewFractory=r;t=function(n){function t(){n.apply(this,arguments);this._bAuthor=!1;this.renderMenu=function(){}}return __extends(t,n),t.prototype.setTreeId=function(n){this._id=Math.floor(n)},t}(n.BaseView);n.DetailTreeView=t;i=function(t){function i(i){var u=this,r;t.call(this,i);this.renderMenu=function(){var t=u;n.Controller.checkLogin(function(i){if(i.result==!0||i.result=="true")n.Controller.checkAdmin(function(r){var f,u;r.result==!0||r.result=="true"?(u=_.template(n.Template.getDetailMenuTemplate()),t.$("#wrapper-mapmenu").html(u({}))):(r.result==!1||r.result=="false")&&(f=n.Model.getAdopts().findWhere({tree:t._tree.getId(),parent:parseInt(i.id)}),f?(u=_.template(n.Template.getDetailMenuTemplate3()),t.$("#wrapper-mapmenu").html(u({}))):(u=_.template(n.Template.getDetailMenuTemplate2()),t.$("#wrapper-mapmenu").html(u({}))))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)});else{var r=_.template(n.Template.getDetailMenuTemplate2());t.$("#wrapper-mapmenu").html(r({}))}},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderTreeChart=function(t,i,r){var f=u;n.Controller.fetchImageNotesOfTreesDuringPeriod([f._tree],i,r,1e4,0,function(){var s,h,t,o,c;f.$("#wrapper-chart").html('<canvas id="content-chart" class="content-chart" />');s=f.$("#content-chart")[0];f.$("#content-chart").attr({width:f.$("#content-chart").innerWidth(),height:f.$("#content-chart").innerHeight()});h=s.getContext("2d");f.$("#wrapper-graph").on("mousemove",function(n){n.clientX-24-$("#wrapper-tooltip").outerWidth()<0?f.$("#wrapper-tooltip").css({top:n.clientY-60,left:n.clientX+24}):f.$("#wrapper-tooltip").css({top:n.clientY-60,left:n.clientX-24-f.$("#wrapper-tooltip").outerWidth()})});f.$("#wrapper-graph").on("mouseleave",function(){f.$("#wrapper-tooltip").addClass("hidden")});var e=[],u=[],l=moment(i).set("hour",13).set("minute",0).set("seconds",0).set("milliseconds",0);for(t=moment(l).valueOf();t<moment(r).add("day",1).valueOf();t+=864e5)e.push(moment(t).format(n.Setting.getDateHourFormat())),o=n.Model.getNotes().getLatestImageNoteOfDate(f._tree.getId(),t,n.NoteType.IMAGE),o?u.push(o):u.push(new n.Note({type:n.NoteType.IMAGE,tree:f._tree.getId(),person:0,comment:"",picture:"",rate:0,cover:0,date:moment(t).format(n.Setting.getDateTimeFormat())}));console.log("Graph Points Length: "+u.length);c=Math.floor(e.length/(f.$("#content-chart").innerWidth()/150));f._chart&&f._chart.destroy();f._chart=new Chart(h).Line({labels:e,datasets:[{label:"My First dataset",fillColor:"rgba(132,167,87,0.4)",strokeColor:"rgba(132,167,87,1)",pointColor:"rgba(132,167,87,1)",pointStrokeColor:"rgba(132,167,87,1)",pointHighlightFill:"rgba(220,220,220,1)",pointHighlightStroke:"rgba(132,167,87,1)",data:u},]},{scaleOverride:!0,scaleSteps:1,scaleStepWidth:10,scaleStartValue:0,pointDotRadius:3,pointDotStrokeWidth:2,bezierCurve:!1,pointHitDetectionRadius:f.$("#content-chart").innerWidth()/u.length*.5,pointDot:!1,labelskip:c,customTooltips:function(t){if(!t||!t.id){f.$("#wrapper-tooltip").addClass("hidden");return}if(f._note=n.Model.getNotes().findWhere({id:t.id}),f._note){var i=_.template(n.Template.getToolTipTemplate()),r={image:n.Setting.getBlankImagePath(),value:f._note.getRate().toFixed(2)+" / "+n.Setting.getMaxRating().toFixed(2),comment:htmlDecode(f._note.getComment()),date:t.label};f.$("#wrapper-tooltip").html(i(r));f._note.getPictures().length>0?f.$("#wrapper-tooltip img").attr("src",n.Setting.getContentPictureDir()+f._note.getPictures()[0]).load(function(){$(this).removeClass("hidden")}).error(function(){$(this).attr("src",n.Setting.getBlankImagePath());$(this).addClass("hidden")}):f.$("#wrapper-tooltip img").addClass("hidden")}else f.$("#wrapper-tooltip img").addClass("hidden");f.$("#wrapper-tooltip").removeClass("hidden")}})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderTreeInfo=function(t){var i=u;i._bAuthor=!1;n.Controller.checkAdmin(function(r){(r.result==!0||r.result=="true")&&(i._bAuthor=!0);n.Controller.fetchAllFlagsAndOwners(function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()}),u=n.Model.getOwnerships().findWhere({id:t.getOwnershipId()}),f=_.template(n.Template.getTreeInfoTemplate2()),e={foodname:r.getName(),treename:t.getName(),lat:t.getLat().toFixed(4),lng:t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships(),description:t.getDescription(),persons:t.getParents()};if(i.$(".content-tree-info").html(f(e)),i.$(".input-address").replaceWith('<div class="input-address"><\/div>'),t.getAddress().trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(n){i.$(".input-address").html("<i class='fa fa-map-marker'><\/i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+n.road+", "+n.county+", "+n.state+", "+n.country+", "+n.postcode)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.$(".input-address").html("<i class='fa fa-map-marker'><\/i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+t.getAddress()),i._bAuthor)i.$(".input-address").on("click",function(){$(this).replaceWith("<input type='text' class='input-address form-control' value='"+htmlEncode($(this).text()).trim()+"' />");i.$(".input-address").focus();i.$(".input-address").on("focusout",function(){var r=i.$(".input-address").val();r.trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(r){r.road+", "+r.county+", "+r.state+", "+r.postcode!=t.getAddress()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_ADDRESS,{address:r.road+", "+r.county+", "+r.state+", "+r.postcode},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Address of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has been changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.getAddress().trim()!=r.trim()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_ADDRESS,{address:r.trim()},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Address of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has been changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)})});if(i.renderFlagInfo(t.getFlags()),i.renderOwnershipInfo(u),i.renderRecentActivities(t),i.renderRecentComments(t),i._bAuthor){i.$(".input-description").on("click",function(){$(this).replaceWith("<input type='text' class='input-description form-control' value='"+htmlEncode($(this).text()).trim()+"' />");i.$(".input-description").focus();i.$(".input-description").on("focusout",function(){var r=i.$(".input-description").val();t.getDescription().trim()!=r.trim()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_DESCRIPTION,{description:r},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});i.renderRecentActivities(t);n.EventHandler.handleDataChange("Description of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)})});i.$(".input-food").on("click",function(){var u=_.template(n.Template.FoodSelectTemplate()),f={foods:n.Model.getFoods()};$(this).replaceWith(u(f));i.$(".input-food").selectpicker();i.$(".input-food").selectpicker("val",r.getId());i.$(".input-food").on("hide.bs.dropdown",function(){var r=parseInt($(this).find("option:selected").val());t.getFoodId()!=r?(n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_FOODTYPE,{food:r},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Food type of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),i.renderTreeInfo(t)):i.renderTreeInfo(t)})});i.$(".input-lat").on("click",function(){$(this).replaceWith("<input class='input-lat form-control' value='"+$(this).html()+"' />");i.$(".input-lat").focus();i.$(".input-lat").on("focusout",function(){var r=new L.LatLng(parseFloat(i.$(".input-lat").val()),i._tree.getLng());r.lat!=i._tree.getLat()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_LOCATION,{location:r},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Location of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)})});i.$(".input-lng").on("click",function(){var r=i.$(".input-lng").outerWidth()+8;$(this).replaceWith("<input class='input-lng form-control' value='"+$(this).html()+"' />");i.$(".input-lng").focus();i.$(".input-lng").on("focusout",function(){var r=new L.LatLng(i._tree.getLat(),parseFloat(i.$(".input-lng").val()));r.lng!=i._tree.getLng()?n.EventHandler.handleTreeData(t,n.DATA_MODE.UPDATE_LOCATION,{location:r},function(){var r=n.Model.getFoods().findWhere({id:t.getFoodId()});n.EventHandler.handleDataChange("Location of <strong><i>"+r.getName()+" "+t.getName()+"<\/i><\/strong> has changed successfully.",!0);i.renderTreeInfo(t)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.renderTreeInfo(t)})})}},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};r=this;r.bDebug=!0;r.events={"click .switch-map":"_mouseClick","click .flag-radio":"_applyFlag","click .ownership-radio":"_applyOwnership","dblclick .content-chart":"_mouseClick","click .button-delete-tree":"_deleteTree","click .button-back-map":"_mouseClick","click .button-manage-adoption":"_mouseClick","click .button-new-note":"_mouseClick","click .date-preset":"_datePreset","click .button-tree-adopt":"_adoptTree","click .button-tree-unadopt":"_adoptTree"};r.delegateEvents()}return __extends(i,t),i.prototype.resetNote=function(){var n=this;n._note=null},i.prototype.render=function(t){var r,u,f;return this.bRendered?(this.update(t),r):(this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=_.template(n.Template.getDetailTreeGraphicViewTemplate()),f={},r.$el.html(u(f)),r.setElement(r.$("#wrapper-mtree")),r.resize(),r.renderMenu(),n.Controller.fetchAllTrees(function(){r._tree=n.Model.getTrees().findWhere({id:r._id});r.renderTreeInfo(r._tree);r.$(".tree-graph-start").attr({"data-value":moment(new Date).subtract(1,"month").format(n.Setting.getDateFormat())});r._startDate=moment(moment(new Date).subtract(3,"month").format(n.Setting.getDateFormat())).format(n.Setting.getDateTimeFormat());r.$(".tree-graph-start").pickadate({format:"dd mmm yyyy",today:"",max:new Date(moment(new Date).subtract("day",2).valueOf()),clear:"",close:"Close",onClose:function(){r._startDate=moment(this.get()).startOf("day").format(n.Setting.getDateTimeFormat());r.renderTreeChart(r._tree,r._startDate,r._endDate)}});var t=new Date;r._endDate=moment(t).endOf("day").format(n.Setting.getDateTimeFormat());r.$(".tree-graph-end").attr({"data-value":moment(new Date).format(n.Setting.getDateFormat())});r.$(".tree-graph-end").pickadate({format:"dd mmm yyyy",today:"Today",max:t,clear:"",close:"Close",onClose:function(){r._endDate=moment(this.get()).endOf("day").format(n.Setting.getDateTimeFormat());r.renderTreeChart(r._tree,r._startDate,r._endDate)}});r.renderTreeChart(r._tree,r._startDate,r._endDate)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),r)},i.prototype.resize=function(){var t=this;$("#wrapper-main").css({height:n.View.getHeight()-60});$("#wrapper-mtree").css({height:n.View.getHeight()-60});t.$(".image-group").css({height:t.$(".image-wrapper").innerHeight()-60})},i.prototype.refreshTreeInfo=function(){var n=this;n.bDebug&&console.log(i.TAG+"refreshTreeInfo()");n.renderTreeInfo(n._tree);n.renderTreeChart(n._tree,n._startDate,n._endDate)},i.prototype.renderOwnershipInfo=function(n){var t=this;$.each(t.$(".ownership-radio"),function(i,r){parseInt($(r).attr("data-target"))==n.getId()?($(r).addClass("active"),$(r).find("input").prop({checked:"checked"})):($(r).removeClass("active"),$(r).find("input").prop({checked:""}));parseInt($(r).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(r).addClass("disabled"));t._bAuthor||$(r).css({"pointer-events":"none"})})},i.prototype.renderFlagInfo=function(n){var t=this;t._bAuthor?$.each(t.$(".flag-radio"),function(t,i){var r=!1;$.each(n,function(n,t){parseInt($(i).attr("data-target"))==t&&(r=!0)});r?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""}));parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled"))}):$.each(t.$(".flag-radio"),function(t,i){var r=!1;$.each(n,function(n,t){parseInt($(i).attr("data-target"))==t&&(r=!0)});r?($(i).addClass("active"),$(i).find("input").prop({checked:"checked"})):($(i).removeClass("active"),$(i).find("input").prop({checked:""}));parseInt($(i).attr("data-target"))==0&&($(this).attr("disabled","disabled"),$(i).addClass("disabled"));$(i).css({"pointer-events":"none"})})},i.prototype.renderRecentActivities=function(t){var r=this,i=[];i.push(t);n.Controller.fetchNotesOfTrees(i,n.NoteType.INFO,n.Setting.getLargeNumRecentActivitiesShown(),0,function(){var i=new n.Notes(n.Model.getNotes().where({tree:t.getId(),type:n.NoteType.INFO})),u,f;i.sortByDescendingDate();u=_.template(n.Template.getRecentActivitiesTemplate());f={notes:i,size:n.Setting.getLargeNumRecentActivitiesShown(),coordinate:"@ "+t.getLat().toFixed(4)+", "+t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()};r.$("#list-activities").html(u(f))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.renderRecentComments=function(t){var r=this,i=[];i.push(t);n.Controller.fetchNotesOfTrees(i,n.NoteType.IMAGE,n.Setting.getLargeNumRecentActivitiesShown(),0,function(){var i=new n.Notes(n.Model.getNotes().where({tree:t.getId(),type:n.NoteType.IMAGE})),u,f;i.sortByDescendingDate();u=_.template(n.Template.getRecentCommentsTemplate());f={notes:i,size:n.Setting.getLargeNumRecentActivitiesShown(),coordinate:"@ "+t.getLat().toFixed(4)+", "+t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()};r.$("#list-comments").html(u(f))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype._applyFlag=function(t){var i=this,r;i._bAuthor&&(r=parseInt($(t.target).attr("data-target")),console.log($(t.target).find('input[type="checkbox"]').prop("checked")),setTimeout(function(){$(t.target).find('input[type="checkbox"]').prop("checked")?n.EventHandler.handleTreeData(i._tree,n.DATA_MODE.UPDATE_FLAG,{flag:r,addmode:!0},function(){var t=n.Model.getFoods().findWhere({id:i._tree.getFoodId()});i.renderFlagInfo(i._tree.getFlags());i.renderRecentActivities(i._tree);n.EventHandler.handleDataChange("Status of <strong><i>"+t.getName()+" "+i._tree.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):n.EventHandler.handleTreeData(i._tree,n.DATA_MODE.UPDATE_FLAG,{flag:r,addmode:!1},function(){var t=n.Model.getFoods().findWhere({id:i._tree.getFoodId()});i.renderFlagInfo(i._tree.getFlags());i.renderRecentActivities(i._tree);n.EventHandler.handleDataChange("Status of <strong><i>"+t.getName()+" "+i._tree.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},1))},i.prototype._applyOwnership=function(t){var i=this,r;i._bAuthor&&(r=parseInt($(t.target).attr("data-target")),i._tree.getOwnershipId()!=r&&n.EventHandler.handleTreeData(i._tree,n.DATA_MODE.UPDATE_OWNERSHIP,{ownership:r},function(){var t=n.Model.getFoods().findWhere({id:i._tree.getFoodId()}),r=n.Model.getOwnerships().findWhere({id:i._tree.getOwnershipId()});i.renderOwnershipInfo(r);i.renderRecentActivities(i._tree);n.EventHandler.handleDataChange("Ownership of <strong><i>"+t.getName()+" "+i._tree.getName()+"<\/i><\/strong> has changed successfully.",!0)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}))},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i,{note:i._note,tree:i._tree})},i.prototype._datePreset=function(t){var i=this;$(t.currentTarget).hasClass("4years")?i._startDate=moment(i._endDate).subtract(4,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("2years")?i._startDate=moment(i._endDate).subtract(2,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("1year")?i._startDate=moment(i._endDate).subtract(1,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("6months")?i._startDate=moment(i._endDate).subtract(6,"months").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("3months")?i._startDate=moment(i._endDate).subtract(3,"months").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("1month")&&(i._startDate=moment(i._endDate).subtract(1,"months").startOf("day").format(n.Setting.getDateTimeFormat()));i.$(".tree-graph-start").pickadate("picker").set("select",moment(i._startDate).format(n.Setting.getDateFormat()),{format:"dd mmm yyyy"});i.renderTreeChart(i._tree,i._startDate,i._endDate)},i.prototype._deleteTree=function(){var t=this,i=n.Model.getFoods().findWhere({id:t._tree.getFoodId()}),r=i.getName()+" "+t._tree.getName();n.EventHandler.handleTreeData(t._tree,n.DATA_MODE.DELETE,{},function(){Backbone.history.history.back();n.EventHandler.handleDataChange("<strong><i>"+r+"<\/i><\/strong> has deleted successfully.",!1)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype._adoptTree=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i,{tree:i._tree})},i.TAG="DetailTreeGraphicView - ",i}(t);n.DetailTreeGraphicView=i}(FoodParent||(FoodParent={})),function(n){var t=function(){function t(){if(t._instance)throw new Error("Error: Instantiation failed: Use MarkerFractory.getInstance() instead of new.");t._instance=this}return t.getInstance=function(){return t._instance},t.getIcon=function(t){return new L.Icon({iconUrl:t.getIconPath(),shadowUrl:n.Setting.getMarkerShadowPath(),iconSize:new L.Point(40,40),iconAnchor:new L.Point(20,40),shadowAnchor:new L.Point(9,38),popupAnchor:new L.Point(0,48)})},t.create=function(t,i,r){var f=n.Model.getFoods().findWhere({id:t.getFoodId()}),o=new L.Icon({iconUrl:f.getIconPath(),shadowUrl:n.Setting.getMarkerShadowPath(),iconSize:new L.Point(40,40),iconAnchor:new L.Point(20,40),shadowAnchor:new L.Point(9,38),popupAnchor:new L.Point(0,48)}),e,u;e=r?_.template(n.Template.getManageTreesPopupTemplateForAdmin()):_.template(n.Template.getManageTreesPopupTemplateForGuestAndParent());u=new L.Marker(t.getLocation(),{id:t.getId(),icon:o,draggable:!1,riseOnHover:!0}).bindPopup(e({id:t.getId()}),{closeButton:!1,closeOnClick:i}).bindLabel(f.getName()+" "+t.getName(),{clickable:!0,noHide:!0,direction:"right"});u.on("dragend",function(){this.openPopup()});return L.DomEvent.addListener(u.label,"click",function(){this.togglePopup()},u),u},t.create2=function(t,i){var u=n.Model.getFoods().findWhere({id:t.getFoodId()}),f=new L.Icon({iconUrl:u.getIconPath(),shadowUrl:n.Setting.getMarkerShadowPath(),iconSize:new L.Point(40,40),iconAnchor:new L.Point(20,40),shadowAnchor:new L.Point(9,38),popupAnchor:new L.Point(0,48)}),e=_.template(n.Template.getManageTreesPopupTemplate2()),o={id:t.getId()},r=new L.Marker(t.getLocation(),{id:t.getId(),icon:f,draggable:!1,riseOnHover:!0}).bindPopup(e(o),{closeButton:!1,closeOnClick:i}).bindLabel(u.getName()+" "+t.getName(),{clickable:!0,noHide:!0,direction:"right"});r.on("dragend",function(){this.openPopup()});return L.DomEvent.addListener(r.label,"click",function(){this.togglePopup()},r),r},t._instance=new t,t}();n.MarkerFractory=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var r=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use ManagePeopleViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var r;return r=new i({el:n}),r.setPeopleId(t),r},n._instance=new n,n}(),t,i;n.ManagePeopleViewFractory=r;t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.setPeopleId=function(n){this._id=n},t}(n.BaseView);n.ManagePeopleView=t;i=function(t){function i(i){var r=this,u;t.call(this,i);this.renderPersons=function(){var t=r;n.Controller.fetchAllPersonsAndAuthsAndFoodAndTreesAndAdopts(function(){t.renderPersonsList(n.Model.getPersons());t.renderFilterList()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderPersonsList=function(t){var f=r,u=[],i;u.push({name:"Authorization",values:n.Model.getAuths().toArray()});PersonColumn[0].cell=Backgrid.SelectCell.extend({editor:Backgrid.AuthSelectCellEditor,optionValues:u});i=new Backgrid.Grid({columns:PersonColumn,collection:t,emptyText:n.Setting.getNoDataText()});i.render();i.sort("name","ascending");f.$(".list-people").html(i.el)};this._addNewPerson=function(){var t=r,e,i,u,f;t.$(".new-person").hasClass("hidden")?(e=new n.Person({auth:0,name:"",address:"",contact:"",neighborhood:""}),i=new n.Persons,i.add(e),u=[],u.push({name:"Authorization",values:n.Model.getAuths().toArray()}),NewPersonColumn[0].cell=Backgrid.SelectCell.extend({editor:Backgrid.AuthSelectCellEditor,optionValues:u}),f=new Backgrid.Grid({columns:NewPersonColumn,collection:i,emptyText:n.Setting.getNoDataText()}),f.render(),t.$(".new-person").html('<div class="list-title">Add a New Person<\/div>'),t.$(".new-person").append(f.el),t.$(".new-person").removeClass("hidden")):t.$(".new-person").addClass("hidden")};this.renderFilterList=function(){var t=r,i=_.template(n.Template.getPersonFilterListTemplate()),u={auths:n.Model.getAuths()};t.$("#filter-list").html(i(u))};u=this;u.bDebug=!0;u.events={"click .add-person":"_addNewPerson","click .filter-checkbox":"_applyFilter"};u.delegateEvents()}return __extends(i,t),i.prototype.render=function(t){var r,u,f;return this.bRendered?(this.update(t),r):(this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=_.template(n.Template.getManagePeopleTableViewTemplate()),f={},r.$el.html(u(f)),r.setElement(r.$("#wrapper-mpeople")),r.resize(),r.renderPersons(),r)},i.prototype.resize=function(){$("#content-mpeople-table").css({width:n.View.getWidth()-$("#wrapper-tablemenu").outerWidth()});$("#wrapper-main").css({height:n.View.getHeight()-60});$("#wrapper-mpeople").css({height:n.View.getHeight()-60});$(".collapsible-list").css({height:n.View.getHeight()-148})},i.prototype._applyFilter=function(t){var r=this,i=n.Model.getPersons();setTimeout(function(){var n,u;t!=undefined&&$(t.target).find("input").prop("name")=="authsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-auth").addClass("active"),$(".filter-auth input").prop({checked:"checked"})):($(".filter-auth").removeClass("active"),$(".filter-auth input").prop({checked:""})));n=[];$.each(r.$(".filter-auth input"),function(t,i){$(i).prop("checked")==!0&&n.push(Math.floor($(i).prop("name")))});i=i.filterByAuthIds(n);t!=undefined&&$(t.target).find("input").prop("name")=="adoptsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-adopt").addClass("active"),$(".filter-adopt input").prop({checked:"checked"})):($(".filter-adopt").removeClass("active"),$(".filter-adopt input").prop({checked:""})));u=[];$.each(r.$(".filter-adopt input"),function(n,t){$(t).prop("checked")==!0&&u.push(Math.floor($(t).prop("name")))});i=i.filterByAdoptStatus(u);r.renderPersonsList(i)},1)},i.TAG="ManageTreesMapView - ",i}(t);n.ManagePeopleTableView=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var f=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use ManageDonationsViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var r;return r=new i({el:n}),r.setTreeId(t),r},n._instance=new n,n}(),t,i,u,r;n.ManageDonationsViewFractory=f;t=function(n){function t(){n.apply(this,arguments);this.renderTreeInfo=function(){}}return __extends(t,n),t.prototype.setTreeId=function(n){this._id=n},t}(n.BaseView);n.ManageDonationsView=t;i=function(t){function i(i){var r=this,u;t.call(this,i);this._addNewPlace=function(){var t=r;t.$(".new-location").hasClass("hidden")?n.Controller.updateGeoLocation(t.renderNewPlace,t.renderGeoLocationError):t.$(".new-location").addClass("hidden")};this.renderGeoLocationError=function(t){var i=r;switch(t.code){case t.PERMISSION_DENIED:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR);break;case t.POSITION_UNAVAILABLE:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR)}};this.renderNewPlace=function(t){var i=r,e=new n.Place({name:"",description:"",lat:t.coords.latitude,lng:t.coords.longitude}),f=new n.Places,u;f.add(e);u=new Backgrid.Grid({columns:NewLocationColumn,collection:f,emptyText:n.Setting.getNoDataText()});u.render();i.$(".new-location").html('<div class="list-title">Add a New Location<\/div>');i.$(".new-location").append(u.el);i.$(".new-location").removeClass("hidden")};this.renderLocations=function(){var t=r;n.Controller.fetchAllLocations(function(){t.renderLocationList(n.Model.getPlaces())},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderLocationList=function(t){var u=r,i=new Backgrid.Grid({columns:LocationColumn,collection:t,emptyText:n.Setting.getNoDataText()});i.render();i.sort("name","ascending");u.$(".list-location").html(i.el)};u=this;u.bDebug=!0;u.events={"click .switch-map":"_mouseClick","click .filter-checkbox":"_applyFilter","click .add-location":"_addNewPlace"};u.delegateEvents()}return __extends(i,t),i.prototype.render=function(t){var r,u,f;return this.bRendered?(this.update(t),r):(this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=_.template(n.Template.getManageDonationsTableViewTemplate()),f={},r.$el.html(u(f)),r.setElement(r.$("#wrapper-mdonations")),r.renderLocations(),r.resize(),r)},i.prototype.resize=function(){$("#content-donations-table").css({width:n.View.getWidth()-$("#wrapper-tablemenu").outerWidth()});$("#wrapper-main").css({height:n.View.getHeight()-60});$("#wrapper-mtrees").css({height:n.View.getHeight()-60});$(".collapsible-list").css({height:n.View.getHeight()-182})},i.TAG="ManageDonationsTableView - ",i}(t);n.ManageDonationsTableView=i;u=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use AddDonationViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var i=new r({el:n});return i.setPlace(t),i},n._instance=new n,n}();n.AddDonationViewFactory=u;r=function(t){function i(r){var u=this,f;t.call(this,r);this.renderNewDonation=function(){var t=u,i,f,r;t._donation==undefined&&(t._donation=new n.Donation({type:0,place:t._place.getId(),quantity:0,picture:"",date:moment(new Date).format(n.Setting.getDateTimeFormat())}));i="";i+='<div class="label-group">';i+='<div class="label-group-label">Trees<\/div>';i+='<div class="label-group-content new-donation-trees"><\/div>';i+="<\/div>";i+='<div class="label-group">';i+='<div class="label-group-label">Amount<\/div>';i+='<div class="label-group-content new-donation-amount"><%= amount %> lbs.<\/div>';i+="<\/div>";i+='<div class="label-group">';i+='<div class="label-group-label">Donation Date<\/div>';i+='<div class="label-group-content new-donation-date"><\/div>';i+="<\/div>";r=_.template(i);f={amount:t._donation.getQuantity()};t.$(".new-donation").html(r(f));t.$(".new-donation-date").html(t._donation.getFormattedDate());t.$(".new-donation-date").attr({"data-value":moment(t._donation.getDateForDatePicker()).format(n.Setting.getDateFormat())});t.$(".new-donation-date").pickadate({format:"dd mmm yyyy",today:"",max:new Date(moment(new Date).valueOf()),clear:"",close:"Close",onClose:function(){t._donation.setDate(moment(this.get()).startOf("day").format(n.Setting.getDateTimeFormat()));t.renderNewDonation()}});t.$(".new-donation-amount").on("click",function(){$(this).replaceWith("<input class='new-donation-amount form-control' value='"+parseFloat($(this).html())+"' />");t.$(".new-donation-amount").focus();t.$(".new-donation-amount").on("focusout",function(){t._donation.setQuantity(parseFloat(t.$(".new-donation-amount").val()));t.renderNewDonation()})});t.$("input[type=file]").off("change");t.$("input[type=file]").on("change",function(i){t.$(".wrapper-input-upload-picture").addClass("hidden");t.$(".wrapper-uploading-picture").removeClass("hidden");var r=i.target.files;r.length>0&&n.Controller.uploadNotePictureFile(r[0],fileNameEncode(t._place.getName()),function(n){t._donation.addPicture(n);t.$("input[type=file]").val("");t.$(".wrapper-uploading-picture").addClass("hidden");t.$(".wrapper-input-upload-picture").removeClass("hidden");t.renderDonationImages()},function(){t.$(".wrapper-uploading-picture").addClass("hidden");t.$(".wrapper-input-upload-picture").removeClass("hidden")})});r=_.template(n.Template.getAddNewDonationTreeTemplate());t.$(".new-donation-trees").html(r({trees:n.Model.getTrees().filterByIds(t._donation.getTreeIds())}));t.$(".content-manage-adoption-table").scrollTop()};this.renderTrees=function(){var t=u;n.Controller.fetchAllTrees(function(){t.renderTreeList(n.Model.getTrees());t.renderFilterList()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderTreeList=function(t){var i=u,f,r;i._bTableView?(f=[],f.push({name:"Food",values:n.Model.getFoods().toArray()}),DonationColumn[0].cell=Backgrid.SelectCell.extend({editor:Backgrid.FoodSelectCellEditor,optionValues:f}),r=new Backgrid.Grid({columns:DonationColumn,collection:t,emptyText:n.Setting.getNoDataText()}),r.render(),r.sort("id","ascending"),i.$(".list-donation").html(r.el)):n.Controller.updateGeoLocation(i.renderMap,i.renderMapError)};this.renderMapError=function(t){var i=u;switch(t.code){case t.PERMISSION_DENIED:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR);break;case t.POSITION_UNAVAILABLE:n.EventHandler.handleError(n.ERROR_MODE.GEO_PERMISSION_ERROR)}i.renderMap({coords:{accuracy:4196,altitude:null,altitudeAccuracy:null,heading:null,latitude:33.7946333,longitude:-84.448771,speed:null},timestamp:(new Date).valueOf()})};this.renderMap=function(t){var i=u,r=t.coords.accuracy;if(i._location=new L.LatLng(t.coords.latitude,t.coords.longitude),i._map==undefined){i.setLocation(new L.LatLng(t.coords.latitude,t.coords.longitude));i._map=L.map(i.$("#list-donation")[0].id,{zoomControl:!1,closePopupOnClick:!0,doubleClickZoom:!0,touchZoom:!0,zoomAnimation:!0,markerZoomAnimation:!0}).setView(i._location,i._zoom);L.tileLayer(n.Setting.getTileMapAddress(),{minZoom:n.Setting.getMapMinZoomLevel(),maxZoom:n.Setting.getMapMaxZoomLevel()}).addTo(i._map);i._map.invalidateSize(!1);i._map.whenReady(i.renderMarkers);i._map.on("moveend",i.afterMoveMap);i._map.on("popupopen",function(t){var r=t.popup._source,u;r._bringToFront();$(r.label._container).addClass("active");u=n.Model.getTrees().findWhere({id:r.options.id});i._selectedMarker=r;i.renderTreeInfo(u);n.View.getMessageView()&&n.View.getMessageView().setInvisible()});i._map.on("popupclose",function(n){var t=n.popup._source;t._resetZIndex();$(t.label._container).removeClass("active");i.$("#wrapper-treeinfo").addClass("hidden");i._selectedMarker=null})}};this.renderMarkers=function(){var t=u,r,f,e;console.log(i.TAG+"renderMarkers()");t._markers=[];$.each(n.Model.getTrees().models,function(n,i){for(var r=!1,u=0;u<t._markers.length&&!r;u++)i.getId()==t._markers[u].options.id&&(r=!0);r||t.addMarker(i)});r=n.Model.getTrees();f=[];$.each(t.$(".filter-food input"),function(n,t){$(t).prop("checked")==!0&&f.push(Math.floor($(t).prop("name")))});r=r.filterByFoodIds(f);e=[];$.each(t.$(".filter-adopt input"),function(n,t){$(t).prop("checked")==!0&&e.push(Math.floor($(t).prop("name")))});r=r.filterByAdoptStatus(e);t.updateMarkers(r);t.$(".leaflet-top.leaflet-right").html('<div id="wrapper-treeinfo"><\/div>')};this.updateMarkers=function(n){var t=u,r,f;for(console.log(i.TAG+"updateMarkers()"),$.each(n.models,function(n,i){for(var r=!1,u=0;u<t._markers.length&&!r;u++)i.getId()==t._markers[u].options.id&&(r=!0);r||t.addMarker(i)}),r=0;r<t._markers.length;)f=!1,$.each(n.models,function(n,i){i.getId()==t._markers[r].options.id&&(f=!0)}),f||(t._markers[r]==t._selectedMarker&&t._selectedMarker.closePopup(),t.removeMarker(t._markers[r]),t._markers=_.without(t._markers,t._markers[r]),r--),r++};this.afterMoveMap=function(){var n=u;n._selectedMarker&&n._selectedMarker._bringToFront()};this.renderFilterList=function(){var t=u;n.Controller.checkAdmin(function(i){if(i.result=="true"){var r=_.template(n.Template.getTreeFilterListTemplate()),u={foods:n.Model.getFoods(),userid:parseInt(i.id),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()};t.$("#filter-list").html(r(u))}},function(){})};f=this;f.bDebug=!0;f._bTableView=!0;f._zoom=n.Setting.getDefaultMapZoomLevel();f._markers=[];f.events={"click .confirm-confirm":"_executeCommand","click .confirm-cancel":"_mouseClick","click .button-close":"_mouseClick","click .filter-checkbox":"_applyFilter","click .button-submit-donation":"_submitDonations","click .cell-tree-detail":"_removeNewDonationTree","click .switch-map":"_switchView","click .marker-control-plus":"_addNewDonation","click .image-group img":"_selectCoverImage"};f.delegateEvents()}return __extends(i,t),i.prototype.setPlace=function(n){var t=this;t._place=n},i.prototype.getPlace=function(){var n=this;return n._place},i.prototype.render=function(t){var r,u,f;if(this.bRendered){this.update(t);return}return this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=_.template(n.Template.getManageDonationViewTemplate()),f={placename:r._place.getName(),placeid:r._place.getId()},r.$el.html(u(f)),r.setElement(r.$("#wrapper-manage-donation")),r.renderTrees(),r.renderNewDonation(),r.setVisible(),r.resize(),r},i.prototype.addNewDonation=function(t){var i=this,r;if(i._donation.getTreeIds().length==0)i._donation.addTreeId(t.getId());else{var u=Math.floor(i._donation.getTreeIds()[0]),f=n.Model.getTrees().findWhere({id:u}),e=n.Model.getFoods().findWhere({id:f.getFoodId()}),o=n.Model.getFoods().findWhere({id:t.getFoodId()});e.getId()==o.getId()?i._donation.addTreeId(t.getId()):new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please select <strong>same type<\/strong> of food.",undoable:!1}).execute()}r=_.template(n.Template.getAddNewDonationTreeTemplate());i.$(".new-donation-trees").html(r({trees:n.Model.getTrees().filterByIds(i._donation.getTreeIds())}))},i.prototype._addNewDonation=function(){var t=this;t.addNewDonation(n.Model.getTrees().findWhere({id:t._selectedMarker.options.id}))},i.prototype.removeNewDonation=function(){var n=this},i.prototype.renderDonationImages=function(){var t=this,i="";$.each(t._donation.getPictures(),function(t){i+=t==0?'<img src="'+n.Setting.getBlankImagePath()+'" data-target="'+t+'" class="selected" />':'<img src="'+n.Setting.getBlankImagePath()+'" data-target="'+t+'" />'});t.$(".image-group").html(i);$.each(t.$(".image-group img"),function(i,r){$(r).attr("src",n.Setting.getContentPictureDir()+t._donation.getPictures()[i]).load(function(){}).error(function(){$(r).attr("src",n.Setting.getBlankImagePath())})})},i.prototype._selectCoverImage=function(n){var t=this;$.each(t.$(".image-group img"),function(n,t){$(t).removeClass("selected")});$(n.target).addClass("selected");t._donation.setCover(parseInt($(n.target).attr("data-target")));t.renderDonationImages()},i.prototype.renderTreeInfo=function(t){var i=this,r=n.Model.getFoods().findWhere({id:t.getFoodId()}),u=_.template(n.Template.getTreeInfoTemplate3()),f={foodname:r.getName(),treename:t.getName(),lat:t.getLat().toFixed(4),lng:t.getLng().toFixed(4),description:t.getDescription(),persons:t.getParents()};i.$("#wrapper-treeinfo").html(u(f));i.$("#wrapper-treeinfo").removeClass("hidden");t.getAddress().trim()==""?n.GeoLocation.reverseGeocoding(t.getLocation(),function(n){i.$(".input-address").html(n.road+", "+n.county+", "+n.state+", "+n.country+", "+n.postcode)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):i.$(".input-address").html(t.getAddress());i.renderRecentActivities(t)},i.prototype.renderRecentActivities=function(t){var r=this,i=[];i.push(t);n.Controller.fetchNotesOfTrees(i,n.NoteType.IMAGE,n.Setting.getNumRecentActivitiesShown(),0,function(){var i=new n.Notes(n.Model.getNotes().where({tree:t.getId(),type:n.NoteType.IMAGE})),u,f;i.sortByDescendingDate();u=_.template(n.Template.getRecentCommentsTemplate());f={notes:i,size:n.Setting.getNumRecentActivitiesShown(),coordinate:"@ "+t.getLat().toFixed(4)+", "+t.getLng().toFixed(4),flags:n.Model.getFlags(),ownerships:n.Model.getOwnerships()};r.$("#list-activities").html(u(f))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype.removeMarker=function(n){var t=this;t._map.removeLayer(n)},i.prototype.addMarker=function(t){var i=this,r=n.MarkerFractory.create2(t,!0);i._markers.push(r);r.addTo(i._map)},i.prototype.setLocation=function(n){var t=this;t._location=n},i.prototype.update=function(n){if(!this.bRendered){this.render(n);return}var t=this;return t.bDebug&&console.log(i.TAG+"update()"),t},i.prototype.resize=function(){var t=this;$("#content-manage-adoption-table").css({width:t.getWidth()-$("#wrapper-tablemenu").outerWidth()});$("#wrapper-main").css({height:n.View.getHeight()-60});$("#wrapper-mtrees").css({height:n.View.getHeight()-60});$(".collapsible-list").css({height:t.getHeight()-132})},i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i.prototype._applyFilter=function(t){var r=this,i=n.Model.getTrees();setTimeout(function(){var n,u,f,e;r.$('input[name="onlymine"]').prop("checked")==!0&&(i=i.filterByParent(parseInt(r.$('input[name="onlymine"]').attr("data-target"))));t!=undefined&&$(t.target).find("input").prop("name")=="ownershipsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-ownership").addClass("active"),$(".filter-ownership input").prop({checked:"checked"})):($(".filter-ownership").removeClass("active"),$(".filter-ownership input").prop({checked:""})));n=[];$.each(r.$(".filter-ownership input"),function(t,i){$(i).prop("checked")==!0&&n.push(Math.floor($(i).prop("name")))});i=i.filterByOwnershipIds(n);t!=undefined&&$(t.target).find("input").prop("name")=="flagsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-flag").addClass("active"),$(".filter-flag input").prop({checked:"checked"})):($(".filter-flag").removeClass("active"),$(".filter-flag input").prop({checked:""})));u=[];$.each(r.$(".filter-flag input"),function(n,t){$(t).prop("checked")==!0&&u.push(Math.floor($(t).prop("name")))});i=i.filterByFlagIds(u);t!=undefined&&$(t.target).find("input").prop("name")=="foodsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-food").addClass("active"),$(".filter-food input").prop({checked:"checked"})):($(".filter-food").removeClass("active"),$(".filter-food input").prop({checked:""})));f=[];$.each(r.$(".filter-food input"),function(n,t){$(t).prop("checked")==!0&&f.push(Math.floor($(t).prop("name")))});i=i.filterByFoodIds(f);t!=undefined&&$(t.target).find("input").prop("name")=="adoptsall"&&($(t.target).find("input").prop("checked")==!0?($(".filter-adopt").addClass("active"),$(".filter-adopt input").prop({checked:"checked"})):($(".filter-adopt").removeClass("active"),$(".filter-adopt input").prop({checked:""})));e=[];$.each(r.$(".filter-adopt input"),function(n,t){$(t).prop("checked")==!0&&e.push(Math.floor($(t).prop("name")))});i=i.filterByAdoptStatus(e);r._bTableView?r.renderTreeList(i):r.updateMarkers(i)},1)},i.prototype._submitDonations=function(){var t=this,i,r;t._donation.getTreeIds().length==0||t._donation.getQuantity()==0?new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please select at least <strong>one tree<\/strong> with proper <strong>amount<\/strong> for donation.",undoable:!1}).execute():(i=t._donation.getTreeIds(),r=n.Model.getTrees().findWhere({id:i[0]}),t._donation.setType(r.getFoodId()),n.EventHandler.handleDonationData(t._donation,n.DATA_MODE.CREATE,{},function(){n.EventHandler.handleDataChange("Donation for <strong><i>"+t._place.getName()+"<\/i><\/strong> has been added successfully.",!0);t._donation=null;t.renderNewDonation();t.$(".image-group").html("")},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}))},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._removeNewDonationTree=function(t){var i=this,u=parseInt($(t.target).attr("data-target")),r;i._donation.removeTreeId(u);r=_.template(n.Template.getAddNewDonationTreeTemplate());i.$(".new-donation-trees").html(r({trees:n.Model.getTrees().filterByIds(i._donation.getTreeIds())}))},i.prototype._switchView=function(t){var i=this,r,u,f;i._bTableView?(i._bTableView=!1,$(t.target).html("Switch to Table View")):(i._bTableView=!0,$(t.target).html("Switch to Map View"),i._map.remove(),i._map=null);i.$("#list-donation").html("");i.renderTreeList(n.Model.getTrees());r=n.Model.getTrees();u=[];$.each(i.$(".filter-food input"),function(n,t){$(t).prop("checked")==!0&&u.push(Math.floor($(t).prop("name")))});r=r.filterByFoodIds(u);f=[];$.each(i.$(".filter-adopt input"),function(n,t){$(t).prop("checked")==!0&&f.push(Math.floor($(t).prop("name")))});r=r.filterByAdoptStatus(f);i._bTableView&&i.renderTreeList(r)},i.TAG="AddDonationView - ",i}(n.PopupView);n.AddDonationView=r}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var f=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use DetailDonationViewFractory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var r;return r=new i({el:n}),r.setPlaceId(t),r},n._instance=new n,n}(),t,i,u,r;n.DetailDonationViewFractory=f;t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.setPlaceId=function(n){this._id=Math.floor(n)},t.prototype.refreshDonationInfo=function(){},t}(n.BaseView);n.DetailDonationView=t;i=function(t){function i(i){var u=this,r;t.call(this,i);this.renderPlaceInfo=function(t){var i=u,r=_.template(n.Template.getPlaceInfoTemplate2()),f={placename:t.getName(),lat:t.getLat().toFixed(4),lng:t.getLng().toFixed(4),description:t.getDescription()};i.$(".content-donation-info").html(r(f));n.GeoLocation.reverseGeocoding(t.getLocation(),function(n){i.$(".donation-info-address").html("<div>&nbsp;<i class='fa fa-map-marker'><\/i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+n.road+", "+n.county+", "+n.state+", "+n.country+", "+n.postcode+"<\/div>")},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)});i.renderRecentDonations(t)};this.renderDonationChart=function(t,i,r){var f=u;n.Controller.fetchDonationsOfPlacesDuringPeriod([f._place],i,r,1e4,0,function(){var s,h,t,e,c;f.$("#wrapper-chart").html('<canvas id="content-chart" class="content-chart" />');s=f.$("#content-chart")[0];f.$("#content-chart").attr({width:f.$("#content-chart").innerWidth(),height:f.$("#content-chart").innerHeight()});h=s.getContext("2d");f.$("#wrapper-graph").on("mousemove",function(n){n.clientX-24-$("#wrapper-tooltip").outerWidth()<0?f.$("#wrapper-tooltip").css({top:n.clientY-60,left:n.clientX+24}):f.$("#wrapper-tooltip").css({top:n.clientY-60,left:n.clientX-24-f.$("#wrapper-tooltip").outerWidth()})});f.$("#wrapper-graph").on("mouseleave",function(){f.$("#wrapper-tooltip").addClass("hidden")});var o=[],u=[],l=moment(i).set("hour",13).set("minute",0).set("seconds",0).set("milliseconds",0),a=null;for(t=moment(l).valueOf();t<moment(r).add("day",1).valueOf();t+=864e5)o.push(moment(t).format(n.Setting.getDateHourFormat())),e=n.Model.getDonations().getLatestDonationOfDate(f._place.getId(),t),e?(u.push(e),a=e):u.push(new n.Donation({place:f._place.getId(),tree:"",quantity:0,date:moment(t).format(n.Setting.getDateTimeFormat())}));console.log("Graph Points Length: "+u.length);c=Math.floor(o.length/(f.$("#content-chart").innerWidth()/150));f._chart&&f._chart.destroy();f._chart=new Chart(h).Line({labels:o,datasets:[{label:"My First dataset",fillColor:"rgba(132,167,87,0.4)",strokeColor:"rgba(132,167,87,1)",pointColor:"rgba(132,167,87,1)",pointStrokeColor:"rgba(132,167,87,1)",pointHighlightFill:"rgba(220,220,220,1)",pointHighlightStroke:"rgba(132,167,87,1)",data:u},]},{scaleOverride:!1,scaleSteps:1,scaleStepWidth:10,scaleStartValue:0,pointDotRadius:3,pointDotStrokeWidth:2,bezierCurve:!1,pointHitDetectionRadius:f.$("#content-chart").innerWidth()/u.length*.5,pointDot:!1,labelskip:c,customTooltips:function(t){if(!t||!t.id){f.$("#wrapper-tooltip").addClass("hidden");f._donation=null;return}if(f._donation=n.Model.getDonations().findWhere({id:t.id}),f._donation){var i=_.template(n.Template.getToolTipTemplate2()),r={image:n.Setting.getBlankImagePath(),value:f._donation.getCumulativeQuantity(),comment:htmlDecode(f._donation.getComment()),startdate:n.Model.getDonations().models[0].getFormattedDate(),date:f._donation.getFormattedHourTime()};f.$("#wrapper-tooltip").html(i(r));f._donation.getPictures().length>0?f.$("#wrapper-tooltip img").attr("src",n.Setting.getContentPictureDir()+f._donation.getPictures()[0]).load(function(){$(this).removeClass("hidden")}).error(function(){$(this).attr("src",n.Setting.getBlankImagePath());$(this).addClass("hidden")}):f.$("#wrapper-tooltip img").addClass("hidden")}f.$("#wrapper-tooltip").removeClass("hidden")}})},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};r=this;r.bDebug=!0;r.events={"click .switch-map":"_mouseClick","click .date-preset":"_datePreset","dblclick .content-chart":"_mouseClick","click .button-new-donation":"_mouseClick","click .button-delete-location":"_deleteLocation"};r.delegateEvents()}return __extends(i,t),i.prototype.render=function(t){var r,u,f;return this.bRendered?(this.update(t),r):(this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=_.template(n.Template.getDetailDonationGraphicViewTemplate()),f={},r.$el.html(u(f)),r.setElement(r.$("#wrapper-mdonation")),r.resize(),n.Controller.fetchAllLocations(function(){r._place=n.Model.getPlaces().findWhere({id:r._id});r.renderPlaceInfo(r._place);r.$(".donation-graph-start").attr({"data-value":moment(new Date).subtract(1,"month").format(n.Setting.getDateFormat())});r._startDate=moment(moment(new Date).subtract(3,"month").format(n.Setting.getDateFormat())).format(n.Setting.getDateTimeFormat());r.$(".donation-graph-start").pickadate({format:"dd mmm yyyy",today:"",max:new Date(moment(new Date).subtract("day",2).valueOf()),clear:"",close:"Close",onClose:function(){r._startDate=moment(this.get()).startOf("day").format(n.Setting.getDateTimeFormat());r.renderDonationChart(r._place,r._startDate,r._endDate)}});var t=new Date;r._endDate=moment(t).endOf("day").format(n.Setting.getDateTimeFormat());r.$(".donation-graph-end").attr({"data-value":moment(new Date).format(n.Setting.getDateFormat())});r.$(".donation-graph-end").pickadate({format:"dd mmm yyyy",today:"Today",max:t,clear:"",close:"Close",onClose:function(){r._endDate=moment(this.get()).endOf("day").format(n.Setting.getDateTimeFormat());r.renderDonationChart(r._place,r._startDate,r._endDate)}});r.renderDonationChart(r._place,r._startDate,r._endDate)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}),r)},i.prototype.resize=function(){var t=this;$("#wrapper-main").css({height:n.View.getHeight()-60});$("#wrapper-mdonation").css({height:n.View.getHeight()-60});t.$(".image-group").css({height:t.$(".image-wrapper").innerHeight()-60})},i.prototype.refreshDonationInfo=function(){var n=this;n.renderPlaceInfo(n._place);n.renderDonationChart(n._place,n._startDate,n._endDate)},i.prototype.renderRecentDonations=function(t){var r=this,i=[];i.push(t);n.Controller.fetchDonationsOfPlaces(i,n.Setting.getLargeNumRecentActivitiesShown(),0,function(){var i=new n.Donations(n.Model.getDonations().where({place:t.getId()})),u,f;i.sortByDescendingDate();u=_.template(n.Template.getRecentDonationsTemplate());f={donations:i,size:n.Setting.getLargeNumRecentActivitiesShown()};r.$("#list-donations").html(u(f))},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype._datePreset=function(t){var i=this;$(t.currentTarget).hasClass("4years")?i._startDate=moment(i._endDate).subtract(4,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("2years")?i._startDate=moment(i._endDate).subtract(2,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("1year")?i._startDate=moment(i._endDate).subtract(1,"years").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("6months")?i._startDate=moment(i._endDate).subtract(6,"months").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("3months")?i._startDate=moment(i._endDate).subtract(3,"months").startOf("day").format(n.Setting.getDateTimeFormat()):$(t.currentTarget).hasClass("1month")&&(i._startDate=moment(i._endDate).subtract(1,"months").startOf("day").format(n.Setting.getDateTimeFormat()));i.$(".donation-graph-start").pickadate("picker").set("select",moment(i._startDate).format(n.Setting.getDateFormat()),{format:"dd mmm yyyy"});i.renderDonationChart(i._place,i._startDate,i._endDate)},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i,{donation:i._donation,place:i._place})},i.prototype._deleteLocation=function(){var t=this;n.EventHandler.handlePlaceData(t._place,n.DATA_MODE.DELETE,{},function(){Backbone.history.history.back();n.EventHandler.handleDataChange("<strong><i>"+t._place.getName()+"<\/i><\/strong> has deleted successfully.",!1)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.TAG="DetailDonationGraphicView - ",i}(t);n.DetailDonationGraphicView=i;u=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use EditDonationViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var i=new r({el:n});return i.setDonation(t),i},n._instance=new n,n}();n.EditDonationViewFactory=u;r=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .alert-confirm":"_mouseClick","click .top-right-button":"_mouseClick","click .delete-donation":"_deleteDonation","click .prev-note":"_prevNote","click .next-note":"_nextNote","click .image-group img":"_changeCoverImage","click .delete-note":"_deleteNote","click .cell-tree-detail":"_removeNewDonationTree"};i.delegateEvents()}return __extends(i,t),i.prototype.setDonation=function(n){var t=this;t._donation=n},i.prototype.render=function(t){var r;if(this.bRendered){this.update(t);return}this.bRendered=!0;r=this;r.bDebug&&console.log(i.TAG+"render()");var u=n.Model.getPlaces().findWhere({id:r._donation.getPlaceId()}),f=_.template(n.Template.getEditDonationViewTemplate()),e={name:u.getName(),image:n.Setting.getBlankImagePath(),amount:r._donation.getQuantity(),date:r._donation.getFormattedHourTime()};return $("#wrapper-pop").html(f(e)),r.setElement($("#wrapper-donation")),r.renderDonationInfo(),r.setVisible(),r.resize(),r},i.prototype.renderDonationInfo=function(){var t=this,u=new Date,i,r;t.$(".input-date").attr({"data-value":t._donation.getFormattedDate()});t.$(".input-date").pickadate({format:"dd mmm yyyy",today:"Today",max:u,clear:"",close:"Close",onClose:function(){n.EventHandler.handleDonationData(t._donation,n.DATA_MODE.UPDATE_DATE,{date:moment(this.get()).startOf("day").format(n.Setting.getDateTimeFormat())},function(){n.EventHandler.handleDataChange("Date of this <strong><i>Donation<\/i><\/strong> has changed successfully.",!0);t.renderDonationInfo()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})}});t.$(".input-date").pickadate("picker").set("select",t._donation.getFormattedDate(),{format:"dd mmm yyyy"});i=_.template(n.Template.getAddNewDonationTreeTemplate());t.$(".new-donation-trees").html(i({trees:n.Model.getTrees().filterByIds(t._donation.getTreeIds())}));t.renderDonationImages();t.$("input[type=file]").off("change");t.$("input[type=file]").on("change",function(i){t.$(".wrapper-input-upload-picture").addClass("hidden");t.$(".wrapper-uploading-picture").removeClass("hidden");var r=i.target.files,u=n.Model.getPlaces().findWhere({id:t._donation.getPlaceId()});r.length>0&&n.Controller.uploadNotePictureFile(r[0],fileNameEncode(u.getName()),function(i){n.EventHandler.handleDonationData(t._donation,n.DATA_MODE.ADD_PICTURE,{filename:i},function(){n.EventHandler.handleDataChange("<strong><i>"+i+"<\/i><\/strong> has been added successfully.",!0);t.$("input[type=file]").val("");t.$(".wrapper-uploading-picture").addClass("hidden");t.$(".wrapper-input-upload-picture").removeClass("hidden");t.renderDonationImages()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){n.EventHandler.handleDataChange("<strong><i>"+i+"<\/i><\/strong> has been removed successfully.",!0);t.$("input[type=file]").val("");t.$(".wrapper-uploading-picture").addClass("hidden");t.$(".wrapper-input-upload-picture").removeClass("hidden");t.renderDonationImages()})},function(){t.$(".wrapper-uploading-picture").addClass("hidden");t.$(".wrapper-input-upload-picture").removeClass("hidden")})});i=_.template(n.Template.TreeSelectTemplate());r={trees:n.Model.getTrees()};t.$(".add-donation-tree").html(i(r));t.$(".input-tree").selectpicker();t.$(".input-tree").selectpicker("val",0);t.$(".input-tree").on("hide.bs.dropdown",function(){var f=parseInt($(this).find("option:selected").val()),i=n.Model.getTrees().findWhere({id:f}),r;if(i!=undefined)if(r=n.Model.getFoods().findWhere({id:i.getFoodId()}),t._donation.getTreeIds().length==0)n.EventHandler.handleDonationData(t._donation,n.DATA_MODE.ADD_DONATION_TREE,{tree:i},function(){n.EventHandler.handleDataChange("<strong><i>"+r.getName()+" "+i.getName()+"<\/i><\/strong> has been added successfully.",!0);t.renderDonationInfo()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){n.EventHandler.handleDataChange("<strong><i>"+r.getName()+" "+i.getName()+"<\/i><\/strong> has been removed successfully.",!0);t.renderDonationInfo()});else{var e=Math.floor(t._donation.getTreeIds()[0]),o=n.Model.getTrees().findWhere({id:e}),u=n.Model.getFoods().findWhere({id:o.getFoodId()}),s=n.Model.getFoods().findWhere({id:i.getFoodId()});u.getId()==s.getId()?t._donation.hasTreeId(i.getId())?(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"<strong><i>"+u.getName()+" "+i.getName()+"<\/i><\/strong> already exist.",undoable:!1}).execute(),t.$(".input-tree").selectpicker("val",0)):n.EventHandler.handleDonationData(t._donation,n.DATA_MODE.ADD_DONATION_TREE,{tree:i},function(){n.EventHandler.handleDataChange("<strong><i>"+r.getName()+" "+i.getName()+"<\/i><\/strong> has been added successfully.",!0);t.renderDonationInfo()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){n.EventHandler.handleDataChange("<strong><i>"+r.getName()+" "+i.getName()+"<\/i><\/strong> has been removed successfully.",!0);t.renderDonationInfo()}):(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please select <strong>same type<\/strong> of food.",undoable:!1}).execute(),t.$(".input-tree").selectpicker("val",0))}});t.$(".input-amount").replaceWith('<div class="input-amount">'+t._donation.getQuantity()+" lbs.<\/div>");t.$(".input-amount").on("click",function(){$(this).replaceWith("<input type='text' class='input-amount form-control' value='"+parseFloat(htmlEncode($(this).text()))+"' />");t.$(".input-amount").focus();t.$(".input-amount").on("focusout",function(){var i=parseFloat(t.$(".input-amount").val());i!=t._donation.getQuantity()?n.EventHandler.handleDonationData(t._donation,n.DATA_MODE.UPDATE_DONATION_AMOUNT,{amount:i},function(){n.EventHandler.handleDataChange("<strong><i>Amount of donation<\/i><\/strong> has been changed successfully.",!0);t.renderDonationInfo()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)}):t.renderDonationInfo()})})},i.prototype.renderDonationImages=function(){var t=this,i="";$.each(t._donation.getPictures(),function(t){i+=t==0?'<img src="'+n.Setting.getBlankImagePath()+'" data-target="'+t+'" class="selected" />':'<img src="'+n.Setting.getBlankImagePath()+'" data-target="'+t+'" />'});t.$(".image-group").html(i);$.each(t.$(".image-group img"),function(i,r){$(r).attr("src",n.Setting.getContentPictureDir()+t._donation.getPictures()[i]).load(function(){}).error(function(){$(r).attr("src",n.Setting.getBlankImagePath())})})},i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._changeCoverImage=function(t){var i=this,r=parseInt($(t.target).attr("data-target")),u=n.Model.getPlaces().findWhere({id:i._donation.getPlaceId()});r!=0&&n.EventHandler.handleDonationData(i._donation,n.DATA_MODE.UPDATE_COVER,{cover:r},function(){n.EventHandler.handleDataChange("Cover picture of <strong><i>"+u.getName()+"<\/i><\/strong> has changed successfully.",!0);i.renderDonationImages()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.prototype._prevNote=function(){var t=this,i=new n.Donations(n.Model.getDonations().where({place:t._donation.getPlaceId()})),r;i.sortByAscendingDate();r=!1;$.each(i.models,function(n,u){if(t._donation.getId()==u.getId()&&!r){r=!0;t._donation=n==0?i.models[i.models.length-1]:i.models[n-1];t.renderDonationInfo();return}})},i.prototype._nextNote=function(){var t=this,i=new n.Donations(n.Model.getDonations().where({place:t._donation.getPlaceId()})),r;i.sortByAscendingDate();r=!1;$.each(i.models,function(n,u){if(t._donation.getId()==u.getId()&&!r){r=!0;t._donation=n==i.models.length-1?i.models[0]:i.models[n+1];t.renderDonationInfo();return}})},i.prototype._removeNewDonationTree=function(t){var r=this,f=parseInt($(t.target).attr("data-target")),i=n.Model.getTrees().findWhere({id:f}),u=n.Model.getFoods().findWhere({id:i.getFoodId()});n.EventHandler.handleDonationData(r._donation,n.DATA_MODE.REMOVE_DONATION_TREE,{tree:i},function(){n.EventHandler.handleDataChange("<strong><i>"+u.getName()+" "+i.getName()+"<\/i><\/strong> has been removed successfully.",!0);r.renderDonationInfo()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)},function(){n.EventHandler.handleDataChange("<strong><i>"+u.getName()+" "+i.getName()+"<\/i><\/strong> has been added successfully.",!0);r.renderDonationInfo()})},i.prototype._deleteDonation=function(){var t=this,i=t._donation.getFormattedDate();n.EventHandler.handleDonationData(t._donation,n.DATA_MODE.DELETE,{},function(){n.View.getDetailDonationView()&&n.View.getDetailDonationView().refreshDonationInfo();n.EventHandler.handleDataChange("Donation of <strong><i>"+i+"<\/i><\/strong> has been removed successfully.",!0)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})},i.TAG="EditDonationView - ",i}(n.PopupView);n.EditDonationView=r}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var e=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use AdoptTreeViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,i){var r=new t({el:n});return r.setTree(i),r},n._instance=new n,n}(),t,u,i,f,r;n.AdoptTreeViewFactory=e;t=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .evt-close":"_mouseClick","click .evt-submit":"_mouseClick"};i.delegateEvents()}return __extends(i,t),i.prototype.setTree=function(t){var i=this;i._tree=n.Model.getTrees().findWhere({id:t})},i.prototype.getTree=function(){var n=this;return n._tree},i.prototype.render=function(r){var u;t.prototype.render.call(this,r);u=this;u.bDebug&&console.log(i.TAG+"render()");var f=n.Model.getFoods().findWhere({id:u._tree.getFoodId()}),e=_.template(n.Template.getAdoptTreeViewTemplate()),o={header:"Adopt Tree",treename:f.getName()+" "+u._tree.getName()};return u.$el.html(e(o)),u.setElement(u.$("#wrapper-tree-adopt")),u.setVisible(),u.resize(),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.prototype.resize=function(){var n=this},i.prototype._mouseClick=function(t){var i=this;i._tree!=undefined?n.EventHandler.handleMouseClick($(t.currentTarget),i,{tree:i._tree}):n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.TAG="AdoptTreeView - ",i}(n.PopupView);n.AdoptTreeView=t;u=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use UnadoptTreeViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var r=new i({el:n});return r.setTree(t),r},n._instance=new n,n}();n.UnadoptTreeViewFactory=u;i=function(t){function i(n){t.call(this,n);var i=this;i.bDebug=!0;i.events={"click .evt-close":"_mouseClick","click .evt-submit":"_mouseClick"};i.delegateEvents()}return __extends(i,t),i.prototype.setTree=function(t){var i=this;i._tree=n.Model.getTrees().findWhere({id:t})},i.prototype.getTree=function(){var n=this;return n._tree},i.prototype.render=function(r){var u;t.prototype.render.call(this,r);u=this;u.bDebug&&console.log(i.TAG+"render()");var f=n.Model.getFoods().findWhere({id:u._tree.getFoodId()}),e=_.template(n.Template.getUnadoptTreeViewTemplate()),o={header:"Unadopt Tree",treename:f.getName()+" "+u._tree.getName()};return u.$el.html(e(o)),u.setElement(u.$("#wrapper-tree-adopt")),u.setVisible(),u.resize(),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.prototype.resize=function(){var n=this},i.prototype._mouseClick=function(t){var i=this;i._tree!=undefined?n.EventHandler.handleMouseClick($(t.currentTarget),i,{tree:i._tree}):n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.TAG="UnadoptTreeView - ",i}(n.PopupView);n.UnadoptTreeView=i;f=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use AdoptionManageViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,t){var i=new r({el:n});return i.setTree(t),i},n._instance=new n,n}();n.AdoptionManageViewFactory=f;r=function(t){function i(i){var u=this,r;t.call(this,i);this.renderManageAdoption=function(){var t=u;n.Controller.fetchAllPersonsAndAuthsAndFoodAndTreesAndAdopts(function(){t.renderParentsList(n.Model.getPersons());t.renderFilterList()},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR)})};this.renderFilterList=function(){var t=u,i=_.template(n.Template.getAdoptionFilterListTemplate()),r={header:"Filter List",auths:n.Model.getAuths()};t.$(".adoption-filter").html(i(r))};this.renderParentsList=function(t){var r=u,i=new Backgrid.Grid({columns:AdoptionColumn,collection:t,emptyText:n.Setting.getNoDataText()});i.render();i.sort("name","ascending");r.$(".list-adoption").html(i.el)};r=this;r.bDebug=!0;r.events={"click .evt-close":"_mouseClick","click .btn-filter":"_clickFilter","click .evt-reset-filter":"_resetFilter"};r.delegateEvents()}return __extends(i,t),i.prototype.setTree=function(t){var i=this;i._tree=n.Model.getTrees().findWhere({id:t})},i.prototype.getTree=function(){var n=this;return n._tree},i.prototype.render=function(r){var u;t.prototype.render.call(this,r);u=this;u.bDebug&&console.log(i.TAG+"render()");var f=n.Model.getFoods().findWhere({id:u._tree.getFoodId()}),e=_.template(n.Template.getAdoptionManageViewTemplateForAdmin()),o={header:"Manage Adoptions",treename:f.getName()+" "+u._tree.getName(),treeId:u._tree.getId()};return u.$el.append(e(o)),u.setElement(u.$("#wrapper-manage-adoption")),u.renderManageAdoption(),u.setVisible(),u.resize(),u},i.prototype.update=function(n){t.prototype.update.call(this,n);var r=this;return r.bDebug&&console.log(i.TAG+"update()"),r},i.prototype.resize=function(){var n=this},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._clickFilter=function(n){var t=this;$(n.currentTarget).hasClass("filter-parenting-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-parenting-item").length==t.$(".filter-parenting-item.active").length?t.$(".filter-parenting-all").addClass("active"):t.$(".filter-parenting-all").removeClass("active"));$(n.currentTarget).hasClass("filter-parenting-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-parenting-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-parenting-item").addClass("active")));$(n.currentTarget).hasClass("filter-auth-item")&&($(n.currentTarget).hasClass("active")?$(n.currentTarget).removeClass("active"):$(n.currentTarget).addClass("active"),t.$(".filter-auth-item").length==t.$(".filter-auth-item.active").length?t.$(".filter-auth-all").addClass("active"):t.$(".filter-auth-all").removeClass("active"));$(n.currentTarget).hasClass("filter-auth-all")&&($(n.currentTarget).hasClass("active")?($(n.currentTarget).removeClass("active"),t.$(".filter-auth-item").removeClass("active")):($(n.currentTarget).addClass("active"),t.$(".filter-auth-item").addClass("active")));t._applyFilter()},i.prototype._resetFilter=function(){var n=this;n.$(".filter-parenting-all").addClass("active");n.$(".filter-auth-all").addClass("active");n.$(".filter-parenting-item").removeClass("active");n.$(".filter-auth-item").removeClass("active");n._applyFilter()},i.prototype._applyFilter=function(){var t=this,i=n.Model.getPersons(),u=[],r;t.$(".filter-parenting-all").hasClass("active")?$.each(t.$(".filter-parenting-item"),function(n,t){u.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-parenting-item"),function(n,t){$(t).hasClass("active")&&u.push(parseInt($(t).attr("data-id")))});i=i.filterByAdoptStatusForTree(u,t._tree.getId());r=[];t.$(".filter-auth-all").hasClass("active")?$.each(t.$(".filter-auth-item"),function(n,t){r.push(parseInt($(t).attr("data-id")))}):$.each(t.$(".filter-auth-item"),function(n,t){$(t).hasClass("active")&&r.push(parseInt($(t).attr("data-id")))});i=i.filterByAuthIds(r);t.renderParentsList(i)},i.TAG="AdoptionManageView - ",i}(n.PopupView);n.AdoptionManageView=r}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var i=function(){function n(){if(n._instance)throw new Error("Error: Instantiation failed: Use ChangePasswordViewFactory.getInstance() instead of new.");n._instance=this}return n.getInstance=function(){return n._instance},n.create=function(n,i){var r=new t({el:n});return r.setPerson(i),r},n._instance=new n,n}(),t;n.ChangePasswordViewFactory=i;t=function(t){function i(n){t.call(this,n);this.bProcessing=!1;var i=this;i.bDebug=!0;i.events={"click .top-right-button":"_mouseClick","click .password-cancel":"_mouseClick","click .password-submit":"_submitPassword"};i.delegateEvents()}return __extends(i,t),i.prototype.setPerson=function(n){var t=this;t._person=n},i.prototype.render=function(t){var r,u,f;if(this.bRendered){this.update(t);return}return this.bRendered=!0,r=this,r.bDebug&&console.log(i.TAG+"render()"),u=_.template(n.Template.getChangePasswordViewTemplate()),f={personname:r._person.getName()},r.$el.html(u(f)),r.setElement(r.$("#wrapper-change-password")),r.setVisible(),r.resize(),r},i.prototype.update=function(n){if(!this.bRendered){this.render(n);return}var t=this;return t.bDebug&&console.log(i.TAG+"update()"),t},i.prototype.resize=function(){var n=this},i.prototype.setVisible=function(){var t=this;n.Setting.getPopWrapperElement().removeClass("hidden")},i.prototype.setInvisible=function(){var t=this;n.Setting.getPopWrapperElement().addClass("hidden")},i.prototype._mouseClick=function(t){var i=this;n.EventHandler.handleMouseClick($(t.currentTarget),i)},i.prototype._submitPassword=function(){var t=this;t.bProcessing||(t.bProcessing=!0,t.$(".input-password").val().trim()==""&&t.$(".input-password2").val().trim()==""?(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please <strong>enter<\/strong> a new password.",undoable:!1}).execute(),t.bProcessing=!1):t.$(".input-password").val().trim().length<6?(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"The password should be longer than <strong>6 characters<\/strong>.",undoable:!1}).execute(),t.bProcessing=!1):t.$(".input-password").val().trim()==t.$(".input-password2").val().trim()?n.Controller.changePassword(t._person.getId(),t.$(".input-password").val().trim(),function(i){i.result=="true"||i.result==!0?(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"The <strong>password<\/strong> has changed successfully.",undoable:!1}).execute(),new RemoveAlertViewCommand({delay:n.Setting.getRemovePopupDuration()}).execute(),t.bProcessing=!1,Backbone.history.loadUrl(Backbone.history.fragment)):(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:n.Setting.getErrorMessage(i.code),undoable:!1}).execute(),t.bProcessing=!1)},function(){n.EventHandler.handleError(n.ERROR_MODE.SEVER_CONNECTION_ERROR);t.bProcessing=!1}):(new n.RenderMessageViewCommand({el:n.Setting.getMessageWrapperElement(),message:"Please enter <strong>same<\/strong> passwords.",undoable:!1}).execute(),t.bProcessing=!1))},i.TAG="ChangePasswordView - ",i}(n.PopupView);n.ChangePasswordView=t}(FoodParent||(FoodParent={})),function(n){var t=function(){function t(){if(this.bDebug=!0,t._instance)throw new Error("Error: Instantiation failed: Use Model.getInstance() instead of new.");t._instance=this}return t.getInstance=function(){return t._instance},t.getAdopts=function(){var i=t._instance;return i.adopts==undefined&&(i.adopts=new n.Adopts),i.adopts},t.getFoods=function(){var i=t._instance;return i.foods==undefined&&(i.foods=new n.Foods),i.foods},t.getAuths=function(){var i=t._instance;return i.auths==undefined&&(i.auths=new n.Auths),i.auths},t.getTrees=function(){var i=t._instance;return i.trees==undefined&&(i.trees=new n.Trees),i.trees},t.getFlags=function(){var i=t._instance;return i.flags==undefined&&(i.flags=new n.Flags),i.flags},t.getOwnerships=function(){var i=t._instance;return i.ownerships==undefined&&(i.ownerships=new n.Ownerships),i.ownerships},t.getNotes=function(){var i=t._instance;return i.notes==undefined&&(i.notes=new n.Notes),i.notes},t.getPersons=function(){var i=t._instance;return i.persons==undefined&&(i.persons=new n.Persons),i.persons},t.getPlaces=function(){var i=t._instance;return i.places==undefined&&(i.places=new n.Places),i.places},t.getDonations=function(){var i=t._instance;return i.donations==undefined&&(i.donations=new n.Donations),i.donations},t.fetchAllAuths=function(){var i=t._instance;return i.auths==undefined&&(i.auths=new n.Auths),i.auths.fetch({remove:!0,processData:!0,data:{},success:function(){},error:function(){console.log("error while fetching item data from the server")}})},t.fetchAllFoods=function(){var i=t._instance;return i.foods==undefined&&(i.foods=new n.Foods),i.foods.fetch({remove:!0,processData:!0,data:{mode:2,ids:0,id:0},success:function(){i.foods.sortByAscendingName()},error:function(){console.log("error while fetching item data from the server")}})},t.fetchAllTrees=function(){var i=t._instance;return i.trees==undefined&&(i.trees=new n.Trees),i.foods==undefined&&(i.foods=new n.Foods),i.trees.fetch({remove:!0,processData:!0,data:{mode:2,id:0,south:0,north:0,west:0,east:0},success:function(){},error:function(){console.log("error while fetching item data from the server")}})},t.fetchAllFlags=function(){var i=t._instance;return i.flags==undefined&&(i.flags=new n.Flags),i.flags.fetch({remove:!0,processData:!0,data:{},success:function(){i.flags.sortByAscendingName()},error:function(){console.log("error while fetching item data from the server")}})},t.fetchAllOwnerships=function(){var i=t._instance;return i.ownerships==undefined&&(i.ownerships=new n.Ownerships),i.ownerships.fetch({remove:!0,processData:!0,data:{},success:function(){},error:function(){console.log("error while fetching item data from the server")}})},t.fetchAllPersons=function(){var i=t._instance;return i.persons==undefined&&(i.persons=new n.Persons),i.persons.fetch({remove:!0,processData:!0,data:{},success:function(){},error:function(){console.log("error while fetching item data from the server")}})},t.fetchAllAdopts=function(){var i=t._instance;return i.adopts==undefined&&(i.adopts=new n.Adopts),i.adopts.fetch({remove:!0,processData:!0,data:{},success:function(){},error:function(){console.log("error while fetching item data from the server")}})},t.fetchNotesOfTrees=function(i,r,u,f){var e=t._instance;if(e.notes==undefined&&(e.notes=new n.Notes),i.length!=0){if(r==n.NoteType.IMAGE)return e.notes.fetch({remove:!1,processData:!0,data:{mode:2,trees:i.toString(),start:"",end:"",size:u,offset:f},success:function(){},error:function(){console.log("error while fetching item data from the server")}});if(r==n.NoteType.INFO)return e.notes.fetch({remove:!1,processData:!0,data:{mode:3,trees:i.toString(),start:"",end:"",size:u,offset:f},success:function(){},error:function(){console.log("error while fetching item data from the server")}})}return null},t.fetchCommentsOfTreesDuringPeriod=function(i,r,u,f,e){var o=t._instance;return(o.notes==undefined&&(o.notes=new n.Notes),i.length!=0)?o.notes.fetch({remove:!1,processData:!0,data:{mode:1,trees:i.toString(),start:r,end:u,size:f,offset:e},success:function(){},error:function(){console.log("error while fetching item data from the server")}}):null},t.fetchLatestCommentOfTrees=function(i){var r=t._instance;return(r.notes==undefined&&(r.notes=new n.Notes),i.length!=0)?r.notes.fetch({remove:!1,processData:!0,data:{mode:4,trees:i.toString(),start:"",end:"",size:1,offset:0},success:function(){},error:function(){console.log("error while fetching item data from the server")}}):null},t.fetchAllPlaces=function(){var i=t._instance;return i.places==undefined&&(i.places=new n.Places),i.places.fetch({remove:!0,processData:!0,data:{mode:2,ids:0,id:0},success:function(){},error:function(){}})},t.fetchDonationsOfPlaces=function(i,r,u){var f=t._instance;return(f.donations==undefined&&(f.donations=new n.Donations),i.length!=0)?f.donations.fetch({remove:!1,processData:!0,data:{mode:0,places:i.toString(),start:"",end:"",size:r,offset:u},success:function(){},error:function(){console.log("error while fetching item data from the server")}}):null},t.fetchDonationsOfPlacesDuringPeriod=function(i,r,u,f,e){var o=t._instance;return(o.donations==undefined&&(o.donations=new n.Donations),i.length!=0)?o.donations.fetch({remove:!1,processData:!0,data:{mode:1,places:i.toString(),start:r,end:u,size:f,offset:e},success:function(){},error:function(){console.log("error while fetching item data from the server")}}):null},t._instance=new t,t.TAG="Model - ",t}();n.Model=t}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.url="adopt.php";var u=this;this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,tree:"",parent:"",updated:moment(new Date).format(n.Setting.getDateTimeFormat())}}return __extends(i,t),i.prototype.parse=function(i,r){return i.id!=null&&(i.id=parseInt(i.id)),i.tree=parseInt(i.tree),i.parent=parseInt(i.parent),i.updated=moment(i.updated).format(n.Setting.getDateTimeFormat()),t.prototype.parse.call(this,i,r)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getTreeId=function(){var n=this;return Math.floor(n.get("tree"))},i.prototype.getParentId=function(){var n=this;return Math.floor(n.get("parent"))},i}(Backbone.Model),i;n.Adopt=t;i=function(i){function r(r,u){i.call(this,r,u);this.url="adopts.php";this.url=n.Setting.getPhpDir()+this.url;this.model=t}return __extends(r,i),r.prototype.getIds=function(){var t=this,n=Array();return $.each(t.models,function(t,i){n.indexOf(i.getId())==-1&&n.push(i.getId())}),n},r.prototype.getTreeIds=function(n){var i=this,t=Array();return $.each(i.models,function(i,r){r.getParentId()==n&&t.indexOf(r.getTreeId())==-1&&t.push(r.getTreeId())}),t},r.prototype.getParentIds=function(n){var i=this,t=Array();return $.each(i.models,function(i,r){r.getTreeId()==n&&t.indexOf(r.getParentId())==-1&&t.push(r.getParentId())}),t},r.prototype.checkAdoption=function(n,t){var i=this;return i.findWhere({tree:n,parent:t})?!0:!1},r}(Backbone.Collection);n.Adopts=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.url="auth.php";this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,name:""}}return __extends(i,t),i.prototype.parse=function(n,i){return n.id!=null&&(n.id=parseInt(n.id)),t.prototype.parse.call(this,n,i)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getName=function(){return this.get("name")},i}(Backbone.Model),i;n.Auth=t;i=function(i){function r(r,u){i.call(this,r,u);this.url="auths.php";this.url=n.Setting.getPhpDir()+this.url;this.model=t}return __extends(r,i),r.prototype.toArray=function(){var t=this,n=[];return $.each(t.models,function(t,i){n.push([i.getName(),i.getId()])}),n},r}(Backbone.Collection);n.Auths=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.url="food.php";this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,name:"",icon:"",description:"",updated:moment(new Date).format(n.Setting.getDateTimeFormat())}}return __extends(i,t),i.prototype.parse=function(i,r){return i.id!=null&&(i.id=parseInt(i.id)),i.updated=moment(i.updated).format(n.Setting.getDateTimeFormat()),t.prototype.parse.call(this,i,r)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getName=function(){return this.get("name")},i.prototype.getIconPath=function(){return n.Setting.getContentIconDir()+this.get("icon")},i}(Backbone.Model),i;n.Food=t;i=function(i){function r(r,u){i.call(this,r,u);this.url="foods.php";this.sortType=n.SortType.ASCENDING;this.url=n.Setting.getPhpDir()+this.url;this.model=t}return __extends(r,i),r.prototype.getUndetectedIds=function(n){var i=this,t=Array();return t=n,$.each(i.models,function(n,i){var r=t.indexOf(i.getId());r!=-1&&t.splice(r,1)}),t},r.prototype.toArray=function(){var t=this,n=[];return $.each(t.models,function(t,i){n.push([i.getName(),i.getId()])}),n},r.prototype.comparator=function(t){var i=this;switch(i.sortType){case n.SortType.NONE:return 0;case n.SortType.ASCENDING:return t.get("name");case n.SortType.DESCENDING:return-t.get("name")}},r.prototype.sortByDescendingName=function(){var t=this;t.sortType=n.SortType.DESCENDING;t.sort()},r.prototype.sortByAscendingName=function(){var n=this;n.models=_.sortBy(n.models,"name")},r}(Backbone.Collection);n.Foods=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.url="ownership.php";this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,name:""}}return __extends(i,t),i.prototype.parse=function(n,i){return n.id!=null&&(n.id=parseInt(n.id)),t.prototype.parse.call(this,n,i)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getName=function(){return this.get("name")},i}(Backbone.Model),i;n.Ownership=t;i=function(i){function r(r,u){i.call(this,r,u);this.url="ownerships.php";this.url=n.Setting.getPhpDir()+this.url;this.model=t}return __extends(r,i),r}(Backbone.Collection);n.Ownerships=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.url="tree.php";this.isSavable=!0;var u=this;this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,lat:0,lng:0,address:"",food:0,type:0,flag:0,owner:0,ownership:0,description:"",updated:moment(new Date).format(n.Setting.getDateTimeFormat())}}return __extends(i,t),i.prototype.parse=function(i,r){return i.id!=null&&(i.id=parseInt(i.id)),i.lat=parseFloat(i.lat),i.lng=parseFloat(i.lng),i.food=parseInt(i.food),i.type=parseInt(i.type),i.owner=parseInt(i.owner),i.ownership=parseInt(i.ownership),i.updated=moment(i.updated).format(n.Setting.getDateTimeFormat()),i.flags=Array(),i.flag!=""&&(i.flags=i.flag.split(",").map(function(n){return parseInt(n)})),i.parents=n.Model.getAdopts().getParentIds(i.id),t.prototype.parse.call(this,i,r)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n.flags&&(n.flag=n.flags.toString()),delete n.flags,delete n.parents,n},i.prototype.getFoodId=function(){return this.get("food")},i.prototype.addFlag=function(n){this.get("flags")==undefined&&this.set("flags",[]);this.get("flags").indexOf(Math.floor(n))<0&&this.get("flags").push(Math.floor(n))},i.prototype.getFlags=function(){return this.get("flags")==undefined&&this.set("flags",[]),this.get("flags")},i.prototype.getCopiedFlags=function(){if(this.get("flags")==undefined)return[];var n=[];return $.each(this.get("flags"),function(t,i){n.push(i)}),n},i.prototype.setFlags=function(n){this.set("flags",n)},i.prototype.getFlag=function(n){return this.get("flags")[n]},i.prototype.removeFlag=function(n){var t=this;t.set("flags",_.without(t.getFlags(),Math.floor(n)));this.get("flags").length==0&&this.get("flags").push(0)},i.prototype.getOwnershipId=function(){return Math.floor(this.get("ownership"))},i.prototype.getName=function(){var n=this;return" #"+n.getId()},i.prototype.getLat=function(){return parseFloat(this.get("lat"))},i.prototype.getLng=function(){return parseFloat(this.get("lng"))},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getParents=function(){var t=new n.Persons;return $.each(this.get("parents"),function(i,r){t.add(n.Model.getPersons().findWhere({id:r}))}),t},i.prototype.getAddress=function(){return this.get("address")},i.prototype.getLocation=function(){return new L.LatLng(this.getLat(),this.getLng())},i.prototype.getDescription=function(){return this.get("description")==""?"&nbsp;":this.get("description")},i.prototype.updateParents=function(){var t=this;t.attributes.parents=n.Model.getAdopts().getParentIds(t.id)},i.prototype.getUpdatedDate=function(){var t=this;return moment(this.get("updated")).format(n.Setting.getDateFormat())},i}(Backbone.Model),i;n.Tree=t;i=function(i){function r(r,u){i.call(this,r,u);this.url="trees.php";this.url=n.Setting.getPhpDir()+this.url;this.model=t}return __extends(r,i),r.prototype.getIds=function(){var t=this,n=Array();return $.each(t.models,function(t,i){n.indexOf(i.getId())==-1&&n.push(i.getId())}),n},r.prototype.getFoodIds=function(){var t=this,n=Array();return $.each(t.models,function(t,i){n.indexOf(i.getFoodId())==-1&&n.push(i.getFoodId())}),n},r.prototype.filterByIds=function(n){var t=this,i=new r(t.models);return i.reset(_.map(n,function(n){return this.get(n)},this))},r.prototype.filterByFoodIds=function(n){var t=this,i=new r(t.models);return new r(i.filter(function(t){return $.inArray(t.getFoodId(),n)>-1?!0:!1}))},r.prototype.filterByFlagIds=function(n){var i=this,t=new r;return $.each(i.models,function(i,r){$.each(r.getFlags(),function(i,u){$.inArray(u,n)>-1&&t.add(r)})}),t},r.prototype.filterByOwnershipIds=function(n){var t=this,i=new r(t.models);return new r(i.filter(function(t){return $.inArray(t.getOwnershipId(),n)>-1?!0:!1}))},r.prototype.filterByAdoptStatus=function(n){var i=this,t=new r;return $.each(i.models,function(i,r){$.inArray(0,n)>-1&&r.get("parents").length==0&&t.where({id:r.getId()})!=undefined&&t.add(r);$.inArray(1,n)>-1&&r.get("parents").length>=1&&t.where({id:r.getId()})!=undefined&&t.add(r)}),t},r.prototype.getAssigned=function(n){var t=this;return $.each(t.models,function(t,i){i.get("parents").length>=1&&n.where({id:i.getId()})!=undefined&&n.add(i)}),n},r.prototype.getUnassigned=function(n){var t=this;return $.each(t.models,function(t,i){i.get("parents").length==0&&n.where({id:i.getId()})!=undefined&&n.add(i)}),n},r.prototype.getFromFoodId=function(n,t){var i=this;return $.each(i.models,function(i,r){r.getFoodId()==t&&n.where({id:r.getId()})!=undefined&&n.add(r)}),n},r.prototype.updateParents=function(){var t=this;$.each(t.models,function(t,i){i.attributes.parents=n.Model.getAdopts().getParentIds(i.id)})},r.prototype.filterByParent=function(t){var u=this,i=new r;return $.each(n.Model.getAdopts().models,function(n,r){if(r.getParentId()==t){var f=u.findWhere({id:r.getTreeId()});i.add(f)}}),i},r}(Backbone.Collection);n.Trees=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.url="flag.php";this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,name:""}}return __extends(i,t),i.prototype.parse=function(n,i){return n.id!=null&&(n.id=parseInt(n.id)),t.prototype.parse.call(this,n,i)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getName=function(){return this.get("name")},i}(Backbone.Model),i;n.Flag=t;i=function(i){function r(r,u){i.call(this,r,u);this.url="flags.php";this.sortType=n.SortType.ASCENDING;this.url=n.Setting.getPhpDir()+this.url;this.model=t}return __extends(r,i),r.prototype.comparator=function(t){var i=this;switch(i.sortType){case n.SortType.NONE:return 0;case n.SortType.ASCENDING:return t.get("name");case n.SortType.DESCENDING:return-t.get("name")}},r.prototype.sortByDescendingName=function(){var t=this;t.sortType=n.SortType.DESCENDING;t.sort()},r.prototype.sortByAscendingName=function(){var n=this;n.models=_.sortBy(n.models,"name")},r}(Backbone.Collection);n.Flags=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t,u,i,r;(function(n){n[n.NONE=0]="NONE";n[n.DESCENDING=1]="DESCENDING";n[n.ASCENDING=2]="ASCENDING"})(n.SortType||(n.SortType={}));t=n.SortType,function(n){n[n.ALL=0]="ALL";n[n.IMAGE=1]="IMAGE";n[n.INFO=2]="INFO";n[n.PICKUP=3]="PICKUP"}(n.NoteType||(n.NoteType={}));u=n.NoteType;i=function(t){function i(i,r){t.call(this,i,r);this.url="note.php";this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,type:0,tree:0,person:0,comment:"",picture:"",rate:0,date:moment(new Date).format(n.Setting.getDateTimeFormat())}}return __extends(i,t),i.prototype.parse=function(i,r){return i.id!=null&&(i.id=parseInt(i.id)),i.type=parseFloat(i.type),i.tree=parseFloat(i.tree),i.person=parseInt(i.person),i.rate=parseFloat(i.rate),i.date=moment(i.date).format(n.Setting.getDateTimeFormat()),i.pictures=Array(),i.picture!=""&&(i.pictures=i.picture.split(",")),t.prototype.parse.call(this,i,r)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n.pictures&&(n.picture=n.pictures.toString()),delete n.pictures,n},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getComment=function(){return this.get("comment")!=""?this.get("comment"):"&nbsp;"},i.prototype.setComment=function(n){this.set("comment",n)},i.prototype.getBlankPicturePath=function(){return n.Setting.getCoreImageDir()+"picture-blank.jpg"},i.prototype.getDateForDatePicker=function(){return moment(this.get("date")).format(n.Setting.getDateForDatePicker())},i.prototype.getFormattedDate=function(){return moment(this.get("date")).format(n.Setting.getDateFormat())},i.prototype.getFormattedDateTime=function(){return moment(this.get("date")).format(n.Setting.getDateTimeFormat())},i.prototype.getFormattedHourTime=function(){return moment(this.get("date")).format(n.Setting.getDateHourFormat())},i.prototype.getDateValueOf=function(){return moment(this.get("date")).valueOf()},i.prototype.getRate=function(){return parseFloat(this.get("rate"))},i.prototype.setRate=function(n){this.set("rate",Math.floor(n))},i.prototype.getType=function(){return parseInt(this.get("type"))},i.prototype.getTreeId=function(){return parseInt(this.get("tree"))},i.prototype.getPersonId=function(){return parseInt(this.get("person"))},i.prototype.setPersonId=function(n){this.set("person",Math.floor(n))},i.prototype.addPicture=function(n){this.get("pictures")==undefined&&this.set("pictures",[]);this.get("pictures").push(n)},i.prototype.getPictures=function(){return this.get("pictures")==undefined&&this.set("pictures",[]),this.get("pictures")},i.prototype.getPicture=function(n){return this.get("pictures")[n]},i.prototype.removePicture=function(n){var t=this;t.set("pictures",_.without(t.getPictures(),n))},i.prototype.setCover=function(n){var t=this,i=t.getPictures()[n];t.set("pictures",_.without(t.getPictures(),i));t.getPictures().unshift(i)},i.prototype.setCoverPicture=function(n){var t=this;t.set("pictures",_.without(t.getPictures(),n));t.getPictures().unshift(n)},i.prototype.setDate=function(t){this.set("date",t.format(n.Setting.getDateTimeFormat()))},i}(Backbone.Model);n.Note=i;r=function(r){function u(u,f){r.call(this,u,f);this.url="notes.php";this.sortType=t.NONE;this.url=n.Setting.getPhpDir()+this.url;this.model=i}return __extends(u,r),u.prototype.comparator=function(n){var i=this;switch(i.sortType){case t.NONE:return 0;case t.ASCENDING:return n.getDateValueOf();case t.DESCENDING:return-n.getDateValueOf()}},u.prototype.sortByDescendingDate=function(){var n=this;n.sortType=t.DESCENDING;n.sort()},u.prototype.sortByAscendingDate=function(){var n=this;n.sortType=t.ASCENDING;n.sort()},u.prototype.getLatestImageNoteOfDate=function(n,t,i){var u=this,r;return u.models.length==0?null:(u.sortByAscendingDate(),r=null,$.each(u.models,function(u,f){if(t>f.getDateValueOf()&&f.getType()==i&&f.getTreeId()==n)r=f;else return r}),r)},u}(Backbone.Collection);n.Notes=r}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.url="person.php";this.isSavable=!0;var u=this;this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,auth:0,name:"",address:"",contact:"",neighborhood:"",updated:moment(new Date).format(n.Setting.getDateTimeFormat())}}return __extends(i,t),i.prototype.parse=function(i,r){return i.id!=null&&(i.id=parseInt(i.id)),i.auth=parseInt(i.auth),i.updated=moment(i.updated).format(n.Setting.getDateTimeFormat()),i.trees=n.Model.getAdopts().getTreeIds(i.id),t.prototype.parse.call(this,i,r)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),delete n.trees,n},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getAuth=function(){var n=this;return Math.floor(this.get("auth"))},i.prototype.getName=function(){var n=this;return this.get("name")===undefined?"<span class='alert'>Unknown<\/span>":this.get("name").trim()==""?this.get("contact"):this.get("name")},i.prototype.getRealName=function(){var n=this;return this.get("name")===undefined?"":this.get("name")},i.prototype.getAddress=function(){var n=this;return this.get("address")},i.prototype.getContact=function(){var n=this;return this.get("contact")},i.prototype.getNeighboorhood=function(){var n=this;return this.get("neighborhood")},i.prototype.updateTrees=function(){var t=this;t.attributes.trees=n.Model.getAdopts().getTreeIds(t.id)},i.prototype.getUpdatedDate=function(){var t=this;return moment(this.get("updated")).format(n.Setting.getDateFormat())},i}(Backbone.Model),i;n.Person=t;i=function(i){function r(r,u){i.call(this,r,u);this.url="persons.php";this.url=n.Setting.getPhpDir()+this.url;this.model=t}return __extends(r,i),r.prototype.getIds=function(){var t=this,n=Array();return $.each(t.models,function(t,i){n.indexOf(i.getId())==-1&&n.push(i.getId())}),n},r.prototype.getAssigned=function(n){var t=this;return $.each(t.models,function(t,i){i.get("trees").length>=1&&n.where({id:i.getId()})!=undefined&&n.add(i)}),n},r.prototype.getUnassigned=function(n){var t=this;return $.each(t.models,function(t,i){i.get("trees").length==0&&n.where({id:i.getId()})!=undefined&&n.add(i)}),n},r.prototype.filterByAuthIds=function(n){var t=this,i=new r(t.models);return new r(i.filter(function(t){return $.inArray(t.getAuth(),n)>-1?!0:!1}))},r.prototype.filterByAdoptStatus=function(n){var i=this,t=new r;return $.each(i.models,function(i,r){$.inArray(0,n)>-1&&r.get("trees").length==0&&t.where({id:r.getId()})!=undefined&&t.add(r);$.inArray(1,n)>-1&&r.get("trees").length>=1&&t.where({id:r.getId()})!=undefined&&t.add(r)}),t},r.prototype.filterByAdoptStatusForTree=function(n,t){var u=this,i=new r;return $.each(u.models,function(r,u){$.inArray(0,n)>-1&&(u.get("trees").length==0||$.inArray(t,u.get("trees"))<0)&&i.where({id:u.getId()})!=undefined&&i.add(u);$.inArray(1,n)>-1&&$.inArray(t,u.get("trees"))>-1&&i.where({id:u.getId()})!=undefined&&i.add(u)}),i},r.prototype.updateTrees=function(){var t=this;$.each(t.models,function(t,i){i.attributes.trees=n.Model.getAdopts().getTreeIds(i.id)})},r.prototype.filterByIds=function(n){var t=this,i=new r(t.models);return i.reset(_.map(n,function(n){return this.get(n)},this))},r}(Backbone.Collection);n.Persons=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t=function(t){function i(i,r){t.call(this,i,r);this.url="place.php";this.isSavable=!0;var u=this;this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,lat:0,lng:0,name:"",address:"",description:"",updated:moment(new Date).format(n.Setting.getDateTimeFormat())}}return __extends(i,t),i.prototype.parse=function(i,r){return i.id!=null&&(i.id=parseInt(i.id)),i.lat=parseFloat(i.lat),i.lng=parseFloat(i.lng),i.updated=moment(i.updated).format(n.Setting.getDateTimeFormat()),t.prototype.parse.call(this,i,r)},i.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n},i.prototype.getFoodId=function(){return this.get("food")},i.prototype.getFlagId=function(){return this.get("flag")},i.prototype.getOwnershipId=function(){return Math.floor(this.get("ownership"))},i.prototype.getName=function(){return this.get("name")},i.prototype.getLocation=function(){return new L.LatLng(this.getLat(),this.getLng())},i.prototype.getAddress=function(){return this.get("address")},i.prototype.getLat=function(){return parseFloat(this.get("lat"))},i.prototype.getLng=function(){return parseFloat(this.get("lng"))},i.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},i.prototype.getDescription=function(){return this.get("description")==""?"&nbsp;":this.get("description")},i}(Backbone.Model),i;n.Place=t;i=function(i){function r(r,u){i.call(this,r,u);this.url="places.php";this.url=n.Setting.getPhpDir()+this.url;this.model=t}return __extends(r,i),r.prototype.getIds=function(){var t=this,n=Array();return $.each(t.models,function(t,i){n.indexOf(i.getId())==-1&&n.push(i.getId())}),n},r.prototype.filterByIds=function(n){var t=this,i=new r(t.models);return i.reset(_.map(n,function(n){return this.get(n)},this))},r}(Backbone.Collection);n.Places=i}(FoodParent||(FoodParent={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var i=function(i){function r(t,r){i.call(this,t,r);this.url="donation.php";this.isSavable=!0;var u=this;this.url=n.Setting.getPhpDir()+this.url;this.defaults={id:0,type:0,place:0,tree:0,quantity:0,picture:"",date:moment(new Date).format(n.Setting.getDateTimeFormat())}}return __extends(r,i),r.prototype.parse=function(t,r){return t.id!=null&&(t.id=parseInt(t.id)),t.type=parseInt(t.type),t.place=parseInt(t.place),t.quantity=parseFloat(t.quantity),t.trees=t.tree.split(",").map(function(n){return parseInt(n)}),t.pictures=Array(),t.picture!=""&&(t.pictures=t.picture.split(",")),t.updated=moment(t.updated).format(n.Setting.getDateTimeFormat()),i.prototype.parse.call(this,t,r)},r.prototype.toJSON=function(){var n=this.clone().attributes;return this.id!=null&&(n.id=this.id),n.trees=_.sortBy(n.trees,function(n){return parseInt(n)}),n.tree=n.trees.toString(),delete n.trees,n.pictures&&(n.picture=n.pictures.toString()),delete n.pictures,n},r.prototype.getPlaceId=function(){return parseFloat(this.get("place"))},r.prototype.getTreeIds=function(){return this.get("trees")==undefined&&this.set("trees",[]),this.get("trees")},r.prototype.getType=function(){return Math.floor(this.get("type"))},r.prototype.setType=function(n){this.set("type",n)},r.prototype.getComment=function(){var r=this,t="<strong>"+r.getQuantity()+" lbs.<\/strong> of ",i=r.getTreeIds();return $.each(i,function(r,u){var f=n.Model.getTrees().findWhere({id:Math.floor(u)}),e=n.Model.getFoods().findWhere({id:f.getFoodId()});r==0&&(t+=i.length==1?"<strong><i>"+e.getName()+"<\/i><\/strong> has been donated from tree ":"<strong><i>"+e.getName()+"<\/i><\/strong> has been donated from trees ");t+=r<i.length-1?"<strong>"+f.getName()+"<\/strong>, ":"<strong>"+f.getName()+"<\/strong>."}),t},r.prototype.getCommentWithDate=function(){var i=this,t="<strong>"+i.getQuantity()+" lbs.<\/strong> of ",r=i.getTreeIds();return $.each(r,function(i,u){var f=n.Model.getTrees().findWhere({id:Math.floor(u)}),e=n.Model.getFoods().findWhere({id:f.getFoodId()});i==0&&(t+=r.length==1?"<strong><i>"+e.getName()+"<\/i><\/strong> has been donated from tree ":"<strong><i>"+e.getName()+"<\/i><\/strong> has been donated from trees ");t+=i<r.length-1?"<strong>"+f.getName()+"<\/strong>, ":"<strong>"+f.getName()+"<\/strong> "}),t+="("+i.getFormattedDate()+")"},r.prototype.addTreeId=function(n){this.get("trees")==undefined&&this.set("trees",[]);this.get("trees").indexOf(n)<0&&this.get("trees").push(n)},r.prototype.hasTreeId=function(n){return(this.get("trees")==undefined&&this.set("trees",[]),this.get("trees").indexOf(n)<0)?!1:!0},r.prototype.removeTreeId=function(n){var t=_.reject(this.get("trees"),function(t){return parseInt(t)==n});this.set("trees",t)},r.prototype.getId=function(){return this.id!=undefined?Math.floor(this.id):null},r.prototype.getQuantity=function(){return parseFloat(this.get("quantity"))},r.prototype.setQuantity=function(n){this.set("quantity",n)},r.prototype.getCumulativeQuantity=function(){var r=this,u=new t(n.Model.getDonations().where({place:r.getPlaceId()})),i;return u.sortByAscendingDate(),i=0,$.each(u.models,function(n,t){if(r.getEndOfDateValueOf()>=t.getStartOfDateValueOf())i+=t.getQuantity();else return i}),i},r.prototype.setDate=function(n){this.set("date",n)},r.prototype.getDateForDatePicker=function(){return moment(this.get("date")).format(n.Setting.getDateForDatePicker())},r.prototype.getFormattedDate=function(){return moment(this.get("date")).format(n.Setting.getDateFormat())},r.prototype.getFormattedDateTime=function(){return moment(this.get("date")).format(n.Setting.getDateTimeFormat())},r.prototype.getFormattedHourTime=function(){return moment(this.get("date")).format(n.Setting.getDateHourFormat())},r.prototype.getDateValueOf=function(){return moment(this.get("date")).valueOf()},r.prototype.getStartOfDateValueOf=function(){return moment(this.get("date")).startOf("day").valueOf()},r.prototype.getEndOfDateValueOf=function(){return moment(this.get("date")).endOf("day").valueOf()},r.prototype.addPicture=function(n){this.get("pictures")==undefined&&this.set("pictures",[]);this.get("pictures").push(n)},r.prototype.getPictures=function(){return this.get("pictures")==undefined&&this.set("pictures",[]),this.get("pictures")},r.prototype.getPicture=function(n){return this.get("pictures")[n]},r.prototype.removePicture=function(n){var t=this;t.set("pictures",_.without(t.getPictures(),n))},r.prototype.setCover=function(n){var t=this,i=t.getPictures()[n];t.set("pictures",_.without(t.getPictures(),i));t.getPictures().unshift(i)},r.prototype.setCoverPicture=function(n){var t=this;t.set("pictures",_.without(t.getPictures(),n));t.getPictures().unshift(n)},r}(Backbone.Model),t;n.Donation=i;t=function(t){function r(r,u){t.call(this,r,u);this.url="donations.php";this.sortType=n.SortType.NONE;this.url=n.Setting.getPhpDir()+this.url;this.model=i}return __extends(r,t),r.prototype.getIds=function(){var t=this,n=Array();return $.each(t.models,function(t,i){n.indexOf(i.getId())==-1&&n.push(i.getId())}),n},r.prototype.filterByIds=function(n){var t=this,i=new r(t.models);return i.reset(_.map(n,function(n){return this.get(n)},this))},r.prototype.comparator=function(t){var i=this;switch(i.sortType){case n.SortType.NONE:return 0;case n.SortType.ASCENDING:return t.getDateValueOf();case n.SortType.DESCENDING:return-t.getDateValueOf()}},r.prototype.sortByDescendingDate=function(){var t=this;t.sortType=n.SortType.DESCENDING;t.sort()},r.prototype.sortByAscendingDate=function(){var t=this;t.sortType=n.SortType.ASCENDING;t.sort()},r.prototype.getLatestDonationOfDate=function(n,t){var r=this,i;return r.models.length==0?null:(r.sortByAscendingDate(),i=null,$.each(r.models,function(r,u){if(t>u.getDateValueOf()&&u.getPlaceId()==n)i=u;else return i}),i)},r}(Backbone.Collection);n.Donations=t}(FoodParent||(FoodParent={}));